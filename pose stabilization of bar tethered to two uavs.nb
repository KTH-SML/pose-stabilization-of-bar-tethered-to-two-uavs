(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   1190619,      31601]
NotebookOptionsPosition[   1149456,      30221]
NotebookOutlinePosition[   1149794,      30236]
CellTagsIndexPosition[   1149751,      30233]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pose Stabilization of a Bar Tethered to Two Aerial Vehicles", "Title",
 CellChangeTimes->{
  3.7134457082910023`*^9, 3.730327197115204*^9, {3.733159388769784*^9, 
   3.733159388980277*^9}}],

Cell[BoxData[
 RowBox[{"(*", "title", "*)"}]], "Input",
 CellChangeTimes->{{3.729372020893559*^9, 3.7293720318693132`*^9}, {
  3.7294632905534983`*^9, 3.729463292589266*^9}, {3.730327200076746*^9, 
  3.730327200745804*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linearization in manifold", "Title",
 CellChangeTimes->{{3.7303328460143538`*^9, 3.7303328502311897`*^9}}],

Cell["This procedure is explained in companion pdf", "Text",
 CellChangeTimes->{{3.733159404815476*^9, 3.733159422763246*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Linearization", "[", "\[IndentingNewLine]", 
    RowBox[{"VectorField_", ",", 
     RowBox[{"(*", 
      RowBox[{"vector", " ", "field"}], "*)"}], "\[IndentingNewLine]", 
     "SetDefiningConstraints_", ",", 
     RowBox[{"(*", 
      RowBox[{
      "constraints", " ", "that", " ", "define", " ", "state", " ", "space", 
       " ", "where", " ", "vector", " ", "field", " ", "is", " ", "defined"}],
       "*)"}], "\[IndentingNewLine]", "EquilibriumPoint_", ",", 
     RowBox[{"(*", 
      RowBox[{
      "equilibrium", " ", "point", " ", "around", " ", "which", " ", 
       "linearization", " ", "is", " ", "performed"}], "*)"}], 
     "\[IndentingNewLine]", "ApplySimplifications_"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "any", " ", "simplifications", " ", "that", " ", "the", " ", "user", 
       " ", "may", " ", "deem", " ", 
       RowBox[{"appropriate", ":", " ", 
        RowBox[{"e", ".", "g", "."}]}]}], ",", " ", 
      RowBox[{"parameter", " ", "\"\<m\>\"", " ", "is", " ", "positive"}]}], 
     "*)"}], "\[IndentingNewLine]", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z", "=", "VectorField"}], ",", "\[IndentingNewLine]", 
       RowBox[{"C", "=", "SetDefiningConstraints"}], ",", "CCT", ",", "Proj", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"z", "=", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["z", "#"], "&"}], ",", 
          RowBox[{"Length", "[", "EquilibriumPoint", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "DC", ",", "A0", ",", "A1"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"NewVectorField", " ", "=", " ", 
          RowBox[{
           RowBox[{"Z", "[", "z", "]"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"DC", "[", "zeq", "]"}], "]"}], ".", 
            RowBox[{"Inverse", "[", 
             RowBox[{
              RowBox[{"DC", "[", "zeq", "]"}], ".", 
              RowBox[{"Transpose", "[", 
               RowBox[{"DC", "[", "zeq", "]"}], "]"}]}], "]"}]}]}]}], "]"}], 
        ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"DC", "[", "z", "]"}], ".", 
           RowBox[{"Z", "[", "z", "]"}]}], "+", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"C", "[", "z", "]"}]}]}], ")"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DC", "=", 
       RowBox[{"ApplySimplifications", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"C", "[", "z", "]"}], ",", 
           RowBox[{"{", "z", "}"}]}], "]"}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"z", "\[Rule]", " ", "EquilibriumPoint"}], "]"}]}], "]"}]}],
       ";", 
      RowBox[{"(*", 
       RowBox[{"derivative", " ", "of", " ", "constraints", " ", "map"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CCT", "=", 
       RowBox[{"ApplySimplifications", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "DC", "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"DC", ".", 
           RowBox[{"Transpose", "[", "DC", "]"}]}], "]"}], ".", "DC"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Proj", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "EquilibriumPoint", "]"}], "]"}], "-", 
        "CCT"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "projection", " ", "onto", " ", "space", " ", "orthogonal", " ", "to", 
        " ", "DC"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"A0", "=", 
       RowBox[{"ApplySimplifications", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Z", "[", "z", "]"}], ",", 
           RowBox[{"{", "z", "}"}]}], "]"}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"z", "\[Rule]", " ", "EquilibriumPoint"}], "]"}]}], "]"}]}],
       ";", 
      RowBox[{"(*", 
       RowBox[{"state", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"A1", "=", 
       RowBox[{"ApplySimplifications", "[", 
        RowBox[{
         RowBox[{"Proj", ".", "A0"}], "-", 
         RowBox[{"\[Lambda]", " ", "CCT"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "modified", " ", "state", " ", "matrix", " ", "that", " ", "is", " ", 
        "easier", " ", "to", " ", "analyze"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{"A0", ",", "A1"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Linearization", "[", "\[IndentingNewLine]", 
     RowBox[{
     "VectorField_", ",", "\[IndentingNewLine]", "SetDefiningConstraints_", 
      ",", "\[IndentingNewLine]", "EquilibriumPoint_", ",", 
      "\[IndentingNewLine]", "ApplySimplifications_"}], "\[IndentingNewLine]",
      "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Z", "=", "VectorField"}], ",", "\[IndentingNewLine]", 
        RowBox[{"C", "=", "SetDefiningConstraints"}], ",", "CCT", ",", "Proj",
         ",", "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["z", "#"], "&"}], ",", 
           RowBox[{"Length", "[", "EquilibriumPoint", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "DC", ",", "A0", ",", "A1"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NewVectorField", " ", "=", " ", 
           RowBox[{
            RowBox[{"Z", "[", "z", "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"DC", "[", "zeq", "]"}], "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"DC", "[", "zeq", "]"}], ".", 
               RowBox[{"Transpose", "[", 
                RowBox[{"DC", "[", "zeq", "]"}], "]"}]}], "]"}]}]}]}], "]"}], 
         ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"DC", "[", "z", "]"}], ".", 
            RowBox[{"Z", "[", "z", "]"}]}], "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"C", "[", "z", "]"}]}]}], ")"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DC", "=", 
        RowBox[{"ApplySimplifications", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"C", "[", "z", "]"}], ",", 
            RowBox[{"{", "z", "}"}]}], "]"}], "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"z", "\[Rule]", " ", "EquilibriumPoint"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CCT", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "DC", "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"DC", ".", 
           RowBox[{"Transpose", "[", "DC", "]"}]}], "]"}], ".", "DC"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Proj", "=", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "EquilibriumPoint", "]"}], "]"}], "-", 
         "CCT"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"A0", "=", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Z", "[", "z", "]"}], ",", 
           RowBox[{"{", "z", "}"}]}], "]"}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"z", "\[Rule]", " ", "EquilibriumPoint"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A1", "=", 
        RowBox[{"ApplySimplifications", "[", 
         RowBox[{
          RowBox[{"Proj", ".", "A0"}], "-", 
          RowBox[{"\[Lambda]", " ", "CCT"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"A0", ",", "A1"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.726663460264488*^9, 3.72666361350443*^9}, {
   3.726663681024269*^9, 3.726663781748385*^9}, {3.7266638330146103`*^9, 
   3.726663908359077*^9}, {3.726663945269642*^9, 3.7266639460814857`*^9}, {
   3.726664017147196*^9, 3.7266642371302147`*^9}, {3.726664321478093*^9, 
   3.726664321782371*^9}, {3.72666639353559*^9, 3.7266665670543528`*^9}, {
   3.726666624762109*^9, 3.726666713868352*^9}, {3.726666828693487*^9, 
   3.726666828921791*^9}, {3.7266669602572002`*^9, 3.726666960963664*^9}, 
   3.7266672404055147`*^9, {3.730331945104433*^9, 3.730331960973138*^9}, 
   3.7303320384570637`*^9, {3.730332859809969*^9, 3.730332904806654*^9}, {
   3.7303346015948067`*^9, 3.730334604804488*^9}, {3.7331594261070833`*^9, 
   3.7331595047092953`*^9}, {3.733159537551491*^9, 3.7331596138765917`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Routh\[CloseCurlyQuote]s Criterion", "Title",
 CellChangeTimes->{{3.7134458142349358`*^9, 3.713445817129426*^9}}],

Cell[CellGroupData[{

Cell["Controllable canonical form matrix", "Chapter",
 CellChangeTimes->{{3.7120541198105907`*^9, 3.71205412486038*^9}, {
  3.733159627983445*^9, 3.733159629892202*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"addrow", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"Length", "[", "a", "]"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "a", "]"}], "+", "1", "-", 
         RowBox[{
          RowBox[{"Dimensions", "[", "#", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "}"}], ",", "#"}], "]"}],
    "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "a_", "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{
    RowBox[{"addrow", "[", "a", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"-", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "]"}], 
  "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7120552813651543`*^9, 3.712055332502823*^9}, {
  3.712055374880151*^9, 3.7120554005155563`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.712854454801506*^9, 3.712857947760923*^9, 
   3.7129284352718563`*^9, 3.712930456299375*^9, 3.7134490623729753`*^9, {
   3.713449635190847*^9, 3.713449646270899*^9}, 3.7134497195704536`*^9, 
   3.713600589550254*^9, {3.713600669796749*^9, 3.713600683111655*^9}, 
   3.714029481675905*^9, 3.71403401884622*^9, 3.7246715181240473`*^9, 
   3.724674983040628*^9, 3.72467528784503*^9, 3.7246758919746733`*^9, 
   3.724676583557749*^9, 3.724676727245852*^9, 3.724677334248103*^9, 
   3.7246775002132177`*^9, 3.724677952453723*^9, 3.724678210545084*^9, 
   3.724678650264865*^9, 3.7246823106354227`*^9, 3.7246825541960917`*^9, 
   3.724683556815722*^9, 3.724683740735095*^9, 3.724684495619385*^9, 
   3.7246847044153557`*^9, 3.724751465051605*^9, 3.724754558730975*^9, 
   3.724767519631216*^9, 3.72476847995142*^9, 3.724768687426711*^9, 
   3.724853586187841*^9, 3.7248558221351347`*^9, 3.724856229199684*^9, 
   3.724910241150772*^9, 3.724938621849215*^9, 3.7262966714634657`*^9, 
   3.726766043233604*^9, 3.72908302676915*^9, 3.729209758207439*^9, 
   3.729274740477643*^9, 3.729280232685474*^9, 3.729370990074807*^9, 
   3.7303314498529243`*^9, 3.730331627431924*^9, 3.730333822631824*^9, 
   3.730334236837236*^9, 3.730336439448463*^9, 3.730342263442474*^9, 
   3.7303842830822573`*^9, 3.73038765071859*^9, 3.73038804765624*^9, 
   3.730392909189591*^9, 3.7304019224651423`*^9, 3.730407789150428*^9, 
   3.730412948214028*^9, 3.7304160679328337`*^9, 3.7304164003302526`*^9, 
   3.7304165206015453`*^9, 3.73308828855921*^9, 3.7331510736112013`*^9, 
   3.733159623406992*^9, 3.733161253518875*^9, 3.733161316739142*^9, 
   3.7331626453016853`*^9, 3.733255123489788*^9, 3.733255901848762*^9, 
   3.7332585593282833`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.712854454801506*^9, 3.712857947760923*^9, 
   3.7129284352718563`*^9, 3.712930456299375*^9, 3.7134490623729753`*^9, {
   3.713449635190847*^9, 3.713449646270899*^9}, 3.7134497195704536`*^9, 
   3.713600589550254*^9, {3.713600669796749*^9, 3.713600683111655*^9}, 
   3.714029481675905*^9, 3.71403401884622*^9, 3.7246715181240473`*^9, 
   3.724674983040628*^9, 3.72467528784503*^9, 3.7246758919746733`*^9, 
   3.724676583557749*^9, 3.724676727245852*^9, 3.724677334248103*^9, 
   3.7246775002132177`*^9, 3.724677952453723*^9, 3.724678210545084*^9, 
   3.724678650264865*^9, 3.7246823106354227`*^9, 3.7246825541960917`*^9, 
   3.724683556815722*^9, 3.724683740735095*^9, 3.724684495619385*^9, 
   3.7246847044153557`*^9, 3.724751465051605*^9, 3.724754558730975*^9, 
   3.724767519631216*^9, 3.72476847995142*^9, 3.724768687426711*^9, 
   3.724853586187841*^9, 3.7248558221351347`*^9, 3.724856229199684*^9, 
   3.724910241150772*^9, 3.724938621849215*^9, 3.7262966714634657`*^9, 
   3.726766043233604*^9, 3.72908302676915*^9, 3.729209758207439*^9, 
   3.729274740477643*^9, 3.729280232685474*^9, 3.729370990074807*^9, 
   3.7303314498529243`*^9, 3.730331627431924*^9, 3.730333822631824*^9, 
   3.730334236837236*^9, 3.730336439448463*^9, 3.730342263442474*^9, 
   3.7303842830822573`*^9, 3.73038765071859*^9, 3.73038804765624*^9, 
   3.730392909189591*^9, 3.7304019224651423`*^9, 3.730407789150428*^9, 
   3.730412948214028*^9, 3.7304160679328337`*^9, 3.7304164003302526`*^9, 
   3.7304165206015453`*^9, 3.73308828855921*^9, 3.7331510736112013`*^9, 
   3.733159623406992*^9, 3.733161253518875*^9, 3.733161316739142*^9, 
   3.7331626453016853`*^9, 3.733255123489788*^9, 3.733255901848762*^9, 
   3.733258559330667*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}], 
      RowBox[{"-", "a4"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.712854454801506*^9, 3.712857947760923*^9, 
   3.7129284352718563`*^9, 3.712930456299375*^9, 3.7134490623729753`*^9, {
   3.713449635190847*^9, 3.713449646270899*^9}, 3.7134497195704536`*^9, 
   3.713600589550254*^9, {3.713600669796749*^9, 3.713600683111655*^9}, 
   3.714029481675905*^9, 3.71403401884622*^9, 3.7246715181240473`*^9, 
   3.724674983040628*^9, 3.72467528784503*^9, 3.7246758919746733`*^9, 
   3.724676583557749*^9, 3.724676727245852*^9, 3.724677334248103*^9, 
   3.7246775002132177`*^9, 3.724677952453723*^9, 3.724678210545084*^9, 
   3.724678650264865*^9, 3.7246823106354227`*^9, 3.7246825541960917`*^9, 
   3.724683556815722*^9, 3.724683740735095*^9, 3.724684495619385*^9, 
   3.7246847044153557`*^9, 3.724751465051605*^9, 3.724754558730975*^9, 
   3.724767519631216*^9, 3.72476847995142*^9, 3.724768687426711*^9, 
   3.724853586187841*^9, 3.7248558221351347`*^9, 3.724856229199684*^9, 
   3.724910241150772*^9, 3.724938621849215*^9, 3.7262966714634657`*^9, 
   3.726766043233604*^9, 3.72908302676915*^9, 3.729209758207439*^9, 
   3.729274740477643*^9, 3.729280232685474*^9, 3.729370990074807*^9, 
   3.7303314498529243`*^9, 3.730331627431924*^9, 3.730333822631824*^9, 
   3.730334236837236*^9, 3.730336439448463*^9, 3.730342263442474*^9, 
   3.7303842830822573`*^9, 3.73038765071859*^9, 3.73038804765624*^9, 
   3.730392909189591*^9, 3.7304019224651423`*^9, 3.730407789150428*^9, 
   3.730412948214028*^9, 3.7304160679328337`*^9, 3.7304164003302526`*^9, 
   3.7304165206015453`*^9, 3.73308828855921*^9, 3.7331510736112013`*^9, 
   3.733159623406992*^9, 3.733161253518875*^9, 3.733161316739142*^9, 
   3.7331626453016853`*^9, 3.733255123489788*^9, 3.733255901848762*^9, 
   3.7332585593324823`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hurwitz conditions", "Chapter",
 CellChangeTimes->{{3.7120554792779493`*^9, 3.712055483753387*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<hurwitz_conditions.nb\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.71005535745792*^9, 3.710055358482471*^9}, {
   3.710055419189004*^9, 3.710055459554541*^9}, {3.7100555370149403`*^9, 
   3.710055548671946*^9}, 3.710055638835634*^9, 3.710057803745392*^9, {
   3.7100599861952877`*^9, 3.710059990024391*^9}, 3.7101574160581427`*^9, {
   3.710157992771703*^9, 3.710157993807963*^9}, {3.712055524490918*^9, 
   3.712055546142333*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[CapitalGamma]3 (all terms need to be positive: in first column of Routh\
\[CloseCurlyQuote]s table)\
\>", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
  3.7120557198662043`*^9, 3.712055720104171*^9}, {3.713449075653973*^9, 
  3.713449081278111*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]\[CapitalGamma]3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", " ", 
      RowBox[{"(", 
       RowBox[{"kp", "+", "fp"}], ")"}]}], " ", ",", 
     RowBox[{
      RowBox[{"fd", " ", "kd"}], "+", "fp"}], ",", "fd"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]3", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]3", "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712930462315465*^9, 3.7129304785245113`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fd"}], " ", 
       RowBox[{"(", 
        RowBox[{"fp", "+", "kp"}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "fp"}], "-", 
       RowBox[{"fd", " ", "kd"}]}], 
      RowBox[{"-", "fd"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7129304759074497`*^9, 3.712930478950245*^9}, 
   3.7134490711519413`*^9, {3.713449637190078*^9, 3.713449648021843*^9}, 
   3.7134497212550783`*^9, 3.713600592366877*^9, {3.713600672100586*^9, 
   3.713600685200796*^9}, 3.714029483707858*^9, 3.7140340206801443`*^9, 
   3.7246715201048937`*^9, 3.724674986264709*^9, 3.724675290620441*^9, 
   3.724675894443315*^9, 3.724676585559958*^9, 3.7246767292665787`*^9, 
   3.724677336316337*^9, 3.724677500981073*^9, 3.724677954783415*^9, 
   3.724678213039586*^9, 3.7246786526353807`*^9, 3.724682313012442*^9, 
   3.724682557070899*^9, 3.724683559416437*^9, 3.724683742871294*^9, 
   3.724684497606535*^9, 3.724684706481213*^9, 3.724751468072857*^9, 
   3.724754560968288*^9, 3.724767523561438*^9, 3.724768482472218*^9, 
   3.724768689764515*^9, 3.724853588895208*^9, 3.7248558260573463`*^9, 
   3.7248562318344603`*^9, 3.7249102446774673`*^9, 3.7249386239558697`*^9, 
   3.726296677842486*^9, 3.7290830319986877`*^9, 3.729209761219206*^9, 
   3.7292747427579327`*^9, 3.729280238268777*^9, 3.729370996968089*^9, 
   3.729371156789001*^9, 3.730331452125552*^9, 3.730331629855007*^9, 
   3.730333824623234*^9, 3.730334239210433*^9, 3.730336441599642*^9, 
   3.730342265465558*^9, 3.73038428510623*^9, 3.7303876551821747`*^9, 
   3.730388049662773*^9, 3.7303929118983583`*^9, 3.7304019245245333`*^9, 
   3.730407791087246*^9, 3.730412951744726*^9, 3.73041607007203*^9, 
   3.730416402516968*^9, 3.730416523111849*^9, 3.733088291372851*^9, 
   3.733151082486824*^9, 3.733159639185594*^9, 3.733161254624358*^9, 
   3.733161317788463*^9, 3.733162647220543*^9, 3.7332551252464657`*^9, 
   3.733255903657474*^9, 3.733258560935116*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"fd"},
      {
       RowBox[{"fd", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fd", " ", "kd"}], "-", "kp"}], ")"}]}]},
      {
       RowBox[{"fd", " ", 
        RowBox[{"(", 
         RowBox[{"fp", "+", "kp"}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7129304759074497`*^9, 3.712930478950245*^9}, 
   3.7134490711519413`*^9, {3.713449637190078*^9, 3.713449648021843*^9}, 
   3.7134497212550783`*^9, 3.713600592366877*^9, {3.713600672100586*^9, 
   3.713600685200796*^9}, 3.714029483707858*^9, 3.7140340206801443`*^9, 
   3.7246715201048937`*^9, 3.724674986264709*^9, 3.724675290620441*^9, 
   3.724675894443315*^9, 3.724676585559958*^9, 3.7246767292665787`*^9, 
   3.724677336316337*^9, 3.724677500981073*^9, 3.724677954783415*^9, 
   3.724678213039586*^9, 3.7246786526353807`*^9, 3.724682313012442*^9, 
   3.724682557070899*^9, 3.724683559416437*^9, 3.724683742871294*^9, 
   3.724684497606535*^9, 3.724684706481213*^9, 3.724751468072857*^9, 
   3.724754560968288*^9, 3.724767523561438*^9, 3.724768482472218*^9, 
   3.724768689764515*^9, 3.724853588895208*^9, 3.7248558260573463`*^9, 
   3.7248562318344603`*^9, 3.7249102446774673`*^9, 3.7249386239558697`*^9, 
   3.726296677842486*^9, 3.7290830319986877`*^9, 3.729209761219206*^9, 
   3.7292747427579327`*^9, 3.729280238268777*^9, 3.729370996968089*^9, 
   3.729371156789001*^9, 3.730331452125552*^9, 3.730331629855007*^9, 
   3.730333824623234*^9, 3.730334239210433*^9, 3.730336441599642*^9, 
   3.730342265465558*^9, 3.73038428510623*^9, 3.7303876551821747`*^9, 
   3.730388049662773*^9, 3.7303929118983583`*^9, 3.7304019245245333`*^9, 
   3.730407791087246*^9, 3.730412951744726*^9, 3.73041607007203*^9, 
   3.730416402516968*^9, 3.730416523111849*^9, 3.733088291372851*^9, 
   3.733151082486824*^9, 3.733159639185594*^9, 3.733161254624358*^9, 
   3.733161317788463*^9, 3.733162647220543*^9, 3.7332551252464657`*^9, 
   3.733255903657474*^9, 3.7332585609363327`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[CapitalGamma]5 (all terms need to be positive: in first column of Routh\
\[CloseCurlyQuote]s table)\
\>", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
   3.712055595766025*^9, 3.712055596366538*^9}, {3.712055702778782*^9, 
   3.712055713266334*^9}, 3.712154265780588*^9, 3.71344908635152*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]\[CapitalGamma]5", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fd", " ", "fp", " ", "kp"}], " ", ",", 
        RowBox[{"fp", " ", "fd", " ", "kv"}], ",", 
        RowBox[{"fd", 
         RowBox[{"(", 
          RowBox[{"kp", "+", " ", 
           RowBox[{"fp", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], " ", ",", 
        RowBox[{
         RowBox[{"fd", " ", "kv"}], "+", 
         RowBox[{"fp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "fd"}], "}"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]5", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]5", "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712854475602787*^9, 3.7128545452865553`*^9}, {
  3.7128546037419252`*^9, 3.712854639899626*^9}, {3.712854782574995*^9, 
  3.712854790674692*^9}, {3.712855059645575*^9, 3.712855060238492*^9}, {
  3.7128552583318768`*^9, 3.7128552596810207`*^9}, {3.7128554224390697`*^9, 
  3.712855430784445*^9}, {3.7128556039266567`*^9, 3.712855607155005*^9}, {
  3.7128565905430307`*^9, 3.7128566070877733`*^9}, {3.71285702699781*^9, 
  3.712857040329*^9}, {3.712857087715067*^9, 3.712857091194635*^9}, {
  3.71285795421245*^9, 3.712857999637442*^9}, {3.712928444078889*^9, 
  3.712928627056727*^9}, {3.712928757908557*^9, 3.712928773069557*^9}, {
  3.729371003145669*^9, 3.729371033374247*^9}, {3.729371149420752*^9, 
  3.72937115221913*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fd"}], " ", "fp", " ", "kp"}], 
      RowBox[{
       RowBox[{"-", "fd"}], " ", "fp", " ", "kv"}], 
      RowBox[{
       RowBox[{"-", "fd"}], " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "fd"}], " ", "kv"}], "-", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}]}]}], 
      RowBox[{"-", "fd"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.714034020750087*^9, 3.7246715201730223`*^9, 
   3.7246749863616667`*^9, 3.724675290795164*^9, 3.724675894627564*^9, 
   3.724676585714593*^9, 3.7246767294333553`*^9, 3.724677336482195*^9, 
   3.724677501165421*^9, 3.7246779549204884`*^9, 3.7246782132856417`*^9, 
   3.724678652784285*^9, 3.7246823131634083`*^9, 3.724682557219479*^9, 
   3.724683559549835*^9, 3.724683743021758*^9, 3.7246844977751207`*^9, 
   3.7246847066720343`*^9, 3.724751468250647*^9, 3.724754561085058*^9, 
   3.724767523774898*^9, 3.724768482603153*^9, 3.7247686899270678`*^9, 
   3.724853589193647*^9, 3.7248558263610563`*^9, 3.724856231984133*^9, 
   3.724910244931972*^9, 3.7249386240750513`*^9, 3.726296677903413*^9, 
   3.7290830321304407`*^9, 3.7292097613319407`*^9, 3.7292747428416433`*^9, 
   3.7292802383983603`*^9, {3.729371004534656*^9, 3.729371034121004*^9}, {
   3.729371152871213*^9, 3.729371158557995*^9}, 3.730331452258939*^9, 
   3.7303316299703197`*^9, 3.7303338246925173`*^9, 3.730334239274189*^9, 
   3.730336441670321*^9, 3.7303422655300827`*^9, 3.73038428517293*^9, 
   3.730387655249927*^9, 3.73038804972892*^9, 3.7303929119802437`*^9, 
   3.730401924607839*^9, 3.730407791154995*^9, 3.7304129518075113`*^9, 
   3.7304160701583*^9, 3.730416402585884*^9, 3.730416523177854*^9, 
   3.733088291449519*^9, 3.733151082587467*^9, 3.733159641379445*^9, 
   3.73316125464016*^9, 3.73316131780702*^9, 3.7331626473032713`*^9, 
   3.7332551253220243`*^9, 3.733255903949127*^9, 3.733258561009883*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"fd"},
      {
       RowBox[{"fd", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kp"}], "+", 
          RowBox[{"fd", " ", "kv"}]}], ")"}]}]},
      {
       RowBox[{
        SuperscriptBox["fd", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kp"}], "+", 
          RowBox[{"fd", " ", "kv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "q"}]}], ")"}]}]},
      {
       RowBox[{
        SuperscriptBox["fd", "2"], " ", 
        SuperscriptBox["fp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"kp", "-", 
           RowBox[{"fd", " ", "kv"}]}], ")"}], "2"], " ", "q"}]},
      {
       RowBox[{"fd", " ", "fp", " ", "kp"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.714034020750087*^9, 3.7246715201730223`*^9, 
   3.7246749863616667`*^9, 3.724675290795164*^9, 3.724675894627564*^9, 
   3.724676585714593*^9, 3.7246767294333553`*^9, 3.724677336482195*^9, 
   3.724677501165421*^9, 3.7246779549204884`*^9, 3.7246782132856417`*^9, 
   3.724678652784285*^9, 3.7246823131634083`*^9, 3.724682557219479*^9, 
   3.724683559549835*^9, 3.724683743021758*^9, 3.7246844977751207`*^9, 
   3.7246847066720343`*^9, 3.724751468250647*^9, 3.724754561085058*^9, 
   3.724767523774898*^9, 3.724768482603153*^9, 3.7247686899270678`*^9, 
   3.724853589193647*^9, 3.7248558263610563`*^9, 3.724856231984133*^9, 
   3.724910244931972*^9, 3.7249386240750513`*^9, 3.726296677903413*^9, 
   3.7290830321304407`*^9, 3.7292097613319407`*^9, 3.7292747428416433`*^9, 
   3.7292802383983603`*^9, {3.729371004534656*^9, 3.729371034121004*^9}, {
   3.729371152871213*^9, 3.729371158557995*^9}, 3.730331452258939*^9, 
   3.7303316299703197`*^9, 3.7303338246925173`*^9, 3.730334239274189*^9, 
   3.730336441670321*^9, 3.7303422655300827`*^9, 3.73038428517293*^9, 
   3.730387655249927*^9, 3.73038804972892*^9, 3.7303929119802437`*^9, 
   3.730401924607839*^9, 3.730407791154995*^9, 3.7304129518075113`*^9, 
   3.7304160701583*^9, 3.730416402585884*^9, 3.730416523177854*^9, 
   3.733088291449519*^9, 3.733151082587467*^9, 3.733159641379445*^9, 
   3.73316125464016*^9, 3.73316131780702*^9, 3.7331626473032713`*^9, 
   3.7332551253220243`*^9, 3.733255903949127*^9, 3.733258561018372*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[CapitalGamma]4 (all terms need to be positive: in first column of Routh\
\[CloseCurlyQuote]s table)\
\>", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
   3.712055595766025*^9, 3.712055596366538*^9}, {3.712055702778782*^9, 
   3.712055713266334*^9}, 3.712154265780588*^9, 3.71344908635152*^9, 
   3.729371063090432*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]\[CapitalGamma]4", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"fp", " ", "kp"}], " ", ",", 
        RowBox[{"fp", " ", "kv"}], ",", 
        RowBox[{"kp", "+", " ", 
         RowBox[{"fp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}]}]}], " ", ",", " ", "kv"}], "}"}]}],
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712854475602787*^9, 3.7128545452865553`*^9}, {
  3.7128546037419252`*^9, 3.712854639899626*^9}, {3.712854782574995*^9, 
  3.712854790674692*^9}, {3.712855059645575*^9, 3.712855060238492*^9}, {
  3.7128552583318768`*^9, 3.7128552596810207`*^9}, {3.7128554224390697`*^9, 
  3.712855430784445*^9}, {3.7128556039266567`*^9, 3.712855607155005*^9}, {
  3.7128565905430307`*^9, 3.7128566070877733`*^9}, {3.71285702699781*^9, 
  3.712857040329*^9}, {3.712857087715067*^9, 3.712857091194635*^9}, {
  3.71285795421245*^9, 3.712857999637442*^9}, {3.712928444078889*^9, 
  3.712928627056727*^9}, {3.712928757908557*^9, 3.712928773069557*^9}, {
  3.729371003145669*^9, 3.729371033374247*^9}, {3.729371087075905*^9, 
  3.7293711381116*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fp"}], " ", "kp"}], 
      RowBox[{
       RowBox[{"-", "fp"}], " ", "kv"}], 
      RowBox[{
       RowBox[{"-", "kp"}], "-", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}]}]}], 
      RowBox[{"-", "kv"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.714034020750087*^9, 3.7246715201730223`*^9, 
   3.7246749863616667`*^9, 3.724675290795164*^9, 3.724675894627564*^9, 
   3.724676585714593*^9, 3.7246767294333553`*^9, 3.724677336482195*^9, 
   3.724677501165421*^9, 3.7246779549204884`*^9, 3.7246782132856417`*^9, 
   3.724678652784285*^9, 3.7246823131634083`*^9, 3.724682557219479*^9, 
   3.724683559549835*^9, 3.724683743021758*^9, 3.7246844977751207`*^9, 
   3.7246847066720343`*^9, 3.724751468250647*^9, 3.724754561085058*^9, 
   3.724767523774898*^9, 3.724768482603153*^9, 3.7247686899270678`*^9, 
   3.724853589193647*^9, 3.7248558263610563`*^9, 3.724856231984133*^9, 
   3.724910244931972*^9, 3.7249386240750513`*^9, 3.726296677903413*^9, 
   3.7290830321304407`*^9, 3.7292097613319407`*^9, 3.7292747428416433`*^9, 
   3.7292802383983603`*^9, {3.729371004534656*^9, 3.729371034121004*^9}, {
   3.729371131798595*^9, 3.729371160767071*^9}, 3.730331452376543*^9, 
   3.730331630070998*^9, 3.730333824774057*^9, 3.730334239343535*^9, 
   3.730336441736677*^9, 3.730342265598034*^9, 3.730384285242241*^9, 
   3.73038765531492*^9, 3.730388049794132*^9, 3.7303929120653048`*^9, 
   3.730401924694021*^9, 3.730407791219788*^9, 3.730412951928677*^9, 
   3.730416070242484*^9, 3.730416402652995*^9, 3.730416523294052*^9, 
   3.73308829153146*^9, 3.733151082811722*^9, 3.7331596442548447`*^9, 
   3.733161254662614*^9, 3.733161317821782*^9, 3.733162647392522*^9, 
   3.733255125394977*^9, 3.733255904281292*^9, 3.7332585610867767`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"kv"},
      {
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "q"}]}], ")"}]}]},
      {
       RowBox[{
        SuperscriptBox["fp", "2"], " ", 
        SuperscriptBox["kv", "2"], " ", "q"}]},
      {
       RowBox[{"fp", " ", "kp"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.714034020750087*^9, 3.7246715201730223`*^9, 
   3.7246749863616667`*^9, 3.724675290795164*^9, 3.724675894627564*^9, 
   3.724676585714593*^9, 3.7246767294333553`*^9, 3.724677336482195*^9, 
   3.724677501165421*^9, 3.7246779549204884`*^9, 3.7246782132856417`*^9, 
   3.724678652784285*^9, 3.7246823131634083`*^9, 3.724682557219479*^9, 
   3.724683559549835*^9, 3.724683743021758*^9, 3.7246844977751207`*^9, 
   3.7246847066720343`*^9, 3.724751468250647*^9, 3.724754561085058*^9, 
   3.724767523774898*^9, 3.724768482603153*^9, 3.7247686899270678`*^9, 
   3.724853589193647*^9, 3.7248558263610563`*^9, 3.724856231984133*^9, 
   3.724910244931972*^9, 3.7249386240750513`*^9, 3.726296677903413*^9, 
   3.7290830321304407`*^9, 3.7292097613319407`*^9, 3.7292747428416433`*^9, 
   3.7292802383983603`*^9, {3.729371004534656*^9, 3.729371034121004*^9}, {
   3.729371131798595*^9, 3.729371160767071*^9}, 3.730331452376543*^9, 
   3.730331630070998*^9, 3.730333824774057*^9, 3.730334239343535*^9, 
   3.730336441736677*^9, 3.730342265598034*^9, 3.730384285242241*^9, 
   3.73038765531492*^9, 3.730388049794132*^9, 3.7303929120653048`*^9, 
   3.730401924694021*^9, 3.730407791219788*^9, 3.730412951928677*^9, 
   3.730416070242484*^9, 3.730416402652995*^9, 3.730416523294052*^9, 
   3.73308829153146*^9, 3.733151082811722*^9, 3.7331596442548447`*^9, 
   3.733161254662614*^9, 3.733161317821782*^9, 3.733162647392522*^9, 
   3.733255125394977*^9, 3.733255904281292*^9, 3.733258561090178*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[CapitalGamma]4tilde (all terms need to be positive: in first column of \
Routh\[CloseCurlyQuote]s table)\
\>", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
   3.712055595766025*^9, 3.712055596366538*^9}, {3.712055702778782*^9, 
   3.712055713266334*^9}, 3.712154265780588*^9, 3.71344908635152*^9, 
   3.729371063090432*^9, {3.7293711673411703`*^9, 3.7293711678895473`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]\[CapitalGamma]4", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"-", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"kp", "+", 
           RowBox[{"fp", " ", "q", " ", "qt"}]}], ")"}]}], " ", ",", 
        RowBox[{"fp", " ", "kv"}], ",", 
        RowBox[{"kp", "+", " ", 
         RowBox[{"fp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}]}]}], " ", ",", " ", "kv"}], "}"}]}],
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]4", "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712854475602787*^9, 3.7128545452865553`*^9}, {
  3.7128546037419252`*^9, 3.712854639899626*^9}, {3.712854782574995*^9, 
  3.712854790674692*^9}, {3.712855059645575*^9, 3.712855060238492*^9}, {
  3.7128552583318768`*^9, 3.7128552596810207`*^9}, {3.7128554224390697`*^9, 
  3.712855430784445*^9}, {3.7128556039266567`*^9, 3.712855607155005*^9}, {
  3.7128565905430307`*^9, 3.7128566070877733`*^9}, {3.71285702699781*^9, 
  3.712857040329*^9}, {3.712857087715067*^9, 3.712857091194635*^9}, {
  3.71285795421245*^9, 3.712857999637442*^9}, {3.712928444078889*^9, 
  3.712928627056727*^9}, {3.712928757908557*^9, 3.712928773069557*^9}, {
  3.729371003145669*^9, 3.729371033374247*^9}, {3.729371087075905*^9, 
  3.7293711381116*^9}, {3.729371172697906*^9, 3.7293711912911577`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fp"}], " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", " ", "q", " ", "qt"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "fp"}], " ", "kv"}], 
      RowBox[{
       RowBox[{"-", "kp"}], "-", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}]}]}], 
      RowBox[{"-", "kv"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.714034020750087*^9, 3.7246715201730223`*^9, 
   3.7246749863616667`*^9, 3.724675290795164*^9, 3.724675894627564*^9, 
   3.724676585714593*^9, 3.7246767294333553`*^9, 3.724677336482195*^9, 
   3.724677501165421*^9, 3.7246779549204884`*^9, 3.7246782132856417`*^9, 
   3.724678652784285*^9, 3.7246823131634083`*^9, 3.724682557219479*^9, 
   3.724683559549835*^9, 3.724683743021758*^9, 3.7246844977751207`*^9, 
   3.7246847066720343`*^9, 3.724751468250647*^9, 3.724754561085058*^9, 
   3.724767523774898*^9, 3.724768482603153*^9, 3.7247686899270678`*^9, 
   3.724853589193647*^9, 3.7248558263610563`*^9, 3.724856231984133*^9, 
   3.724910244931972*^9, 3.7249386240750513`*^9, 3.726296677903413*^9, 
   3.7290830321304407`*^9, 3.7292097613319407`*^9, 3.7292747428416433`*^9, 
   3.7292802383983603`*^9, {3.729371004534656*^9, 3.729371034121004*^9}, {
   3.729371131798595*^9, 3.729371160767071*^9}, 3.7293711921409483`*^9, 
   3.7303314525093527`*^9, 3.730331630255632*^9, 3.730333824842498*^9, 
   3.730334239410255*^9, 3.7303364418201942`*^9, 3.730342265699593*^9, 
   3.730384285304332*^9, 3.730387655383449*^9, 3.730388049861841*^9, 
   3.730392912149419*^9, 3.730401924777451*^9, 3.730407791287344*^9, 
   3.730412952012208*^9, 3.730416070341107*^9, 3.7304164027194023`*^9, 
   3.730416523394932*^9, 3.733088291615431*^9, 3.733151082889325*^9, 
   3.7331596467312717`*^9, 3.733161254683237*^9, 3.7331613178402452`*^9, 
   3.733162647476036*^9, 3.733255125465067*^9, 3.733255904301256*^9, 
   3.733258561158361*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"kv"},
      {
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "q"}]}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["fp", "2"]}], " ", 
        SuperscriptBox["kv", "2"], " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "qt"}], ")"}]}]},
      {
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "q", " ", "qt"}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.714034020750087*^9, 3.7246715201730223`*^9, 
   3.7246749863616667`*^9, 3.724675290795164*^9, 3.724675894627564*^9, 
   3.724676585714593*^9, 3.7246767294333553`*^9, 3.724677336482195*^9, 
   3.724677501165421*^9, 3.7246779549204884`*^9, 3.7246782132856417`*^9, 
   3.724678652784285*^9, 3.7246823131634083`*^9, 3.724682557219479*^9, 
   3.724683559549835*^9, 3.724683743021758*^9, 3.7246844977751207`*^9, 
   3.7246847066720343`*^9, 3.724751468250647*^9, 3.724754561085058*^9, 
   3.724767523774898*^9, 3.724768482603153*^9, 3.7247686899270678`*^9, 
   3.724853589193647*^9, 3.7248558263610563`*^9, 3.724856231984133*^9, 
   3.724910244931972*^9, 3.7249386240750513`*^9, 3.726296677903413*^9, 
   3.7290830321304407`*^9, 3.7292097613319407`*^9, 3.7292747428416433`*^9, 
   3.7292802383983603`*^9, {3.729371004534656*^9, 3.729371034121004*^9}, {
   3.729371131798595*^9, 3.729371160767071*^9}, 3.7293711921409483`*^9, 
   3.7303314525093527`*^9, 3.730331630255632*^9, 3.730333824842498*^9, 
   3.730334239410255*^9, 3.7303364418201942`*^9, 3.730342265699593*^9, 
   3.730384285304332*^9, 3.730387655383449*^9, 3.730388049861841*^9, 
   3.730392912149419*^9, 3.730401924777451*^9, 3.730407791287344*^9, 
   3.730412952012208*^9, 3.730416070341107*^9, 3.7304164027194023`*^9, 
   3.730416523394932*^9, 3.733088291615431*^9, 3.733151082889325*^9, 
   3.7331596467312717`*^9, 3.733161254683237*^9, 3.7331613178402452`*^9, 
   3.733162647476036*^9, 3.733255125465067*^9, 3.733255904301256*^9, 
   3.733258561162303*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Crane system", "Title",
 CellChangeTimes->{{3.713445818990615*^9, 3.713445823656205*^9}}],

Cell["check notebook at \[OpenCurlyDoubleQuote]crane_system/crane_system\
\[CloseCurlyDoubleQuote].nb", "Chapter",
 CellChangeTimes->{{3.713449136132983*^9, 3.7134491458120337`*^9}}],

Cell[CellGroupData[{

Cell["Relations with specific physical constants", "Chapter",
 CellChangeTimes->{{3.713451238360181*^9, 3.713451249565943*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gravity", "\[Rule]", "9.81"}], ",", "\[IndentingNewLine]", 
     RowBox[{"m1", " ", "\[Rule]", "2.222"}], ",", 
     RowBox[{"(*", 
      RowBox[{"neo", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"m2", "\[Rule]", " ", 
      RowBox[{"2.733", "+", "0.8"}]}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"popeye", " ", "mass"}], " ", "+", " ", 
       RowBox[{"robotic", " ", "arm"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"L1", "\[Rule]", " ", "1.45"}], ",", 
     RowBox[{"(*", 
      RowBox[{"cable", " ", "length", " ", "neo"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"L2", "\[Rule]", "1.2"}], " ", ",", 
     RowBox[{"(*", 
      RowBox[{"cable", " ", "length", " ", "popeye"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d1", "\[Rule]", " ", 
      RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2", "\[Rule]", " ", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{"PhysicalConstants", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"J", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"d1", " ", "m1", " ", "gravity"}], "+", 
           RowBox[{"d2", " ", "m2", " ", "gravity"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", "d1", "]"}], "+", 
               RowBox[{"Abs", "[", "d2", "]"}]}], ")"}], "2"]}]}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"d1", "*", "m1", "*", "g"}], "+", 
           RowBox[{"d2", "*", "m2", "*", "g"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox["L", "2"]}]}], "*)"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"m", "\[Rule]", " ", 
          RowBox[{"m1", "+", "m2", "+", "mbar"}]}]}], "\[IndentingNewLine]", 
        "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", " ", "0.587"}], ",", 
         RowBox[{"m2", "\[Rule]", " ", "0.608"}], ",", 
         RowBox[{"mbar", "\[Rule]", " ", "0.287"}]}], "}"}]}], "/.", 
      "PhysicalConstants"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.712857223867889*^9, 3.712857238341395*^9}, {
  3.712857280749794*^9, 3.71285735491728*^9}, {3.712857407267355*^9, 
  3.712857408344347*^9}, {3.7128574532220287`*^9, 3.712857486081949*^9}, {
  3.7128575765153503`*^9, 3.712857584937153*^9}, {3.713451231875615*^9, 
  3.713451251297145*^9}, {3.7267647457065277`*^9, 3.726764747447349*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Notation", "Title",
 CellChangeTimes->{{3.713445719142926*^9, 3.713445735876649*^9}, {
  3.713445773377067*^9, 3.713445796019923*^9}, {3.71344815603894*^9, 
  3.713448156767825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Orthogonal", " ", "projection", " ", "matrix", " ", "to", " ", "x"}], 
    " ", "\[Element]", " ", 
    SuperscriptBox["S", "2"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OP", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"x", ",", " ", "x"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Skew", " ", "symmetric", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Skew", "[", "\[Omega]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.712038015027322*^9, {3.73032728493086*^9, 3.730327298115808*^9}, {
   3.733159689595478*^9, 3.733159704533126*^9}}],

Cell[CellGroupData[{

Cell["Parametrization of unit vector with psi and theta angle", \
"Subsubsection",
 CellChangeTimes->{{3.730327307712089*^9, 3.730327313928431*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"uv1", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "]"}], " ", "=", " ", "e1"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"uv1", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]1_", ",", "\[Theta]2_"}], "}"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"uv3", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "]"}], " ", "=", " ", "e3"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uv3", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]1_", ",", "\[Theta]2_"}], "}"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Duv1", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]1_", ",", "\[Theta]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]1_", ",", "\[Omega]2_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"uv1", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "}"}]}], "]"}], 
       "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Duv3", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]1_", ",", "\[Theta]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]1_", ",", "\[Omega]2_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"uv3", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "}"}]}], "]"}], 
       "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"just", " ", "checking", " ", "orthogonality"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"uv1", "[", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], "]"}], ".", 
      RowBox[{"Duv1", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]\[Psi]", ",", "\[Omega]\[Theta]"}], "}"}]}], 
       "]"}]}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"uv3", "[", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], "]"}], ".", 
      RowBox[{"Duv3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]\[Psi]", ",", "\[Omega]\[Theta]"}], "}"}]}], 
       "]"}]}], "//", "Simplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyk0ow2EAx/HNe2pcpCSLvC/NHFZshgc7ODh456DkNS9tWvKWwwolM0Ss
ZcUKk5fDDpjh4G1eZlaaFfK2IvwdRHKYlee3w7fP5RtTKy9u8GGxWFE0+PEq
WA4tYohM+2mCKQ9/h5CtkRzB/Ph1Th31+MUeCkP2e6YMVG7unA5mSipPYXQZ
2wEznlwFS9QhS2AxnPTsyWGpx62AC7eCAfjODZiGBqutbIU6+7xYA/3SD+rh
/H1CIwzeIia4Ybk7gcNnXTZ4rmq/gO6zwlQntTyy2auw5Cfrq50hN7Oj2ZCE
BA8aVQxRqC/H4O6VSA/X+3qNsFN9uQll1mozbNHnT1xTuf4FXsNLfjyiEYa0
9Y+zxdRt1RsHfjeZ46B0LSkZZvq1pUHBeexvr5ohYXydV75OmnBK1fJmEqHG
ohM5qYsVSjFcdZwkVxnwf/G82k1pcCcqQgotgd1C/gFD8pSuHOjbqu+A5jh+
JzTeHz8GWRlSG9/lgv/wIfEf
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ".", 
    RowBox[{"OP", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}], ",", "0"}], "}"}], "]"}]}], "//", 
   "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.726924669438966*^9, 3.726924731606028*^9}, {
  3.726924784689349*^9, 3.726924813222094*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Psi]", "]"}], "2"], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0"},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Psi]", "]"}], "2"], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726924728667233*^9, 3.7269247319042063`*^9}, {
   3.726924807765942*^9, 3.726924813594981*^9}, 3.728796813314357*^9, 
   3.72880078220438*^9, 3.72881875145196*^9, 3.729079612290077*^9, 
   3.7292747454012957`*^9, 3.729275793297426*^9, 3.729309080803289*^9, 
   3.729351820514917*^9, 3.730331452723241*^9, 3.7303316314760733`*^9, 
   3.730333824984889*^9, 3.730334239610045*^9, 3.730336442020153*^9, 
   3.730342265969371*^9, 3.730384285464665*^9, 3.730387655586804*^9, 
   3.7303880522239532`*^9, 3.730392912343891*^9, 3.7304019250835752`*^9, 
   3.730407791508862*^9, 3.730412952205402*^9, 3.730416070525404*^9, 
   3.730416402940898*^9, 3.73041652354556*^9, 3.7330882918402157`*^9, 
   3.73315108307355*^9, 3.733161254787483*^9, 3.733161317894684*^9, 
   3.7331626478619347`*^9, 3.733255125883943*^9, 3.7332559047979393`*^9, 
   3.733258561546998*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fully-actuated UAVs", "Title",
 CellChangeTimes->{{3.7134457981662817`*^9, 3.713445805074523*^9}, {
   3.726209648064849*^9, 3.726209654216749*^9}, 3.726218316332646*^9}],

Cell[CellGroupData[{

Cell["State and input decomposition (these are dummy names)", "Chapter",
 CellChangeTimes->{{3.666548864490391*^9, 3.6665488704971523`*^9}, {
  3.713448172575499*^9, 3.71344818704732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"kinematic", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"{", 
      RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{"{", 
      RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2", "=", 
     RowBox[{"{", 
      RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zk", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"p", ",", "n", ",", "P1", ",", "P2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"dynamic", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V1", "=", 
     RowBox[{"{", 
      RowBox[{"v1x", ",", "v1y", ",", "v1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V2", "=", 
     RowBox[{"{", 
      RowBox[{"v2x", ",", "v2y", ",", "v2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zd", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"v", ",", "\[Omega]", ",", "V1", ",", "V2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"full", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z1", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"zk", ",", "zd"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "input", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1", "=", 
     RowBox[{"{", 
      RowBox[{"u1x", ",", "u1y", ",", "u1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2", "=", 
     RowBox[{"{", 
      RowBox[{"u2x", ",", "u2y", ",", "u2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"u1", ",", "u2"}], "]"}]}], ";"}]}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["State set (in manuscript Z1SET is called f)", "Chapter",
 CellChangeTimes->{{3.7134482064870863`*^9, 3.713448228580737*^9}, 
   3.730327342908567*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z1SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"#", ".", "#"}], 
           SuperscriptBox["L1", "2"]], " ", "-", " ", "1"}], ")"}], "&"}], 
       ")"}], "[", 
      RowBox[{"P1", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d1", " ", "n"}]}], ")"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"#", ".", "#", " "}], 
           SuperscriptBox["L2", "2"]], "-", " ", "1"}], ")"}], "&"}], ")"}], 
      "[", 
      RowBox[{"P2", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d2", " ", "n"}]}], ")"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"#1", ".", "#2"}], 
         SuperscriptBox["L1", "2"]], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P1", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V1", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d1", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"#1", ".", "#2"}], 
         SuperscriptBox["L2", "2"]], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P2", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V2", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d2", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", ".", "n"}], "-", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"n", ".", "\[Omega]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9, {3.724684010957909*^9, 
   3.724684014373664*^9}, {3.724751269757082*^9, 3.7247512733298903`*^9}, 
   3.726212948183769*^9, {3.72621315028013*^9, 3.7262131532690783`*^9}, {
   3.726665294952071*^9, 3.72666531105767*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tangent set", "Chapter",
 CellChangeTimes->{{3.7134482603686028`*^9, 3.713448262456069*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]p", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]px", ",", "\[Delta]py", ",", "\[Delta]pz"}], "}"}]}], 
  ";", 
  RowBox[{"\[Delta]n", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]nx", ",", "\[Delta]ny", ",", "\[Delta]nz"}], "}"}]}], 
  ";", 
  RowBox[{"\[Delta]P1", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]p1x", ",", "\[Delta]p1y", ",", "\[Delta]p1z"}], "}"}]}], 
  ";", 
  RowBox[{"\[Delta]P2", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]p2x", ",", "\[Delta]p2y", ",", "\[Delta]p2z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]v", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]vx", ",", "\[Delta]vy", ",", "\[Delta]vz"}], "}"}]}], 
  ";", 
  RowBox[{"\[Delta]\[Omega]", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Delta]\[Omega]x", ",", "\[Delta]\[Omega]y", ",", "\[Delta]\[Omega]z"}],
     "}"}]}], ";", 
  RowBox[{"\[Delta]V1", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]v1x", ",", "\[Delta]v1y", ",", "\[Delta]v1z"}], "}"}]}], 
  ";", 
  RowBox[{"\[Delta]V2", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]v2x", ",", "\[Delta]v2y", ",", "\[Delta]v2z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]z1", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "\[Delta]p", ",", "\[Delta]n", ",", "\[Delta]P1", ",", "\[Delta]P2", ",",
       "\[Delta]v", ",", "\[Delta]\[Omega]", ",", "\[Delta]V1", ",", 
      "\[Delta]V2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TangentZ1SET", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\[Delta]px_", ",", "\[Delta]py_", ",", "\[Delta]pz_", ",", 
       "\[Delta]nx_", ",", "\[Delta]ny_", ",", "\[Delta]nz_", ",", 
       "\[Delta]p1x_", ",", "\[Delta]p1y_", ",", "\[Delta]p1z_", ",", 
       "\[Delta]p2x_", ",", "\[Delta]p2y_", ",", "\[Delta]p2z_", ",", 
       "\[Delta]vx_", ",", "\[Delta]vy_", ",", "\[Delta]vz_", ",", 
       "\[Delta]\[Omega]x_", ",", "\[Delta]\[Omega]y_", ",", 
       "\[Delta]\[Omega]z_", ",", "\[Delta]v1x_", ",", "\[Delta]v1y_", ",", 
       "\[Delta]v1z_", ",", "\[Delta]v2x_", ",", "\[Delta]v2y_", ",", 
       "\[Delta]v2z_"}], "}"}]}], "\[IndentingNewLine]", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", ".", "#2"}], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P1", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"\[Delta]P1", "-", 
        RowBox[{"(", 
         RowBox[{"\[Delta]p", "+", 
          RowBox[{"d1", " ", "\[Delta]n"}]}], ")"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", ".", "#2"}], "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P2", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"\[Delta]P2", "-", 
        RowBox[{"(", 
         RowBox[{"\[Delta]p", "+", 
          RowBox[{"d2", " ", "\[Delta]n"}]}], ")"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#3", ".", "#2"}], "+", 
         RowBox[{"#1", ".", "#4"}]}], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P1", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V1", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d1", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}], 
       ",", 
       RowBox[{"\[Delta]P1", "-", 
        RowBox[{"(", 
         RowBox[{"\[Delta]p", "+", 
          RowBox[{"d1", " ", "\[Delta]n"}]}], ")"}]}], ",", 
       RowBox[{"\[Delta]V1", "-", 
        RowBox[{"(", 
         RowBox[{"\[Delta]v", "+", 
          RowBox[{"d1", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Delta]\[Omega]", "]"}], ".", "n"}]}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "\[Delta]n"}]}]}], 
         ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#3", ".", "#2"}], "+", 
         RowBox[{"#1", ".", "#4"}]}], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P2", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V2", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d2", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}], 
       ",", 
       RowBox[{"\[Delta]P2", "-", 
        RowBox[{"(", 
         RowBox[{"\[Delta]p", "+", 
          RowBox[{"d2", " ", "\[Delta]n"}]}], ")"}]}], ",", 
       RowBox[{"\[Delta]V2", "-", 
        RowBox[{"(", 
         RowBox[{"\[Delta]v", "+", 
          RowBox[{"d2", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Delta]\[Omega]", "]"}], ".", "n"}]}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "\[Delta]n"}]}]}], 
         ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"n", ".", "\[Delta]n"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Delta]n", ".", "\[Omega]"}], "+", 
      RowBox[{"n", ".", "\[Delta]\[Omega]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9, {3.724684010957909*^9, 
   3.724684014373664*^9}, {3.724751269757082*^9, 3.7247512733298903`*^9}, 
   3.726212948183769*^9, {3.72621315028013*^9, 3.7262131532690783`*^9}, {
   3.726213352120707*^9, 3.726213359218369*^9}, {3.726213498750091*^9, 
   3.726213535283311*^9}, 3.726218409343957*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Function that generates random element in state set", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
   3.666784754227034*^9, 3.6667847600915203`*^9}, {3.713448271503984*^9, 
   3.713448298749484*^9}, 3.726218436032008*^9, {3.730327485421747*^9, 
   3.7303274896355953`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z1l", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{"p", ",", "\[IndentingNewLine]", 
      RowBox[{"uv1", "[", 
       RowBox[{"{", 
        RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "+", 
       RowBox[{"d1", " ", 
        RowBox[{"uv1", "[", 
         RowBox[{"{", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}]}], "+", 
       RowBox[{"L1", " ", 
        RowBox[{"uv3", "[", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]11", ",", "\[Alpha]12"}], "}"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "+", 
       RowBox[{"d2", " ", 
        RowBox[{"uv1", "[", 
         RowBox[{"{", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}]}], "+", 
       RowBox[{"L2", " ", 
        RowBox[{"uv3", "[", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]21", ",", "\[Alpha]22"}], "}"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "v", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"uv1", "[", 
         RowBox[{"{", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], "]"}], ".", 
       RowBox[{"Duv1", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]1d", ",", "\[Theta]2d"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "+", 
       RowBox[{"d1", " ", 
        RowBox[{"Duv1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1d", ",", "\[Theta]2d"}], "}"}]}], "]"}]}], "+", 
       RowBox[{"L1", " ", 
        RowBox[{"Duv3", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Alpha]11", ",", "\[Alpha]12"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]11d", ",", "\[Alpha]12d"}], "}"}]}], "]"}]}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"v", "+", 
       RowBox[{"d2", " ", 
        RowBox[{"Duv1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1d", ",", "\[Theta]2d"}], "}"}]}], "]"}]}], "+", 
       RowBox[{"L2", " ", 
        RowBox[{"Duv3", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Alpha]21", ",", "\[Alpha]22"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]21d", ",", "\[Alpha]22d"}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]11", ",", "\[Alpha]12"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]21", ",", "\[Alpha]22"}], "}"}], ",", "v", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1d", ",", "\[Theta]2d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]11d", ",", "\[Alpha]12d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]21d", ",", "\[Alpha]22d"}], "}"}]}], "]"}], 
      "\[Rule]", " ", "l"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z1lR", "[", "]"}], ":=", 
   RowBox[{"z1l", "[", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "18"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z1lR", "[", "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Z1SET", "[", 
    RowBox[{"z1l", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "#"], "&"}], ",", "18"}], "]"}], "]"}], "]"}], 
   "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.697118200248754*^9, 3.697118239535376*^9}, {
   3.697118360659931*^9, 3.697118470468795*^9}, {3.697118689203661*^9, 
   3.6971187966698236`*^9}, {3.6971188307685328`*^9, 
   3.6971188421873293`*^9}, {3.697118878196802*^9, 3.697118974011015*^9}, {
   3.697119006213297*^9, 3.6971190396741123`*^9}, {3.6971390020228662`*^9, 
   3.697139009318285*^9}, {3.697139373346467*^9, 3.697139374878284*^9}, {
   3.697139414268791*^9, 3.697139469001493*^9}, {3.697141223768364*^9, 
   3.697141227711032*^9}, {3.69731249658494*^9, 3.697312510042843*^9}, {
   3.697400254573415*^9, 3.697400273661202*^9}, {3.697400303986665*^9, 
   3.69740057700772*^9}, {3.697400609630624*^9, 3.697400609841353*^9}, {
   3.698055377956704*^9, 3.698055400306435*^9}, {3.6980554414583282`*^9, 
   3.698055483594681*^9}, {3.7116174218139544`*^9, 3.711617421827387*^9}, 
   3.7116176007977867`*^9, {3.711617938728627*^9, 3.7116180228914537`*^9}, {
   3.711621070398707*^9, 3.711621081343431*^9}, {3.711715923540648*^9, 
   3.711715992726617*^9}, {3.711717833103348*^9, 3.711717833110628*^9}, {
   3.7117370649094048`*^9, 3.7117370657243958`*^9}, {3.712038037186582*^9, 
   3.712038054528998*^9}, {3.712841289703867*^9, 3.712841352076231*^9}, {
   3.712841392500101*^9, 3.712841558909223*^9}, {3.7128421149733753`*^9, 
   3.7128421239142103`*^9}, {3.712842751772552*^9, 3.712842776049879*^9}, {
   3.7128428291157846`*^9, 3.712842830499154*^9}, {3.7128433773066273`*^9, 
   3.712843431773552*^9}, {3.71284394430901*^9, 3.712843966942237*^9}, {
   3.7128479117985287`*^9, 3.712847930833536*^9}, {3.71344832098267*^9, 
   3.7134483254863033`*^9}, 3.71344970442523*^9, {3.72468409489301*^9, 
   3.72468422406437*^9}, {3.724751280547143*^9, 3.7247512918682213`*^9}, 
   3.7247513605213118`*^9, {3.7262099792998047`*^9, 3.726210290407324*^9}, {
   3.72621032100861*^9, 3.7262104064197474`*^9}, {3.726210456219047*^9, 
   3.726210526852673*^9}, {3.7262105855034237`*^9, 3.726210693104999*^9}, {
   3.7262107376497*^9, 3.726210766210454*^9}, {3.7262137463579884`*^9, 
   3.726213766244155*^9}, 3.726213986097473*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.713448323233808*^9, 3.713448390223907*^9, {3.713449634163185*^9, 
   3.713449645340069*^9}, {3.713449706025828*^9, 3.7134497188018837`*^9}, 
   3.71360058842673*^9, {3.7136006685489397`*^9, 3.713600682113246*^9}, 
   3.714029480515603*^9, 3.714034017964863*^9, 3.724671517202312*^9, 
   3.724671687504498*^9, 3.7246758700137177`*^9, 3.724676565820986*^9, 
   3.724676708693903*^9, 3.724677313584942*^9, 3.7246779327917852`*^9, 
   3.7246781901384*^9, 3.724678631696704*^9, 3.7246822965985518`*^9, 
   3.724682534169868*^9, 3.724683539680078*^9, 3.7246837388220387`*^9, {
   3.724684206373262*^9, 3.724684225708366*^9}, 3.724684320378913*^9, 
   3.724684701468829*^9, 3.7247512999918547`*^9, {3.724751352914468*^9, 
   3.724751361217469*^9}, 3.724754557375256*^9, 3.724761570143579*^9, 
   3.724768422747458*^9, 3.724768684256563*^9, 3.7248535843393993`*^9, 
   3.724855818111979*^9, 3.7248562265875893`*^9, 3.724910239304582*^9, 
   3.724937949211851*^9, {3.725038001976623*^9, 3.725038030182336*^9}, 
   3.725038087554584*^9, 3.7251856223217793`*^9, 3.725211682778277*^9, 
   3.725354734439815*^9, 3.726209932674185*^9, {3.726209975004208*^9, 
   3.726209998167625*^9}, {3.726210507460998*^9, 3.7262105411906033`*^9}, {
   3.726210758980612*^9, 3.726210766788156*^9}, 3.726213766677883*^9, 
   3.726218451428857*^9, 3.7262185811951027`*^9, 3.726219896782536*^9, 
   3.726220288470662*^9, 3.726238928244588*^9, 3.7262839059050713`*^9, 
   3.72629519230781*^9, 3.7262978785505533`*^9, 3.726298025175082*^9, 
   3.726314213421253*^9, 3.726314492598207*^9, 3.72631744656526*^9, 
   3.726325297359796*^9, 3.726383908929594*^9, 3.726390820408121*^9, 
   3.726395019626896*^9, 3.726398687096232*^9, 3.726410980482993*^9, 
   3.726659631237425*^9, 3.726659669582211*^9, 3.72666324985797*^9, 
   3.7266653311991577`*^9, 3.726724981878901*^9, 3.72674436907754*^9, 
   3.726754977054784*^9, 3.726763821141025*^9, 3.726763917920088*^9, 
   3.726832036830784*^9, 3.7288007826189013`*^9, 3.7288110009934998`*^9, 
   3.728811048045299*^9, 3.7288187516358023`*^9, 3.7290796124881563`*^9, 
   3.729274748354321*^9, 3.72927579356728*^9, 3.729309081065854*^9, 
   3.729351820744611*^9, 3.7303274790386753`*^9, 3.730331452981493*^9, 
   3.730331631791898*^9, 3.7303338252100077`*^9, 3.730334253931897*^9, 
   3.7303364422455187`*^9, 3.7303422662132397`*^9, 3.73038428565891*^9, 
   3.730387655785329*^9, 3.730388052417655*^9, 3.730392912618952*^9, 
   3.730401925435697*^9, 3.730407791693553*^9, 3.73041295244458*^9, 
   3.730416070728829*^9, 3.730416403141665*^9, 3.7304165237566137`*^9, 
   3.7330882920783567`*^9, 3.733151083356544*^9, 3.733159748377325*^9, 
   3.733161254863661*^9, 3.733161317961895*^9, 3.733162648242647*^9, 
   3.7332551262775593`*^9, 3.733255905174918*^9, 3.733258561958926*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vector field (Z1 is called Z in article)", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
  3.711621165123749*^9, 3.711621169743795*^9}, {3.726212155676237*^9, 
  3.726212167517591*^9}, {3.726218728661997*^9, 3.726218730295368*^9}, {
  3.730327499959344*^9, 3.730327507849231*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"cables", " ", "unit", " ", "vectors"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nC1", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
     FractionBox[
      RowBox[{"P1", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d1", " ", "n"}]}], ")"}]}], "L1"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nC2", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
     FractionBox[
      RowBox[{"P2", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d2", " ", "n"}]}], ")"}]}], "L2"]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"tensions", " ", "in", " ", "cables"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MT", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["m", "m1"], ",", 
           FractionBox["m", "m2"]}], "}"}], "]"}], "+", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "\[Gamma]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1"}], "}"}]}], "}"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"m", " ", "d1", " ", "d2"}], "J"], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["d1", "d2"], " ", 
              RowBox[{"\[Delta]1", ".", "\[Delta]1"}]}], ",", 
             RowBox[{"\[Delta]1", ".", "\[Delta]2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Delta]1", ".", "\[Delta]2"}], ",", 
             RowBox[{
              FractionBox["d2", "d1"], 
              RowBox[{"\[Delta]2", ".", "\[Delta]2"}]}]}], "}"}]}], "}"}]}]}],
        ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Gamma]", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"nC1", "[", "z1", "]"}], ".", 
          RowBox[{"nC2", "[", "z1", "]"}]}]}], ",", 
        RowBox[{"\[Delta]1", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"Skew", "[", "n", "]"}], ".", 
          RowBox[{"nC1", "[", "z1", "]"}]}]}], ",", 
        RowBox[{"\[Delta]2", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"Skew", "[", "n", "]"}], ".", 
          RowBox[{"nC2", "[", "z1", "]"}]}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BB", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"nC1", "[", "z1", "]"}], ".", "u1"}], 
          FractionBox["m", "m1"]}], "+", 
         RowBox[{
          FractionBox["m", "L1"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", 
           RowBox[{"V1", "-", 
            RowBox[{"(", 
             RowBox[{"v", "+", 
              RowBox[{"d1", " ", 
               RowBox[{
                RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], 
             ")"}]}], "]"}]}], "+", " ", 
         RowBox[{"m", " ", "d1", " ", 
          RowBox[{
           RowBox[{"nC1", "[", "z1", "]"}], ".", "n"}], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", "\[Omega]", 
           "]"}]}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"nC2", "[", "z1", "]"}], ".", "u2"}], 
          FractionBox["m", "m2"]}], "+", 
         RowBox[{
          FractionBox["m", "L2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", 
           RowBox[{"V2", "-", 
            RowBox[{"(", 
             RowBox[{"v", "+", 
              RowBox[{"d2", " ", 
               RowBox[{
                RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], 
             ")"}]}], "]"}]}], "+", " ", 
         RowBox[{"m", " ", "d2", " ", 
          RowBox[{
           RowBox[{"nC2", "[", "z1", "]"}], ".", "n"}], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", "\[Omega]", 
           "]"}]}]}], ")"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Te", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"MT", "[", "zk", "]"}], "]"}], ".", 
      RowBox[{"BB", "[", 
       RowBox[{"z1", ",", "u"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"linear", " ", "and", " ", "angular", " ", "accelerations"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", "m"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"T1", " ", 
          RowBox[{"nC1", "[", "z1", "]"}]}], "+", 
         RowBox[{"T2", " ", 
          RowBox[{"nC2", "[", "z1", "]"}]}], "-", " ", 
         RowBox[{"m", " ", "gravity", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z1", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]B", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", "J"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"d1", " ", "n"}], "]"}], ".", 
           RowBox[{"nC1", "[", "z1", "]"}]}], " ", "T1"}], " ", "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"d2", " ", "n"}], "]"}], ".", 
           RowBox[{"nC2", "[", "z1", "]"}]}], "T2"}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z1", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A1", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["1", "m1"], 
       RowBox[{"(", 
        RowBox[{"u1", "-", 
         RowBox[{"T1", " ", 
          RowBox[{"nC1", "[", "z1", "]"}]}], "-", " ", 
         RowBox[{"m1", " ", "gravity", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z1", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["1", "m2"], 
       RowBox[{"(", 
        RowBox[{"u2", "-", 
         RowBox[{"T2", " ", 
          RowBox[{"nC2", "[", "z1", "]"}]}], "-", " ", 
         RowBox[{"m2", " ", "gravity", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z1", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zk", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{"v", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}], ",", 
       "\[IndentingNewLine]", "V1", ",", "\[IndentingNewLine]", "V2"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zd", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"z1", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Tau]B", "[", 
        RowBox[{"z1", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"A1", "[", 
        RowBox[{"z1", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"A2", "[", 
        RowBox[{"z1", ",", "u"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Z1", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Zk", "[", "z1", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Zd", "[", 
        RowBox[{"z1", ",", "u"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.697400682497552*^9, 3.697400683235924*^9}, 
   3.697400813783896*^9, {3.697400858437114*^9, 3.697400871115472*^9}, {
   3.697400908311493*^9, 3.697401159068199*^9}, {3.698055586122117*^9, 
   3.698055588296116*^9}, {3.698056542684677*^9, 3.698056552466524*^9}, {
   3.698235111344733*^9, 3.69823512671377*^9}, {3.6982366567826138`*^9, 
   3.6982366803944607`*^9}, {3.698237041849807*^9, 3.698237062183079*^9}, {
   3.698296328890626*^9, 3.698296382642074*^9}, {3.698296426982251*^9, 
   3.698296484584517*^9}, {3.698296525845749*^9, 3.698296558333123*^9}, {
   3.698296594014716*^9, 3.698296639109754*^9}, {3.698296715695365*^9, 
   3.698296766142324*^9}, {3.698296829912444*^9, 3.6982968462241087`*^9}, {
   3.698296919475834*^9, 3.6982969512167892`*^9}, {3.6982970081121407`*^9, 
   3.6982971601189327`*^9}, {3.7116172924516172`*^9, 
   3.7116173135692368`*^9}, {3.711617600829135*^9, 3.711617600834444*^9}, {
   3.7116211814820538`*^9, 3.7116211903545094`*^9}, {3.711621674121518*^9, 
   3.711621684289032*^9}, {3.7116226266695623`*^9, 3.711622657368965*^9}, {
   3.7116227064891872`*^9, 3.711622875093487*^9}, {3.711623073320809*^9, 
   3.7116230935901937`*^9}, {3.711623124016121*^9, 3.711623136621789*^9}, {
   3.711623194100933*^9, 3.7116232225230007`*^9}, {3.711623291248263*^9, 
   3.7116233162765017`*^9}, {3.711626131209844*^9, 3.711626132107855*^9}, {
   3.711626373708078*^9, 3.7116263753900623`*^9}, {3.7116264742237577`*^9, 
   3.711626679957713*^9}, {3.711626725144823*^9, 3.711626778033641*^9}, {
   3.71162689733743*^9, 3.7116269922027283`*^9}, {3.711627036057825*^9, 
   3.711627037440173*^9}, {3.7116279668739223`*^9, 3.711627995359263*^9}, {
   3.7116280287955837`*^9, 3.711628078391036*^9}, {3.711628446905264*^9, 
   3.711628816619896*^9}, {3.711628849708926*^9, 3.711628851675909*^9}, {
   3.711628903811613*^9, 3.711629021299794*^9}, {3.711629084199346*^9, 
   3.7116292645521173`*^9}, {3.711629298749126*^9, 3.711629334010613*^9}, {
   3.711630407964484*^9, 3.711630461296159*^9}, {3.7116327828384447`*^9, 
   3.7116328480417957`*^9}, {3.711632986156638*^9, 3.71163302875439*^9}, {
   3.71163307677535*^9, 3.711633080282186*^9}, 3.7116331265298433`*^9, {
   3.711689294866427*^9, 3.711689298484226*^9}, {3.711716284965667*^9, 
   3.7117163320871058`*^9}, {3.711716755984516*^9, 3.7117168689313707`*^9}, {
   3.711716914097118*^9, 3.711716926278614*^9}, {3.711716978791876*^9, 
   3.711717134159712*^9}, 3.7117173042513313`*^9, {3.711723906207171*^9, 
   3.7117239189962263`*^9}, 3.712038129588223*^9, {3.712039142693501*^9, 
   3.712039273186387*^9}, {3.712043072787568*^9, 3.712043075086792*^9}, {
   3.712841828031774*^9, 3.7128418281427298`*^9}, {3.7128419997226543`*^9, 
   3.7128420529535933`*^9}, {3.712842173438087*^9, 3.712842173507884*^9}, {
   3.712842222131393*^9, 3.712842535873464*^9}, 3.71284260024035*^9, {
   3.712844022737658*^9, 3.71284402501755*^9}, {3.7128461211563377`*^9, 
   3.712846191106421*^9}, {3.712847103843172*^9, 3.712847112378648*^9}, {
   3.712847966107134*^9, 3.712847966222744*^9}, {3.712848040002239*^9, 
   3.712848072801487*^9}, {3.712848118243079*^9, 3.712848136005253*^9}, {
   3.7128482011882353`*^9, 3.712848298990376*^9}, {3.713448346045266*^9, 
   3.7134483598689203`*^9}, {3.71344839713986*^9, 3.713448420023366*^9}, {
   3.713448499727456*^9, 3.713448544843899*^9}, {3.724673792676518*^9, 
   3.7246738001579657`*^9}, {3.7246738628642817`*^9, 3.724673866218055*^9}, {
   3.724674829248177*^9, 3.7246748421839447`*^9}, {3.724675188888874*^9, 
   3.72467519980689*^9}, {3.724684045613626*^9, 3.724684045715145*^9}, {
   3.724684249379312*^9, 3.724684291947019*^9}, 3.7246843717877483`*^9, {
   3.72475133367165*^9, 3.7247513397400513`*^9}, {3.724751375118907*^9, 
   3.724751378365162*^9}, 3.7249339773857307`*^9, {3.726212768196412*^9, 
   3.726212786964567*^9}, {3.7262187690238543`*^9, 3.7262187856256523`*^9}, {
   3.7262188456107893`*^9, 3.726218847410037*^9}, {3.7262188927558203`*^9, 
   3.726218960117014*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check that vector field is within tangent set", "Chapter",
 CellChangeTimes->{{3.712038811277717*^9, 3.712038834014045*^9}, {
  3.7262188097444067`*^9, 3.726218812456545*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Z1SET", "[", "z1", "]"}], ",", 
         RowBox[{"{", "z1", "}"}]}], "]"}], "]"}], ".", 
      RowBox[{"Z1", "[", 
       RowBox[{"z1", ",", "u"}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"z1", "\[Rule]", " ", 
       RowBox[{"z1lR", "[", "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
        "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], "/.", 
   "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{"u", "\[Rule]", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "6"}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.711633142776978*^9, 3.711633142957838*^9}, {
   3.711633207554667*^9, 3.711633208645482*^9}, 3.711633238773624*^9, {
   3.71163407516049*^9, 3.711634139805245*^9}, {3.711717396201397*^9, 
   3.711717418048194*^9}, 3.711717480473504*^9, {3.711717833150804*^9, 
   3.711717833157578*^9}, {3.7120381316591873`*^9, 3.712038187889556*^9}, {
   3.712038320716567*^9, 3.712038339377733*^9}, {3.712038369407885*^9, 
   3.712038371599181*^9}, {3.712038633411572*^9, 3.712038651549141*^9}, {
   3.712038783309617*^9, 3.7120388016940727`*^9}, {3.712842552026746*^9, 
   3.712842569687134*^9}, {3.712842861381813*^9, 3.712842861842023*^9}, {
   3.7128483060378313`*^9, 3.712848358959763*^9}, {3.713448442566313*^9, 
   3.713448490895706*^9}, {3.713448556254397*^9, 3.713448589422153*^9}, {
   3.724684343156171*^9, 3.724684343380728*^9}, {3.724751384506638*^9, 
   3.724751385346961*^9}, {3.726210796755254*^9, 3.726210802076049*^9}, {
   3.726210876838047*^9, 3.726210878239806*^9}, {3.7262188144900093`*^9, 
   3.726218833457203*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7120381152681627`*^9, 3.712038195254126*^9}, 
   3.7120382373104057`*^9, 3.7120383560503407`*^9, 3.712038462602194*^9, 
   3.712038802489809*^9, 3.7120392870802507`*^9, 3.7120400533716917`*^9, 
   3.7120490080286407`*^9, 3.712058597787944*^9, 3.712117088837121*^9, 
   3.712127201428541*^9, 3.712134774567882*^9, 3.7121500948831882`*^9, 
   3.712150579414322*^9, 3.712151238841858*^9, 3.7121558587600393`*^9, 
   3.712382151600459*^9, 3.712830597485321*^9, 3.712830642766521*^9, 
   3.712839871831526*^9, 3.712842570656641*^9, {3.7128426196284513`*^9, 
   3.712842632872696*^9}, 3.712842700299861*^9, {3.7128428566748323`*^9, 
   3.712842865294299*^9}, 3.7128432121144953`*^9, 3.712843359828312*^9, 
   3.712843716013856*^9, {3.7128439891062517`*^9, 3.712844029913664*^9}, 
   3.7128462227703342`*^9, 3.712847153088462*^9, 3.712848324583284*^9, 
   3.7128483623165817`*^9, 3.712899212710343*^9, 3.712905101540876*^9, 
   3.712928201042177*^9, 3.712928304583976*^9, 3.712928974185845*^9, 
   3.712929755275689*^9, 3.712948193231392*^9, 3.712948727344996*^9, 
   3.712982052846031*^9, 3.7129830128655987`*^9, 3.7129881519644003`*^9, {
   3.713448480305551*^9, 3.713448491675489*^9}, {3.713448562111394*^9, 
   3.713448579875558*^9}, {3.713449634571957*^9, 3.713449645826301*^9}, 
   3.7134497192056217`*^9, 3.713600588873612*^9, {3.71360066897045*^9, 
   3.713600682495743*^9}, 3.7140294809841433`*^9, 3.714034018379023*^9, 
   3.724671517656289*^9, 3.724671688034443*^9, 3.724674845980844*^9, 
   3.7246752040893917`*^9, 3.724675870445623*^9, 3.7246765661857967`*^9, 
   3.724676709145646*^9, 3.724677314080927*^9, 3.7246779331790237`*^9, 
   3.724678190609071*^9, 3.724678632162191*^9, 3.724682297116111*^9, 
   3.724682534579548*^9, 3.724683540148499*^9, 3.7246837392847443`*^9, {
   3.724684348591413*^9, 3.724684378323009*^9}, 3.7246847018378477`*^9, 
   3.724751387142557*^9, 3.724754557816175*^9, 3.7247615707540827`*^9, 
   3.7247684344483223`*^9, 3.7247686862595663`*^9, 3.724853585681106*^9, 
   3.724855819956768*^9, 3.724856228333187*^9, 3.724910240729185*^9, 
   3.724937950414678*^9, 3.725185624033813*^9, 3.725211684413662*^9, 
   3.725354736221507*^9, {3.726210817934394*^9, 3.72621083376735*^9}, 
   3.726210880131469*^9, {3.726218938685609*^9, 3.726218963413804*^9}, 
   3.726219897017189*^9, 3.7262202887120934`*^9, 3.726238928549459*^9, 
   3.726283906318223*^9, 3.726295192639059*^9, 3.7262978788970537`*^9, 
   3.726298025541687*^9, 3.72631421586162*^9, 3.7263144928869743`*^9, 
   3.7263174469101*^9, 3.726325297715104*^9, 3.72638390916263*^9, 
   3.726390820629161*^9, 3.7263950198988447`*^9, 3.726398687333599*^9, 
   3.726410980730322*^9, 3.7266596353149843`*^9, 3.726659669958211*^9, 
   3.726663250244672*^9, 3.7266653315530252`*^9, 3.726724982246048*^9, 
   3.7267443694790373`*^9, 3.726754977472248*^9, 3.726763821507367*^9, 
   3.726763918326289*^9, 3.726832037075843*^9, 3.728800782912716*^9, 
   3.728811001347433*^9, 3.728811048395681*^9, 3.728818751853265*^9, 
   3.7290796128484507`*^9, 3.7292747487263727`*^9, 3.729275793981514*^9, 
   3.729309083681946*^9, 3.729351821128721*^9, 3.7303275189526663`*^9, 
   3.730331453512734*^9, 3.730331632164563*^9, 3.730333825556847*^9, 
   3.730334254312801*^9, 3.730336442640792*^9, 3.730342266571939*^9, 
   3.730384286036232*^9, 3.730387656125207*^9, 3.730388052775943*^9, 
   3.730392913054763*^9, 3.730401925863163*^9, 3.730407792053239*^9, 
   3.730412952889051*^9, 3.730416071080237*^9, 3.730416403515505*^9, 
   3.730416524109099*^9, 3.7330882925946627`*^9, 3.733151083909712*^9, 
   3.7331597598613567`*^9, 3.733161255065206*^9, 3.73316131818124*^9, 
   3.733162648602129*^9, 3.733255126616159*^9, 3.733255905560321*^9, 
   3.7332585622545033`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium input", "Chapter",
 CellChangeTimes->{{3.712039046240158*^9, 3.712039050803523*^9}, {
   3.712039321674848*^9, 3.712039330339319*^9}, {3.713448619185652*^9, 
   3.713448619412182*^9}, 3.7262194363268967`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u1eq", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"T", " ", 
     RowBox[{"{", 
      RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m1", " ", "gravity"}], " ", "+", 
       FractionBox[
        RowBox[{"d2", " ", "gravity", " ", "m"}], 
        RowBox[{"d2", "-", "d1"}]]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u2eq", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "T"}], " ", 
     RowBox[{"{", 
      RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m2", " ", "gravity"}], " ", "+", 
       FractionBox[
        RowBox[{"d1", " ", "gravity", " ", "m"}], 
        RowBox[{"d1", "-", "d2"}]]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ueq", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"u1eq", "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}], ",", 
     RowBox[{"u2eq", "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712039055245289*^9, 3.712039075825623*^9}, {
   3.712039346484489*^9, 3.7120393530212927`*^9}, {3.713448637769609*^9, 
   3.713448638505965*^9}, {3.724672540579483*^9, 3.7246725786814013`*^9}, {
   3.7246729410326357`*^9, 3.724672944260565*^9}, 3.724672976046919*^9, {
   3.7246731404728003`*^9, 3.724673142791277*^9}, {3.724673327956553*^9, 
   3.7246733384851913`*^9}, 3.7246735844815817`*^9, {3.724673649571423*^9, 
   3.7246736516075163`*^9}, {3.724673732418491*^9, 3.724673734859748*^9}, {
   3.724674239895697*^9, 3.724674244068883*^9}, {3.724674409933182*^9, 
   3.724674413606282*^9}, {3.724675144751145*^9, 3.724675147483992*^9}, {
   3.7247627366551*^9, 3.724762752970986*^9}, {3.725185668038444*^9, 
   3.7251856861013603`*^9}, {3.7262194387194223`*^9, 3.726219495560824*^9}, {
   3.72623991751577*^9, 3.726239927972032*^9}, {3.726314089136449*^9, 
   3.726314198089994*^9}, 3.726314613116111*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium state", "Chapter",
 CellChangeTimes->{{3.7120389777603073`*^9, 3.712038982949807*^9}, {
   3.7134486113669453`*^9, 3.713448611875164*^9}, 3.7262194935124474`*^9, {
   3.7262199047868977`*^9, 3.726219905618948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"z1eq", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
      "#p", ",", "\[IndentingNewLine]", "#n", ",", "\[IndentingNewLine]", 
       RowBox[{"#p", "+", 
        RowBox[{"d1", "#n"}], "+", 
        RowBox[{"L1", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["#", 
             SqrtBox[
              RowBox[{"#", ".", "#"}]]], "&"}], "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"d2", " ", "m", " ", "gravity", " "}], 
              RowBox[{"d2", "-", "d1"}]], 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "+", 
            RowBox[{"T", "#n"}]}], "]"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"#p", "+", 
        RowBox[{"d2", "#n"}], "+", 
        RowBox[{"L2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["#", 
             SqrtBox[
              RowBox[{"#", ".", "#"}]]], "&"}], "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"d1", " ", "m", " ", "gravity"}], 
              RowBox[{"d1", "-", "d2"}]], 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "-", 
            RowBox[{"T", "#n"}]}], "]"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], "&"}], "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<n\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}]}], ",", 
      RowBox[{"\"\<p\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"pxd", ",", "pyd", ",", "pzd"}], "}"}]}]}], "|>"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.724671708164706*^9, 3.724671721785706*^9}, {
   3.7246718337125473`*^9, 3.72467191557898*^9}, 3.724672736852481*^9, {
   3.724672840224821*^9, 3.7246729288648252`*^9}, 3.72467301919235*^9, {
   3.7246731471457443`*^9, 3.72467316966125*^9}, {3.724673208910364*^9, 
   3.724673239181883*^9}, {3.724673310294273*^9, 3.7246733143776407`*^9}, {
   3.724673375193405*^9, 3.7246734202956343`*^9}, {3.724673475760662*^9, 
   3.7246734901940193`*^9}, {3.7246736617338533`*^9, 3.724673678579351*^9}, {
   3.724674059583976*^9, 3.724674147221874*^9}, {3.724674185153*^9, 
   3.724674231964046*^9}, {3.724674654756015*^9, 3.724674660320261*^9}, {
   3.724674856556801*^9, 3.724674861079214*^9}, {3.7246751525816317`*^9, 
   3.7246751844498577`*^9}, {3.724684420119937*^9, 3.724684429202366*^9}, {
   3.7247514025721607`*^9, 3.724751410322489*^9}, {3.724761660252659*^9, 
   3.724761763786743*^9}, {3.7247624448564587`*^9, 3.724762532522059*^9}, {
   3.724762703484544*^9, 3.724762704005192*^9}, {3.725185691080762*^9, 
   3.7251857465436897`*^9}, {3.726219508705741*^9, 3.7262196626696587`*^9}, {
   3.72623993222043*^9, 3.7262400081745*^9}, {3.726240089847913*^9, 
   3.726240092008296*^9}, {3.726313678153681*^9, 3.7263139781117887`*^9}, {
   3.726314102616952*^9, 3.726314133817443*^9}, {3.73032754363144*^9, 
   3.730327545347105*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "test", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"z1eq", "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
     "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "1"}], ",", 
     RowBox[{"d2", "\[Rule]", 
      RowBox[{"-", " ", "1"}]}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "1"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "1"}], ",", 
     RowBox[{"m", "\[Rule]", " ", "1"}], ",", 
     RowBox[{"gravity", "\[Rule]", " ", "10"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.726288699416965*^9, 3.72628871011607*^9}, {
  3.7263142621679707`*^9, 3.7263142798043222`*^9}, {3.726314394102726*^9, 
  3.726314397238368*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", 
   ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.726288703413809*^9, 3.726288710550844*^9}, 
   3.7262951927679768`*^9, 3.7262978793083467`*^9, 3.7262980259856043`*^9, 
   3.7263138306417923`*^9, 3.7263142821269836`*^9, {3.7263144989367933`*^9, 
   3.726314521950761*^9}, 3.726317447176524*^9, 3.726325297890656*^9, 
   3.726383909297702*^9, 3.726390820748904*^9, 3.726395019937439*^9, 
   3.726398687381366*^9, 3.7264109808317966`*^9, 3.72665963556569*^9, 
   3.726659670120736*^9, 3.726663250502246*^9, 3.726665331705161*^9, 
   3.726724982410721*^9, 3.7267443696288757`*^9, 3.726754977588524*^9, 
   3.726763821643783*^9, 3.726763918555999*^9, 3.72683203715475*^9, 
   3.728800783200602*^9, 3.728811001503975*^9, 3.728811048562972*^9, 
   3.728818751912821*^9, 3.729079613018078*^9, 3.7292747488628273`*^9, 
   3.729275794463373*^9, 3.729309083842733*^9, 3.729351821295958*^9, 
   3.730331453831071*^9, 3.7303316323261003`*^9, 3.7303338257251587`*^9, 
   3.730334254450737*^9, 3.730336442810769*^9, 3.730342266851675*^9, 
   3.730342682155838*^9, 3.730384286226894*^9, 3.73038765628937*^9, 
   3.7303880529089947`*^9, 3.73039291320466*^9, 3.73040192606322*^9, 
   3.730407792210017*^9, 3.7304129530816708`*^9, 3.730416071263482*^9, 
   3.730416403675881*^9, 3.730416524280836*^9, 3.7330882927115088`*^9, 
   3.733151084004781*^9, 3.7331597700178967`*^9, 3.733161255134061*^9, 
   3.7331613182089787`*^9, 3.733162648825251*^9, 3.7332551267879143`*^9, 
   3.733255905810257*^9, 3.7332585624229507`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Check vector field vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.7134486234932833`*^9, 3.713448635451254*^9}, 
   3.7262197167103033`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z1", "[", 
       RowBox[{
        RowBox[{"z1eq", "[", "#", "]"}], ",", 
        RowBox[{"ueq", "[", "#", "]"}]}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], "]"}], "//", 
    "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z1", "[", 
       RowBox[{
        RowBox[{"z1eq", "[", "#", "]"}], ",", 
        RowBox[{"ueq", "[", "#", "]"}]}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], "]"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "you", " ", "may", " ", "also", " ", "check", " ", "the", " ", "one", " ",
      "below"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Z1", "[", 
        RowBox[{
         RowBox[{"z1eq", "[", "#", "]"}], ",", 
         RowBox[{"ueq", "[", "#", "]"}]}], "]"}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}], "]"}], "//", 
     "Simplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.724673502096986*^9, 3.7246735136043577`*^9}, {
   3.7246743370190907`*^9, 3.724674353654626*^9}, {3.724674666960822*^9, 
   3.724674779496702*^9}, 3.724683542150405*^9, {3.724684436683853*^9, 
   3.724684441913939*^9}, {3.724751420552719*^9, 3.724751426304945*^9}, 
   3.72476278597145*^9, 3.724767375558063*^9, 3.7251857543635693`*^9, {
   3.72521173990169*^9, 3.725211765317054*^9}, {3.725354869301927*^9, 
   3.725354879916892*^9}, {3.726219660087023*^9, 3.726219679551108*^9}, {
   3.726314429983406*^9, 3.7263144673534813`*^9}, {3.726314542130348*^9, 
   3.726314550274928*^9}, {3.7263146311002493`*^9, 3.726314632935423*^9}, {
   3.726314687798992*^9, 3.7263146990138083`*^9}, 3.726317526980926*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.725185759416065*^9, {3.7252117232824497`*^9, 3.725211761305444*^9}, {
   3.725354865097033*^9, 3.725354880263102*^9}, {3.726219671760923*^9, 
   3.726219681869781*^9}, {3.72621991316885*^9, 3.7262199298664427`*^9}, 
   3.726220291121941*^9, 3.726238931275157*^9, 3.726239914135146*^9, 
   3.726239972053733*^9, {3.726240073168275*^9, 3.726240098834255*^9}, 
   3.7262839115749483`*^9, 3.726295208102378*^9, 3.726297888420207*^9, 
   3.72629803543312*^9, 3.726314469513629*^9, {3.726314499868211*^9, 
   3.7263145254549713`*^9}, 3.7263145837472067`*^9, 3.726314626553689*^9, 
   3.726314797068233*^9, 3.72631745127217*^9, 3.726325307932817*^9, 
   3.726383912887031*^9, 3.7263908242733517`*^9, 3.72639502363492*^9, 
   3.7263986907255163`*^9, 3.726410984544533*^9, {3.7266596515643997`*^9, 
   3.726659676253044*^9}, 3.726663261796871*^9, 3.726665336187626*^9, 
   3.7267249925853977`*^9, 3.726744380887854*^9, 3.726754988975157*^9, 
   3.726763826375297*^9, 3.72676392910411*^9, 3.726832040541238*^9, 
   3.728800789786066*^9, 3.728811005196268*^9, 3.7288110520583467`*^9, 
   3.728818755678979*^9, 3.729079624282687*^9, 3.7292747601968927`*^9, 
   3.729275806259569*^9, 3.7293090951487627`*^9, 3.729351833080305*^9, 
   3.730327580704468*^9, 3.730331458467607*^9, 3.730331636941556*^9, 
   3.730333834883759*^9, 3.73033425951476*^9, 3.7303364523406973`*^9, 
   3.730342271896879*^9, 3.7303426854257517`*^9, 3.7303842906326933`*^9, 
   3.730387661255365*^9, 3.730388057462844*^9, 3.7303929177444277`*^9, 
   3.730401931193987*^9, 3.7304077968964376`*^9, 3.730412957246416*^9, 
   3.730416075720923*^9, 3.730416408395256*^9, 3.730416528906782*^9, 
   3.733088297159285*^9, 3.7331510914262877`*^9, 3.7331597798999453`*^9, 
   3.7331612577138577`*^9, 3.733161319983437*^9, 3.733162651461731*^9, 
   3.733255129450016*^9, 3.7332559084858313`*^9, 3.7332585650937033`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Matrix ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]]]
}], "Chapter",
 CellChangeTimes->{{3.726220509677809*^9, 3.726220515898181*^9}}],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
   "Accelerations", " ", "are", " ", "linear", " ", "in", " ", "tensions"}], 
   ",", " ", 
   RowBox[{"i", ".", "e", "."}], ",", " ", 
   RowBox[{
    OverscriptBox["V", "."], "=", " ", 
    RowBox[{"...", "+", 
     RowBox[{"N", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["T", "1"], ",", 
        SubscriptBox["T", "2"]}], ")"}]}]}]}]}], 
  TraditionalForm]]]], "Subsection",
 CellChangeTimes->{{3.7250389080532846`*^9, 3.725039036922432*^9}, {
  3.726212263632893*^9, 3.72621227323166*^9}, {3.7262205022182817`*^9, 
  3.7262205069222383`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NN", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
      "p2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "m"], " ", 
         RowBox[{"nC1", "[", "z1", "]"}]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Skew", "[", 
           RowBox[{"d1", " ", "n"}], "]"}], ".", 
          RowBox[{"nC1", "[", "z1", "]"}]}], "J"], ",", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "m1"]}], " ", 
         RowBox[{"nC1", "[", "z1", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "m"], " ", 
         RowBox[{"nC2", "[", "z1", "]"}]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Skew", "[", 
           RowBox[{"d2", " ", "n"}], "]"}], ".", 
          RowBox[{"nC2", "[", "z1", "]"}]}], "J"], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "m2"]}], " ", 
         RowBox[{"nC2", "[", "z1", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726212323104609*^9, 3.726212324232532*^9}, {
  3.726220525419156*^9, 3.7262205357790117`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vector field is input affine", "Chapter",
 CellChangeTimes->{{3.713346563102528*^9, 3.7133465680483007`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockDiagonalMatrix", "[", 
   RowBox[{"b", ":", 
    RowBox[{"{", 
     RowBox[{"__", "?", "MatrixQ"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", "c", ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "b", "]"}]}], ",", "i", ",", "j"}], "}"}], ",", 
    
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "c"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Dimensions", "/@", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "j"}], ",", 
          RowBox[{"b", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"c", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.6974018150495167`*^9, 3.6974018150510883`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "dynamics (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["v", "."], "=", 
    RowBox[{"A", "+", "Bu"}]}], TraditionalForm]]],
 ") B matrix below"
}], "Subsection",
 CellChangeTimes->{{3.713346606087528*^9, 3.713346607189866*^9}, {
  3.71334666737858*^9, 3.7133466713193827`*^9}, {3.726221303654501*^9, 
  3.726221323493959*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BU", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
      "p2z_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           FractionBox["1", "m1"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           FractionBox["1", "m2"]}], "}"}]}], "}"}], ",", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NN", "[", "zk", "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"MT", "[", "zk", "]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          FractionBox["m", "m1"], 
          RowBox[{"nC1", "[", "z1", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{
          FractionBox["m", "m2"], 
          RowBox[{"nC2", "[", "z1", "]"}]}]}], "]"}]}], "}"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.697035329195168*^9, 3.697035367670477*^9}, {
   3.6970355419965973`*^9, 3.697035569425507*^9}, {3.6970356910125217`*^9, 
   3.697035718704912*^9}, {3.69703576016464*^9, 3.6970357720182247`*^9}, {
   3.697036991460384*^9, 3.6970371544179373`*^9}, 3.697037203362626*^9, {
   3.697037253544096*^9, 3.697037446948592*^9}, {3.6970376309731693`*^9, 
   3.69703766308992*^9}, 3.697037836389969*^9, {3.697037950883712*^9, 
   3.697037975734763*^9}, {3.697038661171624*^9, 3.6970387317890053`*^9}, {
   3.6970405352272243`*^9, 3.697040535930058*^9}, {3.697046873129723*^9, 
   3.697046997330277*^9}, 3.697276675617457*^9, {3.6974011710303087`*^9, 
   3.697401294270267*^9}, {3.697401376130664*^9, 3.697401383136842*^9}, {
   3.6982972077503366`*^9, 3.698297238810359*^9}, {3.6982972787142153`*^9, 
   3.698297321768669*^9}, {3.698299605331813*^9, 3.698299612132792*^9}, {
   3.7116172582945547`*^9, 3.711617258312307*^9}, {3.711617600849107*^9, 
   3.711617600852448*^9}, {3.711624429332727*^9, 3.711624438094323*^9}, {
   3.711630483368987*^9, 3.71163055095201*^9}, {3.711630595735708*^9, 
   3.71163072499994*^9}, {3.711633384948941*^9, 3.711633406262703*^9}, {
   3.711633443143999*^9, 3.7116334809413958`*^9}, {3.7117162851589327`*^9, 
   3.711716285176291*^9}, {3.711716791494047*^9, 3.711716791727915*^9}, {
   3.711717121256366*^9, 3.711717127248275*^9}, {3.711717776546451*^9, 
   3.711717854377488*^9}, {3.711717894155507*^9, 3.7117179214531603`*^9}, 
   3.713346575307498*^9, {3.713346659850647*^9, 3.713346660084598*^9}, {
   3.72476512256815*^9, 3.724765126173181*^9}, {3.724765163574741*^9, 
   3.7247651765390797`*^9}, {3.726220688854803*^9, 3.726220712071764*^9}, {
   3.726220748608316*^9, 3.726220812930604*^9}, {3.72622088122031*^9, 
   3.7262208838311787`*^9}, 3.726221165093759*^9, {3.726221264990226*^9, 
   3.726221284029303*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Confirm vector field is input affine", \
"Subsection"]], "Subsection",
 CellChangeTimes->{{3.697047007599029*^9, 3.697047018146491*^9}, {
  3.713346625540678*^9, 3.713346630868363*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"error", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
       "u2z_"}], "}"}]}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{"Zd", "[", 
     RowBox[{"z1", ",", "u"}], "]"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Zd", "[", 
       RowBox[{"z1", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], "]"}], "+", 
      RowBox[{
       RowBox[{"BU", "[", "zk", "]"}], ".", "u"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"error", "[", 
    RowBox[{
     RowBox[{"z1lR", "[", "]"}], ",", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "6"}], "]"}]}], "]"}], "/.",
    "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
       "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.697119775974114*^9, 3.697119788318269*^9}, {
   3.697276454967676*^9, 3.697276506828673*^9}, 3.697276679029952*^9, {
   3.697401341553103*^9, 3.697401391357871*^9}, {3.711624662744238*^9, 
   3.711624672779372*^9}, {3.711633488993495*^9, 3.711633491886991*^9}, 
   3.711717854409224*^9, {3.713346652999345*^9, 3.7133466623435783`*^9}, 
   3.724765213657694*^9, {3.726220730159717*^9, 3.726220745209098*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7133466635161247`*^9, 3.713346733146927*^9, 3.714560194670536*^9, 
   3.7148039828276854`*^9, 3.714898824336399*^9, 3.714899066673945*^9, 
   3.7148999396577597`*^9, 3.714901800831893*^9, 3.714901972658229*^9, 
   3.7149029626917467`*^9, 3.714916605820282*^9, 3.714916654648596*^9, 
   3.714931970540353*^9, 3.714934887785818*^9, 3.7149375247346087`*^9, {
   3.724765215859941*^9, 3.724765217992632*^9}, 3.7247684242995787`*^9, 
   3.7247686852242403`*^9, 3.724853585157958*^9, 3.724855819142227*^9, 
   3.724856227554269*^9, 3.724910240224248*^9, 3.724937949919243*^9, 
   3.725038004460093*^9, 3.72503810302605*^9, 3.72518562317572*^9, 
   3.725211683448029*^9, 3.725354735193646*^9, 3.726220743077162*^9, {
   3.726221278355919*^9, 3.726221291931815*^9}, 3.726221355941938*^9, 
   3.7262389317795477`*^9, 3.7262952086283607`*^9, 3.726297888911993*^9, 
   3.726298035937731*^9, 3.7263148051031218`*^9, 3.726317451869089*^9, 
   3.7263253084954357`*^9, 3.726383913165155*^9, 3.726390824517527*^9, 
   3.7263950238892193`*^9, 3.7263986909744062`*^9, 3.7264109847893543`*^9, 
   3.726659676723625*^9, 3.726663262387203*^9, 3.726665336683916*^9, 
   3.726724993053371*^9, 3.726744381423427*^9, 3.726754989511671*^9, 
   3.726763826826315*^9, 3.726763929596979*^9, 3.7268320408107233`*^9, 
   3.728800790391086*^9, 3.7288110057022743`*^9, 3.7288110525688868`*^9, 
   3.7288187559086018`*^9, 3.729079624812565*^9, 3.7292747607890377`*^9, 
   3.7292758067976923`*^9, 3.729309095727149*^9, 3.7293518336238823`*^9, 
   3.730327598451561*^9, 3.7303314589438143`*^9, 3.7303316376228113`*^9, 
   3.7303338355319433`*^9, 3.7303342600815*^9, 3.73033645368134*^9, 
   3.730342272341894*^9, 3.7303426859870243`*^9, 3.730384291088333*^9, 
   3.730387661737068*^9, 3.730388058084549*^9, 3.730392918217698*^9, 
   3.7304019317356052`*^9, 3.730407797377544*^9, 3.730412957823172*^9, 
   3.7304160762082767`*^9, 3.730416408934881*^9, 3.7304165293764687`*^9, 
   3.733088297568471*^9, 3.733151091847116*^9, 3.73315978878643*^9, 
   3.733161257944901*^9, 3.7331613202006617`*^9, 3.733162651980645*^9, 
   3.733255129993546*^9, 3.733255908996915*^9, 3.733258565573621*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking momentum independence from Tensions", "Chapter",
 CellChangeTimes->{{3.7250378833089123`*^9, 3.725037898854957*^9}, {
  3.7262213861592712`*^9, 3.7262213915593987`*^9}}],

Cell[CellGroupData[{

Cell["linear and angular momentum w.r.t. bar\[CloseCurlyQuote]s center of  \
mass", "Subsection",
 CellChangeTimes->{{3.7250379660420523`*^9, 3.725037968965962*^9}, {
  3.7250382158022614`*^9, 3.725038217827067*^9}, {3.726221456621122*^9, 
  3.726221468577251*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PP", "[", 
    RowBox[{"{", 
     RowBox[{
     "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", "\[Omega]y_", ",",
       "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", ",", "v2x_", ",", 
      "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"m", " ", "v"}], " ", "+", " ", 
    RowBox[{"m1", " ", "V1"}], " ", "+", " ", 
    RowBox[{"m2", " ", "V2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HH", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", ",", "v2x_", 
       ",", "v2y_", ",", "v2z_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"J", " ", "\[Omega]"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{
       RowBox[{"d1", " ", "n"}], " ", "+", " ", 
       RowBox[{"l1", " ", 
        RowBox[{"nC1", "[", "z1", "]"}]}]}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"m1", " ", "V1"}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{
       RowBox[{"d2", " ", "n"}], " ", "+", " ", 
       RowBox[{"l2", " ", 
        RowBox[{"nC2", "[", "z1", "]"}]}]}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"m2", " ", "V2"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7250379702556*^9, 3.725037991072814*^9}, {
  3.7250381059815063`*^9, 3.725038210022147*^9}, {3.725038764345265*^9, 
  3.725038848810918*^9}, {3.72622140392822*^9, 3.7262214060962133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"PP", "[", "zd", "]"}], ",", 
     RowBox[{"{", "zd", "}"}]}], "]"}], ".", 
   RowBox[{"NN", "[", "zk", "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"HH", "[", 
      RowBox[{"zk", ",", "zd"}], "]"}], ",", 
     RowBox[{"{", "zd", "}"}]}], "]"}], ".", 
   RowBox[{"NN", "[", "zk", "]"}]}], "//", "Simplify"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.725038855909321*^9, 3.7251856235578938`*^9, 3.725211683974394*^9, 
   3.725354735644252*^9, {3.726221394144219*^9, 3.726221407871228*^9}, 
   3.726238931910808*^9, 3.726295208651374*^9, 3.726297889045788*^9, 
   3.7262980360361156`*^9, 3.726314805137747*^9, 3.726317451946529*^9, 
   3.726325308637525*^9, 3.7263839131973753`*^9, 3.726390824549046*^9, 
   3.726395023929043*^9, 3.726398693164082*^9, 3.7264109848193502`*^9, 
   3.726659676825004*^9, 3.726663262570775*^9, 3.726665336804385*^9, 
   3.726724993136581*^9, 3.726744381539721*^9, 3.726754989624723*^9, 
   3.726763826994279*^9, 3.726763929691512*^9, 3.726832040855206*^9, 
   3.728800790604025*^9, 3.728811005833143*^9, 3.728811052709538*^9, 
   3.728818755946477*^9, 3.729079624995351*^9, 3.72927476097475*^9, 
   3.7292758069126062`*^9, 3.729309095896708*^9, 3.729351833798805*^9, 
   3.730327607757271*^9, 3.730331459043522*^9, 3.7303316377585363`*^9, 
   3.730333835621065*^9, 3.730334260184548*^9, 3.73033645378509*^9, 
   3.730342272433165*^9, 3.730342686209272*^9, 3.7303842911738863`*^9, 
   3.730387661832547*^9, 3.730388058269452*^9, 3.730392918314425*^9, 
   3.730401931945983*^9, 3.730407797471634*^9, 3.730412957926193*^9, 
   3.7304160763306313`*^9, 3.730416409020371*^9, 3.730416529478421*^9, 
   3.7330882976648912`*^9, 3.733151091914113*^9, 3.7331597948653383`*^9, 
   3.733161257972294*^9, 3.733161320224201*^9, 3.733162652108169*^9, 
   3.733255130124048*^9, 3.733255909077022*^9, 3.73325856564756*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.725038855909321*^9, 3.7251856235578938`*^9, 3.725211683974394*^9, 
   3.725354735644252*^9, {3.726221394144219*^9, 3.726221407871228*^9}, 
   3.726238931910808*^9, 3.726295208651374*^9, 3.726297889045788*^9, 
   3.7262980360361156`*^9, 3.726314805137747*^9, 3.726317451946529*^9, 
   3.726325308637525*^9, 3.7263839131973753`*^9, 3.726390824549046*^9, 
   3.726395023929043*^9, 3.726398693164082*^9, 3.7264109848193502`*^9, 
   3.726659676825004*^9, 3.726663262570775*^9, 3.726665336804385*^9, 
   3.726724993136581*^9, 3.726744381539721*^9, 3.726754989624723*^9, 
   3.726763826994279*^9, 3.726763929691512*^9, 3.726832040855206*^9, 
   3.728800790604025*^9, 3.728811005833143*^9, 3.728811052709538*^9, 
   3.728818755946477*^9, 3.729079624995351*^9, 3.72927476097475*^9, 
   3.7292758069126062`*^9, 3.729309095896708*^9, 3.729351833798805*^9, 
   3.730327607757271*^9, 3.730331459043522*^9, 3.7303316377585363`*^9, 
   3.730333835621065*^9, 3.730334260184548*^9, 3.73033645378509*^9, 
   3.730342272433165*^9, 3.730342686209272*^9, 3.7303842911738863`*^9, 
   3.730387661832547*^9, 3.730388058269452*^9, 3.730392918314425*^9, 
   3.730401931945983*^9, 3.730407797471634*^9, 3.730412957926193*^9, 
   3.7304160763306313`*^9, 3.730416409020371*^9, 3.730416529478421*^9, 
   3.7330882976648912`*^9, 3.733151091914113*^9, 3.7331597948653383`*^9, 
   3.733161257972294*^9, 3.733161320224201*^9, 3.733162652108169*^9, 
   3.733255130124048*^9, 3.733255909077022*^9, 3.733258565658277*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular momentum written w.r.t. an arbitrary point", "Subsection",
 CellChangeTimes->{{3.7250388657313766`*^9, 3.725038884944981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PP", "[", 
    RowBox[{"{", 
     RowBox[{
     "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", "\[Omega]y_", ",",
       "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", ",", "v2x_", ",", 
      "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"m", " ", "v"}], " ", "+", " ", 
    RowBox[{"m1", " ", "V1"}], " ", "+", " ", 
    RowBox[{"m2", " ", "V2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HH", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", "\[Omega]y_", 
       ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", ",", "v2x_", 
       ",", "v2y_", ",", "v2z_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"J", " ", "\[Omega]"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"o1", ",", "o2", ",", "o3"}], "}"}], "+", 
       RowBox[{"d1", " ", "n"}], " ", "+", " ", 
       RowBox[{"l1", " ", 
        RowBox[{"nC1", "[", "z1", "]"}]}]}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"m1", " ", "V1"}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"o1", ",", "o2", ",", "o3"}], "}"}], "+", 
       RowBox[{"d2", " ", "n"}], " ", "+", " ", 
       RowBox[{"l2", " ", 
        RowBox[{"nC2", "[", "z1", "]"}]}]}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"m2", " ", "V2"}], ")"}]}], "+", " ", 
    RowBox[{
     RowBox[{"Skew", "[", 
      RowBox[{"{", 
       RowBox[{"o1", ",", "o2", ",", "o3"}], "}"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"m", " ", "v"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.725038859275548*^9, {3.726221422872381*^9, 3.7262214417774057`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"PP", "[", "zd", "]"}], ",", 
     RowBox[{"{", "zd", "}"}]}], "]"}], ".", 
   RowBox[{"NN", "[", "zk", "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"HH", "[", 
      RowBox[{"zk", ",", "zd"}], "]"}], ",", 
     RowBox[{"{", "zd", "}"}]}], "]"}], ".", 
   RowBox[{"NN", "[", "zk", "]"}]}], "//", "Simplify"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwA+LGH5MXfjrw2tFo1lcvq4OvHU/VtrC4A+mDV3/d7QHS
O1ImCpocfu2obNs0ywZI+1iIiUYA6eQr6imRQPrTr7YyEJ2yc+myRCD99lPT
xyQg7bF95vE0IL1HUSO1GUir1IofbQPSk8IZLnUA6STbp3O6gPS8Wum5E0D6
P8/j5jry2vGd/I3T3EB6xm/Z8zxAuohN44MmkBZbvC3dGEh7e+6YagGke2KS
n9kA6Uu/LD+DaKsnMqZxQHrH1+tN8ideO+rU7q9XAdJr4+a0guhavwYPDSD9
ylZt5XIgvfef8ke2k68dL657XMwOpHs2MG8VB9L10W6TdYD0JuUQds7Trx2r
N6a94ALSL0T3/gPRZdPLBXmAdMDqTjcQnRmyJ4IXSN/gEzQQANLcGpeSQbTc
oYwtKkB6feX+SDUgvWZeYDeIrks7/0oDSBsfag3UBdKbirboGQDpH/4HNxsB
aTGlPksTIP3yqnIyiJ4iZFwEou0ZLFl9L7x2XMXZsC4bSIduvvwuH0jfjHNY
WgCkPylyrAXRbVIdwYVA2szTo3oekOZYs/IOiF5su1NjAZAGAGOHCBM=
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwA+LGH5MXfjrw2tFo1lcvq4OvHU/VtrC4A+mDV3/d7QHS
O1ImCpocfu2obNs0ywZI+1iIiUYA6eQr6imRQPrTr7YyEJ2yc+myRCD99lPT
xyQg7bF95vE0IL1HUSO1GUir1IofbQPSk8IZLnUA6STbp3O6gPS8Wum5E0D6
P8/j5jry2vGd/I3T3EB6xm/Z8zxAuohN44MmkBZbvC3dGEh7e+6YagGke2KS
n9kA6Uu/LD+DaKsnMqZxQHrH1+tN8ideO+rU7q9XAdJr4+a0guhavwYPDSD9
ylZt5XIgvfef8ke2k68dL657XMwOpHs2MG8VB9L10W6TdYD0JuUQds7Trx2r
N6a94ALSL0T3/gPRZdPLBXmAdMDqTjcQnRmyJ4IXSN/gEzQQANLcGpeSQbTc
oYwtKkB6feX+SDUgvWZeYDeIrks7/0oDSBsfag3UBdKbirboGQDpH/4HNxsB
aTGlPksTIP3yqnIyiJ4iZFwEou0ZLFl9L7x2XMXZsC4bSIduvvwuH0jfjHNY
WgCkPylyrAXRbVIdwYVA2szTo3oekOZYs/IOiF60ZKfGAiANAGZQCHk=
  "]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["invariance to translations and rotations around vertical", "Chapter",
 CellChangeTimes->{{3.730329833167266*^9, 3.730329848025226*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TRo", "[", 
   RowBox[{"z1_", ",", "R_", ",", "o_"}], "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "3"}], "]"}], "]"}], "-", "o"}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"R", ".", 
     RowBox[{"z1", "[", 
      RowBox[{"[", 
       RowBox[{"4", ";;", "6"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"R", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z1", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "9"}], "]"}], "]"}], "-", "o"}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"R", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z1", "[", 
        RowBox[{"[", 
         RowBox[{"10", ";;", "12"}], "]"}], "]"}], "-", "o"}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"R", ".", 
     RowBox[{"z1", "[", 
      RowBox[{"[", 
       RowBox[{"13", ";;", "15"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"R", ".", 
     RowBox[{"z1", "[", 
      RowBox[{"[", 
       RowBox[{"16", ";;", "18"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"R", ".", 
     RowBox[{"z1", "[", 
      RowBox[{"[", 
       RowBox[{"19", ";;", "21"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"R", ".", 
     RowBox[{"z1", "[", 
      RowBox[{"[", 
       RowBox[{"22", ";;", "24"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7303290206093273`*^9, 3.730329206886261*^9}, {
   3.73032948435175*^9, 3.730329494427706*^9}, 3.7303298510894547`*^9}],

Cell[CellGroupData[{

Cell["rotational around vertical", "Subsubsection",
 CellChangeTimes->{{3.7303302638280153`*^9, 3.730330270868142*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Rvertical", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"OP", "[", "#2", "]"}], ".", "#1"}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"#1", ".", "#2"}], ")"}], "2"]}]]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Skew", "[", "#2", "]"}], ".", "#1"}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"#1", ".", "#2"}], ")"}], "2"]}]]], ",", "#2"}], "}"}], 
      "]"}], ")"}], "&"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]]]}], ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]]], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.730331459444475*^9, 3.7303316381072493`*^9, 
  3.730333835859193*^9, 3.7303342604179487`*^9, 3.730336453989085*^9, 
  3.730342272651105*^9, 3.730342686778805*^9, 3.7303842914077463`*^9, 
  3.730387662104549*^9, 3.730388059005521*^9, 3.730392918599001*^9, 
  3.730401932498638*^9, 3.730407797737596*^9, 3.730412958158503*^9, 
  3.7304160765580873`*^9, 3.730416409253578*^9, 3.730416529716176*^9, 
  3.733088297902955*^9, 3.733151092093431*^9, 3.733159805128969*^9, 
  3.7331612580505667`*^9, 3.7331613202819366`*^9, 3.733162652404291*^9, 
  3.733255130404746*^9, 3.733255909464093*^9, 3.733258565930974*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["invariance of open-loop vector field", "Subsubsection",
 CellChangeTimes->{{3.730330274749522*^9, 3.7303302913209476`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BlockDiagonalMatrix", "[", 
    RowBox[{"b", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "MatrixQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "c", ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "b", "]"}]}], ",", "i", ",", "j"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "c"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Dimensions", "/@", "b"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "j"}], ",", 
           RowBox[{"b", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"c", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"too", " ", "complicated", " ", "for", " ", "mathematica"}], ",", 
    " ", 
    RowBox[{
    "because", " ", "tensions", " ", "involve", " ", "the", " ", "inversion", 
     " ", "of", " ", "a", " ", "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Z1", "[", 
         RowBox[{
          RowBox[{"TRo", "[", 
           RowBox[{"z1", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{"ox", ",", "oy", ",", "oz"}], "}"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"#", ".", "u1"}], ",", 
            RowBox[{"#", ".", "u2"}]}], "]"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{"BlockDiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
           "#", ",", "#", ",", "#", ",", "#", ",", "#", ",", "#", ",", "#", 
            ",", "#"}], "}"}], "]"}], ".", 
         RowBox[{"Z1", "[", 
          RowBox[{"z1", ",", "u"}], "]"}]}]}], "&"}], "[", "Rvertical", "]"}],
      ")"}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "tensions", " ", "are", " ", "invariant", " ", "to", " ", "rotations", " ",
     "and", " ", "translations"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MT", "[", 
      RowBox[{
       RowBox[{"TRo", "[", 
        RowBox[{"z1", ",", "#", ",", 
         RowBox[{"{", 
          RowBox[{"ox", ",", "oy", ",", "oz"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "12"}], "]"}], "]"}], "]"}], "-", 
     RowBox[{"MT", "[", 
      RowBox[{"z1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "12"}], "]"}], "]"}], "]"}]}], "&"}], "[", 
   "Rvertical", "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"BB", "[", 
       RowBox[{
        RowBox[{"TRo", "[", 
         RowBox[{"z1", ",", "#", ",", 
          RowBox[{"{", 
           RowBox[{"ox", ",", "oy", ",", "oz"}], "}"}]}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"#", ".", "u1"}], ",", 
          RowBox[{"#", ".", "u2"}]}], "]"}]}], "]"}], "-", 
      RowBox[{"BB", "[", 
       RowBox[{"z1", ",", "u"}], "]"}]}], "&"}], "[", "Rvertical", "]"}], "//",
    "Simplify"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "proving", " ", "that", " ", "Z", " ", "is", " ", "invariant", " ", "to", 
    " ", "rotations", " ", "and", " ", "translations", " ", "is", " ", "easy",
     " ", "after", " ", "showing", " ", "that", " ", "tensions", " ", "are", 
    " ", "invariant", " ", "to", " ", "rotations", " ", "and", " ", 
    "translations"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.730329879536565*^9, 3.7303299222125*^9}, {
  3.730329961022196*^9, 3.7303299963021917`*^9}, {3.730330174743589*^9, 
  3.730330242881774*^9}, {3.730330298343642*^9, 3.730330299225247*^9}, {
  3.7303303436947308`*^9, 3.730330366956299*^9}, {3.7303304309279737`*^9, 
  3.730330479626099*^9}, {3.730330553949007*^9, 3.730330624273017*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.730330625866729*^9, 3.730331460678487*^9, 
  3.730331639394985*^9, 3.730333838465447*^9, 3.73033426161902*^9, 
  3.730336459638233*^9, 3.730342273848605*^9, 3.73034268802306*^9, 
  3.7303842925599203`*^9, 3.7303876632102137`*^9, 3.730388060422243*^9, 
  3.730392919816894*^9, 3.730401933757677*^9, 3.7304077990740213`*^9, 
  3.730412960014741*^9, 3.730416077940377*^9, 3.730416410570324*^9, 
  3.730416530918632*^9, 3.733088299046788*^9, 3.733151093411824*^9, 
  3.733159810601131*^9, 3.7331612587596292`*^9, 3.733161320725273*^9, 
  3.733162653141601*^9, 3.733255131159298*^9, 3.73325591029532*^9, 
  3.7332585667148647`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.730330625866729*^9, 3.730331460678487*^9, 
  3.730331639394985*^9, 3.730333838465447*^9, 3.73033426161902*^9, 
  3.730336459638233*^9, 3.730342273848605*^9, 3.73034268802306*^9, 
  3.7303842925599203`*^9, 3.7303876632102137`*^9, 3.730388060422243*^9, 
  3.730392919816894*^9, 3.730401933757677*^9, 3.7304077990740213`*^9, 
  3.730412960014741*^9, 3.730416077940377*^9, 3.730416410570324*^9, 
  3.730416530918632*^9, 3.733088299046788*^9, 3.733151093411824*^9, 
  3.733159810601131*^9, 3.7331612587596292`*^9, 3.733161320725273*^9, 
  3.733162653141601*^9, 3.733255131159298*^9, 3.73325591029532*^9, 
  3.73325856732082*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Control law for each uav", "Chapter",
 CellChangeTimes->{{3.712040075566353*^9, 3.712040080540077*^9}}],

Cell[CellGroupData[{

Cell["rotation  ", "Subchapter",
 CellChangeTimes->{{3.730331127012053*^9, 3.7303311340666637`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Rn\[Gamma]", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"OP", "[", "#2", "]"}], ".", "#1"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"#1", ".", "#2"}], ")"}], "2"]}]]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"Skew", "[", "#2", "]"}], ".", "#1"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"#1", ".", "#2"}], ")"}], "2"]}]]], ",", "#2"}], "}"}], 
       "]"}], ")"}], "&"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7292993043218193`*^9, 3.729299420294241*^9}, {
  3.729306747925694*^9, 3.729306873595937*^9}, {3.729306907767395*^9, 
  3.729306959253516*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["relations that involve to Rn\[Gamma]", "Subchapter",
 CellChangeTimes->{{3.730329554805827*^9, 3.730329564389059*^9}, {
  3.730331136429009*^9, 3.730331141194113*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rn\[Gamma]AUX", "=", 
   RowBox[{"Rn\[Gamma]", "[", 
    RowBox[{"{", 
     RowBox[{"px", ",", "py", ",", "pz", ",", "T", ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "Rn\[Gamma]AUX", "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ")"}], "-", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "Rn\[Gamma]AUX", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], ")"}], "-", 
    RowBox[{"{", 
     RowBox[{
      SqrtBox[
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], "//", "Simplify"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
      RowBox[{"u1eq", " ", "[", "#", "]"}]}], "-", 
     RowBox[{"u1eq", " ", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], "]"}]}], "&"}], 
   "[", 
   RowBox[{"{", 
    RowBox[{"px", ",", "py", ",", "pz", ",", "T", ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
      RowBox[{"u2eq", " ", "[", "#", "]"}]}], "-", 
     RowBox[{"u2eq", " ", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], "]"}]}], "&"}], 
   "[", 
   RowBox[{"{", 
    RowBox[{"px", ",", "py", ",", "pz", ",", "T", ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], "]"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.729355583019332*^9, 3.729355610438134*^9}, {
  3.7303295724669847`*^9, 3.730329675100209*^9}, {3.7331598600133133`*^9, 
  3.733159914213582*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7293556054942303`*^9, 3.7293556107916327`*^9}, 
   3.729355683603034*^9, 3.729356390077714*^9, 3.7303295837845488`*^9, {
   3.7303296490282927`*^9, 3.7303296754503613`*^9}, 3.730331462119336*^9, 
   3.730331640750132*^9, 3.7303338422055273`*^9, 3.7303342628892517`*^9, 
   3.730336466155878*^9, 3.7303422750705748`*^9, 3.7303426894731483`*^9, 
   3.7303842937944613`*^9, 3.730387664404356*^9, 3.7303880616770477`*^9, 
   3.730392921052248*^9, 3.7304019352518044`*^9, 3.730407800342998*^9, 
   3.730412961334806*^9, 3.730416079198471*^9, 3.730416412127632*^9, 
   3.730416532266808*^9, 3.733088300270527*^9, 3.7331510948692303`*^9, {
   3.733159832468464*^9, 3.733159909831414*^9}, 3.7331612594317102`*^9, 
   3.733161321365674*^9, 3.7331626539470377`*^9, 3.733255132008192*^9, 
   3.733255911197352*^9, 3.733258567510798*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7293556054942303`*^9, 3.7293556107916327`*^9}, 
   3.729355683603034*^9, 3.729356390077714*^9, 3.7303295837845488`*^9, {
   3.7303296490282927`*^9, 3.7303296754503613`*^9}, 3.730331462119336*^9, 
   3.730331640750132*^9, 3.7303338422055273`*^9, 3.7303342628892517`*^9, 
   3.730336466155878*^9, 3.7303422750705748`*^9, 3.7303426894731483`*^9, 
   3.7303842937944613`*^9, 3.730387664404356*^9, 3.7303880616770477`*^9, 
   3.730392921052248*^9, 3.7304019352518044`*^9, 3.730407800342998*^9, 
   3.730412961334806*^9, 3.730416079198471*^9, 3.730416412127632*^9, 
   3.730416532266808*^9, 3.733088300270527*^9, 3.7331510948692303`*^9, {
   3.733159832468464*^9, 3.733159909831414*^9}, 3.7331612594317102`*^9, 
   3.733161321365674*^9, 3.7331626539470377`*^9, 3.733255132008192*^9, 
   3.733255911197352*^9, 3.73325856751635*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7293556054942303`*^9, 3.7293556107916327`*^9}, 
   3.729355683603034*^9, 3.729356390077714*^9, 3.7303295837845488`*^9, {
   3.7303296490282927`*^9, 3.7303296754503613`*^9}, 3.730331462119336*^9, 
   3.730331640750132*^9, 3.7303338422055273`*^9, 3.7303342628892517`*^9, 
   3.730336466155878*^9, 3.7303422750705748`*^9, 3.7303426894731483`*^9, 
   3.7303842937944613`*^9, 3.730387664404356*^9, 3.7303880616770477`*^9, 
   3.730392921052248*^9, 3.7304019352518044`*^9, 3.730407800342998*^9, 
   3.730412961334806*^9, 3.730416079198471*^9, 3.730416412127632*^9, 
   3.730416532266808*^9, 3.733088300270527*^9, 3.7331510948692303`*^9, {
   3.733159832468464*^9, 3.733159909831414*^9}, 3.7331612594317102`*^9, 
   3.733161321365674*^9, 3.7331626539470377`*^9, 3.733255132008192*^9, 
   3.733255911197352*^9, 3.733258567532818*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7293556054942303`*^9, 3.7293556107916327`*^9}, 
   3.729355683603034*^9, 3.729356390077714*^9, 3.7303295837845488`*^9, {
   3.7303296490282927`*^9, 3.7303296754503613`*^9}, 3.730331462119336*^9, 
   3.730331640750132*^9, 3.7303338422055273`*^9, 3.7303342628892517`*^9, 
   3.730336466155878*^9, 3.7303422750705748`*^9, 3.7303426894731483`*^9, 
   3.7303842937944613`*^9, 3.730387664404356*^9, 3.7303880616770477`*^9, 
   3.730392921052248*^9, 3.7304019352518044`*^9, 3.730407800342998*^9, 
   3.730412961334806*^9, 3.730416079198471*^9, 3.730416412127632*^9, 
   3.730416532266808*^9, 3.733088300270527*^9, 3.7331510948692303`*^9, {
   3.733159832468464*^9, 3.733159909831414*^9}, 3.7331612594317102`*^9, 
   3.733161321365674*^9, 3.7331626539470377`*^9, 3.733255132008192*^9, 
   3.733255911197352*^9, 3.733258567546886*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["proportional and derivative gains", "Subchapter",
 CellChangeTimes->{{3.730329685002386*^9, 3.73032969227929*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kp1", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"kpx1", ",", "kpy1", ",", "kpz1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kd1", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"kvx1", ",", "kvy1", ",", "kvz1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kp2", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"kpx2", ",", "kpy2", ",", "kpz2"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kd2", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"kvx2", ",", "kvy2", ",", "kvz2"}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.729307040564336*^9, 3.7293070873903008`*^9}, {
  3.7293561805308857`*^9, 3.7293561877291517`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["pd control law for UAV 1 and 2: unsaturated version", "Subchapter",
 CellChangeTimes->{{3.730329700640293*^9, 3.7303297082095823`*^9}, {
  3.730331151084087*^9, 3.730331155267741*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u1PD", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "m1"}], "  ", 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Kp1", ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}], "-", 
             RowBox[{
              RowBox[{"z1eq", "[", "#", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"7", ";;", "9"}], "]"}], "]"}]}], ")"}]}], "+", 
          "\[IndentingNewLine]", 
          RowBox[{"Kd1", ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"v1x", ",", "v1y", ",", "v1z"}], "}"}]}]}], 
         "\[IndentingNewLine]", ")"}]}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"m1", " ", "d1", " ", 
       FractionBox["L1", 
        RowBox[{"L1", "+", "L2"}]], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kp\[Psi]1", " ", 
           RowBox[{
            RowBox[{"Skew", "[", 
             RowBox[{"{", 
              RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
          RowBox[{"kv\[Psi]1", 
           RowBox[{"{", 
            RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], 
            "}"}]}]}], " ", ")"}]}], 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u2PD", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "m2"}], "  ", 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Kp2", ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}], "-", 
             RowBox[{
              RowBox[{"z1eq", "[", "#", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], ")"}]}], "+", 
          "\[IndentingNewLine]", 
          RowBox[{"Kd2", ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"v2x", ",", "v2y", ",", "v2z"}], "}"}]}]}], 
         "\[IndentingNewLine]", ")"}]}]}], "+", 
      RowBox[{"m2", " ", "d2", " ", 
       FractionBox["L2", 
        RowBox[{"L1", "+", "L2"}]], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kp\[Psi]2", " ", 
           RowBox[{
            RowBox[{"Skew", "[", 
             RowBox[{"{", 
              RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
          RowBox[{"kv\[Psi]2", 
           RowBox[{"{", 
            RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], 
            "}"}]}]}], " ", ")"}]}], 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7303425772932777`*^9, 3.730342589981927*^9}, {
  3.730342624757647*^9, 3.730342642061246*^9}}],

Cell[CellGroupData[{

Cell["include feedforward term", "Subsubsection",
 CellChangeTimes->{{3.730342643845106*^9, 3.7303426503241253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "pd", " ", "control", " ", "law", " ", "for", " ", "for", " ", "each", " ",
     "direction"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u1clComplete", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_",
          ",", "nzd_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ueq", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ")"}], "+", 
        RowBox[{"u1PD", "[", 
         RowBox[{"z1", ",", "#"}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"u2clComplete", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_",
          ",", "nzd_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ueq", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "6"}], "]"}], "]"}], ")"}], "+", 
        RowBox[{"u2PD", "[", 
         RowBox[{"z1", ",", "#"}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.678453870578924*^9, 3.6784538851660337`*^9}, {
   3.6784539201437883`*^9, 3.67845426729596*^9}, {3.6784542976203947`*^9, 
   3.678454338207302*^9}, {3.678454368219833*^9, 3.67845442420653*^9}, {
   3.678455564719254*^9, 3.6784555755938787`*^9}, {3.678455667955229*^9, 
   3.67845567412951*^9}, {3.6784557240285482`*^9, 3.67845580636443*^9}, {
   3.67845594497412*^9, 3.6784560056472273`*^9}, {3.678456040740004*^9, 
   3.678456113360455*^9}, {3.6784565804483*^9, 3.6784566989706917`*^9}, {
   3.67845699495473*^9, 3.6784570051161823`*^9}, {3.678457074189624*^9, 
   3.678457074400229*^9}, {3.678457120811713*^9, 3.678457132773929*^9}, {
   3.6784573833439817`*^9, 3.678457399044024*^9}, {3.678457566717965*^9, 
   3.678457575258934*^9}, {3.6784576138433027`*^9, 3.67845764511302*^9}, {
   3.678457681670499*^9, 3.6784576869371843`*^9}, {3.6785030133194637`*^9, 
   3.678503018851026*^9}, {3.678503053700424*^9, 3.678503061887308*^9}, {
   3.6785031141864853`*^9, 3.678503151671834*^9}, {3.6785035454280252`*^9, 
   3.678503565801978*^9}, {3.692605692777117*^9, 3.692605787151251*^9}, {
   3.692605871228614*^9, 3.692605875567656*^9}, {3.697783560030775*^9, 
   3.697783584633834*^9}, {3.697864144145309*^9, 3.6978642846827497`*^9}, {
   3.6978644724858093`*^9, 3.697864474524767*^9}, {3.6978645253057003`*^9, 
   3.697864529099121*^9}, {3.6978648087283993`*^9, 3.697864819666897*^9}, {
   3.697864857946622*^9, 3.697864871615958*^9}, {3.697865030310058*^9, 
   3.697865054256448*^9}, {3.6978653837364273`*^9, 3.697865403161058*^9}, {
   3.697865434075416*^9, 3.697865435874483*^9}, {3.6978655603144903`*^9, 
   3.6978655605135307`*^9}, {3.697878887139681*^9, 3.6978789273146276`*^9}, {
   3.712038875130848*^9, 3.712038878681403*^9}, 3.7120393854066896`*^9, {
   3.712040082366139*^9, 3.712040082678351*^9}, {3.7120401609284153`*^9, 
   3.712040170183938*^9}, {3.712040226413877*^9, 3.712040307061963*^9}, {
   3.7120403525685987`*^9, 3.7120404400933*^9}, {3.7120474726221743`*^9, 
   3.7120474757472897`*^9}, {3.712116926109763*^9, 3.712117064974493*^9}, {
   3.7121172584306*^9, 3.712117304172991*^9}, {3.71211769691184*^9, 
   3.7121177334271097`*^9}, {3.7121178099621468`*^9, 3.712117826487574*^9}, {
   3.7121273633642406`*^9, 3.712127392651319*^9}, {3.712134728325556*^9, 
   3.712134736513805*^9}, {3.712134776729841*^9, 3.7121347833000307`*^9}, {
   3.712150008166641*^9, 3.712150028687416*^9}, {3.7121500979389563`*^9, 
   3.7121501124205008`*^9}, {3.712841828170721*^9, 3.712841828175336*^9}, {
   3.712842173521311*^9, 3.712842173526173*^9}, {3.712844056258308*^9, 
   3.7128440869021053`*^9}, {3.712847966254746*^9, 3.712847966259042*^9}, {
   3.712853316853519*^9, 3.712853343932612*^9}, {3.71285339637422*^9, 
   3.712853408929783*^9}, {3.712853548788332*^9, 3.71285355298173*^9}, {
   3.71298295129955*^9, 3.712982955194254*^9}, {3.712983293924004*^9, 
   3.7129833113195972`*^9}, {3.713448815718647*^9, 3.7134488689281063`*^9}, {
   3.724677470559257*^9, 3.724677477162611*^9}, {3.724684045784856*^9, 
   3.724684045790318*^9}, {3.7247513414901543`*^9, 3.724751341495636*^9}, {
   3.7247514357843933`*^9, 3.724751440923985*^9}, {3.724767449503585*^9, 
   3.724767498198578*^9}, {3.726238969736364*^9, 3.726238975223404*^9}, 
   3.726239310539795*^9, 3.726239613844377*^9, {3.726309730345427*^9, 
   3.7263097651304493`*^9}, {3.7263149572380943`*^9, 3.726315093547611*^9}, {
   3.7263151246502113`*^9, 3.726315225524687*^9}, {3.726315278013318*^9, 
   3.7263153074552593`*^9}, {3.7263153577036333`*^9, 3.726315364711985*^9}, {
   3.72639866609133*^9, 3.726398669800305*^9}, {3.7263989080879393`*^9, 
   3.726398919684053*^9}, {3.729299249154545*^9, 3.729299266668913*^9}, {
   3.729306985828233*^9, 3.729307028088059*^9}, {3.729307092926269*^9, 
   3.729307246366514*^9}, {3.7293072956851387`*^9, 3.7293074838458977`*^9}, {
   3.729308584072682*^9, 3.729308592597748*^9}, {3.7293559860897923`*^9, 
   3.729356023422908*^9}, {3.729356105739304*^9, 3.729356108478258*^9}, {
   3.72935629626583*^9, 3.729356308118354*^9}, {3.7303297175636587`*^9, 
   3.7303297203636713`*^9}, {3.730329753529695*^9, 3.730329785287073*^9}, 
   3.730342573006469*^9, {3.730342604767749*^9, 3.73034261210892*^9}, {
   3.730342661237238*^9, 3.730342663510839*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["combine control laws of UAVs", "Subchapter",
 CellChangeTimes->{{3.730329757733515*^9, 3.730329767507823*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"complete", " ", "control", " ", "law"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ucl", "[", 
    RowBox[{"z_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"u1clComplete", "[", 
      RowBox[{"z", ",", "\[Gamma]"}], "]"}], ",", 
     RowBox[{"u2clComplete", "[", 
      RowBox[{"z", ",", "\[Gamma]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.730331387911173*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Verify that we only really need to consider \[Gamma]=",
 Cell[BoxData[
  RowBox[{"(", 
   RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
    SqrtBox[
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]],
  CellChangeTimes->{{3.73032935172048*^9, 3.730329377583016*^9}, {
   3.7303294221596603`*^9, 3.730329424939258*^9}}]
}], "Subchapter",
 CellChangeTimes->{{3.730329427487344*^9, 3.730329459168325*^9}, {
  3.730329501456642*^9, 3.7303295023652763`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"u1clComplete", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#2", "]"}], ".", 
        RowBox[{"u1clComplete", "[", 
         RowBox[{
          RowBox[{"TRo", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Rn\[Gamma]", "[", "#2", "]"}], "]"}], ",", 
            RowBox[{"#2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
            SqrtBox[
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}]}], 
      "&"}], "[", 
     RowBox[{
      RowBox[{"z1l", "[", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "#"], "&"}], ",", "18"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], "//", 
    "Simplify"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"only", " ", "verified", " ", "for", " ", "UAV", " ", "1"}], ",", 
    " ", 
    RowBox[{
    "but", " ", "can", " ", "also", " ", "be", " ", "verified", " ", "for", 
     " ", "UAV", " ", "2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"u1clComplete", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Rn\[Gamma]", "[", "#2", "]"}], ".", 
       RowBox[{"u1clComplete", "[", 
        RowBox[{
         RowBox[{"TRo", "[", 
          RowBox[{"#1", ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Rn\[Gamma]", "[", "#2", "]"}], "]"}], ",", 
           RowBox[{"#2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
           SqrtBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}]}], "&"}],
     "[", 
    RowBox[{
     RowBox[{"z1l", "[", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "#"], "&"}], ",", "18"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz", ",", "T", ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.73032935172048*^9, 3.730329377583016*^9}, {
  3.7303294221596603`*^9, 3.730329424939258*^9}, {3.730331631709503*^9, 
  3.7303316786420937`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7303293616491613`*^9, 3.730329416668701*^9, 
  3.73033169276869*^9, 3.7303339018697033`*^9, 3.730334301236817*^9, 
  3.7303365390974817`*^9, 3.730342315714055*^9, 3.730384333029756*^9, 
  3.73038770035574*^9, 3.7303880986468477`*^9, 3.730392958503497*^9, 
  3.7304019962372932`*^9, 3.730407840193145*^9, 3.7304130065147343`*^9, 
  3.730416117986843*^9, 3.730416451253708*^9, 3.730416570476912*^9, 
  3.73308833749825*^9, 3.733151145013157*^9, 3.7331599797533407`*^9, 
  3.733161279049676*^9, 3.733161339541712*^9, 3.733162673349268*^9, 
  3.733255151218997*^9, 3.733255931273551*^9, 3.733258586540913*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["pd control law for UAV 1 and 2: Saturated", "Subchapter",
 CellChangeTimes->{{3.730329700640293*^9, 3.7303297082095823`*^9}, {
  3.730330669966112*^9, 3.7303306723711147`*^9}}],

Cell[CellGroupData[{

Cell["saturation function", "Subsection",
 CellChangeTimes->{{3.730342736535818*^9, 3.730342742473597*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Sigma]3D", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Sigma]", "[", "x", "]"}], ",", 
    RowBox[{"\[Sigma]", "[", "y", "]"}], ",", 
    RowBox[{"\[Sigma]", "[", "z", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.730330689546586*^9, 3.730330728464548*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["saturated PD", "Subsection",
 CellChangeTimes->{{3.730342719175447*^9, 3.730342733382784*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u1PDSaturated", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "m1"}], "  ", 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Kp1", ".", 
           RowBox[{"\[Sigma]3D", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}], "-", 
               RowBox[{
                RowBox[{"z1eq", "[", "#", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"7", ";;", "9"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
          "+", "\[IndentingNewLine]", 
          RowBox[{"Kd1", ".", 
           RowBox[{"\[Sigma]3D", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{"v1x", ",", "v1y", ",", "v1z"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", ")"}]}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"m1", " ", "d1", " ", 
       FractionBox["L1", 
        RowBox[{"L1", "+", "L2"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kp\[Psi]1", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ".", 
           RowBox[{"Skew", "[", 
            RowBox[{"{", 
             RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
         RowBox[{"kv\[Psi]1", " ", 
          RowBox[{"\[Sigma]", "[", "\[Omega]z", "]"}]}]}], " ", ")"}], 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u2PDSaturated", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "m2"}], "  ", 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Kp2", ".", 
           RowBox[{"\[Sigma]3D", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}], "-", 
               RowBox[{
                RowBox[{"z1eq", "[", "#", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
           "+", "\[IndentingNewLine]", 
          RowBox[{"Kd2", ".", 
           RowBox[{"\[Sigma]3D", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Rn\[Gamma]", "[", "#", "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{"v2x", ",", "v2y", ",", "v2z"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", ")"}]}]}], "+", 
      RowBox[{"m2", " ", "d2", " ", 
       FractionBox["L2", 
        RowBox[{"L1", "+", "L2"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kp\[Psi]2", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ".", 
           RowBox[{"Skew", "[", 
            RowBox[{"{", 
             RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
         RowBox[{"kv\[Psi]2", " ", 
          RowBox[{"\[Sigma]", "[", "\[Omega]z", "]"}]}]}], " ", ")"}], 
       RowBox[{
        RowBox[{"Rn\[Gamma]", "[", "#", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.730342747026775*^9, 3.730342770530195*^9}}],

Cell[CellGroupData[{

Cell["include feedforward term", "Subsubsection",
 CellChangeTimes->{{3.730342643845106*^9, 3.7303426503241253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "pd", " ", "control", " ", "law", " ", "for", " ", "for", " ", "each", " ",
     "direction"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u1clCompleteSaturated", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_",
          ",", "nzd_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ueq", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ")"}], "+", 
        RowBox[{"u1PDSaturated", "[", 
         RowBox[{"z1", ",", "#"}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"u2clCompleteSaturated", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_",
          ",", "nzd_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ueq", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "6"}], "]"}], "]"}], ")"}], "+", 
        RowBox[{"u2PDSaturated", "[", 
         RowBox[{"z1", ",", "#"}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"complete", " ", "control", " ", "law"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uclSaturated", "[", 
     RowBox[{"z_", ",", "\[Gamma]_"}], "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"u1clCompleteSaturated", "[", 
       RowBox[{"z", ",", "\[Gamma]"}], "]"}], ",", 
      RowBox[{"u2clCompleteSaturated", "[", 
       RowBox[{"z", ",", "\[Gamma]"}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.678453870578924*^9, 3.6784538851660337`*^9}, {
   3.6784539201437883`*^9, 3.67845426729596*^9}, {3.6784542976203947`*^9, 
   3.678454338207302*^9}, {3.678454368219833*^9, 3.67845442420653*^9}, {
   3.678455564719254*^9, 3.6784555755938787`*^9}, {3.678455667955229*^9, 
   3.67845567412951*^9}, {3.6784557240285482`*^9, 3.67845580636443*^9}, {
   3.67845594497412*^9, 3.6784560056472273`*^9}, {3.678456040740004*^9, 
   3.678456113360455*^9}, {3.6784565804483*^9, 3.6784566989706917`*^9}, {
   3.67845699495473*^9, 3.6784570051161823`*^9}, {3.678457074189624*^9, 
   3.678457074400229*^9}, {3.678457120811713*^9, 3.678457132773929*^9}, {
   3.6784573833439817`*^9, 3.678457399044024*^9}, {3.678457566717965*^9, 
   3.678457575258934*^9}, {3.6784576138433027`*^9, 3.67845764511302*^9}, {
   3.678457681670499*^9, 3.6784576869371843`*^9}, {3.6785030133194637`*^9, 
   3.678503018851026*^9}, {3.678503053700424*^9, 3.678503061887308*^9}, {
   3.6785031141864853`*^9, 3.678503151671834*^9}, {3.6785035454280252`*^9, 
   3.678503565801978*^9}, {3.692605692777117*^9, 3.692605787151251*^9}, {
   3.692605871228614*^9, 3.692605875567656*^9}, {3.697783560030775*^9, 
   3.697783584633834*^9}, {3.697864144145309*^9, 3.6978642846827497`*^9}, {
   3.6978644724858093`*^9, 3.697864474524767*^9}, {3.6978645253057003`*^9, 
   3.697864529099121*^9}, {3.6978648087283993`*^9, 3.697864819666897*^9}, {
   3.697864857946622*^9, 3.697864871615958*^9}, {3.697865030310058*^9, 
   3.697865054256448*^9}, {3.6978653837364273`*^9, 3.697865403161058*^9}, {
   3.697865434075416*^9, 3.697865435874483*^9}, {3.6978655603144903`*^9, 
   3.6978655605135307`*^9}, {3.697878887139681*^9, 3.6978789273146276`*^9}, {
   3.712038875130848*^9, 3.712038878681403*^9}, 3.7120393854066896`*^9, {
   3.712040082366139*^9, 3.712040082678351*^9}, {3.7120401609284153`*^9, 
   3.712040170183938*^9}, {3.712040226413877*^9, 3.712040307061963*^9}, {
   3.7120403525685987`*^9, 3.7120404400933*^9}, {3.7120474726221743`*^9, 
   3.7120474757472897`*^9}, {3.712116926109763*^9, 3.712117064974493*^9}, {
   3.7121172584306*^9, 3.712117304172991*^9}, {3.71211769691184*^9, 
   3.7121177334271097`*^9}, {3.7121178099621468`*^9, 3.712117826487574*^9}, {
   3.7121273633642406`*^9, 3.712127392651319*^9}, {3.712134728325556*^9, 
   3.712134736513805*^9}, {3.712134776729841*^9, 3.7121347833000307`*^9}, {
   3.712150008166641*^9, 3.712150028687416*^9}, {3.7121500979389563`*^9, 
   3.7121501124205008`*^9}, {3.712841828170721*^9, 3.712841828175336*^9}, {
   3.712842173521311*^9, 3.712842173526173*^9}, {3.712844056258308*^9, 
   3.7128440869021053`*^9}, {3.712847966254746*^9, 3.712847966259042*^9}, {
   3.712853316853519*^9, 3.712853343932612*^9}, {3.71285339637422*^9, 
   3.712853408929783*^9}, {3.712853548788332*^9, 3.71285355298173*^9}, {
   3.71298295129955*^9, 3.712982955194254*^9}, {3.712983293924004*^9, 
   3.7129833113195972`*^9}, {3.713448815718647*^9, 3.7134488689281063`*^9}, {
   3.724677470559257*^9, 3.724677477162611*^9}, {3.724684045784856*^9, 
   3.724684045790318*^9}, {3.7247513414901543`*^9, 3.724751341495636*^9}, {
   3.7247514357843933`*^9, 3.724751440923985*^9}, {3.724767449503585*^9, 
   3.724767498198578*^9}, {3.726238969736364*^9, 3.726238975223404*^9}, 
   3.726239310539795*^9, 3.726239613844377*^9, {3.726309730345427*^9, 
   3.7263097651304493`*^9}, {3.7263149572380943`*^9, 3.726315093547611*^9}, {
   3.7263151246502113`*^9, 3.726315225524687*^9}, {3.726315278013318*^9, 
   3.7263153074552593`*^9}, {3.7263153577036333`*^9, 3.726315364711985*^9}, {
   3.72639866609133*^9, 3.726398669800305*^9}, {3.7263989080879393`*^9, 
   3.726398919684053*^9}, {3.729299249154545*^9, 3.729299266668913*^9}, {
   3.729306985828233*^9, 3.729307028088059*^9}, {3.729307092926269*^9, 
   3.729307246366514*^9}, {3.7293072956851387`*^9, 3.7293074838458977`*^9}, {
   3.729308584072682*^9, 3.729308592597748*^9}, {3.7293559860897923`*^9, 
   3.729356023422908*^9}, {3.729356105739304*^9, 3.729356108478258*^9}, {
   3.72935629626583*^9, 3.729356308118354*^9}, {3.7303297175636587`*^9, 
   3.7303297203636713`*^9}, {3.730329753529695*^9, 3.730329785287073*^9}, {
   3.730330674468965*^9, 3.7303306815258093`*^9}, {3.730330735672233*^9, 
   3.7303307865679617`*^9}, {3.7303309813390493`*^9, 3.730330984349592*^9}, {
   3.730331404304755*^9, 3.7303314147398577`*^9}, {3.7303427772232437`*^9, 
   3.73034279084997*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Verify that saturation does not play a role when we linearize (so, we can \
ignore saturations)
\[Sigma][0]=0
\[Sigma]\[CloseCurlyQuote][0]=1\
\>", "Subchapter",
 CellChangeTimes->{{3.7303311750362177`*^9, 3.730331201933482*^9}, {
  3.730331799871663*^9, 3.7303318083096657`*^9}}],

Cell[CellGroupData[{

Cell["\<\
input with and without saturations is the same at the equilibrium\
\>", "Subsubsection",
 CellChangeTimes->{{3.730331812573482*^9, 3.7303318391010323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"uclSaturated", "[", 
        RowBox[{"z1", ",", "#"}], "]"}], "-", 
       RowBox[{"ucl", "[", 
        RowBox[{"z1", ",", "#"}], "]"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z1", "\[Rule]", " ", 
        RowBox[{"z1eq", "[", "#", "]"}]}], "]"}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}], ",", 
   RowBox[{
    RowBox[{"\[Sigma]", "[", "0", "]"}], "\[Equal]", "0"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.7303317666483793`*^9, 3.7303317921887093`*^9}, {
  3.7303428222049026`*^9, 3.730342825769911*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.730331772061802*^9, 3.730331792894672*^9}, 
   3.7303339021088133`*^9, 3.730334301480698*^9, 3.730336539316042*^9, 
   3.730342316073567*^9, 3.730342819378593*^9, 3.73038433328545*^9, 
   3.730387700912362*^9, 3.730388098918468*^9, 3.730392958885448*^9, 
   3.730401996525153*^9, 3.730407840500737*^9, 3.73041300676516*^9, 
   3.7304161183864737`*^9, 3.730416451599875*^9, 3.730416570830106*^9, 
   3.7330883377167273`*^9, 3.733151145309708*^9, 3.7331599885919933`*^9, 
   3.7331612791486797`*^9, 3.733161339609955*^9, 3.733162673773604*^9, 
   3.733255151708535*^9, 3.733255931755374*^9, 3.7332585870514317`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
note that equilibrium point is the same for the unsaturated and the saturated \
control laws (that is not the case when there is an integral term)\
\>", "Subsubsection",
 CellChangeTimes->{{3.730331208739121*^9, 3.730331241487995*^9}, {
  3.733160013405724*^9, 3.733160013828698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ans1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"u1clCompleteSaturated", "[", 
           RowBox[{"z1", ",", "#"}], "]"}], ",", 
          RowBox[{"{", "z1", "}"}]}], "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"z1", "\[Rule]", " ", 
          RowBox[{"z1eq", "[", "#", "]"}]}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Sigma]", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "  ", "1"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ans2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u1clComplete", "[", 
          RowBox[{"z1", ",", "#"}], "]"}], ",", 
         RowBox[{"{", "z1", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"z1", "\[Rule]", " ", 
         RowBox[{"z1eq", "[", "#", "]"}]}], "]"}]}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
       SqrtBox[
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ans1", "-", "ans2"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.73033079479932*^9, 3.730330960101653*^9}, {
  3.7303309910986834`*^9, 3.730331096513131*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.730330955712413*^9, 3.7303309867527113`*^9}, {
   3.7303310632035217`*^9, 3.7303310967953367`*^9}, 3.730331702972208*^9, 
   3.7303339024017076`*^9, 3.730334301822466*^9, 3.730336539577043*^9, 
   3.730342316576541*^9, 3.730342828150488*^9, 3.730384333502323*^9, 
   3.7303877011182528`*^9, 3.7303880991535683`*^9, 3.730392959099511*^9, 
   3.7304019967929163`*^9, 3.730407840755677*^9, 3.730413006963952*^9, 
   3.730416118631494*^9, 3.73041645188451*^9, 3.730416571040653*^9, 
   3.733088337966256*^9, 3.733151145626196*^9, 3.7331600174334593`*^9, 
   3.7331612792779818`*^9, 3.733161339672202*^9, 3.733162673992392*^9, 
   3.733255151864277*^9, 3.733255931907886*^9, 3.733258587205058*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ans1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"u2clCompleteSaturated", "[", 
           RowBox[{"z1", ",", "#"}], "]"}], ",", 
          RowBox[{"{", "z1", "}"}]}], "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"z1", "\[Rule]", " ", 
          RowBox[{"z1eq", "[", "#", "]"}]}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Sigma]", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "  ", "1"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ans2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u2clComplete", "[", 
          RowBox[{"z1", ",", "#"}], "]"}], ",", 
         RowBox[{"{", "z1", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"z1", "\[Rule]", " ", 
         RowBox[{"z1eq", "[", "#", "]"}]}], "]"}]}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
       SqrtBox[
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ans1", "-", "ans2"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7303428354492292`*^9, 3.730342837559602*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.730342841602215*^9, 3.730384333637747*^9, 
  3.730387701339431*^9, 3.730388099281084*^9, 3.7303929592542057`*^9, 
  3.730401997016696*^9, 3.730407840917745*^9, 3.730413007134519*^9, 
  3.730416118796805*^9, 3.7304164522376623`*^9, 3.730416571224131*^9, 
  3.7330883381238947`*^9, 3.733151145834406*^9, 3.7331600199744987`*^9, 
  3.733161279359357*^9, 3.733161339750679*^9, 3.73316267407707*^9, 
  3.73325515194654*^9, 3.733255931985618*^9, 3.733258587289113*^9}]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.7293086971041307`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
check that control law matches equilibrium input at desired equilibrium point\
\
\>", "Chapter",
 CellChangeTimes->{{3.726315375975163*^9, 3.726315401351562*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ucl", "[", 
       RowBox[{
        RowBox[{"z1eq", "[", "#", "]"}], ",", "#"}], "]"}], "-", 
      RowBox[{"ueq", "[", "#", "]"}]}], ")"}], "&"}], "[", 
   RowBox[{"{", 
    RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
     RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
     RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.726239004980282*^9, 3.726239027318301*^9}, {
   3.726239406695359*^9, 3.726239410759004*^9}, {3.726315236652156*^9, 
   3.7263152689890327`*^9}, {3.726315330582827*^9, 3.726315332385208*^9}, 
   3.730331258913059*^9, {3.73033137513789*^9, 3.7303313787955933`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.726239024143753*^9, 3.726239027631098*^9}, 
   3.726239312490584*^9, {3.726239407326797*^9, 3.726239411279821*^9}, 
   3.726239616395049*^9, 3.72624010519522*^9, 3.726284016947322*^9, 
   3.726305208155321*^9, 3.726315231332553*^9, 3.726315270875359*^9, {
   3.726315311646976*^9, 3.726315332892672*^9}, 3.726315367912181*^9, 
   3.726317452304469*^9, 3.726325309027485*^9, 3.7263839133470993`*^9, 
   3.726390824779139*^9, 3.726395024135354*^9, 3.726398695249461*^9, 
   3.726398925742221*^9, 3.72641098490499*^9, 3.7266596771128263`*^9, 
   3.726663263003826*^9, 3.726665337088522*^9, 3.7267249934488363`*^9, 
   3.726744381907058*^9, 3.726754989906164*^9, 3.726763827258354*^9, 
   3.726763929962419*^9, 3.726832040951729*^9, 3.728800791205283*^9, 
   3.7288110061881332`*^9, 3.7288110531260242`*^9, 3.728818756083619*^9, 
   3.729079625555031*^9, 3.7292747613427258`*^9, 3.729275807497901*^9, {
   3.730331250096695*^9, 3.730331259953463*^9}, 3.730331705852971*^9, 
   3.730333902670374*^9, 3.730334301966936*^9, 3.730336539677539*^9, 
   3.730342316668302*^9, 3.7303843337201242`*^9, 3.730387701708543*^9, 
   3.73038809943331*^9, 3.7303929594596453`*^9, 3.730401997134821*^9, 
   3.7304078410891438`*^9, 3.730413007261384*^9, 3.730416118955718*^9, 
   3.730416452505239*^9, 3.7304165713759003`*^9, 3.7330883382967587`*^9, 
   3.73315114592658*^9, 3.733160027816287*^9, 3.73316127938416*^9, 
   3.733161339773048*^9, 3.733162674295829*^9, 3.733255152168593*^9, 
   3.7332559322017517`*^9, 3.733258587510879*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["check that there are other equilibria points", "Chapter",
 CellChangeTimes->{{3.726315416047909*^9, 3.7263154290567913`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConfigurationGraphics2D", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1x", ",", "p1z"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "pz"}], "}"}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "nz"}], "}"}]}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "pz"}], "}"}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "nz"}], "}"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"p2x", ",", "p2z"}], "}"}]}], "}"}], "]"}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "test", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ConfigurationGraphics2D", "[", 
     RowBox[{"z1eq", "[", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "}"}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"L1", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"L2", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"m", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"gravity", "\[Rule]", " ", "10"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConfigurationGraphics2D", "[", 
     RowBox[{"z1eq", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"Cos", "[", "0.2", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "0.2", "]"}]}], "}"}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"L1", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"L2", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"m", "\[Rule]", " ", "1"}], ",", 
      RowBox[{"gravity", "\[Rule]", " ", "10"}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7263161530351267`*^9, 3.726316244196645*^9}, {
  3.7263163423031187`*^9, 3.726316363823337*^9}, {3.726317341384159*^9, 
  3.7263173844173326`*^9}}],

Cell[BoxData[
 GraphicsBox[{LineBox[{{1, 1}, {1, 0}, {-1, 0}, {-1, 1}}], 
   LineBox[{{0.9800665778412416, 1.1986693307950613`}, {0.9800665778412416, 
    0.19866933079506122`}, {-0.9800665778412416, -0.19866933079506122`}, \
{-0.9800665778412416, 0.8013306692049388}}]}]], "Output",
 CellChangeTimes->{
  3.7263163465842247`*^9, {3.726317333017829*^9, 3.726317384636189*^9}, 
   3.726317452451076*^9, 3.726325309138814*^9, 3.7263839133810177`*^9, 
   3.7263908248125353`*^9, 3.7263950241677094`*^9, 3.726398695287384*^9, 
   3.726398925780772*^9, 3.726410984936861*^9, 3.726659677191557*^9, 
   3.726663263136238*^9, 3.7266653371717787`*^9, 3.7267249935130444`*^9, 
   3.726744382040887*^9, 3.7267549899911213`*^9, 3.726763827321837*^9, 
   3.726763930022607*^9, 3.726832040975646*^9, 3.728800791290259*^9, 
   3.728811006262206*^9, 3.7288110532729597`*^9, 3.728818756116356*^9, 
   3.729079625699993*^9, 3.729274761436002*^9, 3.729275807615478*^9, 
   3.7303312937094297`*^9, 3.730331707563489*^9, 3.730333902771566*^9, 
   3.730334302048558*^9, 3.730336539744137*^9, 3.730342316734558*^9, 
   3.730384333775674*^9, 3.730387701807764*^9, 3.730388099530142*^9, 
   3.730392959576768*^9, 3.7304019972220488`*^9, 3.730407841188519*^9, 
   3.730413007341422*^9, 3.730416119056486*^9, 3.730416452603033*^9, 
   3.730416571457015*^9, 3.733088338344531*^9, 3.733151146089932*^9, 
   3.733160032345119*^9, 3.7331612794062433`*^9, 3.733161339791007*^9, 
   3.733162674370988*^9, 3.733255152320301*^9, 3.7332559322856894`*^9, 
   3.733258587593334*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frac", "=", 
       FractionBox["1", "3"]}], ",", "\[IndentingNewLine]", "\[Gamma]Orignal",
       ",", "\[IndentingNewLine]", "\[Gamma]Other", ",", 
      "\[IndentingNewLine]", "configurationOriginal", ",", 
      "configurationOrther"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Gamma]Orignal", "=", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]Other", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["1", 
            SqrtBox[
             RowBox[{"1", "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["frac", "2"]}]}]]]}], ")"}], " ", "L"}], " ", 
        ",", 
        RowBox[{
         RowBox[{"-", "frac"}], " ", "gravity", " ", "m"}], ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Different equilibrium\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ucl", "[", 
            RowBox[{
             RowBox[{"z1eq", "[", "\[Gamma]Other", "]"}], ",", 
             "\[Gamma]Orignal"}], "]"}], "-", 
           RowBox[{"ueq", "[", "\[Gamma]Other", "]"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
            RowBox[{"d2", "\[Rule]", " ", 
             RowBox[{"-", "d"}]}], ",", 
            RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
            RowBox[{"L2", "\[Rule]", " ", "L"}], ",", 
            RowBox[{"kpx1", "\[Rule]", " ", "kp"}], ",", 
            RowBox[{"kpx2", "\[Rule]", " ", "kp"}], ",", 
            RowBox[{"m1", "\[Rule]", "M"}], ",", 
            RowBox[{"m2", "\[Rule]", "M"}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"kp", "\[Rule]", 
           FractionBox[
            RowBox[{"frac", " ", 
             SqrtBox[
              RowBox[{"1", "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["frac", "2"]}]}]], " ", "gravity", " ", "m"}], 
            
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["frac", "2"]}]}]]}], "-", 
               RowBox[{"frac", " ", "L"}]}], ")"}], " ", "M"}]]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gravity", ">", "0"}], "&&", " ", 
         RowBox[{"m", ">", "0"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<UAVs at same height for different equilibria\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z1eq", "[", "\[Gamma]Orignal", "]"}], "-", 
            RowBox[{"z1eq", "[", "\[Gamma]Other", "]"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"9", ",", "12"}], "}"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
           RowBox[{"d2", "\[Rule]", " ", 
            RowBox[{"-", "d"}]}], ",", 
           RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
           RowBox[{"L2", "\[Rule]", " ", "L"}], " ", ",", 
           RowBox[{"kpx1", "\[Rule]", " ", "kp"}], ",", 
           RowBox[{"kpx2", "\[Rule]", " ", "kp"}], ",", 
           RowBox[{"m1", "\[Rule]", "M"}], ",", 
           RowBox[{"m2", "\[Rule]", "M"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gravity", ">", "0"}], "&&", " ", 
         RowBox[{"m", ">", "0"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<x-gain proportional gain that does the job: \>\"", " ", ",", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"frac", " ", 
           SqrtBox[
            RowBox[{"1", "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["frac", "2"]}]}]], " ", "gravity", " ", "m"}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              SqrtBox[
               RowBox[{"1", "+", 
                RowBox[{"4", " ", 
                 SuperscriptBox["frac", "2"]}]}]]}], "-", 
             RowBox[{"frac", " ", "L"}]}], ")"}], " ", "M"}]], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d", "\[Rule]", " ", "1"}], ",", 
           RowBox[{"L", "\[Rule]", " ", "1"}], ",", 
           RowBox[{"m", "\[Rule]", " ", "1"}], ",", 
           RowBox[{"gravity", "\[Rule]", " ", "10"}], ",", 
           RowBox[{"M", "\[Rule]", " ", "2"}]}], "}"}]}], "//", "N"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"configurationOriginal", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ConfigurationGraphics2D", "[", 
         RowBox[{"z1eq", "[", "\[Gamma]Orignal", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
          RowBox[{"d2", "\[Rule]", " ", 
           RowBox[{"-", "d"}]}], ",", 
          RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
          RowBox[{"L2", "\[Rule]", " ", "L"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", "\[Rule]", " ", "1"}], ",", 
         RowBox[{"L", "\[Rule]", " ", "1"}], ",", 
         RowBox[{"m", "\[Rule]", " ", "1"}], ",", 
         RowBox[{"gravity", "\[Rule]", " ", "10"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"configurationOrther", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ConfigurationGraphics2D", "[", 
         RowBox[{"z1eq", "[", "\[Gamma]Other", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
          RowBox[{"d2", "\[Rule]", " ", 
           RowBox[{"-", "d"}]}], ",", 
          RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
          RowBox[{"L2", "\[Rule]", " ", "L"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", "\[Rule]", " ", "1"}], ",", 
         RowBox[{"L", "\[Rule]", " ", "1"}], ",", 
         RowBox[{"m", "\[Rule]", " ", "1"}], ",", 
         RowBox[{"gravity", "\[Rule]", " ", "10"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"configurationOriginal", ",", "configurationOrther"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7263154522270813`*^9, 3.7263155669068003`*^9}, {
   3.726315601949836*^9, 3.726315648926406*^9}, {3.726315685411344*^9, 
   3.726315789754656*^9}, {3.726315835616151*^9, 3.726316047968536*^9}, {
   3.726316100578339*^9, 3.726316146583378*^9}, {3.726316366512109*^9, 
   3.726316438346542*^9}, {3.726316505277112*^9, 3.72631653643676*^9}, {
   3.726316573890386*^9, 3.7263167065473127`*^9}, {3.726316737906537*^9, 
   3.726316963214837*^9}, {3.726317098354992*^9, 3.726317176901079*^9}, {
   3.726317208365127*^9, 3.726317266222796*^9}, {3.730331312617477*^9, 
   3.73033131528299*^9}, {3.730331367148506*^9, 3.7303313682136374`*^9}, 
   3.730336565630844*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Closed loop vector field", "Chapter",
 CellChangeTimes->{{3.713448913683614*^9, 3.713448920377898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z1cl", "[", 
   RowBox[{"z_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Z1", "[", 
   RowBox[{"z", ",", 
    RowBox[{"ucl", "[", 
     RowBox[{"z", ",", "\[Gamma]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7134489264835033`*^9, 3.713448926741601*^9}, {
  3.72631741982528*^9, 3.7263174566026793`*^9}, {3.730331352416745*^9, 
  3.73033135834242*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check it vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.713448929119544*^9, 3.713448934629406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Z1cl", "[", 
      RowBox[{
       RowBox[{"z1eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
     "]"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "you", " ", "may", " ", "also", " ", "check", " ", "the", " ", "one", " ", 
    
    RowBox[{"below", ":", " ", 
     RowBox[{"but", " ", "it", " ", "takes", " ", "longer"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z1cl", "[", 
       RowBox[{
        RowBox[{"z1eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], "]"}], "//", 
    "FullSimplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "you", " ", "may", " ", "also", " ", "check", " ", "the", " ", "one", " ", 
    
    RowBox[{"below", ":", " ", 
     RowBox[{"but", " ", "it", " ", "takes", " ", "longer"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z1cl", "[", 
       RowBox[{
        RowBox[{"z1eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}], "]"}], "//", 
    "Simplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.724683550020112*^9, {3.724684481288904*^9, 3.7246844849574614`*^9}, {
   3.724751449524251*^9, 3.724751453306415*^9}, 3.72476738924961*^9, 
   3.724767514055324*^9, {3.726317465072546*^9, 3.726317503227375*^9}, {
   3.726317540229115*^9, 3.726317556252857*^9}, {3.7263176009733953`*^9, 
   3.726317618784074*^9}, {3.72631771108829*^9, 3.7263177112886868`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.726317485909556*^9, 3.726317498831478*^9}, 
   3.726317554813616*^9, 3.726317712358102*^9, 3.726325309949218*^9, 
   3.726383913816324*^9, 3.726390825193532*^9, 3.726395024648493*^9, 
   3.726398696009034*^9, 3.726398926298602*^9, 3.726659686680285*^9, 
   3.726663264277487*^9, 3.726665337759942*^9, 3.726724994319104*^9, 
   3.7267443829140453`*^9, 3.726754990906167*^9, 3.726763828026725*^9, 
   3.726763930883561*^9, 3.726832041428357*^9, 3.728800791947871*^9, 
   3.7288110068334084`*^9, 3.728811053837419*^9, 3.728818756534542*^9, 
   3.7290796265243473`*^9, 3.729274762435298*^9, 3.7292758083637753`*^9, {
   3.729353593197566*^9, 3.7293536009477882`*^9}, 3.730331716644949*^9, 
   3.730333904220785*^9, 3.7303343132285233`*^9, 3.730336540855554*^9, 
   3.730342317513082*^9, 3.730384334314584*^9, 3.7303877025091343`*^9, 
   3.730388100106737*^9, 3.73039296029515*^9, 3.730401997888322*^9, 
   3.730407841811755*^9, 3.7304130078409986`*^9, 3.730416119701644*^9, 
   3.730416453207067*^9, 3.7304165721941977`*^9, 3.733088338876131*^9, 
   3.733151146828947*^9, 3.733160043735763*^9, 3.73316127973136*^9, 
   3.733161339997324*^9, 3.733162674871779*^9, 3.7332551527720537`*^9, 
   3.7332559327788*^9, 3.733258588096068*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Symmetric T=0 and \[Theta]=0", "Title",
 CellChangeTimes->{{3.726383870002284*^9, 3.72638387347583*^9}, {
   3.7263949107283154`*^9, 3.72639491167203*^9}, {3.7264106266333838`*^9, 
   3.726410634737524*^9}, 3.730392554176424*^9}],

Cell[CellGroupData[{

Cell["equilibrium parametrization", "Subsubsection",
 CellChangeTimes->{{3.7303418117715607`*^9, 3.7303418168665257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Gamma]", 
    RowBox[{"eq", ",", "1"}]], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}],
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726663312002758*^9, 3.726663327356833*^9}, {
  3.726668086034553*^9, 3.7266680868764267`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification", "Chapter",
 CellChangeTimes->{{3.726394905303945*^9, 3.726394907969009*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SimplificationsParameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", " ", 
     RowBox[{"m2", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplificationsGains", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kpx1", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"kvx1", "\[Rule]", " ", "kvx"}], ",", 
     RowBox[{"kpy1", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"kvy1", "\[Rule]", " ", "kvy"}], ",", 
     RowBox[{"kpz1", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"kvz1", "\[Rule]", " ", "kvz"}], ",", 
     RowBox[{"kpx2", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"kvx2", "\[Rule]", " ", "kvx"}], ",", 
     RowBox[{"kpy2", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"kvy2", "\[Rule]", " ", "kvy"}], ",", 
     RowBox[{"kpz2", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"kvz2", "\[Rule]", " ", "kvz"}], ",", 
     RowBox[{"kp\[Psi]1", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]1", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kp\[Psi]2", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]2", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Simplifications", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"SimplificationsParameters", ",", "SimplificationsGains"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsParameters", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "SimplificationsParameters"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}]}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsGains", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"#", "/.", "SimplificationsGains"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplifications", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "Simplifications"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}]}]}], "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.726319366587973*^9, 3.7263194239291143`*^9}, {
   3.726326664972498*^9, 3.72632682474743*^9}, {3.726326908336322*^9, 
   3.726326922450852*^9}, 3.726384367929195*^9, {3.726663272066338*^9, 
   3.726663273806211*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stability vector field term (only for analysis)", "Chapter",
 CellChangeTimes->{{3.7120421708683567`*^9, 3.7120422205169086`*^9}, {
  3.7128306840760193`*^9, 3.71283068718001*^9}, {3.7134496094633293`*^9, 
  3.7134496232282867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DZ1SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z1SET", "[", "z1", "]"}], ",", 
      RowBox[{"{", "z1", "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.712830773527231*^9, 3.7128309192395477`*^9}, {
   3.712833495665552*^9, 3.712833508713584*^9}, {3.71283357008792*^9, 
   3.7128335976910353`*^9}, {3.71283534408328*^9, 3.712835344330735*^9}, {
   3.7128355335133457`*^9, 3.7128355336799107`*^9}, 3.712837005757556*^9, 
   3.712837065836936*^9, 3.712838456858864*^9, {3.712838505922365*^9, 
   3.712838551215933*^9}, {3.7128418281986103`*^9, 3.712841828216846*^9}, {
   3.712842173539816*^9, 3.712842173548656*^9}, {3.712847966278987*^9, 
   3.7128479662996902`*^9}, {3.712905307583363*^9, 3.712905307739265*^9}, 
   3.713449834593012*^9, {3.713600697627223*^9, 3.7136007092075443`*^9}, {
   3.724684045820299*^9, 3.724684045829007*^9}, {3.724751341533758*^9, 
   3.7247513415439157`*^9}, {3.724768463749054*^9, 3.724768468124543*^9}, {
   3.726317769433804*^9, 3.726317784338602*^9}, {3.726318444340234*^9, 
   3.7263184457061653`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["determinant of matrix being inverted is positive", "Chapter",
 CellChangeTimes->{{3.713449796880292*^9, 3.7134498095432177`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"#", ".", 
           RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
        RowBox[{"DZ1SET", "[", 
         RowBox[{"z1eq", "[", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
           "}"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"gravity", ">", "0"}], "&"}], " ", "m"}], ">", "0"}], "&&",
         " ", 
        RowBox[{"d1", ">", "0"}], "&&", " ", 
        RowBox[{"d2", "<", "0"}]}]}], "]"}], "//", 
     RowBox[{"MatrixForm", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{"#", ".", 
            RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
         RowBox[{"DZ1SET", "[", 
          RowBox[{"z1eq", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], "]"}], "]"}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"gravity", ">", "0"}], "&"}], " ", "m"}], ">", "0"}], "&&",
          " ", 
         RowBox[{"d1", ">", "0"}], "&&", " ", 
         RowBox[{"d2", "<", "0"}]}]}], "]"}]}]}], "//", 
    RowBox[{"MatrixForm", "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"#", ".", 
           RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
        RowBox[{"DZ1SET", "[", 
         RowBox[{"z1eq", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", 
            RowBox[{"\[Alpha]", " ", "gravity", " ", "m"}], ",", "1", ",", 
            "0", ",", "0"}], "}"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"gravity", ">", "0"}], "&"}], " ", "m"}], ">", "0"}], "&&",
         " ", 
        RowBox[{"d1", ">", "0"}], "&&", " ", 
        RowBox[{"d2", "<", "0"}]}]}], "]"}]}]}], "//", "MatrixForm"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.712833525463954*^9, 3.7128335553129683`*^9}, {
   3.712905108458235*^9, 3.712905203291492*^9}, {3.724675041227213*^9, 
   3.724675050900496*^9}, 3.72476848918995*^9, {3.726317793787589*^9, 
   3.726317856579891*^9}, {3.7263179130454082`*^9, 3.726317991184404*^9}, {
   3.726318059913103*^9, 3.726318067824499*^9}, {3.726318143706895*^9, 
   3.726318153011718*^9}, {3.7263182570533667`*^9, 3.72631827154195*^9}, 
   3.726318418759379*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"#", ".", 
       RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
    RowBox[{"DZ1SET", "[", 
     RowBox[{"z1eq", "[", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"eq", ",", "1"}]], "]"}], "]"}], "]"}], "-", " ", 
   FractionBox[
    TagBox[
     RowBox[{"64", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d1", ",", "d2"}], "}"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ".", 
          RowBox[{"{", 
           RowBox[{"d1", ",", "d2"}], "}"}]}]}], ")"}], "2"]}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], 
    RowBox[{
     SuperscriptBox["L1", "4"], " ", 
     SuperscriptBox["L2", "4"]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.726318179453529*^9, 3.726318186652172*^9}, {
   3.726318217572694*^9, 3.726318233081394*^9}, {3.726318293399637*^9, 
   3.726318360957098*^9}, {3.726665672808339*^9, 3.726665702108613*^9}, {
   3.73033210056441*^9, 3.7303321596958923`*^9}, {3.7303322808791113`*^9, 
   3.730332282147781*^9}, 3.730337730461813*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.726318180711135*^9, 3.726318187739593*^9}, {
   3.72631823352956*^9, 3.726318240603044*^9}, {3.726318282059971*^9, 
   3.726318294245775*^9}, {3.7263183246076*^9, 3.7263183621338043`*^9}, 
   3.726318423207368*^9, 3.726325310787218*^9, 3.726383914292348*^9, 
   3.726398696144128*^9, 3.7266656534233313`*^9, {3.726665686030655*^9, 
   3.726665702778326*^9}, 3.726666884271078*^9, 3.7288110365146017`*^9, 
   3.728811100300403*^9, 3.7303320471804657`*^9, {3.730332129544588*^9, 
   3.7303321528688*^9}, 3.730332282587955*^9, 3.730333905578318*^9, 
   3.7303343141538477`*^9, 3.7304078426895123`*^9, 3.7331511477720957`*^9, 
   3.733160129011153*^9, 3.73316134042348*^9, 3.7332551535300303`*^9, 
   3.7332559334493113`*^9, 3.733258588887965*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Linearization matrix", "Chapter",
 CellChangeTimes->{{3.712043505293087*^9, 3.712043512378201*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["A", "0"], ",", 
      SubscriptBox["A", "1"]}], "}"}], "=", 
    RowBox[{"Linearization", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Z1cl", "[", 
        RowBox[{"#", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "1"}]]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z1SET", "[", "#", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"z1eq", "[", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"eq", ",", "1"}]], "]"}], ",", "\[IndentingNewLine]", 
      "ApplySimplificationsParameters"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.72666434496215*^9, 3.726664349991723*^9}, {
   3.7266669004646597`*^9, 3.726666923433338*^9}, 3.726666979922227*^9, {
   3.7266671119182053`*^9, 3.7266671744373302`*^9}, {3.7266680966497917`*^9, 
   3.726668098366765*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "unit", " ", "vector", " ", "of", " ", "dimension", " ", "of", " ", 
    "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "i_", "]"}], ":=", 
    RowBox[{"UnitVector", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dimensions", "[", "z1", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}]}], ";"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{"e_", ",", "n_", ",", "A_"}], "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"ApplySimplificationsParameters", "[", 
       RowBox[{"#", ".", "A"}], "]"}], "]"}], "&"}], ",", "e", ",", 
    RowBox[{"n", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{
    RowBox[{"e", "[", "1", "]"}], ",", "4", ",", 
    SubscriptBox["A", "1"]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{
    RowBox[{"e", "[", "1", "]"}], ",", "4", ",", 
    SubscriptBox["A", "1"]}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7263257888187017`*^9, 3.7263258724726763`*^9}, {
   3.7263259166627893`*^9, 3.726326042888208*^9}, {3.7263261879160957`*^9, 
   3.7263261983325*^9}, 3.726326848143663*^9, {3.726667313967251*^9, 
   3.726667320253922*^9}, {3.7303323402456913`*^9, 3.730332340340209*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["gravity", "L"]}], "0", "0", "0", "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", "L"]}], "0", "0", "0", "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726325956372691*^9, 3.726326007567583*^9}, 
   3.726326043774054*^9, 3.726334431506309*^9, 3.726383959228827*^9, 
   3.726398730549676*^9, 3.7266673210093317`*^9, 3.726667472053864*^9, 
   3.7288110430285*^9, 3.728811104665851*^9, {3.730332333822813*^9, 
   3.730332340827402*^9}, 3.730333914583398*^9, 3.730334333239459*^9, 
   3.730407848757894*^9, 3.733151155619891*^9, 3.733160138131572*^9, 
   3.733161344072729*^9, 3.7332551573793373`*^9, 3.733255937269734*^9, 
   3.733258592790709*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["gravity", "L"]}], "0", "0", "0", "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", "L"]}], "0", "0", "0", "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726325956372691*^9, 3.726326007567583*^9}, 
   3.726326043774054*^9, 3.726334431506309*^9, 3.726383959228827*^9, 
   3.726398730549676*^9, 3.7266673210093317`*^9, 3.726667472053864*^9, 
   3.7288110430285*^9, 3.728811104665851*^9, {3.730332333822813*^9, 
   3.730332340827402*^9}, 3.730333914583398*^9, 3.730334333239459*^9, 
   3.730407848757894*^9, 3.733151155619891*^9, 3.733160138131572*^9, 
   3.733161344072729*^9, 3.7332551573793373`*^9, 3.733255937269734*^9, 
   3.733258592792604*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
    RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "6", "]"}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "7", "]"}], "-", 
          RowBox[{"e", "[", "10", "]"}]}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", "4", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", "4", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "5", "]"}], ",", "4", ",", "A"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
   RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PA", "[", "A", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DZ1SET", "[", 
       RowBox[{"z1eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["P", "0"], "=", 
   RowBox[{"PPA", "[", 
    SubscriptBox["A", "0"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "1"], "=", 
    RowBox[{"PPA", "[", 
     SubscriptBox["A", "1"], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Dimensions", "[", 
    SubscriptBox["P", "0"], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MatrixRank", "[", 
    SubscriptBox["P", "0"], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
   3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
   3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
   3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
   3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
   3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
   3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}, {
   3.712831094381729*^9, 3.712831095820244*^9}, {3.712831148394435*^9, 
   3.7128311596982203`*^9}, {3.7128311998383636`*^9, 3.712831230922905*^9}, {
   3.71283380404528*^9, 3.712833817585775*^9}, {3.7128338578199453`*^9, 
   3.7128339145293837`*^9}, {3.712834032813575*^9, 3.712834033874092*^9}, {
   3.712836024098538*^9, 3.7128360488484507`*^9}, {3.71283609327536*^9, 
   3.712836118528947*^9}, {3.712836924452547*^9, 3.712836958498642*^9}, {
   3.712844426115212*^9, 3.71284450242596*^9}, {3.7128449771537046`*^9, 
   3.712845086412121*^9}, {3.712848439443294*^9, 3.7128485151925364`*^9}, {
   3.712944738222735*^9, 3.712944749777299*^9}, {3.712988102089939*^9, 
   3.7129881257009773`*^9}, {3.7134500543777742`*^9, 3.713450055447535*^9}, {
   3.724678693813246*^9, 3.724678697955299*^9}, {3.7246823296039057`*^9, 
   3.724682336385404*^9}, {3.724682370244699*^9, 3.7246823710267973`*^9}, {
   3.724683277507218*^9, 3.7246833021887293`*^9}, {3.7246834824509897`*^9, 
   3.724683513686524*^9}, {3.724684763780971*^9, 3.724684886425336*^9}, {
   3.72468839967736*^9, 3.724688410177302*^9}, {3.7247417260960283`*^9, 
   3.724741737955247*^9}, {3.724751538261547*^9, 3.7247516157283382`*^9}, {
   3.724751670903892*^9, 3.724751672969146*^9}, {3.724751760644328*^9, 
   3.72475178892412*^9}, {3.724751820655284*^9, 3.724751832936578*^9}, {
   3.724751999539131*^9, 3.724752021780467*^9}, 3.724752097482242*^9, {
   3.724752161886855*^9, 3.724752168133781*^9}, {3.724752446862174*^9, 
   3.724752448614086*^9}, {3.724757996420842*^9, 3.72475800444925*^9}, {
   3.7247580472472982`*^9, 3.724758052534409*^9}, {3.724758086078887*^9, 
   3.7247581075217037`*^9}, {3.724758396290547*^9, 3.724758408015748*^9}, {
   3.724758470544146*^9, 3.724758473931033*^9}, 3.7247586153657417`*^9, {
   3.724759149139023*^9, 3.724759151388007*^9}, {3.724759288648301*^9, 
   3.724759302491118*^9}, {3.724768760869358*^9, 3.724768800242721*^9}, {
   3.7247688560626087`*^9, 3.724768863292123*^9}, {3.724768936314774*^9, 
   3.724768950040413*^9}, 3.7247720001122103`*^9, {3.724853635498878*^9, 
   3.7248536406972437`*^9}, {3.726318927086563*^9, 3.726319024616363*^9}, {
   3.726326206275281*^9, 3.726326416142439*^9}, {3.726326454606626*^9, 
   3.726326455720798*^9}, {3.7263265943687067`*^9, 3.726326611353199*^9}, {
   3.7263268511347427`*^9, 3.7263268535081244`*^9}, {3.726336547766362*^9, 
   3.726336572881345*^9}, {3.726667477766415*^9, 3.7266675280761747`*^9}, {
   3.7266680497295427`*^9, 3.726668072533704*^9}, {3.726668110516262*^9, 
   3.7266682143432198`*^9}, {3.7266683526175632`*^9, 3.726668385747107*^9}, 
   3.726670769447485*^9, {3.730336759678958*^9, 3.7303367763498383`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant of similarity matrix", "Chapter",
 CellChangeTimes->{{3.72927489284953*^9, 3.729274902051298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "0"], "]"}], "-", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["gravity", "6"], " ", 
       SuperscriptBox["m", "2"]}], 
      RowBox[{
       SuperscriptBox["J", "2"], " ", 
       SuperscriptBox["L", "10"]}]]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "1"], "]"}], "-", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["gravity", "6"], " ", 
       SuperscriptBox["m", "2"]}], 
      RowBox[{
       SuperscriptBox["J", "2"], " ", 
       SuperscriptBox["L", "10"]}]]}], ")"}]}], "//", "Simplify"}]}], "Input",\

 CellChangeTimes->{{3.730336770255368*^9, 3.7303367714041557`*^9}, {
  3.7303368334475*^9, 3.730336841787073*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.730407848960005*^9, 3.733151156095449*^9, 
  3.733160144429781*^9, 3.733161344176425*^9, 3.7332551575796633`*^9, 
  3.7332559374629927`*^9, 3.733258592934155*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.730407848960005*^9, 3.733151156095449*^9, 
  3.733160144429781*^9, 3.733161344176425*^9, 3.7332551575796633`*^9, 
  3.7332559374629927`*^9, 3.7332585929373083`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
State matrix after similarity transformation (check block triangular \
structure)\
\>", "Chapter",
 CellChangeTimes->{
  3.6784537446066513`*^9, {3.678455413121221*^9, 3.678455417246153*^9}, {
   3.713450070240844*^9, 3.713450102188195*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"lin", "[", 
     RowBox[{"A_", ",", "P_", ",", "C_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"P", ".", 
       RowBox[{"(", 
        RowBox[{"#I", "-", 
         RowBox[{
          RowBox[{"Transpose", "[", "C", "]"}], ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"C", ".", 
            RowBox[{"Transpose", "[", "C", "]"}]}], "]"}], ".", "C"}]}], 
        ")"}], ".", "A", ".", 
       RowBox[{"(", 
        RowBox[{"#I", "-", 
         RowBox[{"#PN", ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"C", ".", "#PN"}], "]"}], ".", "C"}]}], ")"}], ".", 
       RowBox[{"Transpose", "[", "P", "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"P", ".", 
         RowBox[{"Transpose", "[", "P", "]"}]}], "]"}]}], "&"}], "[", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<I\>\"", "\[Rule]", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "A", "]"}], "]"}]}], ",", 
       RowBox[{"\"\<PN\>\"", "\[Rule]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"NullSpace", "[", "P", "]"}], "]"}]}]}], "|>"}], "]"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "2"], " ", "=", 
     RowBox[{"ApplySimplificationsGains", "[", 
      RowBox[{"lin", "[", 
       RowBox[{
        SubscriptBox["A", "0"], ",", 
        RowBox[{"PA", "[", 
         SubscriptBox["A", "0"], "]"}], ",", 
        RowBox[{"DZ1SET", "[", 
         RowBox[{"z1eq", "[", 
          SubscriptBox["\[Gamma]", 
           RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["Asimilar", "2"], "//", "MatrixForm"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7249089502584333`*^9, 3.724909257540804*^9}, {
   3.7249094152200603`*^9, 3.724909441950117*^9}, {3.724909667470776*^9, 
   3.724909705268944*^9}, {3.724910141005493*^9, 3.724910163915674*^9}, 
   3.724910304074479*^9, 3.724910341347337*^9, {3.72632651719333*^9, 
   3.726326518315586*^9}, {3.730334010493908*^9, 3.7303340144673557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "0"], " ", "=", 
     RowBox[{"ApplySimplificationsGains", "[", 
      RowBox[{
       SubscriptBox["P", "0"], ".", 
       SubscriptBox["A", "0"], ".", 
       RowBox[{"Inverse", "[", 
        SubscriptBox["P", "0"], "]"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["Asimilar", "0"], "//", "MatrixForm"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], " ", "=", 
     RowBox[{"ApplySimplificationsGains", "[", 
      RowBox[{
       SubscriptBox["P", "1"], ".", 
       SubscriptBox["A", "1"], ".", 
       RowBox[{"Inverse", "[", 
        SubscriptBox["P", "1"], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.726326530509486*^9, 3.726326537077107*^9}, {
   3.7263265764331923`*^9, 3.726326577052047*^9}, {3.726326618735379*^9, 
   3.726326638273756*^9}, {3.726326856791877*^9, 3.726326866492594*^9}, 
   3.726326982889896*^9, {3.726668226847025*^9, 3.726668329832082*^9}, {
   3.72666839519751*^9, 3.726668405489772*^9}, {3.7266684380036077`*^9, 
   3.7266684652266073`*^9}, {3.726670905770508*^9, 3.7266709108560343`*^9}, {
   3.730332381052085*^9, 3.7303323832673388`*^9}, {3.730334006972403*^9, 
   3.730334025342689*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           SuperscriptBox["M", "2"]}], ")"}]}], "-", 
        RowBox[{"L", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "kpz", " ", "M"}], "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
              RowBox[{"m", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"6", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           SuperscriptBox["M", "2"]}], ")"}]}], "-", 
        RowBox[{"L", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "kpz", " ", "M"}], "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
              RowBox[{"m", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"6", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"J", "-", "M"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", "M", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpz", " ", 
               RowBox[{"(", 
                RowBox[{"M", "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}], "+", 
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "\[Lambda]"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d", "2"], " ", "M", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gravity", " ", 
           RowBox[{"(", 
            RowBox[{"J", "-", "M"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"L", " ", "M", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kpz", " ", 
              RowBox[{"(", 
               RowBox[{"M", "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}], "+", 
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", "\[Lambda]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["d", "2"], " ", "M", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", "kvz", " ", "L", " ", "M"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "kpx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726668466622603*^9, 3.728811045861166*^9, 3.728811106880904*^9, 
   3.730332367384997*^9, {3.730334335861745*^9, 3.730334343322824*^9}, 
   3.730407849597497*^9, 3.733151156868312*^9, 3.733160150267045*^9, 
   3.7331613445247583`*^9, 3.73325515802623*^9, 3.733255937904001*^9, 
   3.733258593377195*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
State matrix after similarity transformation (check block triangular \
structure)\
\>", "Chapter",
 CellChangeTimes->{3.730332400811451*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], " ", "=", 
   RowBox[{"ApplySimplificationsGains", "[", 
    RowBox[{
     SubscriptBox["P", "1"], ".", 
     SubscriptBox["A", "1"], ".", 
     RowBox[{"Inverse", "[", 
      SubscriptBox["P", "1"], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["Asimilar", "1"], "//", "MatrixForm"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           SuperscriptBox["M", "2"]}], ")"}]}], "-", 
        RowBox[{"L", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "kpz", " ", "M"}], "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
              RowBox[{"m", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"6", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           SuperscriptBox["M", "2"]}], ")"}]}], "-", 
        RowBox[{"L", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "kpz", " ", "M"}], "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
              RowBox[{"m", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"6", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"J", "-", "M"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", "M", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpz", " ", 
               RowBox[{"(", 
                RowBox[{"M", "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}], "+", 
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "\[Lambda]"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d", "2"], " ", "M", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gravity", " ", 
           RowBox[{"(", 
            RowBox[{"J", "-", "M"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"L", " ", "M", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kpz", " ", 
              RowBox[{"(", 
               RowBox[{"M", "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}], "+", 
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", "\[Lambda]"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["d", "2"], " ", "M", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", "kvz", " ", "L", " ", "M"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "kpx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m"}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.730332402894513*^9, 3.73033435639926*^9, 3.7304078498874083`*^9, 
   3.733151157319551*^9, {3.733160172418247*^9, 3.733160186494874*^9}, 
   3.73316134463806*^9, 3.7332551581782427`*^9, 3.733255938052898*^9, 
   3.733258593530991*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vertical linear and angular motion", "Chapter",
 CellChangeTimes->{{3.713450417179948*^9, 3.713450422588997*^9}, {
  3.726327222144143*^9, 3.726327230092554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"1", ";;", "4"}], ",", 
     RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.712945014916979*^9, 3.712945043809243*^9}, {
   3.712982474447101*^9, 3.712982483165021*^9}, 3.7134504376899633`*^9, {
   3.726327238090015*^9, 3.7263272499610147`*^9}, 3.726668587204664*^9, {
   3.730334369673802*^9, 3.730334369775124*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712988511498514*^9, 3.713450443598475*^9, 3.713450710505559*^9, 
   3.713451069364211*^9, 3.7136008867065268`*^9, 3.714030540754437*^9, 
   3.714030762041692*^9, 3.7140317218870707`*^9, 3.7140319518285*^9, 
   3.714034134273993*^9, {3.7263272432238617`*^9, 3.726327250259211*^9}, 
   3.726383960081555*^9, 3.726398733148213*^9, 3.726668591767591*^9, 
   3.726668638781921*^9, 3.728811046553246*^9, 3.728811107374322*^9, 
   3.730332406013339*^9, {3.730334356531126*^9, 3.730334378156681*^9}, 
   3.730407849980029*^9, 3.733151157520275*^9, 3.7331602016294737`*^9, 
   3.733161344656158*^9, 3.733255158310717*^9, 3.733255938184634*^9, 
   3.7332585936743383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["vertical linear motion", "Subsection",
 CellChangeTimes->{{3.7263275313349857`*^9, 3.726327541043935*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "2"}], ",", 
      RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328308547742*^9, 3.726328311819013*^9}, 
   3.726668590455509*^9, {3.7303343743158417`*^9, 3.730334380372327*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7263283121640463`*^9, 3.726383960120669*^9, 3.726398733181141*^9, 
   3.726668594144422*^9, 3.726668640540851*^9, 3.728811046660677*^9, 
   3.728811107469739*^9, 3.730332407792685*^9, {3.730334356627475*^9, 
   3.730334380761237*^9}, 3.730407850080673*^9, 3.7331511575820007`*^9, 
   3.733160203085486*^9, 3.733161344674426*^9, 3.733255158392873*^9, 
   3.733255938255293*^9, 3.7332585937449427`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fp_", ",", "\[Delta]kp_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", "\[Delta]kp"}], ")"}]}], " ", ",", 
      RowBox[{"fp", " ", "kd"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"\[CapitalGamma]2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fpz", ",", "\[Delta]kpz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpz", ",", "kvz"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"fpz", ",", "\[Delta]kpz"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327263699593*^9, 3.726327495774548*^9}, {
  3.7263279306820803`*^9, 3.726327941520749*^9}, {3.726328302802548*^9, 
  3.726328303216222*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fpz", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", "M"}], 
      RowBox[{"m", "+", 
       RowBox[{"2", " ", "M"}]}]]}], ",", 
    RowBox[{"\[Delta]kpz", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726327470277322*^9, 3.726327496190207*^9}, 
   3.726327941999847*^9, 3.726328313836656*^9, 3.726383960187357*^9, 
   3.7263987332128687`*^9, 3.726668642136159*^9, 3.7288110468119926`*^9, 
   3.7288111075849*^9, 3.730332409795704*^9, {3.730334356714655*^9, 
   3.7303343825012074`*^9}, 3.73040785019711*^9, 3.733151157679343*^9, 
   3.733160203925918*^9, 3.733161344709848*^9, 3.733255158540257*^9, 
   3.7332559383319073`*^9, 3.733258593834762*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["vertical angular motion", "Subsection",
 CellChangeTimes->{{3.7263275313349857`*^9, 3.726327549661537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"3", ";;", "4"}], ",", 
      RowBox[{"3", ";;", "4"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328285687058*^9, 3.726328294429411*^9}, 
   3.726668622469624*^9, 3.730334388230152*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328295422483*^9, 3.726383960244869*^9, 3.726398733243904*^9, 
   3.726668644007777*^9, 3.7288110468432093`*^9, 3.728811107663579*^9, 
   3.7303324115511093`*^9, {3.730334356810738*^9, 3.730334389170566*^9}, 
   3.7304078502965527`*^9, 3.7331511577406797`*^9, 3.733160205962801*^9, 
   3.73316134472899*^9, 3.733255158558647*^9, 3.733255938398828*^9, 
   3.7332585939058857`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fp_", ",", "\[Delta]kp_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", "\[Delta]kp"}], ")"}]}], " ", ",", 
      RowBox[{"fp", " ", "kd"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"\[CapitalGamma]2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fpz", ",", "\[Delta]kpz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpz", ",", "kvz"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"fpz", ",", "\[Delta]kpz"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327516025825*^9, 3.7263275194444313`*^9}, {
  3.726327896032098*^9, 3.7263279188220367`*^9}, {3.726328281425914*^9, 
  3.7263282985897617`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fpz", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", "M"}], 
      RowBox[{"J", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", "M"}]}]]}], ",", 
    RowBox[{"\[Delta]kpz", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.726327520171771*^9, 3.726327922975806*^9, 
  3.7263282989942408`*^9, 3.7263839602907667`*^9, 3.726398733281904*^9, 
  3.7266686453909063`*^9, 3.72881104693189*^9, 3.728811107772992*^9, 
  3.7303324132393723`*^9, 3.730334356881632*^9, 3.7303343912247334`*^9, 
  3.730407850398168*^9, 3.73315115778859*^9, 3.733160207066638*^9, 
  3.733161344753438*^9, 3.733255158634027*^9, 3.7332559384714403`*^9, 
  3.733258593982204*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Longitudinal motion", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}}],

Cell[CellGroupData[{

Cell["linear motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.7263281711595583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"7", ";;", "10"}], ",", 
      RowBox[{"7", ";;", "10"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, 
   3.726668623349978*^9, 3.7303343980533447`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726383960340681*^9, 3.72639873329073*^9, 3.726668647663102*^9, 
   3.728811047014473*^9, 3.728811107852796*^9, 3.73033241572373*^9, 
   3.730334356961925*^9, 3.730334398561805*^9, 3.730407850498763*^9, 
   3.7331511578549232`*^9, 3.733160212631526*^9, 3.7331613447718773`*^9, 
   3.733255158708078*^9, 3.733255938535562*^9, 3.73325859405093*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]4", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fp_", ",", "\[Delta]kp_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", "kp"}], ",", 
      RowBox[{"fp", " ", "kd"}], ",", 
      RowBox[{"kp", "+", "\[Delta]kp"}], " ", ",", "kd"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"\[CapitalGamma]4", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fpx", ",", "\[Delta]kpx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"fpx", ",", "\[Delta]kpx"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
  3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
  3.726328241473325*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fpx", "\[Rule]", 
     FractionBox["gravity", "L"]}], ",", 
    RowBox[{"\[Delta]kpx", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}], ")"}]}], 
      RowBox[{"2", " ", "L", " ", "M"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, 3.726383960396386*^9, 3.726398733324707*^9, 
   3.7266686497477283`*^9, 3.72881104710806*^9, 3.728811107960506*^9, 
   3.730332417780821*^9, 3.730334357049131*^9, 3.730334400533235*^9, 
   3.7304078505994587`*^9, 3.733151157908478*^9, 3.733160212730452*^9, 
   3.733161344794791*^9, 3.7332551587814913`*^9, 3.733255938600873*^9, 
   3.733258594122993*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.72632817761716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"5", ";;", "6"}], ",", 
      RowBox[{"5", ";;", "6"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{3.7266686240866823`*^9, 3.730334403351961*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{
       RowBox[{"-", "kpx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.726328275912224*^9, 3.726383960433279*^9, 
  3.726398733363179*^9, 3.726668651343306*^9, 3.728811047190118*^9, 
  3.7288111080456047`*^9, 3.730332420176656*^9, 3.730334357125704*^9, 
  3.730334404007133*^9, 3.730407850698985*^9, 3.7331511579708633`*^9, 
  3.733160212794833*^9, 3.733161344803795*^9, 3.7332551588497887`*^9, 
  3.7332559386650143`*^9, 3.733258594193212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fp_", ",", "\[Delta]kp_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"kp", "+", "\[Delta]kp"}], ")"}]}], " ", ",", 
        RowBox[{"fp", " ", "kd"}]}], "}"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"\[CapitalGamma]2", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fpx", ",", "\[Delta]kpx"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"fpx", ",", "\[Delta]kpx"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.726327606871179*^9, 3.7263276106035624`*^9}, {
  3.726327770793311*^9, 3.726327799705961*^9}, {3.7263279496618958`*^9, 
  3.72632798833605*^9}, {3.726328261955852*^9, 3.726328272422624*^9}, {
  3.7263963015221977`*^9, 3.7263963017709084`*^9}, {3.73033440585459*^9, 
  3.7303344064592733`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fpx", "\[Rule]", "1"}], ",", 
    RowBox[{"\[Delta]kpx", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", "m"}], 
      RowBox[{"2", " ", "L", " ", "M"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7263276108839684`*^9, 3.726327800066736*^9, {3.7263279685390987`*^9, 
   3.726327989012171*^9}, 3.7263282741889153`*^9, 3.72638396049432*^9, 
   3.726398733405307*^9, 3.726668652868309*^9, 3.728811047276614*^9, 
   3.72881110813177*^9, 3.730332422529842*^9, 3.7303343572011003`*^9, 
   3.730334406877894*^9, 3.730407850898834*^9, 3.7331511580179873`*^9, 
   3.733160212878561*^9, 3.7331613448261347`*^9, 3.73325515892384*^9, 
   3.733255938742104*^9, 3.733258594269147*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lateral motion", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}, {
   3.726328191491131*^9, 3.726328192534465*^9}}],

Cell[CellGroupData[{

Cell["linear motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.7263281711595583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"11", ";;", "14"}], ",", 
      RowBox[{"11", ";;", "14"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
   3.72632832070956*^9, 3.726328327715292*^9}, 3.7266686252060137`*^9, 
   3.730334413766734*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726328328183877*^9, 3.726383960533135*^9, 3.7263987334381447`*^9, 
   3.726668654710672*^9, 3.728811047356975*^9, 3.728811108210494*^9, 
   3.730332427072317*^9, 3.7303343572815723`*^9, 3.73033441428594*^9, 
   3.730407850997478*^9, 3.733151158079069*^9, 3.7331602186977177`*^9, 
   3.733161344844911*^9, 3.7332551589938393`*^9, 3.733255938806596*^9, 
   3.733258594338744*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]4", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fp_", ",", "\[Delta]kp_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", "kp"}], ",", 
      RowBox[{"fp", " ", "kd"}], ",", 
      RowBox[{"kp", "+", "\[Delta]kp"}], " ", ",", "kd"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"\[CapitalGamma]4", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fpy", ",", "\[Delta]kpy"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"fpy", ",", "\[Delta]kpy"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
  3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
  3.726328241473325*^9}, {3.7263283332636557`*^9, 3.726328342768092*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fpy", "\[Rule]", 
     FractionBox["gravity", "L"]}], ",", 
    RowBox[{"\[Delta]kpy", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}], ")"}]}], 
      RowBox[{"2", " ", "L", " ", "M"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, 3.7263283432806273`*^9, 3.7263839606007843`*^9, 
   3.726398733470619*^9, 3.7266686560986757`*^9, 3.728811047520833*^9, 
   3.728811108294767*^9, 3.730332428865717*^9, 3.730334357363311*^9, 
   3.730334416395158*^9, 3.7304078510989733`*^9, 3.733151158132044*^9, 
   3.733160218798853*^9, 3.7331613448626423`*^9, 3.733255159064664*^9, 
   3.733255938871312*^9, 3.733258594410372*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.72632817761716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"15", ";;", "18"}], ",", 
      RowBox[{"15", ";;", "18"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
   3.72632832070956*^9, 3.726328365616743*^9}, 3.726668627461328*^9, 
   3.730334419874682*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726328328183877*^9, 3.726328366724547*^9, 3.726383960637189*^9, 
   3.726398733481083*^9, 3.7266686579308434`*^9, 3.7288110475986032`*^9, 
   3.7288111084341516`*^9, 3.730332430585003*^9, 3.730334357446701*^9, {
   3.730334420604347*^9, 3.730334427714061*^9}, 3.730407851200143*^9, 
   3.7331511582095423`*^9, 3.733160218859928*^9, 3.7331613448814*^9, 
   3.7332551591350927`*^9, 3.733255938937416*^9, 3.733258594480641*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]4", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fp_", ",", "\[Delta]kp_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fp", " ", "kp"}], ",", 
        RowBox[{"fp", " ", "kd"}], ",", 
        RowBox[{"kp", "+", "\[Delta]kp"}], " ", ",", "kd"}], "}"}]}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"\[CapitalGamma]4", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fpy", ",", "\[Delta]kpy"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"fpy", ",", "\[Delta]kpy"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
   3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
   3.726328241473325*^9}, {3.7263283332636557`*^9, 3.726328342768092*^9}, 
   3.72632837387451*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fpy", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["d", "2"], " ", "gravity", " ", "m"}], 
      RowBox[{"J", " ", "L"}]]}], ",", 
    RowBox[{"\[Delta]kpy", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}], 
      RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, {3.7263283432806273`*^9, 3.726328374449148*^9}, 
   3.72638396067451*^9, 3.72639873351657*^9, 3.7266686595537853`*^9, 
   3.7288110476787987`*^9, 3.7288111085138073`*^9, 3.730332432491774*^9, 
   3.7303343575765123`*^9, 3.7303344293578663`*^9, 3.7304078513002253`*^9, 
   3.7331511582604427`*^9, 3.733160218943293*^9, 3.733161344899664*^9, 
   3.733255159205698*^9, 3.7332559390034533`*^9, 3.733258594559867*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Symmetric T=!0 and \[Theta]=0", "Title",
 CellChangeTimes->{{3.726383870002284*^9, 3.72638387347583*^9}, {
   3.7263949107283154`*^9, 3.72639491167203*^9}, {3.7263999361231613`*^9, 
   3.726399948251811*^9}, {3.726399985484311*^9, 3.726399988188662*^9}, 
   3.7303925515562572`*^9}],

Cell[CellGroupData[{

Cell["equilibrium parametrization", "Subsubsection",
 CellChangeTimes->{{3.7303418117715607`*^9, 3.7303418168665257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Gamma]", 
    RowBox[{"eq", ",", "2"}]], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", "1", ",", "0", ",", "0"}],
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.73033219065933*^9, 3.730332223458544*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification", "Chapter",
 CellChangeTimes->{{3.726394905303945*^9, 3.726394907969009*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SimplificationsParameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", " ", 
     RowBox[{"m2", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplificationsGains", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kpx1", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"kvx1", "\[Rule]", " ", "kvx"}], ",", 
     RowBox[{"kpy1", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"kvy1", "\[Rule]", " ", "kvy"}], ",", 
     RowBox[{"kpz1", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"kvz1", "\[Rule]", " ", "kvz"}], ",", 
     RowBox[{"kpx2", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"kvx2", "\[Rule]", " ", "kvx"}], ",", 
     RowBox[{"kpy2", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"kvy2", "\[Rule]", " ", "kvy"}], ",", 
     RowBox[{"kpz2", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"kvz2", "\[Rule]", " ", "kvz"}], ",", 
     RowBox[{"kp\[Psi]1", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]1", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kp\[Psi]2", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]2", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Simplifications", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"SimplificationsParameters", ",", "SimplificationsGains"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsParameters", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "SimplificationsParameters"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}]}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsGains", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"#", "/.", "SimplificationsGains"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplifications", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "Simplifications"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}]}]}], "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.726319366587973*^9, 3.7263194239291143`*^9}, {
   3.726326664972498*^9, 3.72632682474743*^9}, {3.726326908336322*^9, 
   3.726326922450852*^9}, 3.726384367929195*^9, 3.7263999822493277`*^9, {
   3.726400663768914*^9, 3.7264006798076277`*^9}, {3.7264016641585217`*^9, 
   3.7264016953976717`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stability vector field term (only for analysis)", "Chapter",
 CellChangeTimes->{{3.7120421708683567`*^9, 3.7120422205169086`*^9}, {
  3.7128306840760193`*^9, 3.71283068718001*^9}, {3.7134496094633293`*^9, 
  3.7134496232282867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DZ1SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z1SET", "[", "z1", "]"}], ",", 
      RowBox[{"{", "z1", "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.712830773527231*^9, 3.7128309192395477`*^9}, {
   3.712833495665552*^9, 3.712833508713584*^9}, {3.71283357008792*^9, 
   3.7128335976910353`*^9}, {3.71283534408328*^9, 3.712835344330735*^9}, {
   3.7128355335133457`*^9, 3.7128355336799107`*^9}, 3.712837005757556*^9, 
   3.712837065836936*^9, 3.712838456858864*^9, {3.712838505922365*^9, 
   3.712838551215933*^9}, {3.7128418281986103`*^9, 3.712841828216846*^9}, {
   3.712842173539816*^9, 3.712842173548656*^9}, {3.712847966278987*^9, 
   3.7128479662996902`*^9}, {3.712905307583363*^9, 3.712905307739265*^9}, 
   3.713449834593012*^9, {3.713600697627223*^9, 3.7136007092075443`*^9}, {
   3.724684045820299*^9, 3.724684045829007*^9}, {3.724751341533758*^9, 
   3.7247513415439157`*^9}, {3.724768463749054*^9, 3.724768468124543*^9}, {
   3.726317769433804*^9, 3.726317784338602*^9}, {3.726318444340234*^9, 
   3.7263184457061653`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["determinant of matrix being inverted is positive", "Chapter",
 CellChangeTimes->{{3.713449796880292*^9, 3.7134498095432177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"{", 
    RowBox[{"d1", ",", "d2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"#", ".", 
       RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
    RowBox[{"DZ1SET", "[", 
     RowBox[{"z1eq", "[", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"eq", ",", "2"}]], "]"}], "]"}], "]"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"64", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", 
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"dd", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ".", 
             "dd"}]}], ")"}], " ", 
          SuperscriptBox["gravity", "4"], " ", 
          SuperscriptBox["m", "4"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dd", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "4"}], "}"}]}], "}"}], ".", "dd"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d1", "2"], " ", 
             SuperscriptBox["d2", "2"]}]}], ")"}], " ", 
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox["m", "2"], " ", 
          SuperscriptBox["T", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], "4"], " ", 
          SuperscriptBox["T", "4"]}]}], ")"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["L1", "4"], " ", 
      SuperscriptBox["L2", "4"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", 
          SuperscriptBox["d2", "2"], " ", 
          SuperscriptBox["gravity", "4"], " ", 
          SuperscriptBox["m", "4"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["d1", "2"], "+", 
            SuperscriptBox["d2", "2"]}], ")"}], " ", 
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox["m", "2"], " ", 
          SuperscriptBox["T", "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], "4"], " ", 
          SuperscriptBox["T", "4"]}]}], ")"}], "2"]}], ")"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.726318179453529*^9, 3.726318186652172*^9}, {
   3.726318217572694*^9, 3.726318233081394*^9}, {3.726318293399637*^9, 
   3.726318360957098*^9}, {3.726400698215111*^9, 3.726400839034109*^9}, 
   3.726744128736369*^9, {3.730332192747774*^9, 3.730332197274314*^9}, {
   3.73033248707833*^9, 3.7303325994938107`*^9}, {3.730332636343771*^9, 
   3.7303326489041233`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.726318180711135*^9, 3.726318187739593*^9}, {
   3.72631823352956*^9, 3.726318240603044*^9}, {3.726318282059971*^9, 
   3.726318294245775*^9}, {3.7263183246076*^9, 3.7263183621338043`*^9}, 
   3.726318423207368*^9, 3.726325310787218*^9, 3.726383914292348*^9, 
   3.726398696144128*^9, {3.726400704470714*^9, 3.7264007227937927`*^9}, 
   3.7264007551264067`*^9, {3.726400799182136*^9, 3.726400839659404*^9}, 
   3.728811110580703*^9, 3.7292067470445547`*^9, 3.729274848036179*^9, 
   3.7292758128029547`*^9, {3.730332484237422*^9, 3.730332522962563*^9}, 
   3.7303326435742292`*^9, 3.730333341906165*^9, 3.730334451791527*^9, 
   3.733151278097904*^9, 3.733255160907989*^9, 3.733255940667626*^9, 
   3.733258596180151*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Linearization matrix", "Chapter",
 CellChangeTimes->{{3.7303327236695433`*^9, 3.7303327253036957`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["A", "0"], ",", 
      SubscriptBox["A", "1"]}], "}"}], "=", 
    RowBox[{"Linearization", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Z1cl", "[", 
        RowBox[{"#", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "2"}]]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z1SET", "[", "#", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"z1eq", "[", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"eq", ",", "2"}]], "]"}], ",", "\[IndentingNewLine]", 
      "ApplySimplificationsParameters"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7303327277306023`*^9, 3.730332729777668*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "unit", " ", "vector", " ", "of", " ", "dimension", " ", "of", " ", 
    "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "i_", "]"}], ":=", 
    RowBox[{"UnitVector", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dimensions", "[", "z1", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.7303330008405943`*^9, 3.730333001343239*^9}}],

Cell[CellGroupData[{

Cell["\<\
special point: position, velocity, acceleration and jerk do not depend on \
gains!\
\>", "Subsubsection",
 CellChangeTimes->{{3.730333170349646*^9, 3.730333191900675*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{"e_", ",", "n_", ",", "A_"}], "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplySimplificationsParameters", "[", 
      RowBox[{"#", ".", "A"}], "]"}], "&"}], ",", "e", ",", 
    RowBox[{"n", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainOfIntegrators", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "J", " ", "T"}], 
        RowBox[{"d", " ", 
         SuperscriptBox["m", "2"], "gravity"}]], 
       RowBox[{"e", "[", "6", "]"}]}]}], ",", "4", ",", 
     SubscriptBox["A", "0"]}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"chainOfIntegrators", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], "-", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "J", " ", "T"}], 
          RowBox[{"d", " ", 
           SuperscriptBox["m", "2"], "gravity"}]], 
         RowBox[{"e", "[", "6", "]"}]}]}], ",", "4", ",", 
       SubscriptBox["A", "1"]}], "]"}], "//", "Simplify"}], "//", 
    "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7263257888187017`*^9, 3.7263258724726763`*^9}, {
   3.7263259166627893`*^9, 3.726326042888208*^9}, {3.7263261879160957`*^9, 
   3.7263261983325*^9}, 3.726326848143663*^9, {3.726401180794229*^9, 
   3.7264012066514063`*^9}, 3.726401274598877*^9, {3.726401316284745*^9, 
   3.726401317346849*^9}, {3.726401351085499*^9, 3.726401371861828*^9}, {
   3.726401449864523*^9, 3.726401452127983*^9}, {3.730332946099036*^9, 
   3.730332957365635*^9}, {3.7303329995300817`*^9, 3.7303330458991213`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "J", " ", "T"}], 
        RowBox[{"d", " ", "gravity", " ", 
         SuperscriptBox["m", "2"]}]]}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "J", " ", "T"}], 
       RowBox[{"d", " ", "gravity", " ", 
        SuperscriptBox["m", "2"]}]], "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["gravity", "2"], " ", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["T", "2"]}]}]], 
        RowBox[{"L", " ", "m"}]]}], "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "L", " ", "T"}], "+", 
          RowBox[{"d", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["gravity", "2"], " ", 
              SuperscriptBox["m", "2"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["T", "2"]}]}]]}]}], ")"}]}], 
       RowBox[{"gravity", " ", "L", " ", 
        SuperscriptBox["m", "2"]}]], 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["T", "2"]}]}]], 
       RowBox[{"2", " ", "L", " ", "m"}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["gravity", "2"], " ", 
            SuperscriptBox["m", "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["T", "2"]}]}]]}], 
        RowBox[{"gravity", " ", "L", " ", 
         SuperscriptBox["m", "2"]}]]}], 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["T", "2"]}]}]], 
       RowBox[{"2", " ", "L", " ", "m"}]], "0", 
      FractionBox[
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["gravity", "2"], " ", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["T", "2"]}]}]]}], 
       RowBox[{"gravity", " ", "L", " ", 
        SuperscriptBox["m", "2"]}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["gravity", "2"], " ", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["T", "2"]}]}]], 
        RowBox[{"L", " ", "m"}]]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "T", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "L", " ", "T"}], "+", 
           RowBox[{"d", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["gravity", "2"], " ", 
               SuperscriptBox["m", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["T", "2"]}]}]]}]}], ")"}]}], 
        RowBox[{"gravity", " ", "L", " ", 
         SuperscriptBox["m", "2"]}]]}], "0", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["T", "2"]}]}]], 
       RowBox[{"2", " ", "L", " ", "m"}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"T", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["gravity", "2"], " ", 
            SuperscriptBox["m", "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["T", "2"]}]}]]}], 
        RowBox[{"gravity", " ", "L", " ", 
         SuperscriptBox["m", "2"]}]]}], 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["gravity", "2"], " ", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["T", "2"]}]}]], 
       RowBox[{"2", " ", "L", " ", "m"}]], "0", 
      FractionBox[
       RowBox[{"T", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["gravity", "2"], " ", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["T", "2"]}]}]]}], 
       RowBox[{"gravity", " ", "L", " ", 
        SuperscriptBox["m", "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726325956372691*^9, 3.726326007567583*^9}, 
   3.726326043774054*^9, 3.726334431506309*^9, 3.726383959228827*^9, 
   3.726398730549676*^9, 3.726401143450472*^9, {3.726401188416245*^9, 
   3.726401211737083*^9}, 3.726401281006077*^9, 3.726401322624621*^9, {
   3.72640135860459*^9, 3.7264013763299017`*^9}, 3.726401456492285*^9, 
   3.728811150422689*^9, 3.729206816433448*^9, 3.729274917830278*^9, 
   3.729275833119998*^9, {3.730333008932927*^9, 3.730333048010886*^9}, 
   3.7303334005165577`*^9, 3.730334565612905*^9, 3.733151480501266*^9, 
   3.733255215644145*^9, 3.7332559951214237`*^9, 3.733258650921626*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
    RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "7", "]"}], "-", 
          RowBox[{"e", "[", "10", "]"}]}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "J", " ", "T"}], 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "2"], "gravity"}]], 
           RowBox[{"e", "[", "6", "]"}]}]}], ",", "4", ",", "A"}], "]"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "6", "]"}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", "4", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "5", "]"}], ",", "4", ",", "A"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PPA", "[", "A_", "]"}], ":=", 
    RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PA", "[", "A", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DZ1SET", "[", 
        RowBox[{"z1eq", "[", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "2"}]], "]"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["P", "0"], "=", 
   RowBox[{"PPA", "[", 
    SubscriptBox["A", "0"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "1"], "=", 
    RowBox[{"PPA", "[", 
     SubscriptBox["A", "1"], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Dimensions", "[", 
    SubscriptBox["P", "0"], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MatrixRank", "[", 
    SubscriptBox["P", "0"], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Det", "[", 
     SubscriptBox["P", "0"], "]"}], "//", "Simplify"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Det", "[", 
     SubscriptBox["P", "1"], "]"}], "//", "Simplify"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
   3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
   3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
   3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
   3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
   3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
   3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}, {
   3.712831094381729*^9, 3.712831095820244*^9}, {3.712831148394435*^9, 
   3.7128311596982203`*^9}, {3.7128311998383636`*^9, 3.712831230922905*^9}, {
   3.71283380404528*^9, 3.712833817585775*^9}, {3.7128338578199453`*^9, 
   3.7128339145293837`*^9}, {3.712834032813575*^9, 3.712834033874092*^9}, {
   3.712836024098538*^9, 3.7128360488484507`*^9}, {3.71283609327536*^9, 
   3.712836118528947*^9}, {3.712836924452547*^9, 3.712836958498642*^9}, {
   3.712844426115212*^9, 3.71284450242596*^9}, {3.7128449771537046`*^9, 
   3.712845086412121*^9}, {3.712848439443294*^9, 3.7128485151925364`*^9}, {
   3.712944738222735*^9, 3.712944749777299*^9}, {3.712988102089939*^9, 
   3.7129881257009773`*^9}, {3.7134500543777742`*^9, 3.713450055447535*^9}, {
   3.724678693813246*^9, 3.724678697955299*^9}, {3.7246823296039057`*^9, 
   3.724682336385404*^9}, {3.724682370244699*^9, 3.7246823710267973`*^9}, {
   3.724683277507218*^9, 3.7246833021887293`*^9}, {3.7246834824509897`*^9, 
   3.724683513686524*^9}, {3.724684763780971*^9, 3.724684886425336*^9}, {
   3.72468839967736*^9, 3.724688410177302*^9}, {3.7247417260960283`*^9, 
   3.724741737955247*^9}, {3.724751538261547*^9, 3.7247516157283382`*^9}, {
   3.724751670903892*^9, 3.724751672969146*^9}, {3.724751760644328*^9, 
   3.72475178892412*^9}, {3.724751820655284*^9, 3.724751832936578*^9}, {
   3.724751999539131*^9, 3.724752021780467*^9}, 3.724752097482242*^9, {
   3.724752161886855*^9, 3.724752168133781*^9}, {3.724752446862174*^9, 
   3.724752448614086*^9}, {3.724757996420842*^9, 3.72475800444925*^9}, {
   3.7247580472472982`*^9, 3.724758052534409*^9}, {3.724758086078887*^9, 
   3.7247581075217037`*^9}, {3.724758396290547*^9, 3.724758408015748*^9}, {
   3.724758470544146*^9, 3.724758473931033*^9}, 3.7247586153657417`*^9, {
   3.724759149139023*^9, 3.724759151388007*^9}, {3.724759288648301*^9, 
   3.724759302491118*^9}, {3.724768760869358*^9, 3.724768800242721*^9}, {
   3.7247688560626087`*^9, 3.724768863292123*^9}, {3.724768936314774*^9, 
   3.724768950040413*^9}, 3.7247720001122103`*^9, {3.724853635498878*^9, 
   3.7248536406972437`*^9}, {3.726318927086563*^9, 3.726319024616363*^9}, {
   3.726326206275281*^9, 3.726326416142439*^9}, {3.726326454606626*^9, 
   3.726326455720798*^9}, {3.7263265943687067`*^9, 3.726326611353199*^9}, {
   3.7263268511347427`*^9, 3.7263268535081244`*^9}, {3.726336547766362*^9, 
   3.726336572881345*^9}, {3.726401395223534*^9, 3.726401404887206*^9}, 
   3.7264044271837883`*^9, {3.729207863864435*^9, 3.729207889653813*^9}, {
   3.729274855841749*^9, 3.729274888826123*^9}, {3.730333102309346*^9, 
   3.730333146155109*^9}, {3.730333470337963*^9, 3.730333521721558*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant of similarity matrix", "Chapter",
 CellChangeTimes->{{3.72927489284953*^9, 3.729274902051298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Det", "[", 
      SubscriptBox["P", "1"], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"T", "\[Rule]", " ", 
       RowBox[{"\[Alpha]", " ", 
        FractionBox[
         RowBox[{"m", " ", "gravity"}], "2"]}]}], "}"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " "}]}], "J"], ")"}], "2"]}], 
     FractionBox[
      RowBox[{"2", " "}], 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["L", "4"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"gravity", " "}], 
        RowBox[{" ", "L"}]], ")"}], "6"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}], "3"]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Det", "[", 
      SubscriptBox["P", "0"], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"T", "\[Rule]", " ", 
       RowBox[{"\[Alpha]", " ", 
        FractionBox[
         RowBox[{"m", " ", "gravity"}], "2"]}]}], "}"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m", " "}]}], "J"], ")"}], "2"]}], 
     FractionBox[
      RowBox[{"2", " "}], 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["L", "4"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"gravity", " "}], 
        RowBox[{" ", "L"}]], ")"}], "6"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}], "3"]}], ")"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.729275004296391*^9, 3.729275106252808*^9}, {
  3.7303335174003057`*^9, 3.730333545724848*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7292750014286423`*^9, 3.729275007057749*^9}, {
   3.72927506529924*^9, 3.7292750707630997`*^9}, 3.729275108263803*^9, 
   3.7292764891673393`*^9, {3.730333518194162*^9, 3.730333546734399*^9}, 
   3.730334574836463*^9, 3.733151490509968*^9, 3.733255220430542*^9, 
   3.7332559997892323`*^9, 3.7332586555892057`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7292750014286423`*^9, 3.729275007057749*^9}, {
   3.72927506529924*^9, 3.7292750707630997`*^9}, 3.729275108263803*^9, 
   3.7292764891673393`*^9, {3.730333518194162*^9, 3.730333546734399*^9}, 
   3.730334574836463*^9, 3.733151490509968*^9, 3.733255220430542*^9, 
   3.7332559997892323`*^9, 3.73325865564684*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["small relation", "Subsection",
 CellChangeTimes->{{3.7292923294775343`*^9, 3.729292335559169*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", "J", " ", "T"}], 
    RowBox[{"d", " ", 
     SuperscriptBox["m", "2"], "gravity"}]], "/.", 
   RowBox[{"{", 
    RowBox[{"T", "\[Rule]", " ", 
     RowBox[{"r", " ", 
      FractionBox[
       RowBox[{"gravity", " ", "m"}], "2"]}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7303336885399523`*^9, 3.730333688652095*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"J", " ", "r"}], 
  RowBox[{"d", " ", "m"}]]], "Output",
 CellChangeTimes->{
  3.7303335505970592`*^9, {3.7303345749508266`*^9, 3.730334582670594*^9}, 
   3.733151490657321*^9, 3.733255220512547*^9, 3.733255999855856*^9, 
   3.7332586556637907`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
State matrix after similarity transformation (check block triangular \
structure)\
\>", "Chapter",
 CellChangeTimes->{3.730332400811451*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "faster", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "0"], " ", "=", 
     RowBox[{"ApplySimplifications", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["P", "0"], ".", 
        SubscriptBox["A", "0"], ".", 
        RowBox[{"Inverse", "[", 
         SubscriptBox["P", "0"], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"T", "\[Rule]", " ", 
         RowBox[{"r", " ", 
          FractionBox[
           RowBox[{"gravity", " ", "m"}], "2"]}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["Asimilar", "0"], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{
  3.730333671477943*^9, {3.730333734341753*^9, 3.7303337369185333`*^9}, {
   3.730333789771696*^9, 3.730333792204134*^9}, 3.730334506182132*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"kpx", "-", "kpz"}], ")"}], " ", "L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kvx"}], "+", "kvz"}], ")"}], " ", "M", " ", "r"}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "kpz", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "+", 
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["r", "2"]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}], "+", 
          RowBox[{"m", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "kpz", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "+", 
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["r", "2"]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}], "+", 
          RowBox[{"m", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "kpz", " ", "L", " ", "M", " ", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}]]}], "+", 
          RowBox[{"gravity", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}], "+", 
          RowBox[{"m", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]], "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"2", " ", "kpz", " ", "m", " ", "r"}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]], 
      FractionBox[
       RowBox[{"2", " ", "kvz", " ", "m", " ", "r"}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
         RowBox[{"2", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kpx", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M"}]}], ")"}]}], "+", 
            RowBox[{"kpz", " ", "m", " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"kvx", " ", "m"}], "+", 
         RowBox[{"2", " ", "kvx", " ", "M"}], "+", 
         RowBox[{"kvz", " ", "m", " ", 
          SuperscriptBox["r", "2"]}]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "kpz", " ", "L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{"4", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "kpz", " ", "L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{"4", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"kvz", " ", "L", " ", "m", " ", "r", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]], 
      FractionBox[
       RowBox[{"kvz", " ", "L", " ", "m", " ", "r", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]]}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]], 
      FractionBox[
       RowBox[{"d", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "kpz", " ", "L", " ", "M", " ", 
           SuperscriptBox["r", "2"], " ", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}]]}], "+", 
          RowBox[{"gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "M"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}], "+", 
          RowBox[{"m", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]], "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "d", " ", "L", " ", "M", " ", 
            SuperscriptBox["r", "3"]}], "+", 
           RowBox[{"J", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}]}], ")"}]}], 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "d", " ", "L", " ", "M", " ", 
            SuperscriptBox["r", "3"]}], "+", 
           RowBox[{"J", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}]}], ")"}]}], 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"J", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "kpx", " ", "L", " ", "m", " ", "M"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "kpz", " ", "L", " ", "M", " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"gravity", " ", "m", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "d", " ", "m", " ", "M", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
               RowBox[{"gravity", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]}], ")"}]}], "+", 
            RowBox[{"L", " ", 
             SuperscriptBox["r", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"kpx", "-", "kpz"}], ")"}], " ", "L", " ", "M", " ", 
                
                SqrtBox[
                 RowBox[{"1", "+", 
                  SuperscriptBox["r", "2"]}]]}], "+", 
               RowBox[{"gravity", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}]}], 
           ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "d", " ", 
          RowBox[{"(", 
           RowBox[{"kvx", "-", "kvz"}], ")"}], " ", "L", " ", "m", " ", "M", 
          " ", 
          SuperscriptBox["r", "3"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "kvx", " ", "m", " ", "M", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], "+", 
         RowBox[{"J", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kvx", " ", "m"}], "+", 
            RowBox[{"kvz", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M"}]}], ")"}], " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["J", "2"], " ", "kpx", " ", "M", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "L", " ", "m", " ", "M", " ", "r", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m", " ", "r", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]}], "-", 
             RowBox[{"2", " ", "kpx", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"L", " ", 
                 SuperscriptBox["r", "3"]}], "+", 
                RowBox[{"d", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], 
                  RowBox[{"3", "/", "2"}]]}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "kpz", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"L", " ", 
                 SuperscriptBox["r", "3"]}], "+", 
                RowBox[{"d", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], 
                  RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d", " ", "J", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "d", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "kpx", " ", "M"}], "+", 
                RowBox[{"kpz", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", 
                   RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"gravity", " ", "m", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", 
                   RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
                RowBox[{"2", " ", "L", " ", "M", " ", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}]], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"kpz", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", 
                    RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                    SuperscriptBox["r", "2"]}], "+", 
                   RowBox[{"kpx", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", 
                    RowBox[{"2", " ", "M", " ", 
                    SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "d", " ", "L", " ", "M", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"gravity", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"kvx", "-", "kvz"}], ")"}], " ", "L", " ", "m", " ", "M", 
           " ", "r", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", 
          RowBox[{
           SuperscriptBox["J", "2"], " ", "kvx", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], 
            RowBox[{"7", "/", "2"}]]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"kvx", "-", "kvz"}], ")"}], " ", 
              SuperscriptBox["L", "2"], " ", "m", " ", "M", " ", 
              SuperscriptBox["r", "4"]}], "+", 
             RowBox[{"J", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "kvx", " ", "M"}], "+", 
                RowBox[{"kvz", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", 
                   RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], "3"]}]}], ")"}]}], "+", 
          RowBox[{"d", " ", "J", " ", "L", " ", "r", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kvz", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M"}]}], ")"}], " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"kvx", " ", 
              RowBox[{"(", 
               RowBox[{"m", "-", 
                RowBox[{"2", " ", "M", " ", 
                 SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       
       RowBox[{"d", " ", "L", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]], "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "J"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kpx", " ", "L", " ", "m"}], "-", 
             RowBox[{"kpz", " ", "L", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "M"}], ")"}], " ", 
              SqrtBox[
               RowBox[{"1", "+", 
                SuperscriptBox["r", "2"]}]]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "d", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"kpx", " ", "L", " ", "M"}], "-", 
                RowBox[{"gravity", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M"}], ")"}], " ", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}]]}]}], ")"}]}], "+", 
             RowBox[{"L", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"gravity", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "M"}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", 
                RowBox[{"L", " ", "M", " ", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}]], " ", 
                 RowBox[{"(", 
                  RowBox[{"kpz", "+", 
                   RowBox[{"kpx", " ", 
                    SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{"4", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "J"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpx", " ", "L", " ", "m"}], "-", 
              RowBox[{"kpz", " ", "L", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", "gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "M"}], ")"}], " ", 
               SqrtBox[
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}]]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", "d", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpx", " ", "L", " ", "M"}], "-", 
                 RowBox[{"gravity", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M"}], ")"}], " ", 
                  SqrtBox[
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}]]}]}], ")"}]}], "+", 
              RowBox[{"L", " ", "r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"gravity", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "M"}], ")"}], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", 
                 RowBox[{"L", " ", "M", " ", 
                  SqrtBox[
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}]], " ", 
                  RowBox[{"(", 
                   RowBox[{"kpz", "+", 
                    RowBox[{"kpx", " ", 
                    SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], 
        RowBox[{"4", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvx", " ", "m"}], "-", 
              RowBox[{"kvz", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
           RowBox[{"2", " ", "d", " ", "m", " ", "M", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", "kvx", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
              RowBox[{"L", " ", "r", " ", 
               SqrtBox[
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}]], " ", 
               RowBox[{"(", 
                RowBox[{"kvz", "+", 
                 RowBox[{"kvx", " ", 
                  SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kvx", " ", "m"}], "-", 
             RowBox[{"kvz", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
          RowBox[{"2", " ", "d", " ", "m", " ", "M", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", "kvx", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
             RowBox[{"L", " ", "r", " ", 
              SqrtBox[
               RowBox[{"1", "+", 
                SuperscriptBox["r", "2"]}]], " ", 
              RowBox[{"(", 
               RowBox[{"kvz", "+", 
                RowBox[{"kvx", " ", 
                 SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "m", " ", "M", " ", "r"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"2", " ", "M", " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kvx", " ", "m", " ", "M", " ", "r"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"2", " ", "M", " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "m", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"kpx", "-", "kpz"}], ")"}], " ", "L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{"gravity", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", 
         RowBox[{"(", 
          RowBox[{"kvx", "-", "kvz"}], ")"}], " ", "L", " ", "m", " ", "M", 
         " ", "r"}], 
        RowBox[{"gravity", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "kpz", " ", "m", " ", "M", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], "+", 
         RowBox[{"2", " ", "J", " ", "kpx", " ", "M", " ", 
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], "+", 
         RowBox[{"d", " ", "m", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "kpx", " ", "L", " ", "M", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"2", " ", "kpz", " ", "L", " ", "M", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"gravity", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["r", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "kvx"}], "+", "kvz"}], ")"}], " ", "L", " ", "m", 
            " ", 
            SuperscriptBox["r", "3"], " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "kvz", " ", "m", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
           RowBox[{"J", " ", "kvx", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"r", "+", 
               SuperscriptBox["r", "3"]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gravity", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", 
          RowBox[{"L", " ", "M", " ", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}]], " ", 
           RowBox[{"(", 
            RowBox[{"kpz", "+", 
             RowBox[{"kpx", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", 
           RowBox[{"L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]], " ", 
            RowBox[{"(", 
             RowBox[{"kpz", "+", 
              RowBox[{"kpx", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "L", " ", "m", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{"kvz", "+", 
           RowBox[{"kvx", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", "L", " ", "m", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"kvz", "+", 
          RowBox[{"kvx", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]}], "+", 
         RowBox[{"gravity", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m", " ", "r", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"2", " ", "kpy", " ", "M", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"L", " ", "r"}], "+", 
              RowBox[{"d", " ", 
               SqrtBox[
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}]]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "kvy", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"d", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{"L", " ", "r", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}]}], ")"}]}], 
        RowBox[{"J", " ", "L", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "M", " ", 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"d", " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"L", " ", "r", " ", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  SuperscriptBox["r", "2"]}]]}]}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "2", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "2", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}], " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "M"}], ")"}], " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.730334665548109*^9, 3.733151501303626*^9, 
  3.733255226321546*^9, 3.733256005653451*^9, 3.733258661480138*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], " ", "=", 
     RowBox[{"ApplySimplifications", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["P", "1"], ".", 
        SubscriptBox["A", "1"], ".", 
        RowBox[{"Inverse", "[", 
         SubscriptBox["P", "1"], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"T", "\[Rule]", " ", 
         RowBox[{"r", " ", 
          FractionBox[
           RowBox[{"gravity", " ", "m"}], "2"]}]}], "}"}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "//", "MatrixForm"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.730333637372424*^9, 3.730333668366975*^9}, {
   3.7303337178889217`*^9, 3.730333723120278*^9}, {3.730333783796526*^9, 
   3.730333785134097*^9}, 3.730334511005775*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], "=", 
   SubscriptBox["Asimilar", "0"]}], ";"}]], "Input",
 CellChangeTimes->{{3.730334622425057*^9, 3.730334625104985*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Motions: Vertical linear + Longitudinal angular", "Chapter",
 CellChangeTimes->{{3.713450417179948*^9, 3.713450422588997*^9}, {
  3.726327222144143*^9, 3.726327230092554*^9}, {3.729276638162994*^9, 
  3.729276654867549*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], " ", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"1", ";;", "4"}], ",", 
     RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], " ", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"r", "\[Rule]", " ", "0"}], "}"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712945014916979*^9, 3.712945043809243*^9}, {
   3.712982474447101*^9, 3.712982483165021*^9}, 3.7134504376899633`*^9, {
   3.726327238090015*^9, 3.7263272499610147`*^9}, {3.729292021414647*^9, 
   3.7292920341588182`*^9}, {3.7292920877018843`*^9, 
   3.7292921107734833`*^9}, {3.7292925153648863`*^9, 3.729292532109313*^9}, {
   3.72929257688577*^9, 3.729292579167981*^9}, {3.729292767764278*^9, 
   3.7292927748287573`*^9}, {3.7292928825844393`*^9, 3.729292883718007*^9}, {
   3.730333752739997*^9, 3.730333753511881*^9}, {3.730334677104322*^9, 
   3.73033467783215*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"kpx", "-", "kpz"}], ")"}], " ", "L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kvx"}], "+", "kvz"}], ")"}], " ", "M", " ", "r"}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]]},
     {"0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"2", " ", "kpz", " ", "m", " ", "r"}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]], 
      FractionBox[
       RowBox[{"2", " ", "kvz", " ", "m", " ", "r"}], 
       RowBox[{"m", "+", 
        RowBox[{"2", " ", "M"}], "+", 
        RowBox[{"m", " ", 
         SuperscriptBox["r", "2"]}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
         RowBox[{"2", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kpx", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M"}]}], ")"}]}], "+", 
            RowBox[{"kpz", " ", "m", " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"kvx", " ", "m"}], "+", 
         RowBox[{"2", " ", "kvx", " ", "M"}], "+", 
         RowBox[{"kvz", " ", "m", " ", 
          SuperscriptBox["r", "2"]}]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712988511498514*^9, 3.713450443598475*^9, 3.713450710505559*^9, 
   3.713451069364211*^9, 3.7136008867065268`*^9, 3.714030540754437*^9, 
   3.714030762041692*^9, 3.7140317218870707`*^9, 3.7140319518285*^9, 
   3.714034134273993*^9, {3.7263272432238617`*^9, 3.726327250259211*^9}, 
   3.726383960081555*^9, 3.726398733148213*^9, 3.726401773492017*^9, 
   3.7292075242517157`*^9, 3.72927667255309*^9, 3.729291860311716*^9, 
   3.729292034503024*^9, {3.72929209773079*^9, 3.729292111274146*^9}, 
   3.729292579769044*^9, 3.729292775300233*^9, 3.7292928840542097`*^9, 
   3.730334678607535*^9, 3.733151501449074*^9, 3.7332552265688887`*^9, 
   3.733256005886303*^9, 3.7332586617385406`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "kpx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712988511498514*^9, 3.713450443598475*^9, 3.713450710505559*^9, 
   3.713451069364211*^9, 3.7136008867065268`*^9, 3.714030540754437*^9, 
   3.714030762041692*^9, 3.7140317218870707`*^9, 3.7140319518285*^9, 
   3.714034134273993*^9, {3.7263272432238617`*^9, 3.726327250259211*^9}, 
   3.726383960081555*^9, 3.726398733148213*^9, 3.726401773492017*^9, 
   3.7292075242517157`*^9, 3.72927667255309*^9, 3.729291860311716*^9, 
   3.729292034503024*^9, {3.72929209773079*^9, 3.729292111274146*^9}, 
   3.729292579769044*^9, 3.729292775300233*^9, 3.7292928840542097`*^9, 
   3.730334678607535*^9, 3.733151501449074*^9, 3.7332552265688887`*^9, 
   3.733256005886303*^9, 3.733258661748515*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7292920190792027`*^9}],

Cell[CellGroupData[{

Cell["\<\
dependence on products of gains makes analysis too complicated\
\>", "Subsection",
 CellChangeTimes->{{3.7264027990602713`*^9, 3.7264028160880203`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#2", ".", "#1", ".", 
         RowBox[{"Inverse", "[", "#2", "]"}]}], "&"}], ")"}], "[", 
      RowBox[{"#", ",", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "4", ",", 
         "#"}], "]"}]}], "]"}], "&"}], "[", 
    RowBox[{
     SubscriptBox["Asimilar", "1"], " ", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "4"}], ",", 
       RowBox[{"1", ";;", "4"}]}], "]"}], "]"}], "]"}], "//", "Simplify"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.726402567954501*^9, 3.726402674013166*^9}, {
   3.72640270717282*^9, 3.726402710924004*^9}, {3.7264027529456387`*^9, 
   3.726402754520467*^9}, 3.73033470480754*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpx", " ", "L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{"L", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}], "+", 
           RowBox[{"m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpz", " ", "kvx"}], "+", 
           RowBox[{"kpx", " ", "kvz"}]}], ")"}], " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "-", 
        RowBox[{"gravity", " ", "kvz", " ", "m", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], 
       RowBox[{"L", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}], "+", 
          RowBox[{"m", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "gravity"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpz", " ", "M"}], "+", 
           RowBox[{"2", " ", "kvx", " ", "kvz", " ", "M"}], "+", 
           RowBox[{"kpx", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}], "+", 
           RowBox[{"kpz", " ", "m", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]}], 
       RowBox[{"2", " ", "L", " ", "M", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}], "+", 
          RowBox[{"m", " ", 
           SuperscriptBox["r", "2"]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"kvx", " ", "m"}], "+", 
         RowBox[{"2", " ", "kvx", " ", "M"}], "+", 
         RowBox[{"2", " ", "kvz", " ", "M"}], "+", 
         RowBox[{"kvz", " ", "m", " ", 
          SuperscriptBox["r", "2"]}]}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["r", "2"]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7264027047970953`*^9, 3.726402713670064*^9}, 
   3.726402756436934*^9, 3.7292766750552063`*^9, 3.730334707115348*^9, 
   3.733151503251564*^9, 3.7332552276194267`*^9, 3.733256006901053*^9, 
   3.7332586627971783`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Motions: Longitudinal linear + vertical angular", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}, {
   3.729276689888892*^9, 3.729276705928809*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], " ", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"5", ";;", "10"}], ",", 
      RowBox[{"5", ";;", "10"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AofInterest", "/.", 
    RowBox[{"{", 
     RowBox[{"r", "\[Rule]", " ", "0"}], "}"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
  3.726402833041212*^9, 3.7264028344564657`*^9}, {3.729292987387163*^9, 
  3.729292994447544*^9}, {3.730334743799595*^9, 3.730334752220319*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "d", " ", "L", " ", "M", " ", 
            SuperscriptBox["r", "3"]}], "+", 
           RowBox[{"J", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}]}], ")"}]}], 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "d", " ", "L", " ", "M", " ", 
            SuperscriptBox["r", "3"]}], "+", 
           RowBox[{"J", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], 
             RowBox[{"3", "/", "2"}]]}]}], ")"}]}], 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"J", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "kpx", " ", "L", " ", "m", " ", "M"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "kpz", " ", "L", " ", "M", " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"gravity", " ", "m", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "d", " ", "m", " ", "M", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
               RowBox[{"gravity", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}], ")"}], 
                 RowBox[{"3", "/", "2"}]]}]}], ")"}]}], "+", 
            RowBox[{"L", " ", 
             SuperscriptBox["r", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"kpx", "-", "kpz"}], ")"}], " ", "L", " ", "M", " ", 
                
                SqrtBox[
                 RowBox[{"1", "+", 
                  SuperscriptBox["r", "2"]}]]}], "+", 
               RowBox[{"gravity", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}]}], 
           ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "d", " ", 
          RowBox[{"(", 
           RowBox[{"kvx", "-", "kvz"}], ")"}], " ", "L", " ", "m", " ", "M", 
          " ", 
          SuperscriptBox["r", "3"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "kvx", " ", "m", " ", "M", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], "+", 
         RowBox[{"J", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kvx", " ", "m"}], "+", 
            RowBox[{"kvz", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"2", " ", "M"}]}], ")"}], " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["J", "2"], " ", "kpx", " ", "M", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "3"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "L", " ", "m", " ", "M", " ", "r", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m", " ", "r", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]}], "-", 
             RowBox[{"2", " ", "kpx", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"L", " ", 
                 SuperscriptBox["r", "3"]}], "+", 
                RowBox[{"d", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], 
                  RowBox[{"3", "/", "2"}]]}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "kpz", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"L", " ", 
                 SuperscriptBox["r", "3"]}], "+", 
                RowBox[{"d", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], 
                  RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d", " ", "J", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "d", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "kpx", " ", "M"}], "+", 
                RowBox[{"kpz", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", 
                   RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"gravity", " ", "m", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", 
                   RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
                RowBox[{"2", " ", "L", " ", "M", " ", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   SuperscriptBox["r", "2"]}]], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"kpz", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", 
                    RowBox[{"2", " ", "M"}]}], ")"}], " ", 
                    SuperscriptBox["r", "2"]}], "+", 
                   RowBox[{"kpx", " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", 
                    RowBox[{"2", " ", "M", " ", 
                    SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "d", " ", "L", " ", "M", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"gravity", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"kvx", "-", "kvz"}], ")"}], " ", "L", " ", "m", " ", "M", 
           " ", "r", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", 
          RowBox[{
           SuperscriptBox["J", "2"], " ", "kvx", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], 
            RowBox[{"7", "/", "2"}]]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"kvx", "-", "kvz"}], ")"}], " ", 
              SuperscriptBox["L", "2"], " ", "m", " ", "M", " ", 
              SuperscriptBox["r", "4"]}], "+", 
             RowBox[{"J", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "kvx", " ", "M"}], "+", 
                RowBox[{"kvz", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", 
                   RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}], ")"}], "3"]}]}], ")"}]}], "+", 
          RowBox[{"d", " ", "J", " ", "L", " ", "r", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kvz", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "M"}]}], ")"}], " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"kvx", " ", 
              RowBox[{"(", 
               RowBox[{"m", "-", 
                RowBox[{"2", " ", "M", " ", 
                 SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       
       RowBox[{"d", " ", "L", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"m", " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "M", " ", 
              SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]},
     {"0", "0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kpx", " ", "m", " ", "M", " ", "r"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"2", " ", "M", " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "kvx", " ", "m", " ", "M", " ", "r"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"m", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"2", " ", "M", " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "m", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"kpx", "-", "kpz"}], ")"}], " ", "L", " ", "M", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{"gravity", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", 
         RowBox[{"(", 
          RowBox[{"kvx", "-", "kvz"}], ")"}], " ", "L", " ", "m", " ", "M", 
         " ", "r"}], 
        RowBox[{"gravity", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "kpz", " ", "m", " ", "M", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], "+", 
         RowBox[{"2", " ", "J", " ", "kpx", " ", "M", " ", 
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}], "+", 
         RowBox[{"d", " ", "m", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "kpx", " ", "L", " ", "M", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"2", " ", "kpz", " ", "L", " ", "M", " ", 
             SuperscriptBox["r", "2"]}], "+", 
            RowBox[{"gravity", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["r", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]}], ")"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "kvx"}], "+", "kvz"}], ")"}], " ", "L", " ", "m", 
            " ", 
            SuperscriptBox["r", "3"], " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "kvz", " ", "m", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}], "2"]}], "+", 
           RowBox[{"J", " ", "kvx", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"r", "+", 
               SuperscriptBox["r", "3"]}], ")"}], "2"]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m", " ", "M"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"m", " ", 
               SuperscriptBox["r", "2"]}], "+", 
              RowBox[{"2", " ", "M", " ", 
               SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.726403026704899*^9, 3.729276708078905*^9, 
  3.729292995257024*^9, 3.730334752651723*^9, 3.7331515033539133`*^9, 
  3.7332552277642*^9, 3.733256007041506*^9, 3.7332586629396963`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.726403026704899*^9, 3.729276708078905*^9, 
  3.729292995257024*^9, 3.730334752651723*^9, 3.7331515033539133`*^9, 
  3.7332552277642*^9, 3.733256007041506*^9, 3.733258662943824*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lateral motion", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}, {
   3.726328191491131*^9, 3.726328192534465*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], " ", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"11", ";;", "18"}], ",", 
      RowBox[{"11", ";;", "18"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726403172040745*^9, 3.726403174312581*^9}, 
   3.730334790643292*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]}], "+", 
         RowBox[{"gravity", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m", " ", "r", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"2", " ", "kpy", " ", "M", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"L", " ", "r"}], "+", 
              RowBox[{"d", " ", 
               SqrtBox[
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}]]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "kvy", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"d", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{"L", " ", "r", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}]}], ")"}]}], 
        RowBox[{"J", " ", "L", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "M", " ", 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"d", " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"L", " ", "r", " ", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  SuperscriptBox["r", "2"]}]]}]}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", "kvy"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.726403175051695*^9, 3.7292082166346283`*^9, 
  3.7292798193155537`*^9, 3.730334791112547*^9, 3.733151503454268*^9, 
  3.7332552278418913`*^9, 3.733256007110012*^9, 3.73325866301472*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["linear motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.7263281711595583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], " ", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"11", ";;", "14"}], ",", 
      RowBox[{"11", ";;", "14"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
   3.72632832070956*^9, 3.726328327715292*^9}, 3.730334794164056*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]}], "+", 
         RowBox[{"gravity", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"2", " ", "M"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}], ")"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", "kvy"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726328328183877*^9, 3.726383960533135*^9, 3.7263987334381447`*^9, {
   3.726403163224022*^9, 3.726403178353202*^9}, 3.726403402833206*^9, 
   3.729208220981481*^9, 3.7292109495359087`*^9, 3.7292798215481367`*^9, 
   3.7303347952186317`*^9, 3.730334853410569*^9, 3.730334993104615*^9, 
   3.730335473997572*^9, 3.7331515035226*^9, 3.733255227911872*^9, 
   3.7332560071763783`*^9, 3.73325866308407*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]4", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fp_", ",", "q_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", "kp"}], ",", 
      RowBox[{"fp", " ", "kd"}], ",", 
      RowBox[{"kp", "+", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}]}]}], " ", ",", "kd"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"solyCoeff", "=", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"\[CapitalGamma]4", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fpy", ",", "qy"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"fpy", ",", "qy"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
  3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
  3.726328241473325*^9}, {3.7263283332636557`*^9, 3.726328342768092*^9}, {
  3.7264032122185497`*^9, 3.726403224645129*^9}, {3.729210929983699*^9, 
  3.729210945027062*^9}, {3.7303348093762083`*^9, 3.730334812317006*^9}, {
  3.730334846394421*^9, 3.730334850825376*^9}, {3.7303349887422733`*^9, 
  3.730334990123191*^9}, {3.730335466045949*^9, 3.7303354720064898`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fpy", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", 
       SqrtBox[
        RowBox[{"1", "+", 
         SuperscriptBox["r", "2"]}]]}], "L"]}], ",", 
    RowBox[{"qy", "\[Rule]", 
     FractionBox["m", 
      RowBox[{"2", " ", "M"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, 3.7263283432806273`*^9, 3.7263839606007843`*^9, 
   3.726398733470619*^9, 3.7264031808833838`*^9, {3.7264032166120234`*^9, 
   3.7264032550255404`*^9}, 3.726403328077304*^9, 3.726403405703658*^9, 
   3.729208223664936*^9, {3.7292109455813932`*^9, 3.729210951857543*^9}, 
   3.729279823395385*^9, {3.730334799510427*^9, 3.730334813053689*^9}, 
   3.730334855379539*^9, {3.730334990918002*^9, 3.7303349945887823`*^9}, 
   3.730335475467925*^9, 3.733151503638875*^9, 3.733255227998542*^9, 
   3.733256007255313*^9, 3.733258663164956*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular motion: better to have T>0 than T<0", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.72632817761716*^9}, {
  3.7264035400337267`*^9, 3.7264035485455112`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], " ", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"15", ";;", "18"}], ",", 
      RowBox[{"15", ";;", "18"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
   3.72632832070956*^9, 3.726328365616743*^9}, 3.7303348246646357`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m", " ", "r", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}], "+", 
           RowBox[{"2", " ", "kpy", " ", "M", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"L", " ", "r"}], "+", 
              RowBox[{"d", " ", 
               SqrtBox[
                RowBox[{"1", "+", 
                 SuperscriptBox["r", "2"]}]]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "kvy", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"d", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{"L", " ", "r", " ", 
            SqrtBox[
             RowBox[{"1", "+", 
              SuperscriptBox["r", "2"]}]]}]}], ")"}]}], 
        RowBox[{"J", " ", "L", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["r", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", "d", " ", "M", " ", 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"d", " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"L", " ", "r", " ", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  SuperscriptBox["r", "2"]}]]}]}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M", " ", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["r", "2"]}]]}]]}], 
      RowBox[{"-", "kvy"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726328328183877*^9, 3.726328366724547*^9, 3.726383960637189*^9, 
   3.726398733481083*^9, 3.726403185055325*^9, 3.726403419913102*^9, 
   3.729208230757474*^9, 3.729280219577427*^9, 3.730334825025111*^9, 
   3.730334996792844*^9, 3.730335477473996*^9, 3.733151503707135*^9, 
   3.733255228069159*^9, 3.73325600732066*^9, 3.733258663236092*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]4", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fp_", ",", "q_", ",", "q\[Delta]\[Psi]_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", " ", "q", " ", "q\[Delta]\[Psi]"}]}], ")"}]}], ",", 
      RowBox[{"fp", " ", "kd"}], ",", 
      RowBox[{"kp", "+", 
       RowBox[{"fp", 
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "kd"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Psi]Coeff", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{"Solve", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AofInterest", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
          "#"}], ")"}], "&"}], "[", 
       RowBox[{"\[CapitalGamma]4", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fp\[Psi]", ",", "q\[Psi]", ",", "q\[Delta]\[Psi]"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"fp\[Psi]", ",", "q\[Psi]", ",", "q\[Delta]\[Psi]"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ApplySimplifications", "[", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{"T", "\[Rule]", " ", 
       RowBox[{"\[Beta]", " ", "gravity", " ", "m"}]}], "}"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
   3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
   3.726328241473325*^9}, {3.7263283332636557`*^9, 3.726328342768092*^9}, 
   3.72632837387451*^9, 3.726403193093513*^9, {3.726403431191793*^9, 
   3.7264034582350473`*^9}, {3.726403592453614*^9, 3.726403614264268*^9}, {
   3.726403663196612*^9, 3.726403679895846*^9}, {3.729208300623405*^9, 
   3.7292083029018803`*^9}, {3.729208333571085*^9, 3.729208389887364*^9}, {
   3.729208558339546*^9, 3.729208592505649*^9}, {3.729208917425458*^9, 
   3.729208921299814*^9}, 3.7292090138511972`*^9, {3.729209217826494*^9, 
   3.7292092543800507`*^9}, {3.729209401424637*^9, 3.729209415362714*^9}, {
   3.7292094489614067`*^9, 3.729209457345511*^9}, {3.729209944085902*^9, 
   3.729209961603603*^9}, {3.729210462882316*^9, 3.729210470906701*^9}, {
   3.729210539288288*^9, 3.7292105396300488`*^9}, {3.72921074088489*^9, 
   3.729210745683544*^9}, {3.730334974342911*^9, 3.730334984610446*^9}, {
   3.7303354135106163`*^9, 3.730335448012864*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fp\[Psi]", "\[Rule]", 
     FractionBox[
      RowBox[{"d", " ", "gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", "r"}], "+", 
         RowBox[{"d", " ", 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]}]}], ")"}]}], 
      RowBox[{"J", " ", "L"}]]}], ",", 
    RowBox[{"q\[Psi]", "\[Rule]", 
     FractionBox["J", 
      RowBox[{"2", " ", "d", " ", "M", " ", 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         FractionBox[
          RowBox[{"L", " ", "r"}], 
          SqrtBox[
           RowBox[{"1", "+", 
            SuperscriptBox["r", "2"]}]]]}], ")"}]}]]}], ",", 
    RowBox[{"q\[Delta]\[Psi]", "\[Rule]", 
     FractionBox[
      RowBox[{"L", " ", "r"}], 
      RowBox[{
       RowBox[{"L", " ", "r"}], "+", 
       RowBox[{"d", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["r", "2"]}]]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, {3.7263283432806273`*^9, 3.726328374449148*^9}, 
   3.72638396067451*^9, 3.72639873351657*^9, 3.72640318859599*^9, 
   3.726403458912079*^9, 3.726403614674486*^9, {3.726403670998371*^9, 
   3.726403684856776*^9}, 3.729208239353608*^9, {3.729208574785193*^9, 
   3.729208596948751*^9}, 3.729208676563081*^9, {3.7292092261176577`*^9, 
   3.729209255514476*^9}, 3.7292094254053593`*^9, 3.7292094590998898`*^9, {
   3.7292099557002907`*^9, 3.729209967164884*^9}, 3.729210472283065*^9, 
   3.72921054051051*^9, 3.729210746611999*^9, 3.7292802215516768`*^9, 
   3.7303348325531073`*^9, 3.7303349991188803`*^9, {3.730335450091346*^9, 
   3.730335479428155*^9}, 3.733151504591529*^9, 3.733255228588728*^9, 
   3.733256007819092*^9, 3.7332586637667217`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["see relations between y and \[Psi] constants", "Subsubsection",
 CellChangeTimes->{{3.730335109183812*^9, 3.730335119632824*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]\[Delta]", "=", 
   RowBox[{"1", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"L", " "}], "d"], 
     FractionBox["r", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["r", "2"]}]]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"fp\[Psi]", "/.", 
     RowBox[{"sol\[Psi]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], "m"}], "J"], "  ", "\[Delta]\[Delta]", " ", 
      "fpy"}], "/.", 
     RowBox[{"solyCoeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"q\[Psi]", "/.", 
     RowBox[{"sol\[Psi]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["J", 
       RowBox[{
        SuperscriptBox["d", "2"], "m"}]], 
      SuperscriptBox["\[Delta]\[Delta]", 
       RowBox[{"-", "1"}]], "qy"}], "/.", 
     RowBox[{"solyCoeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"q\[Delta]\[Psi]", "/.", 
     RowBox[{"sol\[Psi]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   FractionBox[
    RowBox[{"\[Delta]\[Delta]", "-", "1"}], "\[Delta]\[Delta]"]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.729209331365559*^9, 3.729209387986137*^9}, {
   3.729209419039522*^9, 3.729209503973575*^9}, {3.729209542107985*^9, 
   3.729209595634783*^9}, {3.729209656840796*^9, 3.729209693787795*^9}, {
   3.729209996726487*^9, 3.729210029029974*^9}, {3.729210140133486*^9, 
   3.7292102927656717`*^9}, {3.729210479133563*^9, 3.7292105134673557`*^9}, 
   3.729210544146443*^9, {3.7292107588071404`*^9, 3.72921081993375*^9}, {
   3.729294432319063*^9, 3.729294490536578*^9}, {3.7303348673765182`*^9, 
   3.730334949832999*^9}, {3.7303350021543083`*^9, 3.730335101161581*^9}, {
   3.730335136442189*^9, 3.7303352921531*^9}, {3.730335325004623*^9, 
   3.7303353325857477`*^9}, {3.730335455761177*^9, 3.7303354624670277`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.729209340047723*^9, 3.729209370366549*^9, {3.729209426449092*^9, 
   3.729209433838592*^9}, 3.729209466111661*^9, 3.7292094981988564`*^9, {
   3.729209560502693*^9, 3.729209596385208*^9}, {3.729209675717709*^9, 
   3.729209694166553*^9}, {3.729209974680539*^9, 3.729210029640605*^9}, {
   3.729210134993685*^9, 3.7292102934078207`*^9}, {3.729210481064137*^9, 
   3.729210514086293*^9}, 3.72921054477673*^9, 3.729210760243805*^9, {
   3.72921079590263*^9, 3.729210820545211*^9}, 3.729280222877926*^9, {
   3.7292944551233377`*^9, 3.729294460654992*^9}, 3.729294491342867*^9, {
   3.730334884189054*^9, 3.730334911359527*^9}, 3.7303349542754602`*^9, {
   3.730335029805276*^9, 3.7303351051364594`*^9}, {3.7303351448629227`*^9, 
   3.730335254839176*^9}, {3.7303352889823103`*^9, 3.7303352926754637`*^9}, {
   3.730335329779396*^9, 3.730335333752239*^9}, 3.730335481467617*^9, 
   3.733151504796818*^9, 3.733255228713776*^9, 3.733256007941587*^9, 
   3.733258663894266*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.729209340047723*^9, 3.729209370366549*^9, {3.729209426449092*^9, 
   3.729209433838592*^9}, 3.729209466111661*^9, 3.7292094981988564`*^9, {
   3.729209560502693*^9, 3.729209596385208*^9}, {3.729209675717709*^9, 
   3.729209694166553*^9}, {3.729209974680539*^9, 3.729210029640605*^9}, {
   3.729210134993685*^9, 3.7292102934078207`*^9}, {3.729210481064137*^9, 
   3.729210514086293*^9}, 3.72921054477673*^9, 3.729210760243805*^9, {
   3.72921079590263*^9, 3.729210820545211*^9}, 3.729280222877926*^9, {
   3.7292944551233377`*^9, 3.729294460654992*^9}, 3.729294491342867*^9, {
   3.730334884189054*^9, 3.730334911359527*^9}, 3.7303349542754602`*^9, {
   3.730335029805276*^9, 3.7303351051364594`*^9}, {3.7303351448629227`*^9, 
   3.730335254839176*^9}, {3.7303352889823103`*^9, 3.7303352926754637`*^9}, {
   3.730335329779396*^9, 3.730335333752239*^9}, 3.730335481467617*^9, 
   3.733151504796818*^9, 3.733255228713776*^9, 3.733256007941587*^9, 
   3.73325866389563*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.729209340047723*^9, 3.729209370366549*^9, {3.729209426449092*^9, 
   3.729209433838592*^9}, 3.729209466111661*^9, 3.7292094981988564`*^9, {
   3.729209560502693*^9, 3.729209596385208*^9}, {3.729209675717709*^9, 
   3.729209694166553*^9}, {3.729209974680539*^9, 3.729210029640605*^9}, {
   3.729210134993685*^9, 3.7292102934078207`*^9}, {3.729210481064137*^9, 
   3.729210514086293*^9}, 3.72921054477673*^9, 3.729210760243805*^9, {
   3.72921079590263*^9, 3.729210820545211*^9}, 3.729280222877926*^9, {
   3.7292944551233377`*^9, 3.729294460654992*^9}, 3.729294491342867*^9, {
   3.730334884189054*^9, 3.730334911359527*^9}, 3.7303349542754602`*^9, {
   3.730335029805276*^9, 3.7303351051364594`*^9}, {3.7303351448629227`*^9, 
   3.730335254839176*^9}, {3.7303352889823103`*^9, 3.7303352926754637`*^9}, {
   3.730335329779396*^9, 3.730335333752239*^9}, 3.730335481467617*^9, 
   3.733151504796818*^9, 3.733255228713776*^9, 3.733256007941587*^9, 
   3.73325866389676*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["relations for matrix to be Hurwitz", "Subsubsection",
 CellChangeTimes->{{3.73033537694578*^9, 3.730335378147416*^9}, {
  3.730336174865375*^9, 3.730336188206271*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q\[Psi]", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q\[Delta]\[Psi]"}], ")"}]}], "/.", 
     RowBox[{"sol\[Psi]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{
    FractionBox["J", 
     RowBox[{
      SuperscriptBox["d", "2"], "m"}]], 
    FractionBox["m", 
     RowBox[{"2", "M"}]], 
    SuperscriptBox["\[Delta]\[Delta]", 
     RowBox[{"-", "2"}]]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"fp\[Psi]", " ", "q\[Psi]", " ", "q\[Delta]\[Psi]"}], "/.", 
     RowBox[{"sol\[Psi]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{
    FractionBox["gravity", "L"], 
    FractionBox["m", 
     RowBox[{"2", " ", "M"}]], 
    FractionBox["L", "d"], 
    FractionBox[
     RowBox[{"  ", "r"}], 
     RowBox[{" ", "\[Delta]\[Delta]"}]]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.730335396904784*^9, 3.730335402860961*^9}, {
  3.730335483865934*^9, 3.730335648755677*^9}, {3.730335715459656*^9, 
  3.730335742098156*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.730335506428546*^9, {3.7303355480605173`*^9, 3.730335552458733*^9}, {
   3.730335585517189*^9, 3.730335599219153*^9}, {3.730335631556847*^9, 
   3.7303356493051662`*^9}, {3.730335728681839*^9, 3.730335743359088*^9}, 
   3.7331515049071693`*^9, 3.7332552288620863`*^9, 3.733256008088522*^9, 
   3.733258664037301*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.730335506428546*^9, {3.7303355480605173`*^9, 3.730335552458733*^9}, {
   3.730335585517189*^9, 3.730335599219153*^9}, {3.730335631556847*^9, 
   3.7303356493051662`*^9}, {3.730335728681839*^9, 3.730335743359088*^9}, 
   3.7331515049071693`*^9, 3.7332552288620863`*^9, 3.733256008088522*^9, 
   3.733258664038866*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Hurwitz conditions for \[CapitalGamma]4_tilde to be Hurwitz", "Chapter",
 CellChangeTimes->{{3.726404886617556*^9, 3.726404889361587*^9}, {
  3.73033620737868*^9, 3.730336231800116*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AAA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"kp", "+", 
           RowBox[{"fp", " ", "q", " ", "q\[Delta]"}]}], ")"}]}], ",", 
        RowBox[{"fp", " ", "kd"}], ",", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", 
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "kd"}], "}"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Step4", "[", "AAA", "]"}], ")"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.724769167506308*^9, 3.72476917329212*^9}, {
  3.724769242649148*^9, 3.724769262231865*^9}, {3.724940802437675*^9, 
  3.724940802673424*^9}, {3.7249408870805817`*^9, 3.7249408872627583`*^9}, {
  3.7292098299782248`*^9, 3.729209882981928*^9}, {3.729209920596171*^9, 
  3.7292099261929197`*^9}, {3.729210042399529*^9, 3.72921004427633*^9}, {
  3.729210309400773*^9, 3.729210331292644*^9}, {3.729210409711996*^9, 
  3.729210447627347*^9}, {3.729210520549864*^9, 3.729210520853876*^9}, {
  3.729210725275095*^9, 3.729210726720089*^9}, {3.729280249478943*^9, 
  3.7292802641122913`*^9}, {3.729281310908073*^9, 3.729281311118717*^9}, {
  3.7292909494701757`*^9, 3.729290954708137*^9}, {3.729291001261447*^9, 
  3.729291053471931*^9}, {3.729291091003559*^9, 3.729291137904512*^9}, {
  3.730336279713032*^9, 3.730336286735362*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"kd"},
      {
       RowBox[{"kd", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "q"}]}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["fp", "2"]}], " ", 
        SuperscriptBox["kd", "2"], " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q\[Delta]"}], ")"}]}]},
      {
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "q", " ", "q\[Delta]"}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.724769246684121*^9, 3.724769262935117*^9}, {
   3.724940800203587*^9, 3.724940805542137*^9}, 3.7249408928270283`*^9, 
   3.726404823814706*^9, {3.729083007883621*^9, 3.729083033987918*^9}, {
   3.7292098834420013`*^9, 3.729209927131382*^9}, 3.729210045487342*^9, {
   3.729210318558154*^9, 3.729210332011664*^9}, {3.729210413979932*^9, 
   3.729210448356039*^9}, 3.72921052150064*^9, 3.7292107280141582`*^9, {
   3.7292802277944717`*^9, 3.729280264693375*^9}, 3.729281311902917*^9, 
   3.729290957631899*^9, {3.72929100575364*^9, 3.729291057533743*^9}, {
   3.729291099658956*^9, 3.729291138432053*^9}, 3.730336235975951*^9, 
   3.730336287693247*^9, 3.733151505052231*^9, 3.733255229011799*^9, 
   3.733256008235756*^9, 3.7332586641978817`*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Symmetric T=0 and \[Theta]=!0", "Title",
 CellChangeTimes->{{3.726383870002284*^9, 3.72638387347583*^9}, {
  3.7263949107283154`*^9, 3.72639491167203*^9}, {3.7263999361231613`*^9, 
  3.726399948251811*^9}, {3.726399985484311*^9, 3.726399988188662*^9}, {
  3.726403986723899*^9, 3.726403990315816*^9}, {3.7303925470046453`*^9, 
  3.730392547165881*^9}}],

Cell[CellGroupData[{

Cell["equilibrium parametrization", "Subsubsection",
 CellChangeTimes->{{3.7303418117715607`*^9, 3.7303418168665257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Gamma]", 
    RowBox[{"eq", ",", "3"}]], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.73033219065933*^9, 3.730332250682181*^9}, {
  3.730336385986979*^9, 3.730336408567123*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification", "Chapter",
 CellChangeTimes->{{3.726394905303945*^9, 3.726394907969009*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SimplificationsParameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", " ", 
     RowBox[{"m2", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplificationsGains", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kpx1", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"kvx1", "\[Rule]", " ", "kvx"}], ",", 
     RowBox[{"kpy1", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"kvy1", "\[Rule]", " ", "kvy"}], ",", 
     RowBox[{"kpz1", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"kvz1", "\[Rule]", " ", "kvz"}], ",", 
     RowBox[{"kpx2", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"kvx2", "\[Rule]", " ", "kvx"}], ",", 
     RowBox[{"kpy2", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"kvy2", "\[Rule]", " ", "kvy"}], ",", 
     RowBox[{"kpz2", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"kvz2", "\[Rule]", " ", "kvz"}], ",", 
     RowBox[{"kp\[Psi]1", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]1", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kp\[Psi]2", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]2", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Simplifications", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"SimplificationsParameters", ",", "SimplificationsGains"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsParameters", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "SimplificationsParameters"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}]}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsGains", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"#", "/.", "SimplificationsGains"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplifications", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "Simplifications"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}]}]}], "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.726319366587973*^9, 3.7263194239291143`*^9}, {
   3.726326664972498*^9, 3.72632682474743*^9}, {3.726326908336322*^9, 
   3.726326922450852*^9}, 3.726384367929195*^9, 3.7263999822493277`*^9, {
   3.726400663768914*^9, 3.7264006798076277`*^9}, {3.7264016641585217`*^9, 
   3.7264016953976717`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stability vector field term (only for analysis)", "Chapter",
 CellChangeTimes->{{3.7120421708683567`*^9, 3.7120422205169086`*^9}, {
  3.7128306840760193`*^9, 3.71283068718001*^9}, {3.7134496094633293`*^9, 
  3.7134496232282867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DZ1SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z1SET", "[", "z1", "]"}], ",", 
      RowBox[{"{", "z1", "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.712830773527231*^9, 3.7128309192395477`*^9}, {
   3.712833495665552*^9, 3.712833508713584*^9}, {3.71283357008792*^9, 
   3.7128335976910353`*^9}, {3.71283534408328*^9, 3.712835344330735*^9}, {
   3.7128355335133457`*^9, 3.7128355336799107`*^9}, 3.712837005757556*^9, 
   3.712837065836936*^9, 3.712838456858864*^9, {3.712838505922365*^9, 
   3.712838551215933*^9}, {3.7128418281986103`*^9, 3.712841828216846*^9}, {
   3.712842173539816*^9, 3.712842173548656*^9}, {3.712847966278987*^9, 
   3.7128479662996902`*^9}, {3.712905307583363*^9, 3.712905307739265*^9}, 
   3.713449834593012*^9, {3.713600697627223*^9, 3.7136007092075443`*^9}, {
   3.724684045820299*^9, 3.724684045829007*^9}, {3.724751341533758*^9, 
   3.7247513415439157`*^9}, {3.724768463749054*^9, 3.724768468124543*^9}, {
   3.726317769433804*^9, 3.726317784338602*^9}, {3.726318444340234*^9, 
   3.7263184457061653`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["determinant of matrix being inverted is positive", "Chapter",
 CellChangeTimes->{{3.713449796880292*^9, 3.7134498095432177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"#", ".", 
       RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
    RowBox[{"DZ1SET", "[", 
     RowBox[{"z1eq", "[", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"eq", ",", "3"}]], "]"}], "]"}], "]"}], "-", 
   RowBox[{"(", 
    RowBox[{"64", " ", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["L1", "4"], " ", 
       SuperscriptBox["L2", "4"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d1", ",", "d2"}], "}"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ".", 
           RowBox[{"{", 
            RowBox[{"d1", ",", "d2"}], "}"}]}], " ", ")"}], 
         FractionBox[
          RowBox[{"1", "+", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "2"]}]}], ")"}], "2"]}], 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.726404053847056*^9, 3.7264041508479643`*^9}, 
   3.726744699247278*^9, {3.730336334296843*^9, 3.730336364022406*^9}, {
   3.730336587780734*^9, 3.730336590498774*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.726404042322948*^9, 3.72640408866853*^9, {3.726404146069633*^9, 
   3.7264041514556913`*^9}, 3.7264044493238163`*^9, 3.729082375186302*^9, {
   3.730336580962425*^9, 3.73033659115821*^9}, 3.7304130081685543`*^9, 
   3.733151505706182*^9, 3.733255229552409*^9, 3.733256008763291*^9, 
   3.7332586647401867`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Linearization matrix", "Chapter",
 CellChangeTimes->{{3.712043505293087*^9, 3.712043512378201*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["A", "0"], ",", 
      SubscriptBox["A", "1"]}], "}"}], "=", 
    RowBox[{"Linearization", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Z1cl", "[", 
        RowBox[{"#", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "3"}]]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z1SET", "[", "#", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"z1eq", "[", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"eq", ",", "3"}]], "]"}], ",", "\[IndentingNewLine]", 
      "ApplySimplificationsParameters"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.72666434496215*^9, 3.726664349991723*^9}, {
   3.7266669004646597`*^9, 3.726666923433338*^9}, 3.726666979922227*^9, {
   3.7266671119182053`*^9, 3.7266671744373302`*^9}, {3.7266680966497917`*^9, 
   3.726668098366765*^9}, {3.7303366392770157`*^9, 3.73033664187505*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "unit", " ", "vector", " ", "of", " ", "dimension", " ", "of", " ", 
    "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "i_", "]"}], ":=", 
    RowBox[{"UnitVector", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dimensions", "[", "z1", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}]}], ";"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{"e_", ",", "n_", ",", "A_"}], "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplySimplificationsParameters", "[", 
      RowBox[{"#", ".", "A"}], "]"}], "&"}], ",", "e", ",", 
    RowBox[{"n", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainOfIntegrators", "[", 
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], ",", "4", ",", 
     SubscriptBox["A", "1"]}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7263257888187017`*^9, 3.7263258724726763`*^9}, {
   3.7263259166627893`*^9, 3.726326042888208*^9}, {3.7263261879160957`*^9, 
   3.7263261983325*^9}, 3.726326848143663*^9, {3.726401180794229*^9, 
   3.7264012066514063`*^9}, 3.726401274598877*^9, {3.726401316284745*^9, 
   3.726401317346849*^9}, {3.726401351085499*^9, 3.726401371861828*^9}, {
   3.726401449864523*^9, 3.726401452127983*^9}, {3.7264043428019533`*^9, 
   3.726404351437282*^9}, {3.730336691878427*^9, 3.730336692781996*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["gravity", "L"]}], "0", "0", "0", "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["gravity", "L"]}], "0", "0", "0", "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0", 
      FractionBox["gravity", 
       RowBox[{"2", " ", "L"}]], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.730336683795156*^9, 3.730336693174904*^9}, 
   3.73041302129985*^9, 3.733151518076082*^9, 3.733255237569581*^9, 
   3.733256016522592*^9, 3.733258672622189*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
    RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "6", "]"}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "7", "]"}], "-", 
          RowBox[{"e", "[", "10", "]"}]}], ",", "2", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", "4", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", "4", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "5", "]"}], ",", "4", ",", "A"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PPA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
    RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PA", "[", "A", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DZ1SET", "[", 
        RowBox[{"z1eq", "[", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "3"}]], "]"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["P", "0"], "=", 
   RowBox[{"PPA", "[", 
    SubscriptBox["A", "0"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "1"], "=", 
    RowBox[{"PPA", "[", 
     SubscriptBox["A", "1"], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Dimensions", "[", 
    SubscriptBox["P", "0"], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MatrixRank", "[", 
    SubscriptBox["P", "0"], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "0"], "//", "MatrixForm"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "1"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
   3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
   3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
   3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
   3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
   3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
   3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}, {
   3.712831094381729*^9, 3.712831095820244*^9}, {3.712831148394435*^9, 
   3.7128311596982203`*^9}, {3.7128311998383636`*^9, 3.712831230922905*^9}, {
   3.71283380404528*^9, 3.712833817585775*^9}, {3.7128338578199453`*^9, 
   3.7128339145293837`*^9}, {3.712834032813575*^9, 3.712834033874092*^9}, {
   3.712836024098538*^9, 3.7128360488484507`*^9}, {3.71283609327536*^9, 
   3.712836118528947*^9}, {3.712836924452547*^9, 3.712836958498642*^9}, {
   3.712844426115212*^9, 3.71284450242596*^9}, {3.7128449771537046`*^9, 
   3.712845086412121*^9}, {3.712848439443294*^9, 3.7128485151925364`*^9}, {
   3.712944738222735*^9, 3.712944749777299*^9}, {3.712988102089939*^9, 
   3.7129881257009773`*^9}, {3.7134500543777742`*^9, 3.713450055447535*^9}, {
   3.724678693813246*^9, 3.724678697955299*^9}, {3.7246823296039057`*^9, 
   3.724682336385404*^9}, {3.724682370244699*^9, 3.7246823710267973`*^9}, {
   3.724683277507218*^9, 3.7246833021887293`*^9}, {3.7246834824509897`*^9, 
   3.724683513686524*^9}, {3.724684763780971*^9, 3.724684886425336*^9}, {
   3.72468839967736*^9, 3.724688410177302*^9}, {3.7247417260960283`*^9, 
   3.724741737955247*^9}, {3.724751538261547*^9, 3.7247516157283382`*^9}, {
   3.724751670903892*^9, 3.724751672969146*^9}, {3.724751760644328*^9, 
   3.72475178892412*^9}, {3.724751820655284*^9, 3.724751832936578*^9}, {
   3.724751999539131*^9, 3.724752021780467*^9}, 3.724752097482242*^9, {
   3.724752161886855*^9, 3.724752168133781*^9}, {3.724752446862174*^9, 
   3.724752448614086*^9}, {3.724757996420842*^9, 3.72475800444925*^9}, {
   3.7247580472472982`*^9, 3.724758052534409*^9}, {3.724758086078887*^9, 
   3.7247581075217037`*^9}, {3.724758396290547*^9, 3.724758408015748*^9}, {
   3.724758470544146*^9, 3.724758473931033*^9}, 3.7247586153657417`*^9, {
   3.724759149139023*^9, 3.724759151388007*^9}, {3.724759288648301*^9, 
   3.724759302491118*^9}, {3.724768760869358*^9, 3.724768800242721*^9}, {
   3.7247688560626087`*^9, 3.724768863292123*^9}, {3.724768936314774*^9, 
   3.724768950040413*^9}, 3.7247720001122103`*^9, {3.724853635498878*^9, 
   3.7248536406972437`*^9}, {3.726318927086563*^9, 3.726319024616363*^9}, {
   3.726326206275281*^9, 3.726326416142439*^9}, {3.726326454606626*^9, 
   3.726326455720798*^9}, {3.7263265943687067`*^9, 3.726326611353199*^9}, {
   3.7263268511347427`*^9, 3.7263268535081244`*^9}, {3.726336547766362*^9, 
   3.726336572881345*^9}, {3.726401395223534*^9, 3.726401404887206*^9}, {
   3.726404372949839*^9, 3.7264044116383867`*^9}, 3.726404469736986*^9, {
   3.730336653355708*^9, 3.73033671908608*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant of similarity matrix", "Chapter",
 CellChangeTimes->{{3.72927489284953*^9, 3.729274902051298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "0"], "]"}], "-", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["gravity", "6"], " ", 
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox["J", "2"], " ", 
       SuperscriptBox["L", "10"]}]]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "1"], "]"}], "-", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["gravity", "6"], " ", 
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox["J", "2"], " ", 
       SuperscriptBox["L", "10"]}]]}], ")"}]}], "//", "Simplify"}]}], "Input",\

 CellChangeTimes->{{3.730336809335566*^9, 3.7303368237102633`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.730336804205954*^9, 3.730336824244089*^9}, 
   3.730413021490299*^9, 3.7331515182880707`*^9, 3.7332552377759037`*^9, 
   3.733256016736006*^9, 3.7332586728274717`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.730336804205954*^9, 3.730336824244089*^9}, 
   3.730413021490299*^9, 3.7331515182880707`*^9, 3.7332552377759037`*^9, 
   3.733256016736006*^9, 3.733258672856699*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
State matrix after similarity transformation (check block triangular \
structure)\
\>", "Chapter",
 CellChangeTimes->{3.730332400811451*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], " ", "=", 
   RowBox[{"ApplySimplifications", "[", 
    RowBox[{
     SubscriptBox["P", "1"], ".", 
     SubscriptBox["A", "1"], ".", 
     RowBox[{"Inverse", "[", 
      SubscriptBox["P", "1"], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["Asimilar", "1"], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7303368740591*^9, 3.730336874233667*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           SuperscriptBox["M", "2"]}], ")"}]}], "-", 
        RowBox[{"L", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "kpz", " ", "M"}], "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
              RowBox[{"m", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"6", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["m", "2"]}], "+", 
           SuperscriptBox["M", "2"]}], ")"}]}], "-", 
        RowBox[{"L", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "kpz", " ", "M"}], "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
              RowBox[{"m", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "M", " ", "\[Lambda]"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"6", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "gravity"}], " ", "m"}], "-", 
          RowBox[{"2", " ", "kpz", " ", "L", " ", "M"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "-", 
             RowBox[{"2", " ", "kpz", " ", "L", " ", "M"}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
        RowBox[{"J", "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "M"}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "M", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}], 
        RowBox[{"4", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"J", "-", "M"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", "M", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["d", "2"]}], ")"}], " ", "kpz", " ", "M"}], 
              "+", 
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "\[Lambda]"}], "+", 
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", "M", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "L", " ", 
            SuperscriptBox["M", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kpz", "+", 
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], ")"}], 
            " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["d", "2"], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gravity", " ", 
           RowBox[{"(", 
            RowBox[{"J", "-", "M"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "M"}], ")"}]}], "+", 
          RowBox[{"L", " ", "M", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["d", "2"]}], ")"}], " ", "kpz", " ", "M"}], 
             "+", 
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", "\[Lambda]"}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", "M", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], 
               ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "L", " ", 
           SuperscriptBox["M", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"kpz", "+", 
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], ")"}], 
           " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["d", "2"], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "M"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "M", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kvz", " ", "L", " ", "M", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["d", "2"], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", "kvz", " ", "L", " ", "M", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["d", "2"], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "M"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "M", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "4"], " ", "gravity", " ", "m"}], "+", 
          RowBox[{"J", " ", "L", " ", 
           SuperscriptBox["\[Lambda]", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "+", 
             RowBox[{"L", " ", "M", " ", "\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d", "2"], " ", "gravity", " ", "m"}], "+", 
             RowBox[{"L", " ", "M", " ", "\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "kvz"}], "+", "\[Lambda]"}], ")"}]}]}], ")"}], 
           " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       RowBox[{"2", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["d", "2"], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "M"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "M", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]], "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m", " ", 
         RowBox[{"Tan", "[", "\[Theta]", "]"}]}], 
        RowBox[{"L", " ", "M"}]]}], "0", 
      RowBox[{
       RowBox[{"-", "kpx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m", " ", 
        RowBox[{"Sec", "[", "\[Theta]", "]"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kvy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kvy", " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvy"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.730332402894513*^9, 3.73033435639926*^9, 
  3.730336879780116*^9, 3.730413024502132*^9, 3.733151521368249*^9, 
  3.733255239587792*^9, 3.733256018538625*^9, 3.733258674669675*^9}]
}, Open  ]]
}, Closed]],

Cell["\<\
Angular z and angular x motion are coupled: all the rest is the same\
\>", "Chapter",
 CellChangeTimes->{{3.726404624851185*^9, 3.726404642707666*^9}}],

Cell[CellGroupData[{

Cell["Angular z and angular x motion are coupled: matrix ", "Chapter",
 CellChangeTimes->{{3.730336953486518*^9, 3.730336966529961*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], " ", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"3", ";;", "6"}], ",", 
       RowBox[{"3", ";;", "6"}]}], "]"}], "]"}], "-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox["J", 
           RowBox[{
            SuperscriptBox["d", "2"], "m"}]], 
          FractionBox["m", 
           RowBox[{"2", "M"}]], 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]]}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz"}], "-", " ", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Tan", "[", "\[Theta]", "]"}], "2"], " ", "fpx"}]}], 
           " ", ",", 
           RowBox[{"-", "kvz"}], ",", "0", ",", "0"}], "}"}], "-", 
         RowBox[{
          FractionBox["fpx", 
           RowBox[{"2", "d"}]], " ", 
          RowBox[{"Tan", "[", "\[Theta]", "]"}], 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}]}], ")"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d", " ", 
         RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", "fpx"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "kpx"}], "-", " ", "fpx"}], ",", 
        RowBox[{"-", "kvx"}]}], "}"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"fpx", "\[Rule]", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"gravity", " "}], 
       RowBox[{" ", "L"}]], 
      FractionBox["m", 
       RowBox[{"2", "M"}]]}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7290866145368347`*^9, 3.729086620128954*^9}, {
  3.7290867014275923`*^9, 3.729087083425228*^9}, {3.729087186821496*^9, 
  3.7290872110903463`*^9}, {3.72920060369267*^9, 3.729200648419804*^9}, {
  3.7303369047528343`*^9, 3.73033692393661*^9}, {3.7332547294073257`*^9, 
  3.733254741581106*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7290867912654533`*^9, 3.729086964970016*^9}, {
   3.7290870056893663`*^9, 3.7290870539572277`*^9}, 3.729087086605753*^9, 
   3.7290872116611977`*^9, 3.7292006491913433`*^9, {3.730336906359989*^9, 
   3.73033692458252*^9}, 3.73041302468427*^9, 3.7331515215459642`*^9, 
   3.733255239805335*^9, 3.7332560187503023`*^9, 3.73325867488636*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Angular z and angular x motion are coupled:", "Chapter",
 CellChangeTimes->{{3.726404624851185*^9, 3.726404642707666*^9}, {
  3.730336971198328*^9, 3.730336975696707*^9}}],

Cell[CellGroupData[{

Cell["\<\
if we write in controllable form, we get products of gains, and it becomes \
hard to analyze\
\>", "Subsubsection",
 CellChangeTimes->{{3.730336977733433*^9, 3.73033700069457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#2", ".", "#1", ".", 
         RowBox[{"Inverse", "[", "#2", "]"}]}], "&"}], ")"}], "[", 
      RowBox[{"#", ",", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "4", ",", 
         "#"}], "]"}]}], "]"}], "&"}], "[", 
    RowBox[{
     SubscriptBox["Asimilar", "1"], " ", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"3", ";;", "6"}], ",", 
       RowBox[{"3", ";;", "6"}]}], "]"}], "]"}], "]"}], "//", "Simplify"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{3.726404595859439*^9, 3.730413052593758*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"kpx", "+", "kpz"}], ")"}], " ", "m"}], "+", 
           RowBox[{"2", " ", "kpx", " ", "kpz", " ", "L", " ", "M"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "kpx"}], "+", "kpz"}], ")"}], " ", "m"}], "+", 
              RowBox[{"2", " ", "kpx", " ", "kpz", " ", "L", " ", "M"}]}], 
             ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"kvx", "+", "kvz"}], ")"}], " ", "m"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpz", " ", "kvx"}], "+", 
              RowBox[{"kpx", " ", "kvz"}]}], ")"}], " ", "L", " ", "M"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "kvx"}], "+", "kvz"}], ")"}], " ", "m"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpz", " ", "kvx"}], "+", 
                 RowBox[{"kpx", " ", "kvz"}]}], ")"}], " ", "L", " ", "M"}]}],
              ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "L", " ", "M", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"J", " ", "kpx"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"kpx", "+", "kpz", "+", 
               RowBox[{"kvx", " ", "kvz"}]}], ")"}], " ", "M"}]}], ")"}]}], 
         "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"kpx", "+", "kpz", "+", 
            RowBox[{"kvx", " ", "kvz"}]}], ")"}], " ", "L", " ", 
          SuperscriptBox["M", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
        RowBox[{"2", " ", "L", " ", "M", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"J", " ", "kvx"}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"kvx", "+", "kvz"}], ")"}], " ", "M"}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"kvx", "+", "kvz"}], ")"}], " ", "M", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
        RowBox[{"J", "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "M"}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "M", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.726404597526545*^9, 3.7290829883036537`*^9, 
  3.7304130248465633`*^9, 3.730413056845895*^9, 3.7331515251241083`*^9, 
  3.733255242049733*^9, 3.733256020863017*^9, 3.733258677005608*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Routh-Hurwitz analysis", "Chapter",
 CellChangeTimes->{{3.726404886617556*^9, 3.726404889361587*^9}, {
  3.730337005031929*^9, 3.730337008546884*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AAA", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a1"}], ",", 
       RowBox[{"-", "b1"}], ",", "\[Gamma]1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]2", ",", "0", ",", 
       RowBox[{"-", "a2"}], ",", 
       RowBox[{"-", "b2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AAA", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPP", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a1"}], ",", 
       RowBox[{"-", "b1"}], ",", "\[Gamma]1", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a1"}], ",", 
        RowBox[{"-", "b1"}], ",", "\[Gamma]1", ",", "0"}], "}"}], ".", 
      "AAA"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Det", "[", "PPP", "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPP", ".", "AAA", ".", 
    RowBox[{"Inverse", "[", "PPP", "]"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Step4", "[", 
     RowBox[{"PPP", ".", "AAA", ".", 
      RowBox[{"Inverse", "[", "PPP", "]"}]}], "]"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Step4", "[", 
       RowBox[{"PPP", ".", "AAA", ".", 
        RowBox[{"Inverse", "[", "PPP", "]"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]2", "\[Rule]", "0"}], " ", "}"}]}], ")"}]}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Step4", "[", 
      RowBox[{"PPP", ".", "AAA", ".", 
       RowBox[{"Inverse", "[", "PPP", "]"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]2", "\[Rule]", "0"}], " ", "}"}]}], ")"}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.724769167506308*^9, 3.72476917329212*^9}, {
   3.724769242649148*^9, 3.724769262231865*^9}, {3.724940802437675*^9, 
   3.724940802673424*^9}, {3.7249408870805817`*^9, 3.7249408872627583`*^9}, {
   3.730337011316687*^9, 3.7303370119690313`*^9}, 3.7332548606302767`*^9, 
   3.733254894619731*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "b1"}], "\[Gamma]1", "0"},
     {"0", "0", "0", "1"},
     {"\[Gamma]2", "0", 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "b2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.724769246684121*^9, 3.724769262935117*^9}, {
   3.724940800203587*^9, 3.724940805542137*^9}, 3.7249408928270283`*^9, 
   3.726404823814706*^9, {3.729083007883621*^9, 3.729083033987918*^9}, 
   3.73033701250921*^9, 3.730413024974496*^9, 3.7304130607036657`*^9, 
   3.73041319190802*^9, 3.733151525206238*^9, 3.7332552421873913`*^9, 
   3.733256020988619*^9, 3.733258677149189*^9}],

Cell[BoxData[
 SuperscriptBox["\[Gamma]1", "2"]], "Output",
 CellChangeTimes->{{3.724769246684121*^9, 3.724769262935117*^9}, {
   3.724940800203587*^9, 3.724940805542137*^9}, 3.7249408928270283`*^9, 
   3.726404823814706*^9, {3.729083007883621*^9, 3.729083033987918*^9}, 
   3.73033701250921*^9, 3.730413024974496*^9, 3.7304130607036657`*^9, 
   3.73041319190802*^9, 3.733151525206238*^9, 3.7332552421873913`*^9, 
   3.733256020988619*^9, 3.7332586771536217`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "a1"}], " ", "a2"}], "+", 
       RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a2"}], " ", "b1"}], "-", 
       RowBox[{"a1", " ", "b2"}]}], 
      RowBox[{
       RowBox[{"-", "a1"}], "-", "a2", "-", 
       RowBox[{"b1", " ", "b2"}]}], 
      RowBox[{
       RowBox[{"-", "b1"}], "-", "b2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.724769246684121*^9, 3.724769262935117*^9}, {
   3.724940800203587*^9, 3.724940805542137*^9}, 3.7249408928270283`*^9, 
   3.726404823814706*^9, {3.729083007883621*^9, 3.729083033987918*^9}, 
   3.73033701250921*^9, 3.730413024974496*^9, 3.7304130607036657`*^9, 
   3.73041319190802*^9, 3.733151525206238*^9, 3.7332552421873913`*^9, 
   3.733256020988619*^9, 3.733258677177575*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"b1", "+", "b2"}], ")"}], "2"], " ", "\[Gamma]1", " ", 
        "\[Gamma]2"}]},
      {
       RowBox[{
        RowBox[{"-", "\[Gamma]1"}], " ", "\[Gamma]2"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.724769246684121*^9, 3.724769262935117*^9}, {
   3.724940800203587*^9, 3.724940805542137*^9}, 3.7249408928270283`*^9, 
   3.726404823814706*^9, {3.729083007883621*^9, 3.729083033987918*^9}, 
   3.73033701250921*^9, 3.730413024974496*^9, 3.7304130607036657`*^9, 
   3.73041319190802*^9, 3.733151525206238*^9, 3.7332552421873913`*^9, 
   3.733256020988619*^9, 3.733258677246286*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {
       RowBox[{"b1", "+", "b2"}]},
      {
       RowBox[{
        RowBox[{"a1", " ", "b1"}], "+", 
        RowBox[{"b2", " ", 
         RowBox[{"(", 
          RowBox[{"a2", "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"b1", "+", "b2"}], ")"}]}]}], ")"}]}]}]},
      {
       RowBox[{"b1", " ", "b2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a1", "2"], "+", 
          RowBox[{"a2", " ", 
           RowBox[{"(", 
            RowBox[{"a2", "+", 
             RowBox[{"b1", " ", 
              RowBox[{"(", 
               RowBox[{"b1", "+", "b2"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"a1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "a2"}], "+", 
             RowBox[{"b2", " ", 
              RowBox[{"(", 
               RowBox[{"b1", "+", "b2"}], ")"}]}]}], ")"}]}]}], ")"}]}]},
      {
       RowBox[{"a1", " ", "a2"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.724769246684121*^9, 3.724769262935117*^9}, {
   3.724940800203587*^9, 3.724940805542137*^9}, 3.7249408928270283`*^9, 
   3.726404823814706*^9, {3.729083007883621*^9, 3.729083033987918*^9}, 
   3.73033701250921*^9, 3.730413024974496*^9, 3.7304130607036657`*^9, 
   3.73041319190802*^9, 3.733151525206238*^9, 3.7332552421873913`*^9, 
   3.733256020988619*^9, 3.733258677273939*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Routh-Hurwitz criterion (note that a1, a2, b1, b2 are all positive): 
all terms in 1st column in Routh Hurwitz table are positive if a1 \
a2-\[Gamma]1\[Gamma]2>0\
\>", "Subsubsection",
 CellChangeTimes->{{3.730413553932073*^9, 3.7304136405558863`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Step4", "[", 
    RowBox[{"PPP", ".", "AAA", ".", 
     RowBox[{"Inverse", "[", "PPP", "]"}]}], "]"}], "//", "FullSimplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Step4", "[", 
     RowBox[{"PPP", ".", "AAA", ".", 
      RowBox[{"Inverse", "[", "PPP", "]"}]}], "]"}], "-", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"1", ",", "\[IndentingNewLine]", 
      RowBox[{"b1", "+", "b2"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a1", " ", "b1"}], "+", 
       RowBox[{"a2", " ", "b2"}], " ", "+", 
       RowBox[{"b2", " ", "b1", " ", 
        RowBox[{"(", 
         RowBox[{"b1", "+", "b2"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b1", " ", "b2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a1", "-", "a2"}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a1", " ", "b2"}], " ", "+", 
             RowBox[{"a2", " ", "b1"}]}], " ", ")"}], 
           RowBox[{"(", 
            RowBox[{"b1", "+", "b2"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"b1", "+", "b2"}], ")"}], "2"], " ", "\[Gamma]1", " ", 
        "\[Gamma]2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a1", " ", "a2"}], "-", 
       RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}]}]}], "\[IndentingNewLine]", 
     "}"}]}], "//", "FullSimplify"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{
  3.730413206138191*^9, {3.730413345929983*^9, 3.73041346360385*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {
       RowBox[{"b1", "+", "b2"}]},
      {
       RowBox[{
        RowBox[{"a1", " ", "b1"}], "+", 
        RowBox[{"b2", " ", 
         RowBox[{"(", 
          RowBox[{"a2", "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"b1", "+", "b2"}], ")"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"b1", " ", "b2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a1", "2"], "+", 
           RowBox[{"a2", " ", 
            RowBox[{"(", 
             RowBox[{"a2", "+", 
              RowBox[{"b1", " ", 
               RowBox[{"(", 
                RowBox[{"b1", "+", "b2"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"a1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "a2"}], "+", 
              RowBox[{"b2", " ", 
               RowBox[{"(", 
                RowBox[{"b1", "+", "b2"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"b1", "+", "b2"}], ")"}], "2"], " ", "\[Gamma]1", " ", 
         "\[Gamma]2"}]}]},
      {
       RowBox[{
        RowBox[{"a1", " ", "a2"}], "-", 
        RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.73041320704072*^9, {3.730413373215205*^9, 3.730413408950343*^9}, {
   3.730413448278274*^9, 3.730413464135483*^9}, 3.733151525609042*^9, 
   3.733255242459198*^9, 3.733256021258898*^9, 3.7332586774267807`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.73041320704072*^9, {3.730413373215205*^9, 3.730413408950343*^9}, {
   3.730413448278274*^9, 3.730413464135483*^9}, 3.733151525609042*^9, 
   3.733255242459198*^9, 3.733256021258898*^9, 3.733258677443192*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Our particular matrix is given by", "Subsubsection",
 CellChangeTimes->{{3.730413651751349*^9, 3.730413659872149*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["Asimilar", "1"], " ", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"3", ";;", "6"}], ",", 
      RowBox[{"3", ";;", "6"}]}], "]"}], "]"}], "//", "MatrixForm"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.72908326305259*^9, 3.7290832639925127`*^9}, {
  3.730337024484026*^9, 3.730337032306962*^9}, {3.7303374610410433`*^9, 
  3.730337462792494*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "gravity"}], " ", "m"}], "-", 
          RowBox[{"2", " ", "kpz", " ", "L", " ", "M"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "-", 
             RowBox[{"2", " ", "kpz", " ", "L", " ", "M"}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], 
        RowBox[{"J", "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "M"}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "M", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}], 
        RowBox[{"4", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M"}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", "M", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}], "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", "m", " ", 
         RowBox[{"Tan", "[", "\[Theta]", "]"}]}], 
        RowBox[{"L", " ", "M"}]]}], "0", 
      RowBox[{
       RowBox[{"-", "kpx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kvx"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7290832642734747`*^9, {3.7303370190394773`*^9, 3.73033703298755*^9}, 
   3.730337064654016*^9, 3.730337463209621*^9, 3.730413105947258*^9, 
   3.730413268070148*^9, 3.7331515258143673`*^9, 3.733255242622039*^9, 
   3.73325602141536*^9, 3.7332586775911903`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thus condition the  a1 a2-\[Gamma]1\[Gamma]2>0 reads as ...", \
"Subsubsection",
 CellChangeTimes->{{3.7304136742495413`*^9, 3.730413684487089*^9}, {
  3.730414109861969*^9, 3.730414110671743*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a1", " ", "a2"}], "-", 
        RowBox[{"\[Gamma]1", " ", "\[Gamma]2"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a1", "\[Rule]", " ", 
         RowBox[{"-", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ",", 
        RowBox[{"a2", "\[Rule]", " ", 
         RowBox[{"-", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "3"}], "]"}], "]"}]}]}], ",", 
        RowBox[{"\[Gamma]1", "\[Rule]", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
        RowBox[{"\[Gamma]2", "\[Rule]", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}]}]}], "}"}]}], "&"}], "[", 
    RowBox[{
     SubscriptBox["Asimilar", "1"], " ", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"3", ";;", "6"}], ",", 
       RowBox[{"3", ";;", "6"}]}], "]"}], "]"}], "]"}], "//", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "-", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"gravity", " "}], "L"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["d", "2"], "m"}], "J"], 
    FractionBox["1", 
     RowBox[{" ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["d", "2"], "m"}], "J"], 
         FractionBox["M", "m"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ")"}]}]}], ")"}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kpz", "  ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
      RowBox[{"kpx", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
      RowBox[{"kpx", " ", "kpz", " ", 
       FractionBox["L", "gravity"], "  ", 
       FractionBox[
        RowBox[{"2", "  ", "M"}], "m"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.730413298364172*^9, 3.730413308344028*^9}, {
  3.730413691972131*^9, 3.730413811894396*^9}, {3.730413854522963*^9, 
  3.730414070622199*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.730413271137972*^9, {3.730413303326872*^9, 3.7304133086784554`*^9}, 
   3.730413686917688*^9, {3.730413887253448*^9, 3.730413943256802*^9}, 
   3.730413988965131*^9, 3.730414031578019*^9, 3.730414071503992*^9, 
   3.733151526613347*^9, 3.733255243134398*^9, 3.733256021920485*^9, 
   3.733258678101576*^9}]
}, Open  ]]
}, Open  ]],

Cell["... which is always positive, for positive gains kpz and kpx", \
"Subsubsection",
 CellChangeTimes->{{3.730414082940497*^9, 3.730414108647011*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Under-actuated UAVs", "Title",
 CellChangeTimes->{{3.726218136123291*^9, 3.726218140880265*^9}, {
  3.726218308165967*^9, 3.7262183129326077`*^9}}],

Cell[CellGroupData[{

Cell["State and input decomposition (these are dummy names)", "Chapter",
 CellChangeTimes->{3.726218154257197*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "state", " ", "is", " ", "constructed", " ", "on", " ", "top",
     " ", "of", " ", "the", " ", "state", " ", "defined", " ", "for", " ", 
    "fully", " ", "actuated", " ", "UAVs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r1", "=", 
     RowBox[{"{", 
      RowBox[{"r1x", ",", "r1y", ",", "r1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2", "=", 
     RowBox[{"{", 
      RowBox[{"r2x", ",", "r2y", ",", "r2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"full", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z2", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"z1", ",", "r1", ",", "r2"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7262181664650507`*^9, 3.7262182147790127`*^9}, {
  3.726668841341745*^9, 3.726668842024454*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["State set (in manuscript ZSET is called f)", "Chapter",
 CellChangeTimes->{{3.7134482064870863`*^9, 3.713448228580737*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z2SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
      "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_"}], "}"}], "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Z1SET", "[", "z1", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1", ".", "r1"}], "-", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r2", ".", "r2"}], "-", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9, {3.724684010957909*^9, 
   3.724684014373664*^9}, {3.724751269757082*^9, 3.7247512733298903`*^9}, 
   3.726212948183769*^9, {3.726212999176859*^9, 3.7262130404501057`*^9}, {
   3.726213147312001*^9, 3.7262132452794027`*^9}, {3.730340379500945*^9, 
   3.730340381386614*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tangent set", "Chapter",
 CellChangeTimes->{{3.7134482603686028`*^9, 3.713448262456069*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]r1", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]p1x", ",", "\[Delta]p1y", ",", "\[Delta]p1z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]r2", "=", 
   RowBox[{"{", 
    RowBox[{"\[Delta]p2x", ",", "\[Delta]p2y", ",", "\[Delta]p2z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]z2", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"\[Delta]z1", ",", "\[Delta]r1", ",", "\[Delta]r2"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TangentZ2SET", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
       "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\[Delta]px_", ",", "\[Delta]py_", ",", "\[Delta]pz_", ",", 
       "\[Delta]nx_", ",", "\[Delta]ny_", ",", "\[Delta]nz_", ",", 
       "\[Delta]p1x_", ",", "\[Delta]p1y_", ",", "\[Delta]p1z_", ",", 
       "\[Delta]p2x_", ",", "\[Delta]p2y_", ",", "\[Delta]p2z_", ",", 
       "\[Delta]vx_", ",", "\[Delta]vy_", ",", "\[Delta]vz_", ",", 
       "\[Delta]\[Omega]x_", ",", "\[Delta]\[Omega]y_", ",", 
       "\[Delta]\[Omega]z_", ",", "\[Delta]v1x_", ",", "\[Delta]v1y_", ",", 
       "\[Delta]v1z_", ",", "\[Delta]v2x_", ",", "\[Delta]v2y_", ",", 
       "\[Delta]v2z_", ",", "\[Delta]r1x_", ",", "\[Delta]r1y_", ",", 
       "\[Delta]r1z_", ",", "\[Delta]r2x_", ",", "\[Delta]r2y_", ",", 
       "\[Delta]r2z_"}], "}"}]}], "\[IndentingNewLine]", "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"TangentZ1SET", "[", 
      RowBox[{"z1", ",", "\[Delta]z1"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"r1", ".", "\[Delta]r1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"r2", ".", "\[Delta]r2"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9, {3.724684010957909*^9, 
   3.724684014373664*^9}, {3.724751269757082*^9, 3.7247512733298903`*^9}, 
   3.726212948183769*^9, {3.726212999176859*^9, 3.7262130404501057`*^9}, {
   3.726213147312001*^9, 3.7262132452794027`*^9}, {3.726213342934226*^9, 
   3.7262133755144367`*^9}, {3.726213419475425*^9, 3.7262134962378607`*^9}, {
   3.726213538279138*^9, 3.726213622168783*^9}, 3.726218518843788*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Function that generates arbitrary element of state set", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
   3.666784754227034*^9, 3.6667847600915203`*^9}, {3.713448271503984*^9, 
   3.713448298749484*^9}, 3.726218484488826*^9, 3.726218536282724*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z2l", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z1l", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "18"}], "]"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"uv3", "[", 
       RowBox[{"{", 
        RowBox[{"\[Gamma]11", ",", "\[Gamma]12"}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"uv3", "[", 
       RowBox[{"{", 
        RowBox[{"\[Gamma]21", ",", "\[Gamma]22"}], "}"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Gamma]11", ",", "\[Gamma]12"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]21", ",", "\[Gamma]22"}], "}"}]}], "]"}], "\[Rule]",
       " ", 
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"19", ";;", "22"}], "]"}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z2lR", "[", "]"}], ":=", 
   RowBox[{"z2l", "[", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "22"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z2lR", "[", "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Z2SET", "[", 
    RowBox[{"z2l", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "#"], "&"}], ",", "22"}], "]"}], "]"}], "]"}], 
   "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.697118200248754*^9, 3.697118239535376*^9}, {
   3.697118360659931*^9, 3.697118470468795*^9}, {3.697118689203661*^9, 
   3.6971187966698236`*^9}, {3.6971188307685328`*^9, 
   3.6971188421873293`*^9}, {3.697118878196802*^9, 3.697118974011015*^9}, {
   3.697119006213297*^9, 3.6971190396741123`*^9}, {3.6971390020228662`*^9, 
   3.697139009318285*^9}, {3.697139373346467*^9, 3.697139374878284*^9}, {
   3.697139414268791*^9, 3.697139469001493*^9}, {3.697141223768364*^9, 
   3.697141227711032*^9}, {3.69731249658494*^9, 3.697312510042843*^9}, {
   3.697400254573415*^9, 3.697400273661202*^9}, {3.697400303986665*^9, 
   3.69740057700772*^9}, {3.697400609630624*^9, 3.697400609841353*^9}, {
   3.698055377956704*^9, 3.698055400306435*^9}, {3.6980554414583282`*^9, 
   3.698055483594681*^9}, {3.7116174218139544`*^9, 3.711617421827387*^9}, 
   3.7116176007977867`*^9, {3.711617938728627*^9, 3.7116180228914537`*^9}, {
   3.711621070398707*^9, 3.711621081343431*^9}, {3.711715923540648*^9, 
   3.711715992726617*^9}, {3.711717833103348*^9, 3.711717833110628*^9}, {
   3.7117370649094048`*^9, 3.7117370657243958`*^9}, {3.712038037186582*^9, 
   3.712038054528998*^9}, {3.712841289703867*^9, 3.712841352076231*^9}, {
   3.712841392500101*^9, 3.712841558909223*^9}, {3.7128421149733753`*^9, 
   3.7128421239142103`*^9}, {3.712842751772552*^9, 3.712842776049879*^9}, {
   3.7128428291157846`*^9, 3.712842830499154*^9}, {3.7128433773066273`*^9, 
   3.712843431773552*^9}, {3.71284394430901*^9, 3.712843966942237*^9}, {
   3.7128479117985287`*^9, 3.712847930833536*^9}, {3.71344832098267*^9, 
   3.7134483254863033`*^9}, 3.71344970442523*^9, {3.72468409489301*^9, 
   3.72468422406437*^9}, {3.724751280547143*^9, 3.7247512918682213`*^9}, 
   3.7247513605213118`*^9, {3.7262099792998047`*^9, 3.726210290407324*^9}, {
   3.72621032100861*^9, 3.7262104064197474`*^9}, {3.726210456219047*^9, 
   3.726210526852673*^9}, {3.7262105855034237`*^9, 3.726210693104999*^9}, {
   3.7262107376497*^9, 3.726210766210454*^9}, {3.7262137700448103`*^9, 
   3.7262138524391937`*^9}, {3.726213892177824*^9, 3.726213918392188*^9}, 
   3.726213984449662*^9, {3.730340388985578*^9, 3.7303403895194693`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.713448323233808*^9, 3.713448390223907*^9, {3.713449634163185*^9, 
   3.713449645340069*^9}, {3.713449706025828*^9, 3.7134497188018837`*^9}, 
   3.71360058842673*^9, {3.7136006685489397`*^9, 3.713600682113246*^9}, 
   3.714029480515603*^9, 3.714034017964863*^9, 3.724671517202312*^9, 
   3.724671687504498*^9, 3.7246758700137177`*^9, 3.724676565820986*^9, 
   3.724676708693903*^9, 3.724677313584942*^9, 3.7246779327917852`*^9, 
   3.7246781901384*^9, 3.724678631696704*^9, 3.7246822965985518`*^9, 
   3.724682534169868*^9, 3.724683539680078*^9, 3.7246837388220387`*^9, {
   3.724684206373262*^9, 3.724684225708366*^9}, 3.724684320378913*^9, 
   3.724684701468829*^9, 3.7247512999918547`*^9, {3.724751352914468*^9, 
   3.724751361217469*^9}, 3.724754557375256*^9, 3.724761570143579*^9, 
   3.724768422747458*^9, 3.724768684256563*^9, 3.7248535843393993`*^9, 
   3.724855818111979*^9, 3.7248562265875893`*^9, 3.724910239304582*^9, 
   3.724937949211851*^9, {3.725038001976623*^9, 3.725038030182336*^9}, 
   3.725038087554584*^9, 3.7251856223217793`*^9, 3.725211682778277*^9, 
   3.725354734439815*^9, 3.726209932674185*^9, {3.726209975004208*^9, 
   3.726209998167625*^9}, {3.726210507460998*^9, 3.7262105411906033`*^9}, {
   3.726210758980612*^9, 3.726210766788156*^9}, 3.726213918890109*^9, 
   3.7262185419529753`*^9, 3.7262185812791*^9, 3.726219945926682*^9, 
   3.726220291207451*^9, 3.726410695889204*^9, 3.726668859060486*^9, 
   3.7267289737831717`*^9, 3.726763828209652*^9, 3.726763933127963*^9, 
   3.726839697926901*^9, 3.729079646625008*^9, {3.730340390084663*^9, 
   3.730340406554042*^9}, 3.730342384724752*^9, 3.730384334494488*^9, 
   3.730387702727468*^9, 3.730388100405717*^9, 3.730403178732518*^9, 
   3.730409638449285*^9, 3.730416120026373*^9, 3.7304164534572372`*^9, 
   3.7304165905619*^9, {3.733088339131325*^9, 3.7330883471704187`*^9}, 
   3.7331515268592463`*^9, 3.73325524348812*^9, 3.733256022298962*^9, 
   3.733258678467449*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vector field", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
  3.711621165123749*^9, 3.711621169743795*^9}, {3.726212155676237*^9, 
  3.726212167517591*^9}, {3.726218728661997*^9, 3.726218730295368*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
       "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
       "u2z_"}], "}"}]}], "]"}], "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Z1", "[", 
      RowBox[{"z1", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u1", ".", "r1"}], " ", "r1"}], ",", 
         RowBox[{
          RowBox[{"u2", ".", "r2"}], " ", "r2"}]}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Skew", "[", 
       RowBox[{
        RowBox[{"-", " ", "kpr1"}], " ", 
        RowBox[{
         RowBox[{"Skew", "[", 
          FractionBox["u1", 
           SqrtBox[
            RowBox[{"u1", ".", "u1"}]]], "]"}], ".", "r1"}]}], "]"}], ".", 
      "r1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Skew", "[", 
       RowBox[{
        RowBox[{"-", "kpr2"}], " ", 
        RowBox[{
         RowBox[{"Skew", "[", 
          FractionBox["u2", 
           SqrtBox[
            RowBox[{"u2", ".", "u2"}]]], "]"}], ".", "r2"}]}], "]"}], ".", 
      "r2"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.697400682497552*^9, 3.697400683235924*^9}, 
   3.697400813783896*^9, {3.697400858437114*^9, 3.697400871115472*^9}, {
   3.697400908311493*^9, 3.697401159068199*^9}, {3.698055586122117*^9, 
   3.698055588296116*^9}, {3.698056542684677*^9, 3.698056552466524*^9}, {
   3.698235111344733*^9, 3.69823512671377*^9}, {3.6982366567826138`*^9, 
   3.6982366803944607`*^9}, {3.698237041849807*^9, 3.698237062183079*^9}, {
   3.698296328890626*^9, 3.698296382642074*^9}, {3.698296426982251*^9, 
   3.698296484584517*^9}, {3.698296525845749*^9, 3.698296558333123*^9}, {
   3.698296594014716*^9, 3.698296639109754*^9}, {3.698296715695365*^9, 
   3.698296766142324*^9}, {3.698296829912444*^9, 3.6982968462241087`*^9}, {
   3.698296919475834*^9, 3.6982969512167892`*^9}, {3.6982970081121407`*^9, 
   3.6982971601189327`*^9}, {3.7116172924516172`*^9, 
   3.7116173135692368`*^9}, {3.711617600829135*^9, 3.711617600834444*^9}, {
   3.7116211814820538`*^9, 3.7116211903545094`*^9}, {3.711621674121518*^9, 
   3.711621684289032*^9}, {3.7116226266695623`*^9, 3.711622657368965*^9}, {
   3.7116227064891872`*^9, 3.711622875093487*^9}, {3.711623073320809*^9, 
   3.7116230935901937`*^9}, {3.711623124016121*^9, 3.711623136621789*^9}, {
   3.711623194100933*^9, 3.7116232225230007`*^9}, {3.711623291248263*^9, 
   3.7116233162765017`*^9}, {3.711626131209844*^9, 3.711626132107855*^9}, {
   3.711626373708078*^9, 3.7116263753900623`*^9}, {3.7116264742237577`*^9, 
   3.711626679957713*^9}, {3.711626725144823*^9, 3.711626778033641*^9}, {
   3.71162689733743*^9, 3.7116269922027283`*^9}, {3.711627036057825*^9, 
   3.711627037440173*^9}, {3.7116279668739223`*^9, 3.711627995359263*^9}, {
   3.7116280287955837`*^9, 3.711628078391036*^9}, {3.711628446905264*^9, 
   3.711628816619896*^9}, {3.711628849708926*^9, 3.711628851675909*^9}, {
   3.711628903811613*^9, 3.711629021299794*^9}, {3.711629084199346*^9, 
   3.7116292645521173`*^9}, {3.711629298749126*^9, 3.711629334010613*^9}, {
   3.711630407964484*^9, 3.711630461296159*^9}, {3.7116327828384447`*^9, 
   3.7116328480417957`*^9}, {3.711632986156638*^9, 3.71163302875439*^9}, {
   3.71163307677535*^9, 3.711633080282186*^9}, 3.7116331265298433`*^9, {
   3.711689294866427*^9, 3.711689298484226*^9}, {3.711716284965667*^9, 
   3.7117163320871058`*^9}, {3.711716755984516*^9, 3.7117168689313707`*^9}, {
   3.711716914097118*^9, 3.711716926278614*^9}, {3.711716978791876*^9, 
   3.711717134159712*^9}, 3.7117173042513313`*^9, {3.711723906207171*^9, 
   3.7117239189962263`*^9}, 3.712038129588223*^9, {3.712039142693501*^9, 
   3.712039273186387*^9}, {3.712043072787568*^9, 3.712043075086792*^9}, {
   3.712841828031774*^9, 3.7128418281427298`*^9}, {3.7128419997226543`*^9, 
   3.7128420529535933`*^9}, {3.712842173438087*^9, 3.712842173507884*^9}, {
   3.712842222131393*^9, 3.712842535873464*^9}, 3.71284260024035*^9, {
   3.712844022737658*^9, 3.71284402501755*^9}, {3.7128461211563377`*^9, 
   3.712846191106421*^9}, {3.712847103843172*^9, 3.712847112378648*^9}, {
   3.712847966107134*^9, 3.712847966222744*^9}, {3.712848040002239*^9, 
   3.712848072801487*^9}, {3.712848118243079*^9, 3.712848136005253*^9}, {
   3.7128482011882353`*^9, 3.712848298990376*^9}, {3.713448346045266*^9, 
   3.7134483598689203`*^9}, {3.71344839713986*^9, 3.713448420023366*^9}, {
   3.713448499727456*^9, 3.713448544843899*^9}, {3.724673792676518*^9, 
   3.7246738001579657`*^9}, {3.7246738628642817`*^9, 3.724673866218055*^9}, {
   3.724674829248177*^9, 3.7246748421839447`*^9}, {3.724675188888874*^9, 
   3.72467519980689*^9}, {3.724684045613626*^9, 3.724684045715145*^9}, {
   3.724684249379312*^9, 3.724684291947019*^9}, 3.7246843717877483`*^9, {
   3.72475133367165*^9, 3.7247513397400513`*^9}, {3.724751375118907*^9, 
   3.724751378365162*^9}, 3.7249339773857307`*^9, {3.726212768196412*^9, 
   3.726212786964567*^9}, {3.7262187690238543`*^9, 3.7262187856256523`*^9}, {
   3.7262188456107893`*^9, 3.726218847410037*^9}, {3.7262188927558203`*^9, 
   3.726218989188953*^9}, {3.726219094865512*^9, 3.7262191381777353`*^9}, {
   3.726220008350851*^9, 3.7262200256464977`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check that vector field is within tangent set", "Chapter",
 CellChangeTimes->{{3.712038811277717*^9, 3.712038834014045*^9}, {
  3.7262188097444067`*^9, 3.726218812456545*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Z2SET", "[", "z2", "]"}], ",", 
          RowBox[{"{", "z2", "}"}]}], "]"}], "]"}], ".", 
       RowBox[{"Z2", "[", 
        RowBox[{"z2", ",", "u"}], "]"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z2", "\[Rule]", " ", 
        RowBox[{"z2lR", "[", "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
         "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], "/.",
     "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{"u", "\[Rule]", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "6"}], "]"}]}], 
     "]"}]}], "/.", "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kpr1", ",", "kpr2"}], "}"}], "\[Rule]", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}], ",", "2"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.711633142776978*^9, 3.711633142957838*^9}, {
   3.711633207554667*^9, 3.711633208645482*^9}, 3.711633238773624*^9, {
   3.71163407516049*^9, 3.711634139805245*^9}, {3.711717396201397*^9, 
   3.711717418048194*^9}, 3.711717480473504*^9, {3.711717833150804*^9, 
   3.711717833157578*^9}, {3.7120381316591873`*^9, 3.712038187889556*^9}, {
   3.712038320716567*^9, 3.712038339377733*^9}, {3.712038369407885*^9, 
   3.712038371599181*^9}, {3.712038633411572*^9, 3.712038651549141*^9}, {
   3.712038783309617*^9, 3.7120388016940727`*^9}, {3.712842552026746*^9, 
   3.712842569687134*^9}, {3.712842861381813*^9, 3.712842861842023*^9}, {
   3.7128483060378313`*^9, 3.712848358959763*^9}, {3.713448442566313*^9, 
   3.713448490895706*^9}, {3.713448556254397*^9, 3.713448589422153*^9}, {
   3.724684343156171*^9, 3.724684343380728*^9}, {3.724751384506638*^9, 
   3.724751385346961*^9}, {3.726210796755254*^9, 3.726210802076049*^9}, {
   3.726210876838047*^9, 3.726210878239806*^9}, {3.7262188144900093`*^9, 
   3.726218833457203*^9}, {3.7262189939667053`*^9, 3.726219024278585*^9}, {
   3.7266688738052893`*^9, 3.726668874423908*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.7120381152681627`*^9, 3.712038195254126*^9}, 
   3.7120382373104057`*^9, 3.7120383560503407`*^9, 3.712038462602194*^9, 
   3.712038802489809*^9, 3.7120392870802507`*^9, 3.7120400533716917`*^9, 
   3.7120490080286407`*^9, 3.712058597787944*^9, 3.712117088837121*^9, 
   3.712127201428541*^9, 3.712134774567882*^9, 3.7121500948831882`*^9, 
   3.712150579414322*^9, 3.712151238841858*^9, 3.7121558587600393`*^9, 
   3.712382151600459*^9, 3.712830597485321*^9, 3.712830642766521*^9, 
   3.712839871831526*^9, 3.712842570656641*^9, {3.7128426196284513`*^9, 
   3.712842632872696*^9}, 3.712842700299861*^9, {3.7128428566748323`*^9, 
   3.712842865294299*^9}, 3.7128432121144953`*^9, 3.712843359828312*^9, 
   3.712843716013856*^9, {3.7128439891062517`*^9, 3.712844029913664*^9}, 
   3.7128462227703342`*^9, 3.712847153088462*^9, 3.712848324583284*^9, 
   3.7128483623165817`*^9, 3.712899212710343*^9, 3.712905101540876*^9, 
   3.712928201042177*^9, 3.712928304583976*^9, 3.712928974185845*^9, 
   3.712929755275689*^9, 3.712948193231392*^9, 3.712948727344996*^9, 
   3.712982052846031*^9, 3.7129830128655987`*^9, 3.7129881519644003`*^9, {
   3.713448480305551*^9, 3.713448491675489*^9}, {3.713448562111394*^9, 
   3.713448579875558*^9}, {3.713449634571957*^9, 3.713449645826301*^9}, 
   3.7134497192056217`*^9, 3.713600588873612*^9, {3.71360066897045*^9, 
   3.713600682495743*^9}, 3.7140294809841433`*^9, 3.714034018379023*^9, 
   3.724671517656289*^9, 3.724671688034443*^9, 3.724674845980844*^9, 
   3.7246752040893917`*^9, 3.724675870445623*^9, 3.7246765661857967`*^9, 
   3.724676709145646*^9, 3.724677314080927*^9, 3.7246779331790237`*^9, 
   3.724678190609071*^9, 3.724678632162191*^9, 3.724682297116111*^9, 
   3.724682534579548*^9, 3.724683540148499*^9, 3.7246837392847443`*^9, {
   3.724684348591413*^9, 3.724684378323009*^9}, 3.7246847018378477`*^9, 
   3.724751387142557*^9, 3.724754557816175*^9, 3.7247615707540827`*^9, 
   3.7247684344483223`*^9, 3.7247686862595663`*^9, 3.724853585681106*^9, 
   3.724855819956768*^9, 3.724856228333187*^9, 3.724910240729185*^9, 
   3.724937950414678*^9, 3.725185624033813*^9, 3.725211684413662*^9, 
   3.725354736221507*^9, {3.726210817934394*^9, 3.72621083376735*^9}, 
   3.726210880131469*^9, {3.726218938685609*^9, 3.726218963413804*^9}, 
   3.726219109083359*^9, 3.7262191403306828`*^9, 3.7262199460983543`*^9, 
   3.7262200363323107`*^9, 3.726220291396204*^9, 3.7264106961298933`*^9, 
   3.7266688757254257`*^9, 3.726728974105405*^9, 3.726763828490724*^9, 
   3.72676393342733*^9, 3.7268396981167717`*^9, 3.729079646936771*^9, 
   3.730342385011835*^9, 3.73038433479006*^9, 3.7303877030443897`*^9, 
   3.7303881007258673`*^9, 3.73040317905977*^9, 3.730409638771585*^9, 
   3.730416120385531*^9, 3.730416453792736*^9, 3.7304165908892603`*^9, {
   3.73308833945328*^9, 3.733088347444536*^9}, 3.733151527143663*^9, 
   3.73325524376633*^9, 3.733256022636712*^9, 3.7332586787382174`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium input", "Chapter",
 CellChangeTimes->{{3.712039046240158*^9, 3.712039050803523*^9}, {
   3.712039321674848*^9, 3.712039330339319*^9}, {3.713448619185652*^9, 
   3.713448619412182*^9}, 3.7262194363268967`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"u1eq", "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
        ",", "nzd_"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"T", " ", 
       RowBox[{"{", 
        RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m1", " ", "gravity"}], " ", "+", 
         FractionBox[
          RowBox[{"d2", " ", "gravity", " ", "m"}], 
          RowBox[{"d2", "-", "d1"}]]}], ")"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"u2eq", "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
        ",", "nzd_"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "T"}], " ", 
       RowBox[{"{", 
        RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}]}], "+", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m2", " ", "gravity"}], " ", "+", 
         FractionBox[
          RowBox[{"d1", " ", "gravity", " ", "m"}], 
          RowBox[{"d1", "-", "d2"}]]}], ")"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ueq", "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
        ",", "nzd_"}], "}"}], "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"u1eq", "[", 
        RowBox[{"{", 
         RowBox[{
         "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",",
           "nzd"}], "}"}], "]"}], ",", 
       RowBox[{"u2eq", "[", 
        RowBox[{"{", 
         RowBox[{
         "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",",
           "nzd"}], "}"}], "]"}]}], "]"}]}], ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.712039055245289*^9, 3.712039075825623*^9}, {
   3.712039346484489*^9, 3.7120393530212927`*^9}, {3.713448637769609*^9, 
   3.713448638505965*^9}, {3.724672540579483*^9, 3.7246725786814013`*^9}, {
   3.7246729410326357`*^9, 3.724672944260565*^9}, 3.724672976046919*^9, {
   3.7246731404728003`*^9, 3.724673142791277*^9}, {3.724673327956553*^9, 
   3.7246733384851913`*^9}, 3.7246735844815817`*^9, {3.724673649571423*^9, 
   3.7246736516075163`*^9}, {3.724673732418491*^9, 3.724673734859748*^9}, {
   3.724674239895697*^9, 3.724674244068883*^9}, {3.724674409933182*^9, 
   3.724674413606282*^9}, {3.724675144751145*^9, 3.724675147483992*^9}, {
   3.7247627366551*^9, 3.724762752970986*^9}, {3.725185668038444*^9, 
   3.7251856861013603`*^9}, {3.7262194387194223`*^9, 3.726219495560824*^9}, {
   3.72623991751577*^9, 3.726239927972032*^9}, {3.726314089136449*^9, 
   3.726314198089994*^9}, 3.726314613116111*^9, {3.730340442195422*^9, 
   3.730340446342197*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium state", "Chapter",
 CellChangeTimes->{{3.7120389777603073`*^9, 3.712038982949807*^9}, {
   3.7134486113669453`*^9, 3.713448611875164*^9}, 3.7262194935124474`*^9, {
   3.7262199047868977`*^9, 3.726219905618948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"z2eq", "[", "\[Gamma]_", "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"z1eq", "[", "\[Gamma]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["#", 
        SqrtBox[
         RowBox[{"#", ".", "#"}]]], "&"}], "[", 
      RowBox[{"u1eq", "[", "\[Gamma]", "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["#", 
        SqrtBox[
         RowBox[{"#", ".", "#"}]]], "&"}], "[", 
      RowBox[{"u2eq", "[", "\[Gamma]", "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724671708164706*^9, 3.724671721785706*^9}, {
   3.7246718337125473`*^9, 3.72467191557898*^9}, 3.724672736852481*^9, {
   3.724672840224821*^9, 3.7246729288648252`*^9}, 3.72467301919235*^9, {
   3.7246731471457443`*^9, 3.72467316966125*^9}, {3.724673208910364*^9, 
   3.724673239181883*^9}, {3.724673310294273*^9, 3.7246733143776407`*^9}, {
   3.724673375193405*^9, 3.7246734202956343`*^9}, {3.724673475760662*^9, 
   3.7246734901940193`*^9}, {3.7246736617338533`*^9, 3.724673678579351*^9}, {
   3.724674059583976*^9, 3.724674147221874*^9}, {3.724674185153*^9, 
   3.724674231964046*^9}, {3.724674654756015*^9, 3.724674660320261*^9}, {
   3.724674856556801*^9, 3.724674861079214*^9}, {3.7246751525816317`*^9, 
   3.7246751844498577`*^9}, {3.724684420119937*^9, 3.724684429202366*^9}, {
   3.7247514025721607`*^9, 3.724751410322489*^9}, {3.724761660252659*^9, 
   3.724761763786743*^9}, {3.7247624448564587`*^9, 3.724762532522059*^9}, {
   3.724762703484544*^9, 3.724762704005192*^9}, {3.725185691080762*^9, 
   3.7251857465436897`*^9}, {3.726219508705741*^9, 3.7262196626696587`*^9}, {
   3.726219958821253*^9, 3.7262199931975327`*^9}, {3.726410741189891*^9, 
   3.726410759264329*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check vector field vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.7134486234932833`*^9, 3.713448635451254*^9}, 
   3.7262197167103033`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Z2", "[", 
      RowBox[{
       RowBox[{"z2eq", "[", "#", "]"}], ",", 
       RowBox[{"ueq", "[", "#", "]"}]}], "]"}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{"pfx", ",", "pfy", ",", "pfz", ",", "T", ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}], "]"}], "/.", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"#", "\[Rule]", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "5"}], "}"}], ",", 
          RowBox[{"Length", "[", "#", "]"}]}], "]"}]}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{
      "d1", ",", "d2", ",", "L1", ",", "L2", ",", "m1", ",", "m2", ",", "m", 
       ",", " ", "gravity", ",", "J", ",", "\[Alpha]", ",", "\[Psi]", ",", 
       "T", ",", "pfx", ",", "pfy", ",", "pfz"}], "}"}], "]"}], ")"}]}], "//",
   "Chop"}]], "Input",
 CellChangeTimes->{{3.724673502096986*^9, 3.7246735136043577`*^9}, {
   3.7246743370190907`*^9, 3.724674353654626*^9}, {3.724674666960822*^9, 
   3.724674779496702*^9}, 3.724683542150405*^9, {3.724684436683853*^9, 
   3.724684441913939*^9}, {3.724751420552719*^9, 3.724751426304945*^9}, 
   3.72476278597145*^9, 3.724767375558063*^9, 3.7251857543635693`*^9, {
   3.72521173990169*^9, 3.725211765317054*^9}, {3.725354869301927*^9, 
   3.725354879916892*^9}, {3.726219660087023*^9, 3.726219679551108*^9}, {
   3.726220000021576*^9, 3.726220001237835*^9}, {3.726410773821322*^9, 
   3.7264109050038633`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.725185759416065*^9, {3.7252117232824497`*^9, 3.725211761305444*^9}, {
   3.725354865097033*^9, 3.725354880263102*^9}, {3.726219671760923*^9, 
   3.726219681869781*^9}, {3.72621991316885*^9, 3.7262199298664427`*^9}, 
   3.726220063497347*^9, 3.7262203152423773`*^9, 3.726410696177788*^9, {
   3.72641086171355*^9, 3.726410905670999*^9}, 3.726668898709762*^9, 
   3.726728974422353*^9, 3.726763828795611*^9, 3.7267639337336884`*^9, 
   3.726839698280295*^9, 3.7290796473242073`*^9, 3.7303404582430067`*^9, 
   3.7303423853592243`*^9, 3.7303843350896883`*^9, 3.730387703412478*^9, 
   3.730388101022746*^9, 3.7304031794170933`*^9, 3.730409639127232*^9, 
   3.730416120751853*^9, 3.730416454153916*^9, 3.730416591212987*^9, {
   3.7330883397663393`*^9, 3.7330883477164803`*^9}, 3.733151527455435*^9, 
   3.7332552440991993`*^9, 3.733256022960203*^9, 3.733258679071416*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Closed loop vector field", "Chapter",
 CellChangeTimes->{{3.713448913683614*^9, 3.713448920377898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z2cl", "[", 
   RowBox[{"z_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Z2", "[", 
   RowBox[{"z", ",", 
    RowBox[{"ucl", "[", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "24"}], "]"}], "]"}], ",", "\[Gamma]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7134489264835033`*^9, 3.713448926741601*^9}, {
  3.72631741982528*^9, 3.7263174566026793`*^9}, {3.7266699047709513`*^9, 
  3.726669908887949*^9}, {3.7266699442586403`*^9, 3.726669956847234*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check it vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.713448929119544*^9, 3.713448934629406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Z2cl", "[", 
      RowBox[{
       RowBox[{"z2eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
     "]"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "you", " ", "may", " ", "also", " ", "check", " ", "the", " ", "one", " ", 
    
    RowBox[{"below", ":", " ", 
     RowBox[{"but", " ", "it", " ", "takes", " ", "longer"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z2cl", "[", 
       RowBox[{
        RowBox[{"z2eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], "]"}], "//", 
    "FullSimplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "you", " ", "may", " ", "also", " ", "check", " ", "the", " ", "one", " ", 
    
    RowBox[{"below", ":", " ", 
     RowBox[{"but", " ", "it", " ", "takes", " ", "longer"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z2cl", "[", 
       RowBox[{
        RowBox[{"z2eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}], "]"}], "//", 
    "Simplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.724683550020112*^9, {3.724684481288904*^9, 3.7246844849574614`*^9}, {
   3.724751449524251*^9, 3.724751453306415*^9}, 3.72476738924961*^9, 
   3.724767514055324*^9, {3.726317465072546*^9, 3.726317503227375*^9}, {
   3.726317540229115*^9, 3.726317556252857*^9}, {3.7263176009733953`*^9, 
   3.726317618784074*^9}, {3.72631771108829*^9, 3.7263177112886868`*^9}, {
   3.72666991164741*^9, 3.726669925178442*^9}, {3.726669969223563*^9, 
   3.726669971224915*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.726317485909556*^9, 3.726317498831478*^9}, 
   3.726317554813616*^9, 3.726317712358102*^9, 3.726325309949218*^9, 
   3.726383913816324*^9, 3.726390825193532*^9, 3.726395024648493*^9, 
   3.726398696009034*^9, 3.726398926298602*^9, 3.726659686680285*^9, 
   3.726663264277487*^9, 3.726665337759942*^9, 3.726669935051169*^9, {
   3.726669965113942*^9, 3.726669975446238*^9}, 3.726728974928953*^9, 
   3.726763828883616*^9, 3.726763933863696*^9, 3.726764000420726*^9, 
   3.726839699749379*^9, {3.729079647506873*^9, 3.729079652035275*^9}, 
   3.730340476271717*^9, 3.7303423899744787`*^9, 3.7303843352173033`*^9, 
   3.730387703561295*^9, 3.730388101114586*^9, 3.7304031799927053`*^9, 
   3.730409639677772*^9, 3.730416121009973*^9, 3.730416454342285*^9, {
   3.73041659136622*^9, 3.730416594877863*^9}, {3.733088339888961*^9, 
   3.733088352883102*^9}, 3.733151527962941*^9, 3.7332552444096212`*^9, 
   3.733256023426318*^9, 3.73325867937221*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Under-actuated UAVS with integral terms in z", \
"Title"]], "Title",
 CellChangeTimes->{{3.726218234482997*^9, 3.7262182696915073`*^9}, {
  3.7266758013500357`*^9, 3.726675802609434*^9}}],

Cell[CellGroupData[{

Cell["State and input decomposition (these are dummy names)", "Chapter",
 CellChangeTimes->{{3.7262182886392183`*^9, 3.726218291797131*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "state", " ", "is", " ", "constructed", " ", "on", " ", 
     "top", " ", "of", " ", "the", " ", "state", " ", "defined", " ", "for", 
     " ", "under"}], "-", 
    RowBox[{"actuated", " ", "UAVs"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Xi]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Xi]1z", ",", "\[Xi]2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"full", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z3", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"z2", ",", "\[Xi]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7262182603653603`*^9, 3.7262182667809668`*^9}, {
  3.7267289560600367`*^9, 3.726728956670644*^9}, {3.730385406172031*^9, 
  3.730385407052006*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["State set (in manuscript ZSET is called f)", "Chapter",
 CellChangeTimes->{{3.7134482064870863`*^9, 3.713448228580737*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z3SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
      "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
      "\[Xi]2z_"}], "}"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Z2SET", "[", "z2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9, {3.724684010957909*^9, 
   3.724684014373664*^9}, {3.724751269757082*^9, 3.7247512733298903`*^9}, 
   3.726212948183769*^9, {3.726212999176859*^9, 3.726213088715043*^9}, 
   3.726213145928883*^9, {3.726213249075329*^9, 3.7262132716718073`*^9}, {
   3.730385413228259*^9, 3.730385414139213*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tangent set", "Chapter",
 CellChangeTimes->{{3.7134482603686028`*^9, 3.713448262456069*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TangentZ3SET", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
       "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
       "\[Xi]2z_"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\[Delta]px_", ",", "\[Delta]py_", ",", "\[Delta]pz_", ",", 
       "\[Delta]nx_", ",", "\[Delta]ny_", ",", "\[Delta]nz_", ",", 
       "\[Delta]p1x_", ",", "\[Delta]p1y_", ",", "\[Delta]p1z_", ",", 
       "\[Delta]p2x_", ",", "\[Delta]p2y_", ",", "\[Delta]p2z_", ",", 
       "\[Delta]vx_", ",", "\[Delta]vy_", ",", "\[Delta]vz_", ",", 
       "\[Delta]\[Omega]x_", ",", "\[Delta]\[Omega]y_", ",", 
       "\[Delta]\[Omega]z_", ",", "\[Delta]v1x_", ",", "\[Delta]v1y_", ",", 
       "\[Delta]v1z_", ",", "\[Delta]v2x_", ",", "\[Delta]v2y_", ",", 
       "\[Delta]v2z_", ",", "\[Delta]r1x_", ",", "\[Delta]r1y_", ",", 
       "\[Delta]r1z_", ",", "\[Delta]r2x_", ",", "\[Delta]r2y_", ",", 
       "\[Delta]r2z_", ",", "\[Delta]\[Xi]1_", ",", "\[Delta]\[Xi]2_"}], 
      "}"}]}], "\[IndentingNewLine]", "]"}], "=", 
   RowBox[{"TangentZ2SET", "[", 
    RowBox[{"z2", ",", "\[Delta]z2"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9, {3.724684010957909*^9, 
   3.724684014373664*^9}, {3.724751269757082*^9, 3.7247512733298903`*^9}, 
   3.726212948183769*^9, {3.726212999176859*^9, 3.726213088715043*^9}, 
   3.726213145928883*^9, {3.726213249075329*^9, 3.7262132716718073`*^9}, 
   3.7262133414460773`*^9, {3.726213593819635*^9, 3.726213656561925*^9}, 
   3.726218631061812*^9, {3.73038541961725*^9, 3.7303854207656593`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Function that generates arbitrary element of state set", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
   3.666784754227034*^9, 3.6667847600915203`*^9}, {3.713448271503984*^9, 
   3.713448298749484*^9}, 3.726218635901528*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z3l", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z2l", "[", 
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "22"}], "]"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Xi]1z", ",", "\[Xi]2z"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"{", 
        RowBox[{"\[Xi]1z", ",", "\[Xi]2z"}], "}"}], "]"}], "\[Rule]", " ", 
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"23", ";;", "24"}], "]"}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z3lR", "[", "]"}], ":=", 
   RowBox[{"z3l", "[", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "24"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z3lR", "[", "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"Z3SET", "[", 
    RowBox[{"z3l", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "#"], "&"}], ",", "24"}], "]"}], "]"}], "]"}], 
   "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9, {3.724684010957909*^9, 
   3.724684014373664*^9}, {3.724751269757082*^9, 3.7247512733298903`*^9}, 
   3.726212948183769*^9, {3.726212999176859*^9, 3.726213088715043*^9}, 
   3.726213145928883*^9, {3.726213249075329*^9, 3.7262132716718073`*^9}, 
   3.7262133414460773`*^9, {3.726213593819635*^9, 3.726213656561925*^9}, {
   3.7262137314014463`*^9, 3.726213732395596*^9}, {3.7262139275215597`*^9, 
   3.726214006770199*^9}, {3.730385431026083*^9, 3.730385434378051*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.7262139930726423`*^9, 3.726214007294332*^9}, 
   3.726218648504375*^9, {3.726220103352295*^9, 3.726220113001697*^9}, 
   3.726220315321309*^9, 3.726675818386922*^9, 3.726728985335083*^9, 
   3.7267425203817177`*^9, 3.7288025266298523`*^9, 3.729079736708909*^9, 
   3.730341886963902*^9, 3.730342365242955*^9, 3.730342400179281*^9, 
   3.730384512909999*^9, 3.730385435403232*^9, 3.730387703947475*^9, 
   3.7303881013181047`*^9, 3.730410108787126*^9, 3.730416121261052*^9, 
   3.7304164546280117`*^9, 3.73041660224494*^9, 3.733088359585577*^9, 
   3.7331516288368483`*^9, 3.733255244713092*^9, 3.733256023663629*^9, 
   3.733258679673148*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vector field", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
  3.711621165123749*^9, 3.711621169743795*^9}, {3.726212155676237*^9, 
  3.726212167517591*^9}, {3.726218728661997*^9, 3.726218730295368*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"z1eq", "[", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], 
      "}"}], "]"}], "[", 
    RowBox[{"[", "9", "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"z1eq", "[", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], 
      "}"}], "]"}], "[", 
    RowBox[{"[", "12", "]"}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.726220157985737*^9, 3.726220160274105*^9}, {
  3.726675826731791*^9, 3.726675850633206*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Z3", "[", 
    RowBox[{"z3_", ",", "u_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Z2", "[", 
      RowBox[{
       RowBox[{"z3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "30"}], "]"}], "]"}], ",", "u"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"z3", "[", 
         RowBox[{"[", "9", "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"z1eq", "[", "\[Gamma]", "]"}], "[", 
         RowBox[{"[", "9", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"z3", "[", 
         RowBox[{"[", "12", "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"z1eq", "[", "\[Gamma]", "]"}], "[", 
         RowBox[{"[", "12", "]"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1z", "-", 
        RowBox[{
         RowBox[{"z1eq", "[", "\[Gamma]", "]"}], "[", 
         RowBox[{"[", "9", "]"}], "]"}]}], ",", 
       RowBox[{"p2z", "-", 
        RowBox[{
         RowBox[{"z1eq", "[", "\[Gamma]", "]"}], "[", 
         RowBox[{"[", "12", "]"}], "]"}]}]}], "}"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.697400682497552*^9, 3.697400683235924*^9}, 
   3.697400813783896*^9, {3.697400858437114*^9, 3.697400871115472*^9}, {
   3.697400908311493*^9, 3.697401159068199*^9}, {3.698055586122117*^9, 
   3.698055588296116*^9}, {3.698056542684677*^9, 3.698056552466524*^9}, {
   3.698235111344733*^9, 3.69823512671377*^9}, {3.6982366567826138`*^9, 
   3.6982366803944607`*^9}, {3.698237041849807*^9, 3.698237062183079*^9}, {
   3.698296328890626*^9, 3.698296382642074*^9}, {3.698296426982251*^9, 
   3.698296484584517*^9}, {3.698296525845749*^9, 3.698296558333123*^9}, {
   3.698296594014716*^9, 3.698296639109754*^9}, {3.698296715695365*^9, 
   3.698296766142324*^9}, {3.698296829912444*^9, 3.6982968462241087`*^9}, {
   3.698296919475834*^9, 3.6982969512167892`*^9}, {3.6982970081121407`*^9, 
   3.6982971601189327`*^9}, {3.7116172924516172`*^9, 
   3.7116173135692368`*^9}, {3.711617600829135*^9, 3.711617600834444*^9}, {
   3.7116211814820538`*^9, 3.7116211903545094`*^9}, {3.711621674121518*^9, 
   3.711621684289032*^9}, {3.7116226266695623`*^9, 3.711622657368965*^9}, {
   3.7116227064891872`*^9, 3.711622875093487*^9}, {3.711623073320809*^9, 
   3.7116230935901937`*^9}, {3.711623124016121*^9, 3.711623136621789*^9}, {
   3.711623194100933*^9, 3.7116232225230007`*^9}, {3.711623291248263*^9, 
   3.7116233162765017`*^9}, {3.711626131209844*^9, 3.711626132107855*^9}, {
   3.711626373708078*^9, 3.7116263753900623`*^9}, {3.7116264742237577`*^9, 
   3.711626679957713*^9}, {3.711626725144823*^9, 3.711626778033641*^9}, {
   3.71162689733743*^9, 3.7116269922027283`*^9}, {3.711627036057825*^9, 
   3.711627037440173*^9}, {3.7116279668739223`*^9, 3.711627995359263*^9}, {
   3.7116280287955837`*^9, 3.711628078391036*^9}, {3.711628446905264*^9, 
   3.711628816619896*^9}, {3.711628849708926*^9, 3.711628851675909*^9}, {
   3.711628903811613*^9, 3.711629021299794*^9}, {3.711629084199346*^9, 
   3.7116292645521173`*^9}, {3.711629298749126*^9, 3.711629334010613*^9}, {
   3.711630407964484*^9, 3.711630461296159*^9}, {3.7116327828384447`*^9, 
   3.7116328480417957`*^9}, {3.711632986156638*^9, 3.71163302875439*^9}, {
   3.71163307677535*^9, 3.711633080282186*^9}, 3.7116331265298433`*^9, {
   3.711689294866427*^9, 3.711689298484226*^9}, {3.711716284965667*^9, 
   3.7117163320871058`*^9}, {3.711716755984516*^9, 3.7117168689313707`*^9}, {
   3.711716914097118*^9, 3.711716926278614*^9}, {3.711716978791876*^9, 
   3.711717134159712*^9}, 3.7117173042513313`*^9, {3.711723906207171*^9, 
   3.7117239189962263`*^9}, 3.712038129588223*^9, {3.712039142693501*^9, 
   3.712039273186387*^9}, {3.712043072787568*^9, 3.712043075086792*^9}, {
   3.712841828031774*^9, 3.7128418281427298`*^9}, {3.7128419997226543`*^9, 
   3.7128420529535933`*^9}, {3.712842173438087*^9, 3.712842173507884*^9}, {
   3.712842222131393*^9, 3.712842535873464*^9}, 3.71284260024035*^9, {
   3.712844022737658*^9, 3.71284402501755*^9}, {3.7128461211563377`*^9, 
   3.712846191106421*^9}, {3.712847103843172*^9, 3.712847112378648*^9}, {
   3.712847966107134*^9, 3.712847966222744*^9}, {3.712848040002239*^9, 
   3.712848072801487*^9}, {3.712848118243079*^9, 3.712848136005253*^9}, {
   3.7128482011882353`*^9, 3.712848298990376*^9}, {3.713448346045266*^9, 
   3.7134483598689203`*^9}, {3.71344839713986*^9, 3.713448420023366*^9}, {
   3.713448499727456*^9, 3.713448544843899*^9}, {3.724673792676518*^9, 
   3.7246738001579657`*^9}, {3.7246738628642817`*^9, 3.724673866218055*^9}, {
   3.724674829248177*^9, 3.7246748421839447`*^9}, {3.724675188888874*^9, 
   3.72467519980689*^9}, {3.724684045613626*^9, 3.724684045715145*^9}, {
   3.724684249379312*^9, 3.724684291947019*^9}, 3.7246843717877483`*^9, {
   3.72475133367165*^9, 3.7247513397400513`*^9}, {3.724751375118907*^9, 
   3.724751378365162*^9}, 3.7249339773857307`*^9, {3.726212768196412*^9, 
   3.726212786964567*^9}, {3.7262187690238543`*^9, 3.7262187856256523`*^9}, {
   3.7262188456107893`*^9, 3.726218847410037*^9}, {3.7262188927558203`*^9, 
   3.726218989188953*^9}, {3.726219094865512*^9, 3.726219211064714*^9}, {
   3.7262192491046963`*^9, 3.726219291991383*^9}, {3.726220145394772*^9, 
   3.726220192370843*^9}, {3.726675855826233*^9, 3.726675855958272*^9}, {
   3.72667594456584*^9, 3.726675978685318*^9}, {3.726676116003172*^9, 
   3.7266761468067636`*^9}, {3.7266764000599213`*^9, 3.7266764238608828`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check that vector field is within tangent set", "Chapter",
 CellChangeTimes->{{3.712038811277717*^9, 3.712038834014045*^9}, {
  3.7262188097444067`*^9, 3.726218812456545*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Z3SET", "[", "z3", "]"}], ",", 
           RowBox[{"{", "z3", "}"}]}], "]"}], "]"}], ".", 
        RowBox[{"Z3", "[", 
         RowBox[{"z3", ",", "u", ",", 
          RowBox[{"{", 
           RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "Td", ",", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]d", "]"}], 
             RowBox[{"Cos", "[", "\[Psi]d", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]d", "]"}], 
             RowBox[{"Sin", "[", "\[Psi]d", "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Alpha]d", "]"}]}]}], "}"}]}], "]"}]}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"z3", "\[Rule]", " ", 
         RowBox[{"z3lR", "[", "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
          "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], "/.",
      "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pxd", ",", "pyd", ",", "pzd", ",", "Td", ",", "\[Alpha]d", ",", 
         "\[Psi]d"}], "}"}], "\[Rule]", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "6"}], "]"}]}], " ", 
      "]"}]}], "/.", "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{"u", "\[Rule]", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "6"}], "]"}]}], 
     "]"}]}], "/.", "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kpr1", ",", "kpr2"}], "}"}], "\[Rule]", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}], ",", "2"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.711633142776978*^9, 3.711633142957838*^9}, {
   3.711633207554667*^9, 3.711633208645482*^9}, 3.711633238773624*^9, {
   3.71163407516049*^9, 3.711634139805245*^9}, {3.711717396201397*^9, 
   3.711717418048194*^9}, 3.711717480473504*^9, {3.711717833150804*^9, 
   3.711717833157578*^9}, {3.7120381316591873`*^9, 3.712038187889556*^9}, {
   3.712038320716567*^9, 3.712038339377733*^9}, {3.712038369407885*^9, 
   3.712038371599181*^9}, {3.712038633411572*^9, 3.712038651549141*^9}, {
   3.712038783309617*^9, 3.7120388016940727`*^9}, {3.712842552026746*^9, 
   3.712842569687134*^9}, {3.712842861381813*^9, 3.712842861842023*^9}, {
   3.7128483060378313`*^9, 3.712848358959763*^9}, {3.713448442566313*^9, 
   3.713448490895706*^9}, {3.713448556254397*^9, 3.713448589422153*^9}, {
   3.724684343156171*^9, 3.724684343380728*^9}, {3.724751384506638*^9, 
   3.724751385346961*^9}, {3.726210796755254*^9, 3.726210802076049*^9}, {
   3.726210876838047*^9, 3.726210878239806*^9}, {3.7262188144900093`*^9, 
   3.726218833457203*^9}, {3.7262189939667053`*^9, 3.726219024278585*^9}, {
   3.7262193388691683`*^9, 3.726219396271489*^9}, {3.726675992141199*^9, 
   3.726676096282362*^9}, {3.726676172684979*^9, 3.726676176586228*^9}, {
   3.726676206943912*^9, 3.726676231530622*^9}, {3.726743644213806*^9, 
   3.726743667460897*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.7120381152681627`*^9, 3.712038195254126*^9}, 
   3.7120382373104057`*^9, 3.7120383560503407`*^9, 3.712038462602194*^9, 
   3.712038802489809*^9, 3.7120392870802507`*^9, 3.7120400533716917`*^9, 
   3.7120490080286407`*^9, 3.712058597787944*^9, 3.712117088837121*^9, 
   3.712127201428541*^9, 3.712134774567882*^9, 3.7121500948831882`*^9, 
   3.712150579414322*^9, 3.712151238841858*^9, 3.7121558587600393`*^9, 
   3.712382151600459*^9, 3.712830597485321*^9, 3.712830642766521*^9, 
   3.712839871831526*^9, 3.712842570656641*^9, {3.7128426196284513`*^9, 
   3.712842632872696*^9}, 3.712842700299861*^9, {3.7128428566748323`*^9, 
   3.712842865294299*^9}, 3.7128432121144953`*^9, 3.712843359828312*^9, 
   3.712843716013856*^9, {3.7128439891062517`*^9, 3.712844029913664*^9}, 
   3.7128462227703342`*^9, 3.712847153088462*^9, 3.712848324583284*^9, 
   3.7128483623165817`*^9, 3.712899212710343*^9, 3.712905101540876*^9, 
   3.712928201042177*^9, 3.712928304583976*^9, 3.712928974185845*^9, 
   3.712929755275689*^9, 3.712948193231392*^9, 3.712948727344996*^9, 
   3.712982052846031*^9, 3.7129830128655987`*^9, 3.7129881519644003`*^9, {
   3.713448480305551*^9, 3.713448491675489*^9}, {3.713448562111394*^9, 
   3.713448579875558*^9}, {3.713449634571957*^9, 3.713449645826301*^9}, 
   3.7134497192056217`*^9, 3.713600588873612*^9, {3.71360066897045*^9, 
   3.713600682495743*^9}, 3.7140294809841433`*^9, 3.714034018379023*^9, 
   3.724671517656289*^9, 3.724671688034443*^9, 3.724674845980844*^9, 
   3.7246752040893917`*^9, 3.724675870445623*^9, 3.7246765661857967`*^9, 
   3.724676709145646*^9, 3.724677314080927*^9, 3.7246779331790237`*^9, 
   3.724678190609071*^9, 3.724678632162191*^9, 3.724682297116111*^9, 
   3.724682534579548*^9, 3.724683540148499*^9, 3.7246837392847443`*^9, {
   3.724684348591413*^9, 3.724684378323009*^9}, 3.7246847018378477`*^9, 
   3.724751387142557*^9, 3.724754557816175*^9, 3.7247615707540827`*^9, 
   3.7247684344483223`*^9, 3.7247686862595663`*^9, 3.724853585681106*^9, 
   3.724855819956768*^9, 3.724856228333187*^9, 3.724910240729185*^9, 
   3.724937950414678*^9, 3.725185624033813*^9, 3.725211684413662*^9, 
   3.725354736221507*^9, {3.726210817934394*^9, 3.72621083376735*^9}, 
   3.726210880131469*^9, {3.726218938685609*^9, 3.726218963413804*^9}, 
   3.726219109083359*^9, 3.7262191403306828`*^9, {3.7262193865914087`*^9, 
   3.726219396783512*^9}, {3.726220103531295*^9, 3.726220113183441*^9}, {
   3.726220181989997*^9, 3.726220194265697*^9}, 3.7262203155492077`*^9, {
   3.726676082214732*^9, 3.726676118643825*^9}, {3.726676153641036*^9, 
   3.7266762323020363`*^9}, 3.726676425724865*^9, 3.726728990574798*^9, 
   3.7267425207911987`*^9, 3.728802526773746*^9, 3.729079737094358*^9, 
   3.730341896928403*^9, 3.7303423654953947`*^9, 3.73034240051956*^9, 
   3.730384513278553*^9, 3.730385447878469*^9, 3.730387704384099*^9, 
   3.730388101623886*^9, 3.7304101091561823`*^9, 3.730416121713913*^9, 
   3.7304164550073147`*^9, 3.7304166026303473`*^9, 3.733088359913488*^9, 
   3.733151629216372*^9, 3.733255245052277*^9, 3.733256023989113*^9, 
   3.733258680013268*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium input", "Chapter",
 CellChangeTimes->{{3.712039046240158*^9, 3.712039050803523*^9}, {
   3.712039321674848*^9, 3.712039330339319*^9}, {3.713448619185652*^9, 
   3.713448619412182*^9}, 3.7262194363268967`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"u1eq", "=", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"gravity", " ", "T", " ", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", "0", ",", 
      RowBox[{
       RowBox[{"m1", " ", "gravity"}], " ", "+", 
       FractionBox[
        RowBox[{"d2", " ", "gravity", " ", "m"}], 
        RowBox[{"d2", "-", "d1"}]], "+", 
       RowBox[{"gravity", " ", "T", " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"u2eq", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", " ", "gravity"}], " ", "T", " ", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", "0", ",", 
      RowBox[{
       RowBox[{"m2", " ", "gravity"}], " ", "+", 
       FractionBox[
        RowBox[{"d1", " ", "gravity", " ", "m"}], 
        RowBox[{"d1", "-", "d2"}]], "-", 
       RowBox[{"gravity", " ", "T", " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ueq", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"u1eq", ",", "u2eq"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.712039055245289*^9, 3.712039075825623*^9}, {
   3.712039346484489*^9, 3.7120393530212927`*^9}, {3.713448637769609*^9, 
   3.713448638505965*^9}, {3.724672540579483*^9, 3.7246725786814013`*^9}, {
   3.7246729410326357`*^9, 3.724672944260565*^9}, 3.724672976046919*^9, {
   3.7246731404728003`*^9, 3.724673142791277*^9}, {3.724673327956553*^9, 
   3.7246733384851913`*^9}, 3.7246735844815817`*^9, {3.724673649571423*^9, 
   3.7246736516075163`*^9}, {3.724673732418491*^9, 3.724673734859748*^9}, {
   3.724674239895697*^9, 3.724674244068883*^9}, {3.724674409933182*^9, 
   3.724674413606282*^9}, {3.724675144751145*^9, 3.724675147483992*^9}, {
   3.7247627366551*^9, 3.724762752970986*^9}, {3.725185668038444*^9, 
   3.7251856861013603`*^9}, {3.7262194387194223`*^9, 3.726219495560824*^9}, 
   3.7262199521604548`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium state", "Chapter",
 CellChangeTimes->{{3.7120389777603073`*^9, 3.712038982949807*^9}, {
   3.7134486113669453`*^9, 3.713448611875164*^9}, 3.7262194935124474`*^9, {
   3.7262199047868977`*^9, 3.726219905618948*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z3eq", "[", "\[Gamma]_", "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"z2eq", "[", "\[Gamma]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Xi]1zeq", ",", "\[Xi]2zeq"}], "}"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"z3eq", "[", 
    SubscriptBox["\[Gamma]", 
     RowBox[{"eq", ",", "1"}]], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.724671708164706*^9, 3.724671721785706*^9}, {
   3.7246718337125473`*^9, 3.72467191557898*^9}, 3.724672736852481*^9, {
   3.724672840224821*^9, 3.7246729288648252`*^9}, 3.72467301919235*^9, {
   3.7246731471457443`*^9, 3.72467316966125*^9}, {3.724673208910364*^9, 
   3.724673239181883*^9}, {3.724673310294273*^9, 3.7246733143776407`*^9}, {
   3.724673375193405*^9, 3.7246734202956343`*^9}, {3.724673475760662*^9, 
   3.7246734901940193`*^9}, {3.7246736617338533`*^9, 3.724673678579351*^9}, {
   3.724674059583976*^9, 3.724674147221874*^9}, {3.724674185153*^9, 
   3.724674231964046*^9}, {3.724674654756015*^9, 3.724674660320261*^9}, {
   3.724674856556801*^9, 3.724674861079214*^9}, {3.7246751525816317`*^9, 
   3.7246751844498577`*^9}, {3.724684420119937*^9, 3.724684429202366*^9}, {
   3.7247514025721607`*^9, 3.724751410322489*^9}, {3.724761660252659*^9, 
   3.724761763786743*^9}, {3.7247624448564587`*^9, 3.724762532522059*^9}, {
   3.724762703484544*^9, 3.724762704005192*^9}, {3.725185691080762*^9, 
   3.7251857465436897`*^9}, {3.726219508705741*^9, 3.7262196626696587`*^9}, {
   3.726219958821253*^9, 3.7262199931975327`*^9}, {3.726220119620245*^9, 
   3.726220125760991*^9}, {3.726220231163723*^9, 3.7262202434288683`*^9}, {
   3.7266762445036173`*^9, 3.7266762504296103`*^9}, {3.7266762808057203`*^9, 
   3.726676281828195*^9}, {3.730385459294541*^9, 3.73038546144233*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check vector field vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.7134486234932833`*^9, 3.713448635451254*^9}, 
   3.7262197167103033`*^9}],

Cell[CellGroupData[{

Cell["satisfied irrespective of the values of the integrals", "Subsubsection",
 CellChangeTimes->{{3.730341911096836*^9, 3.730341925136005*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Z3", "[", 
      RowBox[{
       RowBox[{"z3eq", "[", "#", "]"}], ",", 
       RowBox[{"ueq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pfx", ",", "pfy", ",", "pfz", ",", "0", ",", "1", ",", "0", ",", "0"}], 
     "}"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "ones", " ", "below", " ", "take", " ", "longer", " ", "to", 
     " ", "verify"}], ",", " ", 
    RowBox[{"but", " ", "they", " ", "can", " ", "be", " ", "verified"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z3", "[", 
       RowBox[{
        RowBox[{"z3eq", "[", "#", "]"}], ",", 
        RowBox[{"ueq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{
      "pfx", ",", "pfy", ",", "pfz", ",", "T", ",", "1", ",", "0", ",", "0"}],
       "}"}], "]"}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z3", "[", 
       RowBox[{
        RowBox[{"z3eq", "[", "#", "]"}], ",", 
        RowBox[{"ueq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pfx", ",", "pfy", ",", "pfz", ",", "0", ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], "]"}], "//", 
    "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z3", "[", 
       RowBox[{
        RowBox[{"z3eq", "[", "#", "]"}], ",", 
        RowBox[{"ueq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pfx", ",", "pfy", ",", "pfz", ",", "0", ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], "]"}], "//", 
    "Simplify"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z3", "[", 
       RowBox[{
        RowBox[{"z3eq", "[", "#", "]"}], ",", 
        RowBox[{"ueq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pfx", ",", "pfy", ",", "pfz", ",", "T", ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], "]"}], "//", 
    "Simplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.730341996024004*^9, 3.730342067291911*^9}, {
  3.7303422031818933`*^9, 3.730342206566538*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.730342003366663*^9, 3.7303420286066303`*^9}, 
   3.730342365891266*^9, 3.730342403870365*^9, 3.730384513709818*^9, 
   3.730385466820366*^9, 3.730387704832264*^9, 3.73038810202096*^9, 
   3.730410109731449*^9, 3.730416122210353*^9, 3.730416455476287*^9, 
   3.7304166030633383`*^9, 3.733088360332109*^9, 3.733151629795232*^9, 
   3.73325524542332*^9, 3.7332560244165983`*^9, 3.733258680402523*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Control law for each uav: constructed on top of PD-like control law\
\>", "Chapter",
 CellChangeTimes->{{3.712040075566353*^9, 3.712040080540077*^9}, {
  3.730342189895405*^9, 3.730342225602261*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u1PID", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
       "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
       "\[Xi]2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"u1PD", "[", 
     RowBox[{"z1", ",", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}]}], "]"}], "-", 
    RowBox[{"m1", " ", "kiz1", " ", "\[Xi]1z", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u2PID", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
       "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
       "\[Xi]2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"u2PD", "[", 
     RowBox[{"z1", ",", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}]}], "]"}], "-", 
    RowBox[{"m2", " ", "kiz2", " ", "\[Xi]2z", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.730342082484151*^9, 3.730342183407131*^9}, 
   3.7303424106819143`*^9, {3.730384729352255*^9, 3.730384730967554*^9}, {
   3.730385088730894*^9, 3.730385098236706*^9}, {3.730385264303726*^9, 
   3.730385264670925*^9}, 3.730385400966775*^9}],

Cell[CellGroupData[{

Cell["include best guess of feedforward term", "Subsubsection",
 CellChangeTimes->{{3.730384670233197*^9, 3.730384680240485*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u1eqEstimate3D", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"T", " ", 
     RowBox[{"{", 
      RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], "u1eqEstimate"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u2eqEstimate3D", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "T"}], " ", 
     RowBox[{"{", 
      RowBox[{"nxd", ",", "nyd", ",", "nzd"}], "}"}]}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], "u2eqEstimate"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.730385702217834*^9, 3.7303857485658817`*^9}, {
  3.7303859343519382`*^9, 3.730385935845435*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u1clCompletePID", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", 
        "r1y_", ",", "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", 
        "\[Xi]1z_", ",", "\[Xi]2z_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
        ",", "nzd_"}], "}"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"u1eqEstimate3D", "[", "#", "]"}], "+", 
       RowBox[{"u1PID", "[", 
        RowBox[{"z3", ",", "#"}], "]"}]}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{
      "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
       "nzd"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u2clCompletePID", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
        "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
        "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", 
        "r1y_", ",", "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", 
        "\[Xi]1z_", ",", "\[Xi]2z_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
        ",", "nzd_"}], "}"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"u2eqEstimate3D", "[", "#", "]"}], "+", 
       RowBox[{"u2PID", "[", 
        RowBox[{"z3", ",", "#"}], "]"}]}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{
      "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
       "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"complete", " ", "control", " ", "law"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uclPID", "[", 
   RowBox[{"z_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"u1clCompletePID", "[", 
     RowBox[{"z", ",", "\[Gamma]"}], "]"}], ",", 
    RowBox[{"u2clCompletePID", "[", 
     RowBox[{"z", ",", "\[Gamma]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.726729492863147*^9, 3.726729592915432*^9}, {
   3.726730042261628*^9, 3.726730079976679*^9}, {3.726733341098481*^9, 
   3.726733357271196*^9}, {3.7267334698997498`*^9, 3.72673347615246*^9}, {
   3.726737941731782*^9, 3.726737942097907*^9}, {3.726739497506269*^9, 
   3.72673949935753*^9}, {3.730384722865954*^9, 3.7303848427612762`*^9}, {
   3.730384886525722*^9, 3.7303849015742207`*^9}, {3.730385062804595*^9, 
   3.730385062877212*^9}, {3.730385257892535*^9, 3.730385258043734*^9}, {
   3.730385291418955*^9, 3.7303853209538794`*^9}, 3.7303857123214607`*^9, {
   3.730385751395007*^9, 3.730385768346321*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium state", "Chapter",
 CellChangeTimes->{{3.7120389777603073`*^9, 3.712038982949807*^9}, {
   3.7134486113669453`*^9, 3.713448611875164*^9}, 3.7262194935124474`*^9, {
   3.7262199047868977`*^9, 3.726219905618948*^9}, {3.730384965467394*^9, 
   3.7303849855995398`*^9}}],

Cell[CellGroupData[{

Cell["\<\
now we can provide the equilibrium state, where the integral terms are zero \
if both UAVs know the exactly the equilibrium terms\
\>", "Subsubsection",
 CellChangeTimes->{{3.730384987170072*^9, 3.730385020756102*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z3eq", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"z2eq", "[", "#", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Xi]1eq", ",", "\[Xi]2eq"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]1eq", "\[Rule]", " ", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"kiz1", " ", "m1"}]], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u1eqEstimate3D", "[", "#", "]"}], "-", 
             RowBox[{"u1eq", "[", "#", "]"}]}], ")"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[Xi]2eq", "\[Rule]", "  ", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"kiz2", " ", "m2"}]], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u2eqEstimate3D", "[", "#", "]"}], "-", 
             RowBox[{"u2eq", "[", "#", "]"}]}], ")"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "}"}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"z3eq", "[", 
    SubscriptBox["\[Gamma]", 
     RowBox[{"eq", ",", "1"}]], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.724671708164706*^9, 3.724671721785706*^9}, {
   3.7246718337125473`*^9, 3.72467191557898*^9}, 3.724672736852481*^9, {
   3.724672840224821*^9, 3.7246729288648252`*^9}, 3.72467301919235*^9, {
   3.7246731471457443`*^9, 3.72467316966125*^9}, {3.724673208910364*^9, 
   3.724673239181883*^9}, {3.724673310294273*^9, 3.7246733143776407`*^9}, {
   3.724673375193405*^9, 3.7246734202956343`*^9}, {3.724673475760662*^9, 
   3.7246734901940193`*^9}, {3.7246736617338533`*^9, 3.724673678579351*^9}, {
   3.724674059583976*^9, 3.724674147221874*^9}, {3.724674185153*^9, 
   3.724674231964046*^9}, {3.724674654756015*^9, 3.724674660320261*^9}, {
   3.724674856556801*^9, 3.724674861079214*^9}, {3.7246751525816317`*^9, 
   3.7246751844498577`*^9}, {3.724684420119937*^9, 3.724684429202366*^9}, {
   3.7247514025721607`*^9, 3.724751410322489*^9}, {3.724761660252659*^9, 
   3.724761763786743*^9}, {3.7247624448564587`*^9, 3.724762532522059*^9}, {
   3.724762703484544*^9, 3.724762704005192*^9}, {3.725185691080762*^9, 
   3.7251857465436897`*^9}, {3.726219508705741*^9, 3.7262196626696587`*^9}, {
   3.726219958821253*^9, 3.7262199931975327`*^9}, {3.726220119620245*^9, 
   3.726220125760991*^9}, {3.726220231163723*^9, 3.7262202434288683`*^9}, {
   3.7266762445036173`*^9, 3.7266762504296103`*^9}, {3.7266762808057203`*^9, 
   3.726676281828195*^9}, {3.726739554176145*^9, 3.726739565516049*^9}, {
   3.73038492568793*^9, 3.7303849593885098`*^9}, {3.730385486432744*^9, 
   3.730385487486519*^9}, {3.7303855435245037`*^9, 3.730385639205248*^9}, {
   3.7303857757584476`*^9, 3.730385809609085*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["make sure control law is equal to its equilibrium value", "Chapter",
 CellChangeTimes->{{3.726737946522788*^9, 3.7267379717781277`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"uclPID", "[", 
      RowBox[{
       RowBox[{"z3eq", "[", "#", "]"}], ",", "#"}], "]"}], "-", 
     RowBox[{"ueq", "[", "#", "]"}]}], "&"}], "[", 
   RowBox[{"{", 
    RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Beta]", "]"}], 
      RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Beta]", "]"}], 
      RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Beta]", "]"}]}]}], "}"}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.726239004980282*^9, 3.726239027318301*^9}, {
   3.726239406695359*^9, 3.726239410759004*^9}, {3.726295549267352*^9, 
   3.726295549547233*^9}, 3.7262956125333233`*^9, {3.7267296297615767`*^9, 
   3.7267296711628313`*^9}, {3.726729707488755*^9, 3.7267297172985687`*^9}, {
   3.726729813722527*^9, 3.726729844801374*^9}, 3.730385029719729*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.726239024143753*^9, 3.726239027631098*^9}, 
   3.726239312490584*^9, {3.726239407326797*^9, 3.726239411279821*^9}, 
   3.726239616395049*^9, 3.72624010519522*^9, 3.726284016947322*^9, {
   3.726295554646515*^9, 3.726295564817881*^9}, 3.726295612849842*^9, 
   3.726297901725751*^9, 3.726297957950944*^9, 3.726298037252761*^9, {
   3.7267296495434313`*^9, 3.726729672963224*^9}, {3.7267297133446007`*^9, 
   3.7267297179418783`*^9}, {3.726729771668317*^9, 3.7267297975343447`*^9}, 
   3.72672984535421*^9, 3.726733122854603*^9, {3.726733461737167*^9, 
   3.726733482214148*^9}, 3.726737975158907*^9, 3.72673956904487*^9, 
   3.726739652040523*^9, 3.726742194612885*^9, 3.726742521500214*^9, 
   3.728802527096818*^9, 3.7290797378716*^9, 3.730342366150523*^9, 
   3.730385032672081*^9, 3.730385066850779*^9, 3.73038510358624*^9, 
   3.730385197594729*^9, 3.730385271267345*^9, 3.730385325502445*^9, {
   3.730385477382272*^9, 3.7303854892601624`*^9}, 3.73038558464979*^9, 
   3.730385642570347*^9, 3.730385813167302*^9, 3.730385845203987*^9, {
   3.730385943130028*^9, 3.730385962268471*^9}, 3.730387705132193*^9, 
   3.73038810215373*^9, 3.730410109947713*^9, 3.730416122498498*^9, 
   3.7304164557473097`*^9, 3.730416603315468*^9, 3.733088360551688*^9, 
   3.733151630005353*^9, 3.733255245783539*^9, 3.733256024732935*^9, 
   3.733258680778858*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Closed loop vector field", "Chapter",
 CellChangeTimes->{{3.713448913683614*^9, 3.713448920377898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z3cl", "[", 
   RowBox[{"z_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Z3", "[", 
   RowBox[{"z", ",", 
    RowBox[{"uclPID", "[", 
     RowBox[{"z", ",", "\[Gamma]"}], "]"}], ",", "\[Gamma]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7134489264835033`*^9, 3.713448926741601*^9}, {
   3.72631741982528*^9, 3.7263174566026793`*^9}, {3.7266699047709513`*^9, 
   3.726669908887949*^9}, {3.7266699442586403`*^9, 3.726669956847234*^9}, {
   3.7267290047669477`*^9, 3.726729008185536*^9}, {3.7267291264690533`*^9, 
   3.726729126931026*^9}, 3.7267396439531393`*^9, 3.730385976059051*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Check it vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.713448929119544*^9, 3.713448934629406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Z3cl", "[", 
      RowBox[{
       RowBox[{"z3eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
     "]"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "you", " ", "may", " ", "also", " ", "check", " ", "the", " ", "one", " ", 
    
    RowBox[{"below", ":", " ", 
     RowBox[{"but", " ", "it", " ", "takes", " ", "longer"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z2cl", "[", 
       RowBox[{
        RowBox[{"z2eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], "]"}], "//", 
    "FullSimplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "you", " ", "may", " ", "also", " ", "check", " ", "the", " ", "one", " ", 
    
    RowBox[{"below", ":", " ", 
     RowBox[{"but", " ", "it", " ", "takes", " ", "longer"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Z2cl", "[", 
       RowBox[{
        RowBox[{"z2eq", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], "[", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}], "]"}], "//", 
    "Simplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.724683550020112*^9, {3.724684481288904*^9, 3.7246844849574614`*^9}, {
   3.724751449524251*^9, 3.724751453306415*^9}, 3.72476738924961*^9, 
   3.724767514055324*^9, {3.726317465072546*^9, 3.726317503227375*^9}, {
   3.726317540229115*^9, 3.726317556252857*^9}, {3.7263176009733953`*^9, 
   3.726317618784074*^9}, {3.72631771108829*^9, 3.7263177112886868`*^9}, {
   3.72666991164741*^9, 3.726669925178442*^9}, {3.726669969223563*^9, 
   3.726669971224915*^9}, {3.726729030292454*^9, 3.726729046863867*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.726317485909556*^9, 3.726317498831478*^9}, 
   3.726317554813616*^9, 3.726317712358102*^9, 3.726325309949218*^9, 
   3.726383913816324*^9, 3.726390825193532*^9, 3.726395024648493*^9, 
   3.726398696009034*^9, 3.726398926298602*^9, 3.726659686680285*^9, 
   3.726663264277487*^9, 3.726665337759942*^9, 3.726669935051169*^9, {
   3.726669965113942*^9, 3.726669975446238*^9}, {3.726729102101253*^9, 
   3.726729131557708*^9}, 3.726737988265251*^9, 3.7267395724818*^9, 
   3.726739656077313*^9, 3.7267421976362457`*^9, 3.726742521928359*^9, 
   3.728802527851316*^9, 3.7290797382961206`*^9, 3.730342367330051*^9, 
   3.730385979466196*^9, 3.730387705262701*^9, 3.730388102298015*^9, 
   3.730410110407379*^9, 3.730416122644988*^9, 3.730416455950399*^9, 
   3.730416603462736*^9, 3.7330883606708117`*^9, 3.733151630399333*^9, 
   3.733255245929282*^9, 3.733256024911474*^9, 3.7332586809553537`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Saturated PID control law for UAVs 1 and 2", "Chapter",
 CellChangeTimes->{{3.730329700640293*^9, 3.7303297082095823`*^9}, {
  3.730330669966112*^9, 3.7303306723711147`*^9}, {3.730386573566958*^9, 
  3.730386584228594*^9}}],

Cell[CellGroupData[{

Cell["saturation function", "Subsection",
 CellChangeTimes->{{3.730342736535818*^9, 3.730342742473597*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Sigma]3D", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Sigma]", "[", "x", "]"}], ",", 
     RowBox[{"\[Sigma]", "[", "y", "]"}], ",", 
     RowBox[{"\[Sigma]", "[", "z", "]"}]}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.730330689546586*^9, 3.730330728464548*^9}, 
   3.7303865866310797`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["saturated PD", "Subsection",
 CellChangeTimes->{{3.730342719175447*^9, 3.730342733382784*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"u1PIDSaturated", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
       "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
       "\[Xi]2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"u1PDSaturated", "[", 
       RowBox[{"z1", ",", "#"}], "]"}], "-", 
      RowBox[{"m1", " ", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"kiz1", "  ", "\[Xi]1z"}], "]"}], 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u2PIDSaturated", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
       "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
       "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
       "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_",
        ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
       "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
       "\[Xi]2z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
       ",", "nzd_"}], "}"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"u2PDSaturated", "[", 
       RowBox[{"z1", ",", "#"}], "]"}], "-", 
      RowBox[{"m2", " ", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"kiz2", "  ", "\[Xi]2z"}], "]"}], 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.730342747026775*^9, 3.730342770530195*^9}, {
   3.730386590930838*^9, 3.730386604494928*^9}, {3.7303866704939127`*^9, 
   3.7303867283766947`*^9}, {3.730386804400527*^9, 3.730386817493516*^9}, 
   3.730387069333118*^9}],

Cell[CellGroupData[{

Cell["include feedforward term", "Subsubsection",
 CellChangeTimes->{{3.730342643845106*^9, 3.7303426503241253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "pd", " ", "control", " ", "law", " ", "for", " ", "for", " ", "each", " ",
     "direction"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u1clCompletePIDSaturated", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", 
         "r1y_", ",", "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", 
         "\[Xi]1z_", ",", "\[Xi]2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_",
          ",", "nzd_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"u1eqEstimate3D", "[", "#", "]"}], "+", 
        RowBox[{"u1PIDSaturated", "[", 
         RowBox[{"z3", ",", "#"}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"u2clCompletePIDSaturated", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
         "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", 
         "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", 
         "r1y_", ",", "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", 
         "\[Xi]1z_", ",", "\[Xi]2z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_",
          ",", "nzd_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"u2eqEstimate3D", "[", "#", "]"}], "+", 
        RowBox[{"u2PIDSaturated", "[", 
         RowBox[{"z3", ",", "#"}], "]"}]}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{
       "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
        "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"complete", " ", "control", " ", "law"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uclPIDSaturated", "[", 
     RowBox[{"z_", ",", "\[Gamma]_"}], "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"u1clCompletePIDSaturated", "[", 
       RowBox[{"z", ",", "\[Gamma]"}], "]"}], ",", 
      RowBox[{"u2clCompletePIDSaturated", "[", 
       RowBox[{"z", ",", "\[Gamma]"}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.678453870578924*^9, 3.6784538851660337`*^9}, {
   3.6784539201437883`*^9, 3.67845426729596*^9}, {3.6784542976203947`*^9, 
   3.678454338207302*^9}, {3.678454368219833*^9, 3.67845442420653*^9}, {
   3.678455564719254*^9, 3.6784555755938787`*^9}, {3.678455667955229*^9, 
   3.67845567412951*^9}, {3.6784557240285482`*^9, 3.67845580636443*^9}, {
   3.67845594497412*^9, 3.6784560056472273`*^9}, {3.678456040740004*^9, 
   3.678456113360455*^9}, {3.6784565804483*^9, 3.6784566989706917`*^9}, {
   3.67845699495473*^9, 3.6784570051161823`*^9}, {3.678457074189624*^9, 
   3.678457074400229*^9}, {3.678457120811713*^9, 3.678457132773929*^9}, {
   3.6784573833439817`*^9, 3.678457399044024*^9}, {3.678457566717965*^9, 
   3.678457575258934*^9}, {3.6784576138433027`*^9, 3.67845764511302*^9}, {
   3.678457681670499*^9, 3.6784576869371843`*^9}, {3.6785030133194637`*^9, 
   3.678503018851026*^9}, {3.678503053700424*^9, 3.678503061887308*^9}, {
   3.6785031141864853`*^9, 3.678503151671834*^9}, {3.6785035454280252`*^9, 
   3.678503565801978*^9}, {3.692605692777117*^9, 3.692605787151251*^9}, {
   3.692605871228614*^9, 3.692605875567656*^9}, {3.697783560030775*^9, 
   3.697783584633834*^9}, {3.697864144145309*^9, 3.6978642846827497`*^9}, {
   3.6978644724858093`*^9, 3.697864474524767*^9}, {3.6978645253057003`*^9, 
   3.697864529099121*^9}, {3.6978648087283993`*^9, 3.697864819666897*^9}, {
   3.697864857946622*^9, 3.697864871615958*^9}, {3.697865030310058*^9, 
   3.697865054256448*^9}, {3.6978653837364273`*^9, 3.697865403161058*^9}, {
   3.697865434075416*^9, 3.697865435874483*^9}, {3.6978655603144903`*^9, 
   3.6978655605135307`*^9}, {3.697878887139681*^9, 3.6978789273146276`*^9}, {
   3.712038875130848*^9, 3.712038878681403*^9}, 3.7120393854066896`*^9, {
   3.712040082366139*^9, 3.712040082678351*^9}, {3.7120401609284153`*^9, 
   3.712040170183938*^9}, {3.712040226413877*^9, 3.712040307061963*^9}, {
   3.7120403525685987`*^9, 3.7120404400933*^9}, {3.7120474726221743`*^9, 
   3.7120474757472897`*^9}, {3.712116926109763*^9, 3.712117064974493*^9}, {
   3.7121172584306*^9, 3.712117304172991*^9}, {3.71211769691184*^9, 
   3.7121177334271097`*^9}, {3.7121178099621468`*^9, 3.712117826487574*^9}, {
   3.7121273633642406`*^9, 3.712127392651319*^9}, {3.712134728325556*^9, 
   3.712134736513805*^9}, {3.712134776729841*^9, 3.7121347833000307`*^9}, {
   3.712150008166641*^9, 3.712150028687416*^9}, {3.7121500979389563`*^9, 
   3.7121501124205008`*^9}, {3.712841828170721*^9, 3.712841828175336*^9}, {
   3.712842173521311*^9, 3.712842173526173*^9}, {3.712844056258308*^9, 
   3.7128440869021053`*^9}, {3.712847966254746*^9, 3.712847966259042*^9}, {
   3.712853316853519*^9, 3.712853343932612*^9}, {3.71285339637422*^9, 
   3.712853408929783*^9}, {3.712853548788332*^9, 3.71285355298173*^9}, {
   3.71298295129955*^9, 3.712982955194254*^9}, {3.712983293924004*^9, 
   3.7129833113195972`*^9}, {3.713448815718647*^9, 3.7134488689281063`*^9}, {
   3.724677470559257*^9, 3.724677477162611*^9}, {3.724684045784856*^9, 
   3.724684045790318*^9}, {3.7247513414901543`*^9, 3.724751341495636*^9}, {
   3.7247514357843933`*^9, 3.724751440923985*^9}, {3.724767449503585*^9, 
   3.724767498198578*^9}, {3.726238969736364*^9, 3.726238975223404*^9}, 
   3.726239310539795*^9, 3.726239613844377*^9, {3.726309730345427*^9, 
   3.7263097651304493`*^9}, {3.7263149572380943`*^9, 3.726315093547611*^9}, {
   3.7263151246502113`*^9, 3.726315225524687*^9}, {3.726315278013318*^9, 
   3.7263153074552593`*^9}, {3.7263153577036333`*^9, 3.726315364711985*^9}, {
   3.72639866609133*^9, 3.726398669800305*^9}, {3.7263989080879393`*^9, 
   3.726398919684053*^9}, {3.729299249154545*^9, 3.729299266668913*^9}, {
   3.729306985828233*^9, 3.729307028088059*^9}, {3.729307092926269*^9, 
   3.729307246366514*^9}, {3.7293072956851387`*^9, 3.7293074838458977`*^9}, {
   3.729308584072682*^9, 3.729308592597748*^9}, {3.7293559860897923`*^9, 
   3.729356023422908*^9}, {3.729356105739304*^9, 3.729356108478258*^9}, {
   3.72935629626583*^9, 3.729356308118354*^9}, {3.7303297175636587`*^9, 
   3.7303297203636713`*^9}, {3.730329753529695*^9, 3.730329785287073*^9}, {
   3.730330674468965*^9, 3.7303306815258093`*^9}, {3.730330735672233*^9, 
   3.7303307865679617`*^9}, {3.7303309813390493`*^9, 3.730330984349592*^9}, {
   3.730331404304755*^9, 3.7303314147398577`*^9}, {3.7303427772232437`*^9, 
   3.73034279084997*^9}, {3.730386738616605*^9, 3.730386771358987*^9}, {
   3.7303868227139883`*^9, 3.730386852360127*^9}, {3.730387168152863*^9, 
   3.730387168287243*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equilibrium state", "Chapter",
 CellChangeTimes->{{3.7120389777603073`*^9, 3.712038982949807*^9}, {
   3.7134486113669453`*^9, 3.713448611875164*^9}, 3.7262194935124474`*^9, {
   3.7262199047868977`*^9, 3.726219905618948*^9}, {3.730384965467394*^9, 
   3.7303849855995398`*^9}}],

Cell[CellGroupData[{

Cell["\<\
now we can provide the equilibrium state, where the integral terms are zero \
if both UAVs know the exactly the equilibrium terms\
\>", "Subsubsection",
 CellChangeTimes->{{3.730384987170072*^9, 3.730385020756102*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z3eqSaturated", "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "T_", ",", "nxd_", ",", "nyd_", 
      ",", "nzd_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"z2eq", "[", "#", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Xi]1eq", ",", "\[Xi]2eq"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]1eq", "\[Rule]", " ", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"kiz1", " "}]], 
          RowBox[{
           RowBox[{"InverseFunction", "[", "\[Sigma]", "]"}], "[", " ", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u1eqEstimate3D", "[", "#", "]"}], "-", 
               RowBox[{"u1eq", "[", "#", "]"}]}], ")"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "m1"], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Xi]2eq", "\[Rule]", "  ", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"kiz2", " "}]], " ", 
          RowBox[{
           RowBox[{"InverseFunction", "[", "\[Sigma]", "]"}], "[", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u2eqEstimate3D", "[", "#", "]"}], "-", 
               RowBox[{"u2eq", "[", "#", "]"}]}], ")"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "m2"], "]"}]}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"z3eq", "[", 
    SubscriptBox["\[Gamma]", 
     RowBox[{"eq", ",", "1"}]], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.724671708164706*^9, 3.724671721785706*^9}, {
   3.7246718337125473`*^9, 3.72467191557898*^9}, 3.724672736852481*^9, {
   3.724672840224821*^9, 3.7246729288648252`*^9}, 3.72467301919235*^9, {
   3.7246731471457443`*^9, 3.72467316966125*^9}, {3.724673208910364*^9, 
   3.724673239181883*^9}, {3.724673310294273*^9, 3.7246733143776407`*^9}, {
   3.724673375193405*^9, 3.7246734202956343`*^9}, {3.724673475760662*^9, 
   3.7246734901940193`*^9}, {3.7246736617338533`*^9, 3.724673678579351*^9}, {
   3.724674059583976*^9, 3.724674147221874*^9}, {3.724674185153*^9, 
   3.724674231964046*^9}, {3.724674654756015*^9, 3.724674660320261*^9}, {
   3.724674856556801*^9, 3.724674861079214*^9}, {3.7246751525816317`*^9, 
   3.7246751844498577`*^9}, {3.724684420119937*^9, 3.724684429202366*^9}, {
   3.7247514025721607`*^9, 3.724751410322489*^9}, {3.724761660252659*^9, 
   3.724761763786743*^9}, {3.7247624448564587`*^9, 3.724762532522059*^9}, {
   3.724762703484544*^9, 3.724762704005192*^9}, {3.725185691080762*^9, 
   3.7251857465436897`*^9}, {3.726219508705741*^9, 3.7262196626696587`*^9}, {
   3.726219958821253*^9, 3.7262199931975327`*^9}, {3.726220119620245*^9, 
   3.726220125760991*^9}, {3.726220231163723*^9, 3.7262202434288683`*^9}, {
   3.7266762445036173`*^9, 3.7266762504296103`*^9}, {3.7266762808057203`*^9, 
   3.726676281828195*^9}, {3.726739554176145*^9, 3.726739565516049*^9}, {
   3.73038492568793*^9, 3.7303849593885098`*^9}, {3.730385486432744*^9, 
   3.730385487486519*^9}, {3.7303855435245037`*^9, 3.730385639205248*^9}, {
   3.7303857757584476`*^9, 3.730385809609085*^9}, {3.730386877833433*^9, 
   3.7303869198883657`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["make sure control law is equal to its equilibrium value", "Chapter",
 CellChangeTimes->{{3.726737946522788*^9, 3.7267379717781277`*^9}}],

Cell[CellGroupData[{

Cell[" \[Sigma][0] = 0 (property of saturation function)", "Subsubsection",
 CellChangeTimes->{{3.730387142385928*^9, 3.730387156495406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uclPIDSaturated", "[", 
       RowBox[{
        RowBox[{"z3eqSaturated", "[", "#", "]"}], ",", "#"}], "]"}], "-", 
      RowBox[{"ueq", "[", "#", "]"}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{"pxd", ",", "pyd", ",", "pzd", ",", "T", ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Beta]", "]"}], 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Beta]", "]"}], 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"\[Sigma]", "[", "0", "]"}], "\[Equal]", "0"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.726239004980282*^9, 3.726239027318301*^9}, {
   3.726239406695359*^9, 3.726239410759004*^9}, {3.726295549267352*^9, 
   3.726295549547233*^9}, 3.7262956125333233`*^9, {3.7267296297615767`*^9, 
   3.7267296711628313`*^9}, {3.726729707488755*^9, 3.7267297172985687`*^9}, {
   3.726729813722527*^9, 3.726729844801374*^9}, 3.730385029719729*^9, {
   3.730386925619182*^9, 3.730386929940177*^9}, {3.7303871286906967`*^9, 
   3.73038713889007*^9}}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,308,1,31253086223105391869,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7303869326715603`*^9, 3.7303871219711647`*^9, {3.730387157924293*^9, 
   3.730387172853425*^9}, 3.7303877054814653`*^9, 3.730388102488817*^9, {
   3.730410110604746*^9, 3.730410119578599*^9}, 3.7304161229020357`*^9, 
   3.7304164561810627`*^9, 3.7304166037109623`*^9, 3.7330883608851013`*^9, 
   3.7331516306275177`*^9, 3.73325524624577*^9, 3.733256025283444*^9, 
   3.733258681285572*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,308,2,31253086223105391869,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7303869326715603`*^9, 3.7303871219711647`*^9, {3.730387157924293*^9, 
   3.730387172853425*^9}, 3.7303877054814653`*^9, 3.730388102488817*^9, {
   3.730410110604746*^9, 3.730410119578599*^9}, 3.7304161229020357`*^9, 
   3.7304164561810627`*^9, 3.7304166037109623`*^9, 3.7330883608851013`*^9, 
   3.7331516306275177`*^9, 3.73325524624577*^9, 3.733256025283444*^9, 
   3.733258681289444*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.726239024143753*^9, 3.726239027631098*^9}, 
   3.726239312490584*^9, {3.726239407326797*^9, 3.726239411279821*^9}, 
   3.726239616395049*^9, 3.72624010519522*^9, 3.726284016947322*^9, {
   3.726295554646515*^9, 3.726295564817881*^9}, 3.726295612849842*^9, 
   3.726297901725751*^9, 3.726297957950944*^9, 3.726298037252761*^9, {
   3.7267296495434313`*^9, 3.726729672963224*^9}, {3.7267297133446007`*^9, 
   3.7267297179418783`*^9}, {3.726729771668317*^9, 3.7267297975343447`*^9}, 
   3.72672984535421*^9, 3.726733122854603*^9, {3.726733461737167*^9, 
   3.726733482214148*^9}, 3.726737975158907*^9, 3.72673956904487*^9, 
   3.726739652040523*^9, 3.726742194612885*^9, 3.726742521500214*^9, 
   3.728802527096818*^9, 3.7290797378716*^9, 3.730342366150523*^9, 
   3.730385032672081*^9, 3.730385066850779*^9, 3.73038510358624*^9, 
   3.730385197594729*^9, 3.730385271267345*^9, 3.730385325502445*^9, {
   3.730385477382272*^9, 3.7303854892601624`*^9}, 3.73038558464979*^9, 
   3.730385642570347*^9, 3.730385813167302*^9, 3.730385845203987*^9, {
   3.730385943130028*^9, 3.730385962268471*^9}, 3.730386940658038*^9, 
   3.730387122539723*^9, {3.730387158668497*^9, 3.73038717298641*^9}, 
   3.730387705947432*^9, 3.73038810300249*^9, {3.730410111216833*^9, 
   3.730410119808845*^9}, 3.7304161234325933`*^9, 3.73041645666063*^9, 
   3.730416604201837*^9, 3.733088361391914*^9, 3.733151631162038*^9, 
   3.733255246541347*^9, 3.733256025584856*^9, 3.733258681582513*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Verify that saturation does not play a role when we linearize (so, we can \
ignore saturations)
\[Sigma][0]=0
\[Sigma]\[CloseCurlyQuote][0]=1\
\>", "Subchapter",
 CellChangeTimes->{{3.7303311750362177`*^9, 3.730331201933482*^9}, {
  3.730331799871663*^9, 3.7303318083096657`*^9}}],

Cell[CellGroupData[{

Cell["\<\
input with and without saturations is the same at the equilibrium\
\>", "Subsubsection",
 CellChangeTimes->{{3.730331812573482*^9, 3.7303318391010323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uclPIDSaturated", "[", 
       RowBox[{
        RowBox[{"z3eqSaturated", "[", "#", "]"}], ",", "#"}], "]"}], "-", 
      RowBox[{"uclPID", "[", 
       RowBox[{
        RowBox[{"z3eq", "[", "#", "]"}], ",", "#"}], "]"}]}], "&"}], "[", 
    RowBox[{"{", 
     RowBox[{
     "pxd", ",", "pyd", ",", "pzd", ",", "T", ",", "nxd", ",", "nyd", ",", 
      "nzd"}], "}"}], "]"}], ",", 
   RowBox[{
    RowBox[{"\[Sigma]", "[", "0", "]"}], "\[Equal]", "0"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.7303317666483793`*^9, 3.7303317921887093`*^9}, {
  3.7303428222049026`*^9, 3.730342825769911*^9}, {3.7303872024818907`*^9, 
  3.730387224718526*^9}}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,309,3,31253086223105391869,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73038722858812*^9, 3.730387706135316*^9, 
  3.730388103140491*^9, 3.7304101112916718`*^9, 3.730416123593075*^9, 
  3.7304164568158197`*^9, 3.7304166044482822`*^9, 3.733088361474782*^9, 
  3.733151631267579*^9, 3.733255246764454*^9, 3.733256025706712*^9, 
  3.733258681806287*^9}],

Cell[BoxData[
 TemplateBox[{
  "InverseFunction","ifun",
   "\"Inverse functions are being used. Values may be lost for multivalued \
inverses.\"",2,309,4,31253086223105391869,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73038722858812*^9, 3.730387706135316*^9, 
  3.730388103140491*^9, 3.7304101112916718`*^9, 3.730416123593075*^9, 
  3.7304164568158197`*^9, 3.7304166044482822`*^9, 3.733088361474782*^9, 
  3.733151631267579*^9, 3.733255246764454*^9, 3.733256025706712*^9, 
  3.733258681809936*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.730331772061802*^9, 3.730331792894672*^9}, 
   3.7303339021088133`*^9, 3.730334301480698*^9, 3.730336539316042*^9, 
   3.730342316073567*^9, 3.730342819378593*^9, 3.73038433328545*^9, 
   3.7303872286243477`*^9, 3.7303877061869497`*^9, 3.7303881031966248`*^9, 
   3.7304101113512697`*^9, 3.730416123703637*^9, 3.730416456875408*^9, 
   3.730416604466202*^9, 3.7330883615053883`*^9, 3.733151631293928*^9, 
   3.733255246786578*^9, 3.733256025733241*^9, 3.733258681830495*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
note that equilibrium point is the same for the unsaturated and the saturated \
control laws (that is not the case with there is an integral term)\
\>", "Subsubsection",
 CellChangeTimes->{{3.730331208739121*^9, 3.730331241487995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Gamma]", 
    RowBox[{"eq", ",", "generic"}]], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "T", ",", 
     SqrtBox[
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]], ",", "0", ",", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.730387378965826*^9, 3.730387390386397*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["(verified for UAV1, but it can also be verified for UAV 2)", \
"Subsubsection",
 CellChangeTimes->{{3.730387481241078*^9, 3.73038750111821*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ans1", "=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"uclPIDSaturated", "[", 
         RowBox[{"z3", ",", 
          SubscriptBox["\[Gamma]", 
           RowBox[{"eq", ",", "generic"}]]}], "]"}], ",", 
        RowBox[{"{", "z3", "}"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z3", "\[Rule]", " ", 
        RowBox[{"z3eqSaturated", "[", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "generic"}]], "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Sigma]", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "  ", "1"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ans2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"uclPID", "[", 
        RowBox[{"z3", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "generic"}]]}], "]"}], ",", 
       RowBox[{"{", "z3", "}"}]}], "]"}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"z3", "\[Rule]", " ", 
       RowBox[{"z3eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "generic"}]], "]"}]}], "]"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ans1", "-", 
   RowBox[{"(", 
    RowBox[{"ans2", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kiz1", "\[Rule]", " ", 
        RowBox[{"kiz1", " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           TagBox[
            SuperscriptBox["\[Sigma]", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]],
            InverseFunction,
            Editable->False], "[", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u1eqEstimate3D", "[", 
                SubscriptBox["\[Gamma]", 
                 RowBox[{"eq", ",", "generic"}]], "]"}], "-", 
               RowBox[{"u1eq", "[", 
                SubscriptBox["\[Gamma]", 
                 RowBox[{"eq", ",", "generic"}]], "]"}]}], ")"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "m1"], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"kiz2", "\[Rule]", " ", 
        RowBox[{"kiz2", " ", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", 
          RowBox[{
           TagBox[
            SuperscriptBox["\[Sigma]", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]],
            InverseFunction,
            Editable->False], "[", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u2eqEstimate3D", "[", 
                SubscriptBox["\[Gamma]", 
                 RowBox[{"eq", ",", "generic"}]], "]"}], "-", 
               RowBox[{"u2eq", "[", 
                SubscriptBox["\[Gamma]", 
                 RowBox[{"eq", ",", "generic"}]], "]"}]}], ")"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "m2"], "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ")"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.73033079479932*^9, 3.730330960101653*^9}, {
  3.7303309910986834`*^9, 3.730331096513131*^9}, {3.730387247747916*^9, 
  3.730387473826647*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.730330955712413*^9, 3.7303309867527113`*^9}, {
   3.7303310632035217`*^9, 3.7303310967953367`*^9}, 3.730331702972208*^9, 
   3.7303339024017076`*^9, 3.730334301822466*^9, 3.730336539577043*^9, 
   3.730342316576541*^9, 3.730342828150488*^9, 3.730384333502323*^9, 
   3.730387304198031*^9, {3.7303874191939287`*^9, 3.730387474449594*^9}, 
   3.730387706566131*^9, 3.730388103591899*^9, 3.730410112016939*^9, 
   3.7304161241098137`*^9, 3.7304164572425756`*^9, 3.7304166048464746`*^9, 
   3.733088361988471*^9, 3.7331516319823017`*^9, 3.7332552472402782`*^9, 
   3.733256026184692*^9, 3.733258682280298*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "(verified for UAV1, but it can also be verified for UAV 2)\n(equality below \
does not really need to be verified, since it follows from the fact that\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", "dz"], 
     FractionBox["u", 
      SqrtBox[
       RowBox[{"u", ".", "u"}]]]}], "=", 
    RowBox[{
     RowBox[{"\[CapitalPi]", "[", 
      FractionBox["u", 
       SqrtBox[
        RowBox[{"u", ".", "u"}]]], "]"}], 
     FractionBox["1", 
      SqrtBox[
       RowBox[{"u", ".", "u"}]]], 
     FractionBox["d", "dz"], "u"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nand we already verified equality between u and ",
 Cell[BoxData[
  RowBox[{
   FractionBox["d", "dz"], "u"}]]],
 " with and without saturations\n)"
}], "Subsubsection",
 CellChangeTimes->{{3.730387481241078*^9, 3.73038750111821*^9}, {
  3.7303877340034447`*^9, 3.7303878516113157`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Gamma]", 
      RowBox[{"eq", ",", "generic"}]], "=", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
      "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ans1", "=", 
     RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["#", 
              SqrtBox[
               RowBox[{"#", ".", "#"}]]], "&"}], "[", 
            RowBox[{"uclPIDSaturated", "[", 
             RowBox[{"z3", ",", 
              SubscriptBox["\[Gamma]", 
               RowBox[{"eq", ",", "generic"}]]}], "]"}], "]"}], ")"}], ",", 
          RowBox[{"{", "z3", "}"}]}], "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"z3", "\[Rule]", " ", 
          RowBox[{"z3eqSaturated", "[", 
           SubscriptBox["\[Gamma]", 
            RowBox[{"eq", ",", "generic"}]], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Sigma]", "\[Prime]",
           MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "  ", "1"}],
         " ", "&&", " ", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "0", "]"}], "\[Equal]", "  ", "0"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ans2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["#", 
             SqrtBox[
              RowBox[{"#", ".", "#"}]]], "&"}], "[", 
           RowBox[{"uclPID", "[", 
            RowBox[{"z3", ",", 
             SubscriptBox["\[Gamma]", 
              RowBox[{"eq", ",", "generic"}]]}], "]"}], "]"}], ")"}], ",", 
         RowBox[{"{", "z3", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"z3", "\[Rule]", " ", 
         RowBox[{"z3eq", "[", 
          SubscriptBox["\[Gamma]", 
           RowBox[{"eq", ",", "generic"}]], "]"}]}], "]"}]}], "//", 
      "Simplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ans1", "-", 
      RowBox[{"(", 
       RowBox[{"ans2", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kiz1", "\[Rule]", " ", 
           RowBox[{"kiz1", " ", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "\[Prime]",
              MultilineFunction->None], "[", 
             RowBox[{
              TagBox[
               SuperscriptBox["\[Sigma]", 
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}]],
               InverseFunction,
               Editable->False], "[", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"u1eqEstimate3D", "[", 
                   SubscriptBox["\[Gamma]", 
                    RowBox[{"eq", ",", "generic"}]], "]"}], "-", 
                  RowBox[{"u1eq", "[", 
                   SubscriptBox["\[Gamma]", 
                    RowBox[{"eq", ",", "generic"}]], "]"}]}], ")"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "m1"], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"kiz2", "\[Rule]", " ", 
           RowBox[{"kiz2", " ", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "\[Prime]",
              MultilineFunction->None], "[", 
             RowBox[{
              TagBox[
               SuperscriptBox["\[Sigma]", 
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}]],
               InverseFunction,
               Editable->False], "[", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"u2eqEstimate3D", "[", 
                   SubscriptBox["\[Gamma]", 
                    RowBox[{"eq", ",", "generic"}]], "]"}], "-", 
                  RowBox[{"u2eq", "[", 
                   SubscriptBox["\[Gamma]", 
                    RowBox[{"eq", ",", "generic"}]], "]"}]}], ")"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "m2"], "]"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ")"}]}], "//", "Simplify"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.73033079479932*^9, 3.730330960101653*^9}, {
  3.7303309910986834`*^9, 3.730331096513131*^9}, {3.730387247747916*^9, 
  3.730387473826647*^9}, {3.730387532607974*^9, 3.730387596147023*^9}, {
  3.730387886660995*^9, 3.7303878895052023`*^9}, {3.730387946134263*^9, 
  3.730387998057341*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Symmetric T=0 and \[Theta]=0", "Title",
 CellChangeTimes->{{3.726383870002284*^9, 3.72638387347583*^9}, {
  3.7263949107283154`*^9, 3.72639491167203*^9}, {3.7264106266333838`*^9, 
  3.726410634737524*^9}, {3.7266757540591288`*^9, 3.726675754774651*^9}, {
  3.7267380117529097`*^9, 3.7267380120266743`*^9}, {3.730392530656164*^9, 
  3.730392537204002*^9}}],

Cell[CellGroupData[{

Cell["equilibrium parametrization", "Subsubsection",
 CellChangeTimes->{{3.7303418117715607`*^9, 3.7303418168665257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Gamma]", 
    RowBox[{"eq", ",", "1"}]], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}],
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726663312002758*^9, 3.726663327356833*^9}, {
  3.726668086034553*^9, 3.7266680868764267`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification", "Chapter",
 CellChangeTimes->{{3.726394905303945*^9, 3.726394907969009*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SimplificationsParameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", " ", 
     RowBox[{"m2", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplificationsGains", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"kpx1", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"kpx2", "\[Rule]", " ", "kpx"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "same", " ", "proportional", " ", "gain", " ", "in", " ", 
       "longitudinal", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kvx1", "\[Rule]", " ", "kvx"}], ",", 
     RowBox[{"kvx2", "\[Rule]", " ", "kvx"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kpy1", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"kpy2", "\[Rule]", " ", "kpy"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "same", " ", "proportional", " ", "gain", " ", "in", " ", "lateral", 
       " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kvy1", "\[Rule]", " ", "kvy"}], ",", 
     RowBox[{"kvy2", "\[Rule]", " ", "kvy"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kpz1", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"kpz2", "\[Rule]", " ", "kpz"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "same", " ", "proportional", " ", "gain", " ", "in", " ", "vertical", 
       " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kvz1", "\[Rule]", " ", "kvz"}], ",", 
     RowBox[{"kvz2", "\[Rule]", " ", "kvz"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kp\[Psi]1", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]1", "\[Rule]", " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kp\[Psi]2", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"kv\[Psi]2", "\[Rule]", " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
     RowBox[{"kpr2", "\[Rule]", " ", "kpr"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kiz1", "\[Rule]", " ", "kiz"}], ",", 
     RowBox[{"kiz2", "\[Rule]", " ", "kiz"}]}], " ", 
    RowBox[{"(*", 
     RowBox[{"same", " ", "integral", " ", "gain"}], "*)"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Simplifications", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"SimplificationsParameters", ",", "SimplificationsGains"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsParameters", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "SimplificationsParameters"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}], "&&", 
       RowBox[{"M", ">", "0"}]}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplificationsGains", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"#", "/.", "SimplificationsGains"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySimplifications", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"#", "/.", "Simplifications"}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}], "&&", 
       RowBox[{"M", ">", "0"}]}]}], "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.726319366587973*^9, 3.7263194239291143`*^9}, {
   3.726326664972498*^9, 3.72632682474743*^9}, {3.726326908336322*^9, 
   3.726326922450852*^9}, 3.726384367929195*^9, {3.726663272066338*^9, 
   3.726663273806211*^9}, {3.726670066547372*^9, 3.726670071959792*^9}, {
   3.726670886439637*^9, 3.7266708952836733`*^9}, {3.726739751199342*^9, 
   3.7267399064162188`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stability vector field term (only for analysis)", "Chapter",
 CellChangeTimes->{{3.7120421708683567`*^9, 3.7120422205169086`*^9}, {
  3.7128306840760193`*^9, 3.71283068718001*^9}, {3.7134496094633293`*^9, 
  3.7134496232282867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DZ3SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
      "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
      "\[Xi]2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z3SET", "[", "z3", "]"}], ",", 
      RowBox[{"{", "z3", "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.712830773527231*^9, 3.7128309192395477`*^9}, {
   3.712833495665552*^9, 3.712833508713584*^9}, {3.71283357008792*^9, 
   3.7128335976910353`*^9}, {3.71283534408328*^9, 3.712835344330735*^9}, {
   3.7128355335133457`*^9, 3.7128355336799107`*^9}, 3.712837005757556*^9, 
   3.712837065836936*^9, 3.712838456858864*^9, {3.712838505922365*^9, 
   3.712838551215933*^9}, {3.7128418281986103`*^9, 3.712841828216846*^9}, {
   3.712842173539816*^9, 3.712842173548656*^9}, {3.712847966278987*^9, 
   3.7128479662996902`*^9}, {3.712905307583363*^9, 3.712905307739265*^9}, 
   3.713449834593012*^9, {3.713600697627223*^9, 3.7136007092075443`*^9}, {
   3.724684045820299*^9, 3.724684045829007*^9}, {3.724751341533758*^9, 
   3.7247513415439157`*^9}, {3.724768463749054*^9, 3.724768468124543*^9}, {
   3.726317769433804*^9, 3.726317784338602*^9}, {3.726318444340234*^9, 
   3.7263184457061653`*^9}, {3.726669625481001*^9, 3.726669645559219*^9}, {
   3.726669686051043*^9, 3.726669716180663*^9}, {3.726738044649199*^9, 
   3.726738090253574*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["determinant of matrix being inverted is positive", "Chapter",
 CellChangeTimes->{{3.713449796880292*^9, 3.7134498095432177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Det", "[", 
       RowBox[{"#", ".", 
        RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
     RowBox[{"DZ3SET", "[", 
      RowBox[{"z3eq", "[", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"eq", ",", "1"}]], "]"}], "]"}], "]"}], "-", " ", 
    FractionBox[
     TagBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["2", "5"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"d1", ",", "d2"}], "}"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ".", 
            RowBox[{"{", 
             RowBox[{"d1", ",", "d2"}], "}"}]}]}], ")"}]}], ")"}], "2"],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]], 
     RowBox[{
      SuperscriptBox["L1", "4"], " ", 
      SuperscriptBox["L2", "4"]}]]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.726318179453529*^9, 3.726318186652172*^9}, {
  3.726318217572694*^9, 3.726318233081394*^9}, {3.726318293399637*^9, 
  3.726318360957098*^9}, {3.726665672808339*^9, 3.726665702108613*^9}, {
  3.726669618033771*^9, 3.726669618411982*^9}, {3.72666965360693*^9, 
  3.726669673571744*^9}, {3.726669727449441*^9, 3.726669799979232*^9}, {
  3.7267380697118797`*^9, 3.726738099601037*^9}, {3.7303882128647337`*^9, 
  3.730388213266996*^9}}],

Cell[BoxData[
 TagBox["0",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726318180711135*^9, 3.726318187739593*^9}, {
   3.72631823352956*^9, 3.726318240603044*^9}, {3.726318282059971*^9, 
   3.726318294245775*^9}, {3.7263183246076*^9, 3.7263183621338043`*^9}, 
   3.726318423207368*^9, 3.726325310787218*^9, 3.726383914292348*^9, 
   3.726398696144128*^9, 3.7266656534233313`*^9, {3.726665686030655*^9, 
   3.726665702778326*^9}, 3.726666884271078*^9, {3.726669619893312*^9, 
   3.72666975899158*^9}, {3.72666979553512*^9, 3.7266698008621073`*^9}, 
   3.72666998548096*^9, {3.726738080817458*^9, 3.726738100133525*^9}, 
   3.72673957971581*^9, 3.726739665074848*^9, 3.7303882154953613`*^9, {
   3.733088370507444*^9, 3.7330883747468367`*^9}, 3.733151633762554*^9, 
   3.733255247759686*^9, 3.733256026677238*^9, 3.733258682916823*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Linearization matrix", "Chapter",
 CellChangeTimes->{{3.712043505293087*^9, 3.712043512378201*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["A", "0"], ",", 
      SubscriptBox["A", "1"]}], "}"}], "=", 
    RowBox[{"Linearization", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Z3cl", "[", 
        RowBox[{"#", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "1"}]]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z3SET", "[", "#", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"z3eq", "[", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"eq", ",", "1"}]], "]"}], ",", "\[IndentingNewLine]", 
      "ApplySimplificationsParameters"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.72666434496215*^9, 3.726664349991723*^9}, {
   3.7266669004646597`*^9, 3.726666923433338*^9}, 3.726666979922227*^9, {
   3.7266671119182053`*^9, 3.7266671744373302`*^9}, {3.7266680966497917`*^9, 
   3.726668098366765*^9}, {3.726669845204954*^9, 3.726669848475807*^9}, {
   3.7267381129224052`*^9, 3.726738116162215*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "unit", " ", "vector", " ", "of", " ", "dimension", " ", "of", " ", 
    "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "i_", "]"}], ":=", 
    RowBox[{"UnitVector", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dimensions", "[", "z3", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.726670007137466*^9, 3.726670007235956*^9}, {
  3.7267381320807533`*^9, 3.726738132328216*^9}, {3.7267395907056437`*^9, 
  3.726739591335235*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{"e_", ",", "n_", ",", "A_"}], "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"ApplySimplificationsParameters", "[", 
       RowBox[{"#", ".", "A"}], "]"}], "]"}], "&"}], ",", "e", ",", 
    RowBox[{"n", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainOfIntegrators", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["d2", 
        RowBox[{"d2", "-", "d1"}]], " ", 
       RowBox[{"e", "[", "31", "]"}]}], "+", 
      RowBox[{
       FractionBox["d1", 
        RowBox[{"d1", "-", "d2"}]], " ", 
       RowBox[{"e", "[", "32", "]"}]}]}], ",", "3", ",", 
     SubscriptBox["A", "0"]}], "]"}], "//", "MatrixForm"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"chainOfIntegrators", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["d2", 
         RowBox[{"d2", "-", "d1"}]], " ", 
        RowBox[{"e", "[", "31", "]"}]}], "+", 
       RowBox[{
        FractionBox["d1", 
         RowBox[{"d1", "-", "d2"}]], " ", 
        RowBox[{"e", "[", "32", "]"}]}]}], ",", "3", ",", 
      SubscriptBox["A", "1"]}], "]"}], "//", "MatrixForm"}], "//", 
   "Simplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"chainOfIntegrators", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", "5", ",", 
      SubscriptBox["A", "0"]}], "]"}], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"chainOfIntegrators", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", "5", ",", 
      SubscriptBox["A", "1"]}], "]"}], "//", "MatrixForm"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7263257888187017`*^9, 3.7263258724726763`*^9}, {
   3.7263259166627893`*^9, 3.726326042888208*^9}, {3.7263261879160957`*^9, 
   3.7263261983325*^9}, 3.726326848143663*^9, {3.726667313967251*^9, 
   3.726667320253922*^9}, {3.7266700400873127`*^9, 3.726670040221426*^9}, {
   3.7266700874386997`*^9, 3.726670087561207*^9}, {3.726738268931831*^9, 
   3.726738304949522*^9}, {3.726739691212934*^9, 3.726739693021874*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "0", "0", 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "0", "0", 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726325956372691*^9, 3.726326007567583*^9}, 
   3.726326043774054*^9, 3.726334431506309*^9, 3.726383959228827*^9, 
   3.726398730549676*^9, 3.7266673210093317`*^9, 3.726667472053864*^9, {
   3.726670022756057*^9, 3.726670040516191*^9}, {3.726670084132329*^9, 
   3.726670089116767*^9}, 3.7267381382174053`*^9, {3.726738283997486*^9, 
   3.726738305769822*^9}, 3.726739592547319*^9, {3.726739673391534*^9, 
   3.7267396938358517`*^9}, 3.730388232680019*^9, 3.7330883943401012`*^9, 
   3.733151641912239*^9, 3.733255253129628*^9, 3.733256031945215*^9, 
   3.733258688474181*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "0", "0", 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["\[Lambda]", "3"], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "+", "d2"}], ")"}], " ", "\[Lambda]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "d1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", 
             SuperscriptBox["d", "2"]}], ")"}], " ", "d2"}]}], ")"}], " ", 
        "\[Lambda]"}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}]}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["d", "2"]}], ")"}], " ", "d1"}], "+", "d2", "-", 
           
           RowBox[{
            SuperscriptBox["d", "2"], " ", "d2"}]}], ")"}], " ", 
         "\[Lambda]"}], 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}]}]]}], "0", "0", 
      FractionBox["1", "3"], "0", 
      FractionBox[
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "+", "d2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}]}]], "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", "-", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", "d1"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", "d2"}]}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}]}]], "0", "0", 
      FractionBox[
       RowBox[{"d1", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["d", "2"], " ", "d1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["d", "2"]}], ")"}], " ", "d2"}]}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}]}]], "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726325956372691*^9, 3.726326007567583*^9}, 
   3.726326043774054*^9, 3.726334431506309*^9, 3.726383959228827*^9, 
   3.726398730549676*^9, 3.7266673210093317`*^9, 3.726667472053864*^9, {
   3.726670022756057*^9, 3.726670040516191*^9}, {3.726670084132329*^9, 
   3.726670089116767*^9}, 3.7267381382174053`*^9, {3.726738283997486*^9, 
   3.726738305769822*^9}, 3.726739592547319*^9, {3.726739673391534*^9, 
   3.7267396938358517`*^9}, 3.730388232680019*^9, 3.7330883943401012`*^9, 
   3.733151641912239*^9, 3.733255253129628*^9, 3.733256031945215*^9, 
   3.733258688821404*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
    RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["d2", 
            RowBox[{"d2", "-", "d1"}]], " ", 
           RowBox[{"e", "[", "31", "]"}]}], "+", 
          RowBox[{
           FractionBox["d1", 
            RowBox[{"d1", "-", "d2"}]], " ", 
           RowBox[{"e", "[", "32", "]"}]}]}], ",", "3", ",", "A"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"d2", "-", "d1"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "[", "31", "]"}], "-", " ", 
            RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ",", "3", ",", "A"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "7", "]"}], "-", 
          RowBox[{"e", "[", "10", "]"}]}], ",", "3", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", "5", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", "5", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "5", "]"}], ",", "5", ",", "A"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
   RowBox[{"ApplySimplificationsParameters", "[", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PA", "[", "A", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DZ3SET", "[", 
       RowBox[{"z3eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["P", "0"], "=", 
   RowBox[{"PPA", "[", 
    SubscriptBox["A", "0"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "1"], "=", 
    RowBox[{"PPA", "[", 
     SubscriptBox["A", "1"], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
   3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
   3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
   3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
   3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
   3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
   3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}, {
   3.712831094381729*^9, 3.712831095820244*^9}, {3.712831148394435*^9, 
   3.7128311596982203`*^9}, {3.7128311998383636`*^9, 3.712831230922905*^9}, {
   3.71283380404528*^9, 3.712833817585775*^9}, {3.7128338578199453`*^9, 
   3.7128339145293837`*^9}, {3.712834032813575*^9, 3.712834033874092*^9}, {
   3.712836024098538*^9, 3.7128360488484507`*^9}, {3.71283609327536*^9, 
   3.712836118528947*^9}, {3.712836924452547*^9, 3.712836958498642*^9}, {
   3.712844426115212*^9, 3.71284450242596*^9}, {3.7128449771537046`*^9, 
   3.712845086412121*^9}, {3.712848439443294*^9, 3.7128485151925364`*^9}, {
   3.712944738222735*^9, 3.712944749777299*^9}, {3.712988102089939*^9, 
   3.7129881257009773`*^9}, {3.7134500543777742`*^9, 3.713450055447535*^9}, {
   3.724678693813246*^9, 3.724678697955299*^9}, {3.7246823296039057`*^9, 
   3.724682336385404*^9}, {3.724682370244699*^9, 3.7246823710267973`*^9}, {
   3.724683277507218*^9, 3.7246833021887293`*^9}, {3.7246834824509897`*^9, 
   3.724683513686524*^9}, {3.724684763780971*^9, 3.724684886425336*^9}, {
   3.72468839967736*^9, 3.724688410177302*^9}, {3.7247417260960283`*^9, 
   3.724741737955247*^9}, {3.724751538261547*^9, 3.7247516157283382`*^9}, {
   3.724751670903892*^9, 3.724751672969146*^9}, {3.724751760644328*^9, 
   3.72475178892412*^9}, {3.724751820655284*^9, 3.724751832936578*^9}, {
   3.724751999539131*^9, 3.724752021780467*^9}, 3.724752097482242*^9, {
   3.724752161886855*^9, 3.724752168133781*^9}, {3.724752446862174*^9, 
   3.724752448614086*^9}, {3.724757996420842*^9, 3.72475800444925*^9}, {
   3.7247580472472982`*^9, 3.724758052534409*^9}, {3.724758086078887*^9, 
   3.7247581075217037`*^9}, {3.724758396290547*^9, 3.724758408015748*^9}, {
   3.724758470544146*^9, 3.724758473931033*^9}, 3.7247586153657417`*^9, {
   3.724759149139023*^9, 3.724759151388007*^9}, {3.724759288648301*^9, 
   3.724759302491118*^9}, {3.724768760869358*^9, 3.724768800242721*^9}, {
   3.7247688560626087`*^9, 3.724768863292123*^9}, {3.724768936314774*^9, 
   3.724768950040413*^9}, 3.7247720001122103`*^9, {3.724853635498878*^9, 
   3.7248536406972437`*^9}, {3.726318927086563*^9, 3.726319024616363*^9}, {
   3.726326206275281*^9, 3.726326416142439*^9}, {3.726326454606626*^9, 
   3.726326455720798*^9}, {3.7263265943687067`*^9, 3.726326611353199*^9}, {
   3.7263268511347427`*^9, 3.7263268535081244`*^9}, {3.726336547766362*^9, 
   3.726336572881345*^9}, {3.726667477766415*^9, 3.7266675280761747`*^9}, {
   3.7266680497295427`*^9, 3.726668072533704*^9}, {3.726668110516262*^9, 
   3.7266682143432198`*^9}, {3.7266683526175632`*^9, 3.726668385747107*^9}, {
   3.726670101186329*^9, 3.7266701373548107`*^9}, {3.726670655003562*^9, 
   3.726670735169519*^9}, {3.726738190417445*^9, 3.726738192865327*^9}, {
   3.72673824593629*^9, 3.726738246730743*^9}, {3.726738935260193*^9, 
   3.726739085230927*^9}, {3.726739132154704*^9, 3.726739265838004*^9}, {
   3.726739321501917*^9, 3.726739355468792*^9}, {3.730388253009066*^9, 
   3.730388255106299*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant of similarity matrix", "Chapter",
 CellChangeTimes->{{3.72927489284953*^9, 3.729274902051298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "0"], "]"}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"gravity", " "}], "L"], ")"}], "13"], 
    FractionBox["1", 
     SuperscriptBox["d", "4"]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{" ", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", "m", " "}]}], 
       RowBox[{"2", " ", "J"}]], ")"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["m", "M"], "+", "2"}], ")"}], "4"]}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "1"], "]"}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"gravity", " "}], "L"], ")"}], "13"], 
    FractionBox["1", 
     SuperscriptBox["d", "4"]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{" ", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", "m", " "}]}], 
       RowBox[{"2", " ", "J"}]], ")"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["m", "M"], "+", "2"}], ")"}], "4"]}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.730340907000555*^9, 3.730340915755806*^9}, 
   3.730388285704113*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7303409398991957`*^9, 3.730388286540605*^9, 3.733088394831091*^9, {
   3.733151623731763*^9, 3.7331516440917397`*^9}, 3.7332552537117977`*^9, 
   3.73325603257821*^9, 3.7332586893070927`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7303409398991957`*^9, 3.730388286540605*^9, 3.733088394831091*^9, {
   3.733151623731763*^9, 3.7331516440917397`*^9}, 3.7332552537117977`*^9, 
   3.73325603257821*^9, 3.733258689331349*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
sum of integrals: z-linear motion
difference of integrals: z-angular motion\
\>", "Chapter",
 CellChangeTimes->{{3.7267388866804447`*^9, 3.7267389102231607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chainOfIntegrators", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["d2", 
        RowBox[{"d2", "-", "d1"}]], " ", 
       RowBox[{"e", "[", "31", "]"}]}], "+", 
      RowBox[{
       FractionBox["d1", 
        RowBox[{"d1", "-", "d2"}]], " ", 
       RowBox[{"e", "[", "32", "]"}]}]}], ",", "3", ",", 
     SubscriptBox["A", "0"]}], "]"}], ".", "z3"}], "/.", 
  "SimplificationsParameters"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainOfIntegrators", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"d2", "-", "d1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", "[", "31", "]"}], "-", " ", 
        RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ",", "3", ",", 
     SubscriptBox["A", "0"]}], "]"}], ".", "z3"}], "/.", 
  "SimplificationsParameters"}]}], "Input",
 CellChangeTimes->{{3.7303885273225307`*^9, 3.730388533203287*^9}, {
  3.733154181599791*^9, 3.733154183984483*^9}, {3.733154223920868*^9, 
  3.733154226408559*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["\[Xi]1z", "2"], "+", 
    FractionBox["\[Xi]2z", "2"]}], ",", 
   RowBox[{
    FractionBox["p1z", "2"], "+", 
    FractionBox["p2z", "2"]}], ",", 
   RowBox[{
    FractionBox["v1z", "2"], "+", 
    FractionBox["v2z", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7303885338206787`*^9, 3.733088394931693*^9, 
  3.733154168257976*^9, 3.733154227628565*^9, 3.733255253795086*^9, 
  3.733256032657723*^9, 3.7332586894067793`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[Xi]1z", 
      RowBox[{"2", " ", "d"}]]}], "+", 
    FractionBox["\[Xi]2z", 
     RowBox[{"2", " ", "d"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["p1z", 
      RowBox[{"2", " ", "d"}]]}], "+", 
    FractionBox["p2z", 
     RowBox[{"2", " ", "d"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["v1z", 
      RowBox[{"2", " ", "d"}]]}], "+", 
    FractionBox["v2z", 
     RowBox[{"2", " ", "d"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7303885338206787`*^9, 3.733088394931693*^9, 
  3.733154168257976*^9, 3.733154227628565*^9, 3.733255253795086*^9, 
  3.733256032657723*^9, 3.733258689409432*^9}]
}, Open  ]],

Cell["change of coordinates is nessary", "Text",
 CellChangeTimes->{{3.733154207851521*^9, 3.7331542194681463`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"{", 
    RowBox[{
    "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
     "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_", 
     ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", "\[Omega]y_",
      ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", ",", "v2x_", 
     ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", "r1z_", ",", 
     "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", "\[Xi]2z_"}], 
    "}"}], "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"px", ",", "py", ",", "pz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
        RowBox[{"d1", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L1"], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Skew", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
          RowBox[{"d1", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L1"], 
      "]"}], ".", 
     FractionBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1x", ",", "v1y", ",", "v1z"}], "}"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"{", 
             RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}],
             "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}]}], ")"}]}], 
      "L1"]}], ",", "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
        RowBox[{"d2", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L2"], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Skew", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
          RowBox[{"d2", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L2"], 
      "]"}], ".", 
     FractionBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v2x", ",", "v2y", ",", "v2z"}], "}"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
         RowBox[{"d2", " ", 
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"{", 
             RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}],
             "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}]}], ")"}]}], 
      "L2"]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r1x", ",", "r1y", ",", "r1z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r2x", ",", "r2y", ",", "r2z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Xi]1z", ",", "\[Xi]2z"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"{", 
    RowBox[{
    "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
     "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", ",",
      "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "\[Omega]1x_",
      ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", ",", "n2y_", ",", 
     "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", "\[Omega]2z_", ",", 
     "r1x_", ",", "r1y_", ",", "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", 
     ",", "\[Xi]1z_", ",", "\[Xi]2z_"}], "}"}], "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"px", ",", "py", ",", "pz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
     RowBox[{"d1", " ", 
      RowBox[{"{", 
       RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "+", 
     RowBox[{"L1", 
      RowBox[{"{", 
       RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
     RowBox[{"d2", " ", 
      RowBox[{"{", 
       RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "+", 
     RowBox[{"L2", 
      RowBox[{"{", 
       RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
     RowBox[{"d1", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], 
        "]"}], ".", " ", 
       RowBox[{"{", 
        RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
     RowBox[{"L1", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]1x", ",", "\[Omega]1y", ",", "\[Omega]1z"}], "}"}], 
        "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
     RowBox[{"d2", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], 
        "]"}], ".", " ", 
       RowBox[{"{", 
        RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
     RowBox[{"L2", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2x", ",", "\[Omega]2y", ",", "\[Omega]2z"}], "}"}], 
        "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r1x", ",", "r1y", ",", "r1z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r2x", ",", "r2y", ",", "r2z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Xi]1z", ",", "\[Xi]2z"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.733151661717351*^9, 3.733152045348358*^9}, {
  3.733152123944551*^9, 3.733152458404869*^9}, {3.7331527719805937`*^9, 
  3.733152776993416*^9}, {3.7331531593151827`*^9, 3.7331532005809917`*^9}}],

Cell["it is change of coordinates", "Text",
 CellChangeTimes->{{3.733154232991684*^9, 3.733154237006908*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"g", "[", "#", "]"}], "]"}], "-", "#"}], "&"}], "[", 
   RowBox[{"z3l", "[", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "#"], "&"}], ",", 
      RowBox[{"{", "24", "}"}]}], "]"}], "]"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"h", "[", "#", "]"}], "]"}], "-", "#"}], "&"}], "[", "...", 
     "]"}], "//", "Simplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.733152483785006*^9, 3.7331524888560867`*^9}, {
   3.733152553933412*^9, 3.733152567433075*^9}, {3.733152804817501*^9, 
   3.733152816647923*^9}, {3.733153063289318*^9, 3.733153076252722*^9}, 
   3.7331531131327868`*^9, {3.733154241159384*^9, 3.733154255894775*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.733152555319879*^9, 3.7331525680876417`*^9}, {
   3.7331527823826036`*^9, 3.733152818987845*^9}, 3.733153080733286*^9, 
   3.733153126756961*^9, 3.7331532036392593`*^9, {3.733154238721386*^9, 
   3.733154256537022*^9}, 3.733255254157583*^9, 3.73325603301929*^9, 
   3.7332586897737637`*^9}]
}, Open  ]],

Cell["state matrix in new coordinates", "Text",
 CellChangeTimes->{{3.733154277666449*^9, 3.7331542827606564`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x3", "=", 
   RowBox[{"{", 
    RowBox[{
    "px", ",", "py", ",", "pz", ",", "vx", ",", "vy", ",", "vz", ",", "nx", 
     ",", "ny", ",", "nz", ",", "\[Omega]x", ",", "\[Omega]y", ",", 
     "\[Omega]z", ",", "n1x", ",", "n1y", ",", "n1z", ",", "\[Omega]1x", ",", 
     "\[Omega]1y", ",", "\[Omega]1z", ",", "n2x", ",", "n2y", ",", "n2z", ",",
      "\[Omega]2x", ",", "\[Omega]2y", ",", "\[Omega]2z", ",", "r1x", ",", 
     "r1y", ",", "r1z", ",", "r2x", ",", "r2y", ",", "r2z", ",", "\[Xi]1z", 
     ",", "\[Xi]2z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.733153368599655*^9, 3.733153400569893*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ANewCoordinates", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"g", "[", "z3", "]"}], ",", 
            RowBox[{"{", "z3", "}"}]}], "]"}], ".", 
          RowBox[{"Z3cl", "[", 
           RowBox[{"z3", ",", 
            SubscriptBox["\[Gamma]", 
             RowBox[{"eq", ",", "1"}]]}], "]"}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"z3", "\[Rule]", " ", 
           RowBox[{"h", "[", "x3", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", "x3", "}"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"x3", "\[Rule]", " ", 
        RowBox[{"g", "[", 
         RowBox[{"z3eq", "[", 
          SubscriptBox["\[Gamma]", 
           RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "]"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"same", " ", "exact", " ", 
      RowBox[{"result", ":", " ", 
       RowBox[{"Z3cl", "[", 
        RowBox[{"z3", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "1"}]]}], "]"}]}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"z3", "\[Rule]", " ", 
       RowBox[{"z3eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "1"}]], "]"}]}], "]"}]}], " ", "=", " ", "0"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ANewCoordinates", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"g", "[", "z3", "]"}], ",", 
         RowBox[{"{", "z3", "}"}]}], "]"}], ".", 
       SubscriptBox["A", "0"], ".", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"h", "[", "x3", "]"}], ",", 
         RowBox[{"{", "x3", "}"}]}], "]"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z3", "\[Rule]", " ", 
        RowBox[{"z3eq", "[", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "1"}]], "]"}]}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"x3", "\[Rule]", " ", 
       RowBox[{"g", "[", 
        RowBox[{"z3eq", "[", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "]"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.733153285212645*^9, 3.733153294176649*^9}, {
  3.733153327147587*^9, 3.733153364209305*^9}, {3.733153418636723*^9, 
  3.733153464593306*^9}, {3.73315350580814*^9, 3.733153549811129*^9}, {
  3.733153888678481*^9, 3.733153999576663*^9}, {3.733154040684622*^9, 
  3.733154051000181*^9}, {3.7331541078606157`*^9, 3.733154136049608*^9}}],

Cell[CellGroupData[{

Cell["sum of integrals: z-linear motion", "Subsubsection",
 CellChangeTimes->{{3.733154294948539*^9, 3.7331542971067333`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["d2", 
        RowBox[{"d2", "-", "d1"}]], " ", 
       RowBox[{"e", "[", "31", "]"}]}], "+", 
      RowBox[{
       FractionBox["d1", 
        RowBox[{"d1", "-", "d2"}]], " ", 
       RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "x3"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["d2", 
         RowBox[{"d2", "-", "d1"}]], " ", 
        RowBox[{"e", "[", "31", "]"}]}], "+", 
       RowBox[{
        FractionBox["d1", 
         RowBox[{"d1", "-", "d2"}]], " ", 
        RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "ANewCoordinates", ".",
      "x3"}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["d2", 
        RowBox[{"d2", "-", "d1"}]], " ", 
       RowBox[{"e", "[", "31", "]"}]}], "+", 
      RowBox[{
       FractionBox["d1", 
        RowBox[{"d1", "-", "d2"}]], " ", 
       RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "ANewCoordinates", ".", 
    "ANewCoordinates", ".", "x3"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7331540665819197`*^9, 3.7331540789926357`*^9}, {
  3.733154306758502*^9, 3.7331543118291197`*^9}}],

Cell[BoxData["vz"], "Output",
 CellChangeTimes->{{3.7331540622460833`*^9, 3.7331540794230013`*^9}, {
   3.733154304882041*^9, 3.733154312371545*^9}, 3.7332552544364777`*^9, 
   3.733256033292655*^9, 3.73325869014474*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["difference of integrals : z - angular motion", "Subsubsection",
 CellChangeTimes->{{3.733154298531268*^9, 3.733154300381535*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"d2", "-", "d1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", "[", "31", "]"}], "-", " ", 
        RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ")"}], ".", "x3"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"d2", "-", "d1"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "31", "]"}], "-", " ", 
         RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ")"}], ".", 
     "ANewCoordinates", ".", "x3"}], "//", "Simplify"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"d2", "-", "d1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", "[", "31", "]"}], "-", " ", 
        RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ")"}], ".", 
    "ANewCoordinates", ".", "ANewCoordinates", ".", "x3"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7331540905822163`*^9, 3.7331540977588587`*^9}, {
  3.73315431542099*^9, 3.733154318726165*^9}}],

Cell[BoxData["\[Omega]y"], "Output",
 CellChangeTimes->{3.733154098594603*^9, 3.733154319258716*^9, 
  3.7332552545091476`*^9, 3.733256033380714*^9, 3.733258690376485*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
State matrix after similarity transformation (check block triangular \
structure)\
\>", "Chapter",
 CellChangeTimes->{3.730332400811451*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], " ", "=", 
   RowBox[{"ApplySimplifications", "[", 
    RowBox[{
     SubscriptBox["P", "1"], ".", 
     SubscriptBox["A", "1"], ".", 
     RowBox[{"Inverse", "[", 
      SubscriptBox["P", "1"], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["Asimilar", "1"], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{3.730340961959234*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kiz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           SuperscriptBox["M", "2"]}], ")"}]}], "+", 
        RowBox[{"L", " ", "M", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}]}], 
       RowBox[{"12", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           SuperscriptBox["M", "2"]}], ")"}]}], "+", 
        RowBox[{"L", " ", "M", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "kvz", " ", "M"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}]}], 
       RowBox[{"12", " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"6", " ", "M"}]}]]}], "0", "0", 
      FractionBox["gravity", "2"], 
      FractionBox["gravity", "2"]},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kiz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "J"}], " ", "L", " ", "M", " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"J", "-", "M"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", 
            SuperscriptBox["M", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}]}], 
       RowBox[{"4", " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"J", " ", "L", " ", "M", " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"J", "-", "M"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "M"}], ")"}]}], "+", 
           RowBox[{"L", " ", 
            SuperscriptBox["M", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}]}], 
       RowBox[{"4", " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", "M", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"d", " ", "kvz", " ", "L", " ", "M"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "kvz", " ", "L", " ", "M"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "M"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", 
          RowBox[{"2", " ", "M"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]]},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"kpr", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "kpx"}], "-", 
         FractionBox[
          RowBox[{"gravity", " ", "m"}], 
          RowBox[{"2", " ", "L", " ", "M"}]]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr"}], " ", "kvx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d", " ", "gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"kpr", "-", "\[Lambda]"}], ")"}]}], 
       RowBox[{"2", " ", "L", " ", "M"}]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpr", " ", "kvx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kpy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kvy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpr", " ", "kvy", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpr", " ", "kpy", 
         " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpr", " ", "kvy", 
         " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpr", " ", "kvy", " ", "L", " ", "M"}], 
         "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.730332402894513*^9, 3.73033435639926*^9, 
  3.7303406160074244`*^9, 3.7303409863785553`*^9, 3.7303882919498568`*^9, 
  3.7332552551485233`*^9, 3.733256034022417*^9, 3.7332586911422253`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vertical linear and angular motion", "Chapter",
 CellChangeTimes->{{3.713450417179948*^9, 3.713450422588997*^9}, {
  3.726327222144143*^9, 3.726327230092554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"1", ";;", "6"}], ",", 
     RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.712945014916979*^9, 3.712945043809243*^9}, {
   3.712982474447101*^9, 3.712982483165021*^9}, 3.7134504376899633`*^9, {
   3.726327238090015*^9, 3.7263272499610147`*^9}, 3.726668587204664*^9, {
   3.726739929128441*^9, 3.7267399311305847`*^9}, 3.730388333188307*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kiz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kiz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712988511498514*^9, 3.713450443598475*^9, 3.713450710505559*^9, 
   3.713451069364211*^9, 3.7136008867065268`*^9, 3.714030540754437*^9, 
   3.714030762041692*^9, 3.7140317218870707`*^9, 3.7140319518285*^9, 
   3.714034134273993*^9, {3.7263272432238617`*^9, 3.726327250259211*^9}, 
   3.726383960081555*^9, 3.726398733148213*^9, 3.726668591767591*^9, 
   3.726668638781921*^9, 3.726671129676174*^9, 3.72673993154165*^9, 
   3.730388333871996*^9, 3.733255255278596*^9, 3.733256034147238*^9, 
   3.73325869122606*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["vertical linear motion", "Subsection",
 CellChangeTimes->{{3.7263275313349857`*^9, 3.726327541043935*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "6"}], ",", 
       RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328308547742*^9, 3.726328311819013*^9}, 
   3.726668590455509*^9, {3.726739944901808*^9, 3.726739949727179*^9}, 
   3.730388337272377*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kiz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kpz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "kvz", " ", "M"}], 
        RowBox[{"m", "+", 
         RowBox[{"2", " ", "M"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7263283121640463`*^9, 3.726383960120669*^9, 
  3.726398733181141*^9, 3.726668594144422*^9, 3.726668640540851*^9, 
  3.7266711308915453`*^9, 3.726739950213081*^9, 3.726740030280192*^9, 
  3.730388337740734*^9, 3.7332552553534184`*^9, 3.733256034217029*^9, 
  3.7332586913668337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"C3", "[", 
    RowBox[{"fp_", ",", 
     RowBox[{"{", 
      RowBox[{"ki_", ",", "kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", "ki"}], " ", ",", 
      RowBox[{"fp", " ", "kp"}], ",", 
      RowBox[{"fp", " ", "kd"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"C3", "[", 
      RowBox[{"fp", ",", 
       RowBox[{"{", 
        RowBox[{"kiz", ",", "kpz", ",", "kvz"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", "fp"}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327263699593*^9, 3.726327495774548*^9}, {
  3.7263279306820803`*^9, 3.726327941520749*^9}, {3.726328302802548*^9, 
  3.726328303216222*^9}, {3.726671132646541*^9, 3.72667113316278*^9}, {
  3.726739954262232*^9, 3.726740027319096*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"fp", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "M"}], 
     RowBox[{"m", "+", 
      RowBox[{"2", " ", "M"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726327470277322*^9, 3.726327496190207*^9}, 
   3.726327941999847*^9, 3.726328313836656*^9, 3.726383960187357*^9, 
   3.7263987332128687`*^9, 3.726668642136159*^9, 3.726671133603827*^9, {
   3.726739989763105*^9, 3.726740031332349*^9}, 3.730388339645996*^9, 
   3.7332552554229307`*^9, 3.73325603428761*^9, 3.733258691464179*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["vertical angular motion", "Subsection",
 CellChangeTimes->{{3.7263275313349857`*^9, 3.726327549661537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "6"}], ",", 
       RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"4", ";;", "6"}], ",", 
      RowBox[{"4", ";;", "6"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328285687058*^9, 3.726328294429411*^9}, 
   3.726668622469624*^9, {3.726740008157989*^9, 3.726740014156268*^9}, 
   3.730388341851261*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kiz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "M"}], 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "M"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.726328295422483*^9, 3.726383960244869*^9, 
  3.726398733243904*^9, 3.726668644007777*^9, 3.726671135868108*^9, 
  3.7267400156176043`*^9, 3.726740052430232*^9, 3.7303883423074207`*^9, 
  3.7332552554939947`*^9, 3.733256034360321*^9, 3.733258691532774*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"C3", "[", 
      RowBox[{"fp_", ",", 
       RowBox[{"{", 
        RowBox[{"ki_", ",", "kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fp", " ", "ki"}], " ", ",", 
        RowBox[{"fp", " ", "kp"}], ",", 
        RowBox[{"fp", " ", "kd"}]}], "}"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"C3", "[", 
       RowBox[{"fp", ",", 
        RowBox[{"{", 
         RowBox[{"kiz", ",", "kpz", ",", "kvz"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", "fp"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.726327516025825*^9, 3.7263275194444313`*^9}, {
  3.726327896032098*^9, 3.7263279188220367`*^9}, {3.726328281425914*^9, 
  3.7263282985897617`*^9}, {3.726740037295526*^9, 3.726740047444848*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"fp", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["d", "2"], " ", "M"}], 
     RowBox[{"J", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", "M"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.726327520171771*^9, 3.726327922975806*^9, 3.7263282989942408`*^9, 
   3.7263839602907667`*^9, 3.726398733281904*^9, 3.7266686453909063`*^9, 
   3.726671138667508*^9, {3.7267400499119368`*^9, 3.726740053499915*^9}, 
   3.7303883446803913`*^9, 3.7332552555659323`*^9, 3.733256034428874*^9, 
   3.733258691616858*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Longitudinal motion", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}}],

Cell[CellGroupData[{

Cell["linear motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.7263281711595583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"10", ";;", "14"}], ",", 
      RowBox[{"10", ";;", "14"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, 
   3.726668623349978*^9, {3.726671169197214*^9, 3.726671176857066*^9}, {
   3.726740099455248*^9, 3.726740099656651*^9}, {3.726740132754334*^9, 
   3.726740141877947*^9}, 3.7303883475205317`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kpx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kvx"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpx", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpr", " ", "kvx", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726383960340681*^9, 3.72639873329073*^9, 3.726668647663102*^9, 
   3.726671140553643*^9, 3.726671177170166*^9, 3.726671250554158*^9, 
   3.726740142098926*^9, 3.730388348100007*^9, 3.733255255634294*^9, 
   3.733256034502502*^9, 3.7332586917014103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]5", "[", 
   RowBox[{"q_", ",", 
    RowBox[{"{", 
     RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", " ", "fp", " ", "kp"}], " ", ",", 
     RowBox[{"fp", " ", "fd", " ", "kd"}], ",", 
     RowBox[{"fd", 
      RowBox[{"(", 
       RowBox[{"kp", "+", " ", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], " ", ",", 
     RowBox[{
      RowBox[{"fd", " ", "kd"}], "+", 
      RowBox[{"fp", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "fd"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"\[CapitalGamma]5", "[", 
      RowBox[{"q", ",", 
       RowBox[{"{", 
        RowBox[{"fp", ",", "kpr"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", "fp"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
   3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
   3.726328241473325*^9}, {3.726671252834674*^9, 3.726671318855444*^9}, 
   3.726671778106538*^9, {3.7267401475361137`*^9, 3.726740159563325*^9}, {
   3.730388353160185*^9, 3.730388378867765*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q", "\[Rule]", 
     FractionBox["m", 
      RowBox[{"2", " ", "M"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox["gravity", "L"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, 3.726383960396386*^9, 3.726398733324707*^9, 
   3.7266686497477283`*^9, {3.726671282486897*^9, 3.726671319209889*^9}, {
   3.726740144276381*^9, 3.7267401601866493`*^9}, 3.7303883800047007`*^9, 
   3.733255255713221*^9, 3.73325603458449*^9, 3.733258691786295*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.72632817761716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"7", ";;", "9"}], ",", 
      RowBox[{"7", ";;", "9"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{
  3.7266686240866823`*^9, {3.726671164664237*^9, 3.726671166473584*^9}, {
   3.726740114900279*^9, 3.726740129424129*^9}, 3.7303883826536493`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"kpr", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "kpx"}], "-", 
         FractionBox[
          RowBox[{"gravity", " ", "m"}], 
          RowBox[{"2", " ", "L", " ", "M"}]]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr"}], " ", "kvx"}], "-", 
       FractionBox[
        RowBox[{"gravity", " ", "m"}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328275912224*^9, 3.726383960433279*^9, 3.726398733363179*^9, 
   3.726668651343306*^9, 3.7266713361055613`*^9, 3.7266717191336946`*^9, {
   3.726740121951673*^9, 3.726740129904848*^9}, 3.726740166707769*^9, 
   3.730388383105104*^9, 3.733255255781912*^9, 3.733256034648658*^9, 
   3.733258691868629*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}], 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "-", 
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "&"}], "[", "AofInterest", 
    "]"}], "//", "Simplify"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7266713942660313`*^9, 3.726671435342223*^9}, 
   3.726671710019868*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]3", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fd_", ",", "\[Delta]kp_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"fd", " ", "kp"}], "+", 
       RowBox[{"fd", " ", "\[Delta]kp"}]}], ",", 
      RowBox[{
       RowBox[{"fd", " ", "kd"}], "+", "\[Delta]kp"}], ",", "fd"}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"\[CapitalGamma]3", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fd", ",", "\[Delta]kp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"fd", ",", "\[Delta]kp"}], "}"}]}], "\[IndentingNewLine]", "]"}],
   "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327606871179*^9, 3.7263276106035624`*^9}, {
   3.726327770793311*^9, 3.726327799705961*^9}, {3.7263279496618958`*^9, 
   3.72632798833605*^9}, {3.726328261955852*^9, 3.726328272422624*^9}, {
   3.7263963015221977`*^9, 3.7263963017709084`*^9}, {3.726671627741637*^9, 
   3.726671704484096*^9}, 3.7266717346393642`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fd", "\[Rule]", "kpr"}], ",", 
    RowBox[{"\[Delta]kp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", "m"}], 
      RowBox[{"2", " ", "L", " ", "M"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7263276108839684`*^9, 3.726327800066736*^9, {3.7263279685390987`*^9, 
   3.726327989012171*^9}, 3.7263282741889153`*^9, 3.72638396049432*^9, 
   3.726398733405307*^9, 3.726668652868309*^9, {3.726671699527977*^9, 
   3.72667173494118*^9}, {3.726740169595335*^9, 3.726740183467149*^9}, 
   3.730388385953659*^9, 3.733255255910823*^9, 3.733256034774012*^9, 
   3.733258692010791*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lateral motion", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}, {
   3.726328191491131*^9, 3.726328192534465*^9}}],

Cell[CellGroupData[{

Cell["linear motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.7263281711595583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"15", ";;", "19"}], ",", 
      RowBox[{"15", ";;", "19"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
   3.72632832070956*^9, 3.726328327715292*^9}, 3.7266686252060137`*^9, {
   3.726671754344098*^9, 3.726671770593659*^9}, {3.7267401916408987`*^9, 
   3.7267401984206953`*^9}, 3.730388388483963*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kpy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", "kvy"}], "L"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"gravity", " ", "m"}], "+", 
         RowBox[{"2", " ", "gravity", " ", "M"}], "+", 
         RowBox[{"2", " ", "kpr", " ", "kvy", " ", "L", " ", "M"}]}], 
        RowBox[{"2", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726328328183877*^9, 3.726383960533135*^9, 3.7263987334381447`*^9, 
   3.726668654710672*^9, 3.726671772003193*^9, {3.726740199025012*^9, 
   3.72674021837519*^9}, 3.7303883896502733`*^9, 3.733255255980191*^9, 
   3.733256034841441*^9, 3.733258692081942*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalGamma]5", "[", 
     RowBox[{"q_", ",", 
      RowBox[{"{", 
       RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fd", " ", "fp", " ", "kp"}], " ", ",", 
       RowBox[{"fp", " ", "fd", " ", "kd"}], ",", 
       RowBox[{"fd", 
        RowBox[{"(", 
         RowBox[{"kp", "+", " ", 
          RowBox[{"fp", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], " ", ",", 
       RowBox[{
        RowBox[{"fd", " ", "kd"}], "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "fd"}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"\[CapitalGamma]5", "[", 
       RowBox[{"q", ",", 
        RowBox[{"{", 
         RowBox[{"fp", ",", "kpr"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"q", ",", "fp"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
  3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
  3.726328241473325*^9}, {3.7263283332636557`*^9, 3.726328342768092*^9}, {
  3.726671781484561*^9, 3.726671808929249*^9}, {3.730388398313978*^9, 
  3.7303884061151743`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q", "\[Rule]", 
     FractionBox["m", 
      RowBox[{"2", " ", "M"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox["gravity", "L"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, 3.7263283432806273`*^9, 3.7263839606007843`*^9, 
   3.726398733470619*^9, 3.7266686560986757`*^9, 3.726671809524026*^9, 
   3.726740201766884*^9, 3.730388406478941*^9, 3.733255256057847*^9, 
   3.733256034923723*^9, 3.733258692169867*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.72632817761716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"20", ";;", "24"}], ",", 
      RowBox[{"20", ";;", "24"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
   3.72632832070956*^9, 3.726328365616743*^9}, 3.726668627461328*^9, {
   3.7266718189344797`*^9, 3.7266718266155033`*^9}, {3.726740229013278*^9, 
   3.7267402385384417`*^9}, {3.730388409125037*^9, 3.730388411886148*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpr", " ", "kpy", 
         " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d", "2"], " ", "gravity", " ", "kpr", " ", "kvy", 
         " ", "m"}], 
        RowBox[{"J", " ", "L"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "J", " ", "kpy", " ", "L", " ", "M"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "J", " ", "kpr", " ", "kvy", " ", "L", " ", "M"}], 
         "+", 
         RowBox[{"gravity", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "M"}]}], ")"}]}]}], 
        RowBox[{"2", " ", "J", " ", "L", " ", "M"}]]}], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726328328183877*^9, 3.726328366724547*^9, 3.726383960637189*^9, 
   3.726398733481083*^9, 3.7266686579308434`*^9, 3.72667182762402*^9, 
   3.726740239061949*^9, 3.730388412296423*^9, 3.7332552561271677`*^9, 
   3.733256034990244*^9, 3.7332586922381487`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalGamma]5", "[", 
     RowBox[{"q_", ",", 
      RowBox[{"{", 
       RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fd", " ", "fp", " ", "kp"}], " ", ",", 
       RowBox[{"fp", " ", "fd", " ", "kd"}], ",", 
       RowBox[{"fd", 
        RowBox[{"(", 
         RowBox[{"kp", "+", " ", 
          RowBox[{"fp", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], " ", ",", 
       RowBox[{
        RowBox[{"fd", " ", "kd"}], "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "fd"}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"\[CapitalGamma]5", "[", 
       RowBox[{"q", ",", 
        RowBox[{"{", 
         RowBox[{"fp", ",", "kpr"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"q", ",", "fp"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
   3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
   3.726328241473325*^9}, {3.7263283332636557`*^9, 3.726328342768092*^9}, 
   3.72632837387451*^9, 3.726671816359644*^9, {3.730388416055161*^9, 
   3.730388424868968*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q", "\[Rule]", 
     FractionBox["J", 
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", "M"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["d", "2"], " ", "gravity", " ", "m"}], 
      RowBox[{"J", " ", "L"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, {3.7263283432806273`*^9, 3.726328374449148*^9}, 
   3.72638396067451*^9, 3.72639873351657*^9, 3.7266686595537853`*^9, 
   3.726671831795113*^9, 3.726740241261178*^9, 3.7303884253814096`*^9, 
   3.73325525621909*^9, 3.7332560350741243`*^9, 3.733258692398159*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Asymmetric T=0 and \[Theta]=0", "Title",
 CellChangeTimes->{{3.726383870002284*^9, 3.72638387347583*^9}, {
  3.726384297030336*^9, 3.726384297382331*^9}, {3.726394930144247*^9, 
  3.726394935040613*^9}, {3.726410644081901*^9, 3.726410653378047*^9}, {
  3.726675756182509*^9, 3.726675757070057*^9}, {3.7267380131022987`*^9, 
  3.726738022618495*^9}, {3.730392533535873*^9, 3.730392539809873*^9}}],

Cell[CellGroupData[{

Cell["equilibrium parametrization", "Subsubsection",
 CellChangeTimes->{{3.7303418117715607`*^9, 3.7303418168665257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Gamma]", 
    RowBox[{"eq", ",", "1"}]], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}],
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726663312002758*^9, 3.726663327356833*^9}, {
  3.726668086034553*^9, 3.7266680868764267`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Simplifications (constants that are positive, i.e. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     SuperscriptBox["gravity", "2"]], "=", "gravity"}], TraditionalForm]]],
 ")"
}], "Chapter",
 CellChangeTimes->{{3.726394938200676*^9, 3.726394975793997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplySimplifications", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", 
       RowBox[{"m", ">", "0"}], "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}], "&&", 
       RowBox[{"m1", ">", "0"}], "&&", 
       RowBox[{"m2", ">", "0"}]}]}], "]"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.726319366587973*^9, 3.7263194239291143`*^9}, {
  3.726326664972498*^9, 3.72632682474743*^9}, {3.726326908336322*^9, 
  3.726326922450852*^9}, {3.72638432057878*^9, 3.726384384504632*^9}, {
  3.7266718520744*^9, 3.726671855823606*^9}, {3.7266721737253447`*^9, 
  3.72667217725729*^9}, {3.7267404789826593`*^9, 3.7267404845881166`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Stability vector field term (only for analysis)", "Chapter",
 CellChangeTimes->{{3.7120421708683567`*^9, 3.7120422205169086`*^9}, {
  3.7128306840760193`*^9, 3.71283068718001*^9}, {3.7134496094633293`*^9, 
  3.7134496232282867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DZ3SET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", 
      "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", 
      "\[Xi]2z_"}], "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Z3SET", "[", "z3", "]"}], ",", 
      RowBox[{"{", "z3", "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.712830773527231*^9, 3.7128309192395477`*^9}, {
   3.712833495665552*^9, 3.712833508713584*^9}, {3.71283357008792*^9, 
   3.7128335976910353`*^9}, {3.71283534408328*^9, 3.712835344330735*^9}, {
   3.7128355335133457`*^9, 3.7128355336799107`*^9}, 3.712837005757556*^9, 
   3.712837065836936*^9, 3.712838456858864*^9, {3.712838505922365*^9, 
   3.712838551215933*^9}, {3.7128418281986103`*^9, 3.712841828216846*^9}, {
   3.712842173539816*^9, 3.712842173548656*^9}, {3.712847966278987*^9, 
   3.7128479662996902`*^9}, {3.712905307583363*^9, 3.712905307739265*^9}, 
   3.713449834593012*^9, {3.713600697627223*^9, 3.7136007092075443`*^9}, {
   3.724684045820299*^9, 3.724684045829007*^9}, {3.724751341533758*^9, 
   3.7247513415439157`*^9}, {3.724768463749054*^9, 3.724768468124543*^9}, {
   3.726317769433804*^9, 3.726317784338602*^9}, {3.726318444340234*^9, 
   3.7263184457061653`*^9}, {3.726669625481001*^9, 3.726669645559219*^9}, {
   3.726669686051043*^9, 3.726669716180663*^9}, {3.726740336394246*^9, 
   3.726740369200263*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["determinant of matrix being inverted is positive", "Chapter",
 CellChangeTimes->{{3.713449796880292*^9, 3.7134498095432177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"#", ".", 
       RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "[", 
    RowBox[{"DZ3SET", "[", 
     RowBox[{"z3eq", "[", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"eq", ",", "1"}]], "]"}], "]"}], "]"}], "-", " ", 
   FractionBox[
    TagBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["2", "5"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d1", ",", "d2"}], "}"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ".", 
           RowBox[{"{", 
            RowBox[{"d1", ",", "d2"}], "}"}]}]}], ")"}]}], ")"}], "2"],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], 
    RowBox[{
     SuperscriptBox["L1", "4"], " ", 
     SuperscriptBox["L2", "4"]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.726318179453529*^9, 3.726318186652172*^9}, {
  3.726318217572694*^9, 3.726318233081394*^9}, {3.726318293399637*^9, 
  3.726318360957098*^9}, {3.726665672808339*^9, 3.726665702108613*^9}, {
  3.726669618033771*^9, 3.726669618411982*^9}, {3.72666965360693*^9, 
  3.726669673571744*^9}, {3.726669727449441*^9, 3.726669799979232*^9}, {
  3.726740360053808*^9, 3.726740361997072*^9}, {3.730388668029832*^9, 
  3.730388671683682*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.726318180711135*^9, 3.726318187739593*^9}, {
   3.72631823352956*^9, 3.726318240603044*^9}, {3.726318282059971*^9, 
   3.726318294245775*^9}, {3.7263183246076*^9, 3.7263183621338043`*^9}, 
   3.726318423207368*^9, 3.726325310787218*^9, 3.726383914292348*^9, 
   3.726398696144128*^9, 3.7266656534233313`*^9, {3.726665686030655*^9, 
   3.726665702778326*^9}, 3.726666884271078*^9, {3.726669619893312*^9, 
   3.72666975899158*^9}, {3.72666979553512*^9, 3.7266698008621073`*^9}, 
   3.72666998548096*^9, 3.726671969613221*^9, {3.726740365133731*^9, 
   3.7267403710849867`*^9}, {3.7267421824430656`*^9, 3.726742205234644*^9}, 
   3.729079747118813*^9, 3.730388672235857*^9, 3.7304101517405767`*^9, 
   3.7304161244875717`*^9, 3.730416475400055*^9, 3.7304166339033937`*^9, 
   3.7304166662247133`*^9, {3.7331543755098658`*^9, 3.7331543801213818`*^9}, 
   3.733255256722536*^9, 3.7332560355788507`*^9, 3.733258692780081*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Linearization matrix", "Chapter",
 CellChangeTimes->{{3.712043505293087*^9, 3.712043512378201*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["A", "0"], ",", 
      SubscriptBox["A", "1"]}], "}"}], "=", 
    RowBox[{"Linearization", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Z3cl", "[", 
        RowBox[{"#", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "1"}]]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z3SET", "[", "#", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"z3eq", "[", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"eq", ",", "1"}]], "]"}], ",", "\[IndentingNewLine]", 
      "ApplySimplifications"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["A", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.72666434496215*^9, 3.726664349991723*^9}, {
   3.7266669004646597`*^9, 3.726666923433338*^9}, 3.726666979922227*^9, {
   3.7266671119182053`*^9, 3.7266671744373302`*^9}, {3.7266680966497917`*^9, 
   3.726668098366765*^9}, {3.726669845204954*^9, 3.726669848475807*^9}, 
   3.726671972934722*^9, {3.726740376354781*^9, 3.726740379884259*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "unit", " ", "vector", " ", "of", " ", "dimension", " ", "of", " ", 
    "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "i_", "]"}], ":=", 
    RowBox[{"UnitVector", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dimensions", "[", "z3", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.726670007137466*^9, 3.726670007235956*^9}, {
  3.7267403912598*^9, 3.726740391370504*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "slower", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"chainOfIntegrators", "[", 
     RowBox[{"e_", ",", "n_", ",", "A_"}], "]"}], ":=", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ApplySimplifications", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"#", ".", "A"}], "]"}], "]"}], "&"}], ",", "e", ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"chainOfIntegrators", "[", 
     RowBox[{"e_", ",", "n_", ",", "A_"}], "]"}], ":=", 
    RowBox[{"ApplySimplifications", "[", 
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"#", ".", "A"}], "]"}], "&"}], ",", "e", ",", 
       RowBox[{"n", "-", "1"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"chainOfIntegrators", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["d2", 
         RowBox[{"d2", "-", "d1"}]], " ", 
        RowBox[{"e", "[", "31", "]"}]}], "+", 
       RowBox[{
        FractionBox["d1", 
         RowBox[{"d1", "-", "d2"}]], " ", 
        RowBox[{"e", "[", "32", "]"}]}]}], ",", "3", ",", 
      SubscriptBox["A", "0"]}], "]"}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"chainOfIntegrators", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", "5", ",", 
       SubscriptBox["A", "0"]}], "]"}], "//", "MatrixForm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"chainOfIntegrators", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", "5", ",", 
       SubscriptBox["A", "1"]}], "]"}], "//", "MatrixForm"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7263257888187017`*^9, 3.7263258724726763`*^9}, {
   3.7263259166627893`*^9, 3.726326042888208*^9}, {3.7263261879160957`*^9, 
   3.7263261983325*^9}, 3.726326848143663*^9, {3.726667313967251*^9, 
   3.726667320253922*^9}, {3.7266700400873127`*^9, 3.726670040221426*^9}, {
   3.7266700874386997`*^9, 3.726670087561207*^9}, 3.726672027320222*^9, {
   3.726672117309908*^9, 3.7266721220212193`*^9}, {3.726672211466131*^9, 
   3.726672225629381*^9}, {3.72674039442083*^9, 3.726740399071657*^9}, {
   3.72674043951194*^9, 3.726740451637734*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "0", "0", 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "0", "0", 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726325956372691*^9, 3.726326007567583*^9}, 
   3.726326043774054*^9, 3.726334431506309*^9, 3.726383959228827*^9, 
   3.726398730549676*^9, 3.7266673210093317`*^9, 3.726667472053864*^9, {
   3.726670022756057*^9, 3.726670040516191*^9}, {3.726670084132329*^9, 
   3.726670089116767*^9}, 3.726672031054784*^9, 3.726672123050663*^9, 
   3.726672226854596*^9, 3.726740459493794*^9, 3.726742242894051*^9, 
   3.726742380614732*^9, 3.729079793521089*^9, 3.7303887178572693`*^9, 
   3.730410196995344*^9, 3.730416135087344*^9, 3.730416485829211*^9, {
   3.7304167139711037`*^9, 3.730416719985403*^9}, 3.7331544292675*^9, 
   3.733255281006332*^9, 3.733256059789652*^9, 3.7332587181920652`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
    RowBox[{"ApplySimplifications", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["d2", 
            RowBox[{"d2", "-", "d1"}]], " ", 
           RowBox[{"e", "[", "31", "]"}]}], "+", 
          RowBox[{
           FractionBox["d1", 
            RowBox[{"d1", "-", "d2"}]], " ", 
           RowBox[{"e", "[", "32", "]"}]}]}], ",", "3", ",", "A"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"d2", "-", "d1"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "[", "31", "]"}], "-", " ", 
            RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ",", "3", ",", "A"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", "7", "]"}], "-", 
          RowBox[{"e", "[", "10", "]"}]}], ",", "3", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", "5", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", "5", ",", "A"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"chainOfIntegrators", "[", 
        RowBox[{
         RowBox[{"e", "[", "5", "]"}], ",", "5", ",", "A"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PPA", "[", "A_", "]"}], ":=", "\[IndentingNewLine]", " ", 
   RowBox[{"ApplySimplifications", "[", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PA", "[", "A", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DZ3SET", "[", 
       RowBox[{"z3eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["P", "0"], "=", 
   RowBox[{"PPA", "[", 
    SubscriptBox["A", "0"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "1"], "=", 
    RowBox[{"PPA", "[", 
     SubscriptBox["A", "1"], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "0"], "//", "MatrixForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["P", "1"], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697689284837699*^9, 3.697689454862545*^9}, {
   3.6976895057879887`*^9, 3.697689512545515*^9}, {3.6976895584941053`*^9, 
   3.697689578810162*^9}, {3.6976896127133007`*^9, 3.697689613332836*^9}, {
   3.697689773068844*^9, 3.6976898188578157`*^9}, {3.697690090149658*^9, 
   3.697690143862713*^9}, {3.697869303157887*^9, 3.697869322446196*^9}, {
   3.697869354345582*^9, 3.697869633734407*^9}, {3.6978701218004837`*^9, 
   3.697870132736575*^9}, {3.712043610380047*^9, 3.712043707743073*^9}, {
   3.712831094381729*^9, 3.712831095820244*^9}, {3.712831148394435*^9, 
   3.7128311596982203`*^9}, {3.7128311998383636`*^9, 3.712831230922905*^9}, {
   3.71283380404528*^9, 3.712833817585775*^9}, {3.7128338578199453`*^9, 
   3.7128339145293837`*^9}, {3.712834032813575*^9, 3.712834033874092*^9}, {
   3.712836024098538*^9, 3.7128360488484507`*^9}, {3.71283609327536*^9, 
   3.712836118528947*^9}, {3.712836924452547*^9, 3.712836958498642*^9}, {
   3.712844426115212*^9, 3.71284450242596*^9}, {3.7128449771537046`*^9, 
   3.712845086412121*^9}, {3.712848439443294*^9, 3.7128485151925364`*^9}, {
   3.712944738222735*^9, 3.712944749777299*^9}, {3.712988102089939*^9, 
   3.7129881257009773`*^9}, {3.7134500543777742`*^9, 3.713450055447535*^9}, {
   3.724678693813246*^9, 3.724678697955299*^9}, {3.7246823296039057`*^9, 
   3.724682336385404*^9}, {3.724682370244699*^9, 3.7246823710267973`*^9}, {
   3.724683277507218*^9, 3.7246833021887293`*^9}, {3.7246834824509897`*^9, 
   3.724683513686524*^9}, {3.724684763780971*^9, 3.724684886425336*^9}, {
   3.72468839967736*^9, 3.724688410177302*^9}, {3.7247417260960283`*^9, 
   3.724741737955247*^9}, {3.724751538261547*^9, 3.7247516157283382`*^9}, {
   3.724751670903892*^9, 3.724751672969146*^9}, {3.724751760644328*^9, 
   3.72475178892412*^9}, {3.724751820655284*^9, 3.724751832936578*^9}, {
   3.724751999539131*^9, 3.724752021780467*^9}, 3.724752097482242*^9, {
   3.724752161886855*^9, 3.724752168133781*^9}, {3.724752446862174*^9, 
   3.724752448614086*^9}, {3.724757996420842*^9, 3.72475800444925*^9}, {
   3.7247580472472982`*^9, 3.724758052534409*^9}, {3.724758086078887*^9, 
   3.7247581075217037`*^9}, {3.724758396290547*^9, 3.724758408015748*^9}, {
   3.724758470544146*^9, 3.724758473931033*^9}, 3.7247586153657417`*^9, {
   3.724759149139023*^9, 3.724759151388007*^9}, {3.724759288648301*^9, 
   3.724759302491118*^9}, {3.724768760869358*^9, 3.724768800242721*^9}, {
   3.7247688560626087`*^9, 3.724768863292123*^9}, {3.724768936314774*^9, 
   3.724768950040413*^9}, 3.7247720001122103`*^9, {3.724853635498878*^9, 
   3.7248536406972437`*^9}, {3.726318927086563*^9, 3.726319024616363*^9}, {
   3.726326206275281*^9, 3.726326416142439*^9}, {3.726326454606626*^9, 
   3.726326455720798*^9}, {3.7263265943687067`*^9, 3.726326611353199*^9}, {
   3.7263268511347427`*^9, 3.7263268535081244`*^9}, {3.726336547766362*^9, 
   3.726336572881345*^9}, {3.726667477766415*^9, 3.7266675280761747`*^9}, {
   3.7266680497295427`*^9, 3.726668072533704*^9}, {3.726668110516262*^9, 
   3.7266682143432198`*^9}, {3.7266683526175632`*^9, 3.726668385747107*^9}, {
   3.726670101186329*^9, 3.7266701373548107`*^9}, {3.726670655003562*^9, 
   3.726670735169519*^9}, {3.726738190417445*^9, 3.726738192865327*^9}, {
   3.72673824593629*^9, 3.726738246730743*^9}, {3.726738935260193*^9, 
   3.726739085230927*^9}, {3.726739132154704*^9, 3.726739265838004*^9}, {
   3.726739321501917*^9, 3.726739355468792*^9}, {3.726742569654248*^9, 
   3.726742578975842*^9}, {3.72674276457063*^9, 3.7267427682345057`*^9}, 
   3.730388697538323*^9, {3.730388730771864*^9, 3.730388740849793*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant of similarity matrix", "Chapter",
 CellChangeTimes->{{3.72927489284953*^9, 3.729274902051298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "0"], "]"}], "-", 
   RowBox[{
    SuperscriptBox["2", "5"], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["gravity", 
       RowBox[{"L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " "}]], ")"}], "8"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"gravity", "  ", 
       FractionBox[
        RowBox[{"d1", " ", "d2", "   ", "m", " "}], "J"], 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " "}], 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}]]}], ")"}], "3"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"gravity", 
       RowBox[{"(", 
        RowBox[{"d1", " ", "-", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["m", "m1"], "+", "1"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"d2", "-", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["m", "m2"], "+", "1"}], ")"}]}]}], ")"}]}], ")"}], 
     "2"]}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    SubscriptBox["P", "1"], "]"}], "-", 
   RowBox[{
    SuperscriptBox["2", "5"], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["gravity", 
       RowBox[{"L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " "}]], ")"}], "8"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"gravity", "  ", 
       FractionBox[
        RowBox[{"d1", " ", "d2", "   ", "m", " "}], "J"], 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " "}], 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}]]}], ")"}], "3"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"gravity", 
       RowBox[{"(", 
        RowBox[{"d1", " ", "-", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["m", "m1"], "+", "1"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"d2", "-", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["m", "m2"], "+", "1"}], ")"}]}]}], ")"}]}], ")"}], 
     "2"]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.730388706933689*^9, 3.730388707844345*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.730388749022839*^9, 3.730410200330461*^9, 
  3.730416732425726*^9, 3.7331544338027153`*^9, 3.733255283216126*^9, 
  3.733256061989523*^9, 3.733258720456452*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.730388749022839*^9, 3.730410200330461*^9, 
  3.730416732425726*^9, 3.7331544338027153`*^9, 3.733255283216126*^9, 
  3.733256061989523*^9, 3.733258720470475*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
sum of integrals: z-linear motion
difference of integrals: z-angular motion\
\>", "Chapter",
 CellChangeTimes->{{3.7267388866804447`*^9, 3.7267389102231607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["d2", 
       RowBox[{"d2", "-", "d1"}]], " ", 
      RowBox[{"e", "[", "31", "]"}]}], "+", 
     RowBox[{
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], " ", 
      RowBox[{"e", "[", "32", "]"}]}]}], ",", "3", ",", 
    SubscriptBox["A", "0"]}], "]"}], ".", "z3"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chainOfIntegrators", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"d2", "-", "d1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", "[", "31", "]"}], "-", " ", 
       RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ",", "3", ",", 
    SubscriptBox["A", "0"]}], "]"}], ".", "z3"}]}], "Input",
 CellChangeTimes->{{3.7303885273225307`*^9, 3.730388533203287*^9}, {
  3.733154181599791*^9, 3.733154183984483*^9}, {3.733154223920868*^9, 
  3.733154226408559*^9}, {3.7331544097278347`*^9, 3.733154411460402*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"d2", " ", "\[Xi]1z"}], 
     RowBox[{
      RowBox[{"-", "d1"}], "+", "d2"}]], "+", 
    FractionBox[
     RowBox[{"d1", " ", "\[Xi]2z"}], 
     RowBox[{"d1", "-", "d2"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"d2", " ", "p1z"}], 
     RowBox[{
      RowBox[{"-", "d1"}], "+", "d2"}]], "+", 
    FractionBox[
     RowBox[{"d1", " ", "p2z"}], 
     RowBox[{"d1", "-", "d2"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"d2", " ", "v1z"}], 
     RowBox[{
      RowBox[{"-", "d1"}], "+", "d2"}]], "+", 
    FractionBox[
     RowBox[{"d1", " ", "v2z"}], 
     RowBox[{"d1", "-", "d2"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7303885338206787`*^9, 3.733088394931693*^9, 
  3.733154168257976*^9, 3.733154227628565*^9, 3.73315443403229*^9, 
  3.733255283322348*^9, 3.733256062144568*^9, 3.7332587205438023`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["\[Xi]1z", 
     RowBox[{
      RowBox[{"-", "d1"}], "+", "d2"}]], "+", 
    FractionBox["\[Xi]2z", 
     RowBox[{"d1", "-", "d2"}]]}], ",", 
   RowBox[{
    FractionBox["p1z", 
     RowBox[{
      RowBox[{"-", "d1"}], "+", "d2"}]], "+", 
    FractionBox["p2z", 
     RowBox[{"d1", "-", "d2"}]]}], ",", 
   RowBox[{
    FractionBox["v1z", 
     RowBox[{
      RowBox[{"-", "d1"}], "+", "d2"}]], "+", 
    FractionBox["v2z", 
     RowBox[{"d1", "-", "d2"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7303885338206787`*^9, 3.733088394931693*^9, 
  3.733154168257976*^9, 3.733154227628565*^9, 3.73315443403229*^9, 
  3.733255283322348*^9, 3.733256062144568*^9, 3.7332587205457983`*^9}]
}, Open  ]],

Cell["change of coordinates is necessary", "Text",
 CellChangeTimes->{{3.733154207851521*^9, 3.7331542194681463`*^9}, {
  3.7331544383032837`*^9, 3.733154439451515*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"{", 
    RowBox[{
    "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
     "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_", 
     ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", "\[Omega]y_",
      ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", ",", "v2x_", 
     ",", "v2y_", ",", "v2z_", ",", "r1x_", ",", "r1y_", ",", "r1z_", ",", 
     "r2x_", ",", "r2y_", ",", "r2z_", ",", "\[Xi]1z_", ",", "\[Xi]2z_"}], 
    "}"}], "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"px", ",", "py", ",", "pz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
        RowBox[{"d1", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L1"], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Skew", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
          RowBox[{"d1", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L1"], 
      "]"}], ".", 
     FractionBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1x", ",", "v1y", ",", "v1z"}], "}"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"{", 
             RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}],
             "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}]}], ")"}]}], 
      "L1"]}], ",", "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
        RowBox[{"d2", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L2"], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Skew", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
          RowBox[{"d2", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], ")"}]}], "L2"], 
      "]"}], ".", 
     FractionBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v2x", ",", "v2y", ",", "v2z"}], "}"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
         RowBox[{"d2", " ", 
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"{", 
             RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}],
             "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}]}], ")"}]}], 
      "L2"]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r1x", ",", "r1y", ",", "r1z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r2x", ",", "r2y", ",", "r2z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Xi]1z", ",", "\[Xi]2z"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"{", 
    RowBox[{
    "px_", ",", "py_", ",", "pz_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
     "nx_", ",", "ny_", ",", "nz_", ",", "\[Omega]x_", ",", "\[Omega]y_", ",",
      "\[Omega]z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "\[Omega]1x_",
      ",", "\[Omega]1y_", ",", "\[Omega]1z_", ",", "n2x_", ",", "n2y_", ",", 
     "n2z_", ",", "\[Omega]2x_", ",", "\[Omega]2y_", ",", "\[Omega]2z_", ",", 
     "r1x_", ",", "r1y_", ",", "r1z_", ",", "r2x_", ",", "r2y_", ",", "r2z_", 
     ",", "\[Xi]1z_", ",", "\[Xi]2z_"}], "}"}], "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"px", ",", "py", ",", "pz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
     RowBox[{"d1", " ", 
      RowBox[{"{", 
       RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "+", 
     RowBox[{"L1", 
      RowBox[{"{", 
       RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "+", 
     RowBox[{"d2", " ", 
      RowBox[{"{", 
       RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "+", 
     RowBox[{"L2", 
      RowBox[{"{", 
       RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
     RowBox[{"d1", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], 
        "]"}], ".", " ", 
       RowBox[{"{", 
        RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
     RowBox[{"L1", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]1x", ",", "\[Omega]1y", ",", "\[Omega]1z"}], "}"}], 
        "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "+", 
     RowBox[{"d2", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], 
        "]"}], ".", " ", 
       RowBox[{"{", 
        RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}]}], "+", 
     RowBox[{"L2", " ", 
      RowBox[{
       RowBox[{"Skew", "[", 
        RowBox[{"{", 
         RowBox[{"\[Omega]2x", ",", "\[Omega]2y", ",", "\[Omega]2z"}], "}"}], 
        "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}]}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r1x", ",", "r1y", ",", "r1z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"r2x", ",", "r2y", ",", "r2z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Xi]1z", ",", "\[Xi]2z"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.733151661717351*^9, 3.733152045348358*^9}, {
  3.733152123944551*^9, 3.733152458404869*^9}, {3.7331527719805937`*^9, 
  3.733152776993416*^9}, {3.7331531593151827`*^9, 3.7331532005809917`*^9}}],

Cell["it is change of coordinates", "Text",
 CellChangeTimes->{{3.733154232991684*^9, 3.733154237006908*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"g", "[", "#", "]"}], "]"}], "-", "#"}], "&"}], "[", 
   RowBox[{"z3l", "[", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "#"], "&"}], ",", 
      RowBox[{"{", "24", "}"}]}], "]"}], "]"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"h", "[", "#", "]"}], "]"}], "-", "#"}], "&"}], "[", "...", 
     "]"}], "//", "Simplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.733152483785006*^9, 3.7331524888560867`*^9}, {
   3.733152553933412*^9, 3.733152567433075*^9}, {3.733152804817501*^9, 
   3.733152816647923*^9}, {3.733153063289318*^9, 3.733153076252722*^9}, 
   3.7331531131327868`*^9, {3.733154241159384*^9, 3.733154255894775*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.733152555319879*^9, 3.7331525680876417`*^9}, {
   3.7331527823826036`*^9, 3.733152818987845*^9}, 3.733153080733286*^9, 
   3.733153126756961*^9, 3.7331532036392593`*^9, {3.733154238721386*^9, 
   3.733154256537022*^9}, 3.733154444442832*^9, 3.7332552836141148`*^9, 
   3.733256062381798*^9, 3.733258720838147*^9}]
}, Open  ]],

Cell["state matrix in new coordinates", "Text",
 CellChangeTimes->{{3.733154277666449*^9, 3.7331542827606564`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x3", "=", 
    RowBox[{"{", 
     RowBox[{
     "px", ",", "py", ",", "pz", ",", "vx", ",", "vy", ",", "vz", ",", "nx", 
      ",", "ny", ",", "nz", ",", "\[Omega]x", ",", "\[Omega]y", ",", 
      "\[Omega]z", ",", "n1x", ",", "n1y", ",", "n1z", ",", "\[Omega]1x", ",",
       "\[Omega]1y", ",", "\[Omega]1z", ",", "n2x", ",", "n2y", ",", "n2z", 
      ",", "\[Omega]2x", ",", "\[Omega]2y", ",", "\[Omega]2z", ",", "r1x", 
      ",", "r1y", ",", "r1z", ",", "r2x", ",", "r2y", ",", "r2z", ",", 
      "\[Xi]1z", ",", "\[Xi]2z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ANewCoordinates", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"g", "[", "z3", "]"}], ",", 
            RowBox[{"{", "z3", "}"}]}], "]"}], ".", 
          RowBox[{"Z3cl", "[", 
           RowBox[{"z3", ",", 
            SubscriptBox["\[Gamma]", 
             RowBox[{"eq", ",", "1"}]]}], "]"}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"z3", "\[Rule]", " ", 
           RowBox[{"h", "[", "x3", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", "x3", "}"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"x3", "\[Rule]", " ", 
        RowBox[{"g", "[", 
         RowBox[{"z3eq", "[", 
          SubscriptBox["\[Gamma]", 
           RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "]"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"same", " ", "exact", " ", 
      RowBox[{"result", ":", " ", 
       RowBox[{"Z3cl", "[", 
        RowBox[{"z3", ",", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"eq", ",", "1"}]]}], "]"}]}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"z3", "\[Rule]", " ", 
       RowBox[{"z3eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "1"}]], "]"}]}], "]"}]}], " ", "=", " ", "0"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ANewCoordinates", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"g", "[", "z3", "]"}], ",", 
        RowBox[{"{", "z3", "}"}]}], "]"}], ".", 
      SubscriptBox["A", "0"], ".", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"h", "[", "x3", "]"}], ",", 
        RowBox[{"{", "x3", "}"}]}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"z3", "\[Rule]", " ", 
       RowBox[{"z3eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "1"}]], "]"}]}], "]"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"x3", "\[Rule]", " ", 
      RowBox[{"g", "[", 
       RowBox[{"z3eq", "[", 
        SubscriptBox["\[Gamma]", 
         RowBox[{"eq", ",", "1"}]], "]"}], "]"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.733153285212645*^9, 3.733153294176649*^9}, {
  3.733153327147587*^9, 3.733153364209305*^9}, {3.733153418636723*^9, 
  3.733153464593306*^9}, {3.73315350580814*^9, 3.733153549811129*^9}, {
  3.733153888678481*^9, 3.733153999576663*^9}, {3.733154040684622*^9, 
  3.733154051000181*^9}, {3.7331541078606157`*^9, 3.733154136049608*^9}, {
  3.7331544507141953`*^9, 3.733154451107916*^9}}],

Cell[CellGroupData[{

Cell["sum of integrals: z-linear motion", "Subsubsection",
 CellChangeTimes->{{3.733154294948539*^9, 3.7331542971067333`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["d2", 
        RowBox[{"d2", "-", "d1"}]], " ", 
       RowBox[{"e", "[", "31", "]"}]}], "+", 
      RowBox[{
       FractionBox["d1", 
        RowBox[{"d1", "-", "d2"}]], " ", 
       RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "x3"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["d2", 
         RowBox[{"d2", "-", "d1"}]], " ", 
        RowBox[{"e", "[", "31", "]"}]}], "+", 
       RowBox[{
        FractionBox["d1", 
         RowBox[{"d1", "-", "d2"}]], " ", 
        RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "ANewCoordinates", ".",
      "x3"}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["d2", 
        RowBox[{"d2", "-", "d1"}]], " ", 
       RowBox[{"e", "[", "31", "]"}]}], "+", 
      RowBox[{
       FractionBox["d1", 
        RowBox[{"d1", "-", "d2"}]], " ", 
       RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "ANewCoordinates", ".", 
    "ANewCoordinates", ".", "x3"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7331540665819197`*^9, 3.7331540789926357`*^9}, {
  3.733154306758502*^9, 3.7331543118291197`*^9}}],

Cell[BoxData["vz"], "Output",
 CellChangeTimes->{{3.7331540622460833`*^9, 3.7331540794230013`*^9}, {
   3.733154304882041*^9, 3.733154312371545*^9}, 3.7331544657203093`*^9, 
   3.733255283887225*^9, 3.7332560626525383`*^9, 3.733258721117485*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["difference of integrals : z - angular motion", "Subsubsection",
 CellChangeTimes->{{3.733154298531268*^9, 3.733154300381535*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"d2", "-", "d1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", "[", "31", "]"}], "-", " ", 
        RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ")"}], ".", "x3"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"d2", "-", "d1"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "31", "]"}], "-", " ", 
         RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ")"}], ".", 
     "ANewCoordinates", ".", "x3"}], "//", "Simplify"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"d2", "-", "d1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", "[", "31", "]"}], "-", " ", 
        RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ")"}], ".", 
    "ANewCoordinates", ".", "ANewCoordinates", ".", "x3"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7331540905822163`*^9, 3.7331540977588587`*^9}, {
  3.73315431542099*^9, 3.733154318726165*^9}}],

Cell[BoxData["\[Omega]y"], "Output",
 CellChangeTimes->{3.733154098594603*^9, 3.733154319258716*^9, 
  3.7331544677905188`*^9, 3.7332552839573317`*^9, 3.733256062722124*^9, 
  3.733258721193036*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
State matrix after similarity transformation (check block triangular \
structure)\
\>", "Chapter",
 CellChangeTimes->{3.730332400811451*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["Asimilar", "1"], " ", "=", 
   RowBox[{"ApplySimplifications", "[", 
    RowBox[{
     SubscriptBox["P", "1"], ".", 
     SubscriptBox["A", "1"], ".", 
     RowBox[{"Inverse", "[", 
      SubscriptBox["P", "1"], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["Asimilar", "1"], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{3.730340961959234*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kiz1"}], "+", 
            RowBox[{"d1", " ", "kiz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kiz1", " ", "m1"}], "+", 
            RowBox[{"kiz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kpz1"}], "+", 
            RowBox[{"d1", " ", "kpz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kpz1", " ", "m1"}], "+", 
            RowBox[{"kpz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kvz1"}], "+", 
            RowBox[{"d1", " ", "kvz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kvz1", " ", "m1"}], "+", 
            RowBox[{"kvz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kiz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kiz1"}], "+", "kiz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kiz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kiz1", "-", "kiz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kpz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kpz1"}], "+", "kpz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kpz1", "-", "kpz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kvz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kvz1"}], "+", "kvz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kvz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz1", "-", "kvz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", 
         SuperscriptBox["d2", "4"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "+", 
           RowBox[{"L1", " ", 
            SuperscriptBox["m1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz1", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "5"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "-", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "kvz1", " ", "m1"}], "-", 
              RowBox[{"kvz2", " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
               "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"d1", " ", 
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "m2"}], ")"}]}], "-", "m2"}], ")"}]}], 
              "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz1", " ", "m1"}], "+", 
                 RowBox[{"kvz2", " ", "m2"}]}], ")"}]}], "+", 
              RowBox[{"m2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", "kvz1", " ", "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d1", "2"]}]}], ")"}], " ", "kvz2", " ", 
                  "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "-", 
                    RowBox[{"3", " ", "m1"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d1", "2"], " ", "m1"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m2"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["d1", "2"]}], ")"}]}], " ", "kvz1", " ", 
               "m1", " ", "m2"}], "-", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "kvz2", " ", "m1", " ", "m2"}],
               "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m", " ", "m1", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "m", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m", " ", "m2", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "m1", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d1", "2"], " ", "m1", " ", "m2", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "m1"}], "+", 
                 "m2"}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "kvz1", " ", "m1"}], "+", 
                 RowBox[{"kvz2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m2", "-", 
                    RowBox[{
                    SuperscriptBox["d1", "2"], " ", "m2"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"2", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "kvz1", " ", "m2"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "kvz2", " ", 
                  "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "m"}], "+", 
                    RowBox[{
                    SuperscriptBox["d1", "2"], " ", "m2"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "4"], " ", "d2", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m2", "2"]}], ")"}]}], "+", 
           RowBox[{"L2", " ", 
            SuperscriptBox["m2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz2", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "5"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m2", "2"]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d2", " ", "L2", " ", "m2", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{"2", " ", "kvz2", " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
               "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "-", "m2"}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 SuperscriptBox["d2", "2"]}], ")"}], " ", "m1", " ", "m2"}], 
              "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz1"}], " ", "m1", " ", "m2"}], "-", 
                 RowBox[{"kvz2", " ", "m1", " ", "m2"}], "+", 
                 RowBox[{"m", " ", "m1", " ", "\[Lambda]"}], "+", 
                 RowBox[{"m", " ", "m2", " ", "\[Lambda]"}], "+", 
                 RowBox[{"2", " ", "m1", " ", "m2", " ", "\[Lambda]"}]}], 
                ")"}]}], "+", 
              RowBox[{"2", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
                ")"}]}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m2"}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "m2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}]}], " ", "kvz1", " ", 
                  "m1"}], "-", 
                 RowBox[{"2", " ", "kvz2", " ", "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", "m1"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m1", "-", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", "m1"}]}], ")"}]}], "-", 
                 RowBox[{"2", " ", "kvz2", " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"2", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "-", "m2"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "m1"}], ")"}]}], "-", "m1"}], ")"}], " ",
                "m2"}]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz1", " ", "m1"}], "+", 
                 RowBox[{"kvz2", " ", "m2"}]}], ")"}]}], "+", 
              RowBox[{"m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"]}]}], ")"}], " ", "kvz1", " ", 
                  "m2"}], "+", 
                 RowBox[{"4", " ", "kvz2", " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "-", 
                    RowBox[{"3", " ", "m2"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"L1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "d2", " ", "kvz1"}], "+", 
             RowBox[{
              SuperscriptBox["d2", "3"], " ", "kvz1"}], "+", 
             RowBox[{"d1", " ", "kvz2"}], "+", 
             RowBox[{
              SuperscriptBox["d1", "2"], " ", "d2", " ", "kvz2"}]}], ")"}], 
           " ", "m1", " ", "m2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 SuperscriptBox["d2", "2"]}], ")"}]}], " ", "kvz1", " ", 
              "m1"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"d1", " ", "d2"}]}], ")"}], " ", "kvz2", " ", "m2"}]}]
             , ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d2", " ", "kvz1"}], "+", 
             RowBox[{"d1", " ", 
              SuperscriptBox["d2", "2"], " ", "kvz1"}], "+", 
             RowBox[{"d1", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SuperscriptBox["d1", "2"]}], ")"}], " ", "kvz2"}]}], ")"}], 
           " ", "m1", " ", "m2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kvz1", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", 
                RowBox[{"d1", " ", "d2", " ", "m1"}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SuperscriptBox["d1", "2"]}], ")"}], " ", "kvz2", " ", 
              "m2"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kiz1"}], " ", "m1"}], "+", 
           RowBox[{"kiz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kiz2"}], " ", "m2"}], "+", 
           RowBox[{"kiz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz1"}], " ", "m1"}], "+", 
           RowBox[{"kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz2"}], " ", "m2"}], "+", 
           RowBox[{"kpz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
           RowBox[{"kvz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
           RowBox[{"kvz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kiz1", "+", "kiz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kiz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kiz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kpz1", "+", "kpz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kvz1", "+", "kvz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kvz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kvz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "J", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "L1", " ", 
         SuperscriptBox["m1", "2"], " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], ")"}]}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "4"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", "m1", " ", "m2"}], "-", 
              RowBox[{"2", " ", "J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "m1"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d2", "2"], " ", "m1"}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m1"}]}], ")"}], 
               " ", "m2"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz1", " ", "m1", 
               " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "m2"}]}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", "m1"}], ")"}]}], "-", 
                    RowBox[{"6", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
                 RowBox[{"J", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ",
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "m1", " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz1", " ", "m1", " ", "m2"}], "-", 
              RowBox[{"kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
                 RowBox[{"J", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ",
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz2", " ", "m2"}], "+", 
              RowBox[{"2", " ", "kvz1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}], "-", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m2"}], ")"}]}], "+", 
              RowBox[{"L1", " ", "\[Lambda]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz2"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
                 RowBox[{"kvz1", " ", "m1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
                 RowBox[{"m1", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", "\[Lambda]"}], 
           "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz1", " ", "m1"}], "+", 
              RowBox[{"2", " ", "kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}], "-", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "-", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "-", 
              RowBox[{"kvz1", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
              RowBox[{"m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "4"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m2", "2"]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"2", " ", "J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
              RowBox[{"kvz1", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m2"}]}], 
                ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "m1"}], "+", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], 
                 "+", 
                 RowBox[{"J", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ",
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "m1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m1"}], ")"}]}]}], ")"}], " ", 
               "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz2", " ", "m1", " ", "m2"}], "+", 
              RowBox[{"kvz1", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2"}]}], 
                ")"}]}], "+", 
              RowBox[{"J", " ", "m", " ", "\[Lambda]"}], "+", 
              RowBox[{"J", " ", "m1", " ", "\[Lambda]"}], "+", 
              RowBox[{"3", " ", "m", " ", "m1", " ", "\[Lambda]"}], "+", 
              RowBox[{"J", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{"3", " ", "m1", " ", "m2", " ", "\[Lambda]"}], "-", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "m2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m1"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"L1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", "kvz2", " ", "m1", " ", 
           "m2"}], "-", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz1", " ", "m1"}], 
             "+", 
             RowBox[{"kvz2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kvz2", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "-", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz1", " ", "m1", 
              " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "3"], " ", "kvz2", " ", "m1", " ", "m2"}], 
           "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz1", " ", "m1"}], "+", 
              RowBox[{"2", " ", "kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
           
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz2"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"kvz1", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "kvz2", " ", "m2"}], "+", 
              RowBox[{"kvz1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2", "-", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "m2"}], "-", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", "m2"}], "-", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d1", "2"]}], " ", "kpr1", " ", "kpx1", " ", "L1", 
         " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr2", " ", "kpx2", " ", "L2", " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpx1", " ", "L1"}], "+", 
              RowBox[{"kpr2", " ", "kpx2", " ", "L2"}]}], ")"}], " ", "m1", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr2", " ", "m1"}], "+", 
              RowBox[{"kpr1", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d1", "2"]}], " ", "kpr1", " ", "kvx1", " ", "L1", 
         " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr2", " ", "kvx2", " ", "L2", " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvx1", " ", "L1"}], "+", 
              RowBox[{"kpr2", " ", "kvx2", " ", "L2"}]}], ")"}], " ", "m1", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr1", " ", "L1"}], "+", 
        RowBox[{"d2", " ", "kpr2", " ", "L2"}]}], 
       RowBox[{
        RowBox[{"d1", " ", "L1"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
       RowBox[{"kpr2", " ", "kpx2"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
       RowBox[{"kpr2", " ", "kvx2"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpx1"}], "-", 
              RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L1", " ", "m1"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr2"}], " ", "m1"}], "+", 
              RowBox[{"kpr1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
              RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L2", " ", "m2"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "m2"}], "+", 
              RowBox[{"kpr2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvx1"}], "-", 
              RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
              RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L2", " ", 
            "m2"}]}], ")"}]}]}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}], " ", "L1", " ", "L2"}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}]], "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gravity", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kpr2"}], " ", "m1"}], "-", 
             RowBox[{"kpr1", " ", "m2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
            ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kpr1", " ", 
              RowBox[{"(", 
               RowBox[{"kpx1", "+", 
                RowBox[{"\[Lambda]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "kvx1"}], "+", "\[Lambda]"}], ")"}]}]}], 
               ")"}]}], "-", 
             RowBox[{"kpr2", " ", 
              RowBox[{"(", 
               RowBox[{"kpx2", "+", 
                RowBox[{"\[Lambda]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "kvx2"}], "+", "\[Lambda]"}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "kpr1", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kpx1"}], "-", 
                 RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L1", " ", 
               "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "L1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "kpr2", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
                 RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L2", " ", 
               "m2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kvx1"}], "-", 
                 RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L1", " ", 
               "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "L1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
                 RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L2", " ", 
               "m2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kpx2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kpx1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kvx2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kvx1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"kpr1", "+", "kpr2"}], ")"}]}], "+", 
           RowBox[{"kpr2", " ", "kpx2", " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "kpx1", " ", "L2"}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr1", " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpr2", " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity"}], "+", 
           RowBox[{"kpr2", " ", "kvx2", " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "kvx1", " ", "L2"}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr1", " ", "kvx1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr2", " ", "kvx2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr2", " ", "L1"}], "+", 
        RowBox[{"d2", " ", "kpr1", " ", "L2"}]}], 
       RowBox[{
        RowBox[{"d1", " ", "L1"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", "L2", " ", "m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"kpr1", "-", "\[Lambda]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["\[Lambda]", "3"]}], "+", 
                RowBox[{"kpr1", " ", 
                 RowBox[{"(", 
                  RowBox[{"kpx1", "-", 
                   RowBox[{"kvx1", " ", "\[Lambda]"}], "+", 
                   SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"d1", " ", "L1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"kpr2", "-", "\[Lambda]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Lambda]", "3"], "-", 
                RowBox[{"kpr2", " ", 
                 RowBox[{"(", 
                  RowBox[{"kpx2", "-", 
                   RowBox[{"kvx2", " ", "\[Lambda]"}], "+", 
                   SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kpy2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kpy1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kvy2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kvy1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "kpr2", " ", "L1"}], "+", 
           RowBox[{"gravity", " ", "kpr1", " ", "L2"}], "+", 
           RowBox[{"kpr1", " ", "kpy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{"kpr2", " ", "kpy2", " ", "L1", " ", "L2"}]}], ")"}], " ", 
         "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpy1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpr2", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpy2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr1", " ", "kvy1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr2", " ", "kvy2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "kpr1"}], "-", 
        RowBox[{"d1", " ", "kpr2"}]}], 
       RowBox[{"d1", "-", "d2"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpr1"}], " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kp\[Psi]1"}], " ", "L1"}], "+", 
              RowBox[{"kpy1", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"kpr2", " ", "L1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kp\[Psi]2"}], " ", "L2"}], "+", 
              RowBox[{"kpy2", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kpr1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]1"}], " ", "L1"}], "+", 
             RowBox[{"kvy1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"kpr2", " ", "L1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]2"}], " ", "L2"}], "+", 
             RowBox[{"kvy2", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpr2"}], " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m", " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "kpr1", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpy1"}], "-", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kpy1"}], "+", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpr2", " ", "L1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr2", " ", "L1"}], "-", 
                 RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m2"}]}], 
             ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "-", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "L1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{"J", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kpr1"}], "+", "kpr2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "m"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "kpr2"}], " ", "kpy2", " ", "L1"}], "+", 
          RowBox[{"kpr1", " ", "kpy1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "kpr2"}], " ", "kvy2", " ", "L1"}], "+", 
          RowBox[{"kpr1", " ", "kvy1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kpy1"}], "-", 
                 RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr2"}], " ", "L1", " ", "m1"}], "+", 
                 RowBox[{"kpr1", " ", "L2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ",
             "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kpy1"}], "+", 
                 RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "L2", " ", "m2"}], "+", 
                 RowBox[{"kpr2", " ", "L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         "L2", " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kvy1"}], "-", 
                 RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L1"}], " ", "m1"}], "+", 
                 RowBox[{"L2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ",
             "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kvy1"}], "+", 
                 RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L2"}], " ", "m2"}], "+", 
                 RowBox[{"L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         "L2", " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J"}]], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "kpr1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kp\[Psi]1"}], " ", "L1"}], "+", 
             RowBox[{"kpy1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d2", " ", "kpr2", " ", "L1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kp\[Psi]2"}], " ", "L2"}], "+", 
             RowBox[{"kpy2", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}]}]], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "kpr1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]1"}], " ", "L1"}], "+", 
             RowBox[{"kvy1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d2", " ", "kpr2", " ", "L1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]2"}], " ", "L2"}], "+", 
             RowBox[{"kvy2", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d2", "2"]}], " ", "J", " ", "kpr2", " ", "kpy2", 
         " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "kpr1", 
         " ", "L2", " ", "m", " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr1", " ", "kpy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr2", " ", "L1"}], "+", 
              RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m"}]}], ")"}], " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpy1"}], "+", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m1", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpr2", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"J", " ", "kpr1", " ", "L2", " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "kpr2", " ", "L1", " ", "m1", 
               " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
        "L2", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d2", "2"]}], " ", "J", " ", "kpr2", " ", "kvy2", 
         " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "L2", " ",
          "m", " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr1", " ", "kvy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}], " ", "m"}]}], ")"}], " ", "m1",
          " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m1", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"J", " ", "L2", " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "L1", " ", "m1", " ", "m2"}]}],
              ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
        "L2", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr1"}], "+", 
        RowBox[{"d2", " ", "kpr2"}]}], 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.733256074459936*^9, 3.733258733105921*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vertical linear and angular motion", "Chapter",
 CellChangeTimes->{{3.713450417179948*^9, 3.713450422588997*^9}, {
  3.726327222144143*^9, 3.726327230092554*^9}}],

Cell[CellGroupData[{

Cell["see that linear and angular motions are coupled", "Subsubsection",
 CellChangeTimes->{{3.7303888930624733`*^9, 3.730388901419463*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "6"}], ",", 
      RowBox[{"1", ";;", "6"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.729080519975483*^9, 3.72908061691422*^9}, 
   3.7303887786302977`*^9, {3.730388817856357*^9, 3.730388829417383*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kiz1"}], "+", 
            RowBox[{"d1", " ", "kiz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kiz1", " ", "m1"}], "+", 
            RowBox[{"kiz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kpz1"}], "+", 
            RowBox[{"d1", " ", "kpz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kpz1", " ", "m1"}], "+", 
            RowBox[{"kpz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kvz1"}], "+", 
            RowBox[{"d1", " ", "kvz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kvz1", " ", "m1"}], "+", 
            RowBox[{"kvz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kiz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kiz1"}], "+", "kiz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kiz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kiz1", "-", "kiz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kpz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kpz1"}], "+", "kpz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kpz1", "-", "kpz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kvz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kvz1"}], "+", "kvz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kvz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz1", "-", "kvz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kiz1"}], " ", "m1"}], "+", 
           RowBox[{"kiz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kiz2"}], " ", "m2"}], "+", 
           RowBox[{"kiz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz1"}], " ", "m1"}], "+", 
           RowBox[{"kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz2"}], " ", "m2"}], "+", 
           RowBox[{"kpz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
           RowBox[{"kvz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
           RowBox[{"kvz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kiz1", "+", "kiz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kiz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kiz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kpz1", "+", "kpz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kvz1", "+", "kvz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kvz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kvz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.729080518189208*^9, 3.729080521268837*^9}, {
   3.7290805870774517`*^9, 3.729080617409977*^9}, {3.73038881019559*^9, 
   3.73038883064084*^9}, {3.730410223539234*^9, 3.730410250044673*^9}, 
   3.730416756421324*^9, 3.730417023860867*^9, 3.733255295649714*^9, 
   3.733256074694171*^9, 3.7332587332366133`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["choose gains that decouple linear from angular", "Subsubsection",
 CellChangeTimes->{{3.730341047593988*^9, 3.730341059942281*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solz\[Theta]1", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AofInterest", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "]"}], "]"}], 
      "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kiz2", ",", "kpz2", ",", "kvz2"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.726673992494062*^9, 3.726674036771399*^9}, {
   3.726740516689023*^9, 3.72674054458037*^9}, {3.7267430724064627`*^9, 
   3.726743073121299*^9}, 3.7303887811193533`*^9, {3.730388823223113*^9, 
   3.730388834426373*^9}, {3.730388934838043*^9, 3.730388935149899*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kiz2", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", " ", "kiz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
       " ", "m2"}]]}], ",", 
    RowBox[{"kpz2", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", " ", "kpz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
       " ", "m2"}]]}], ",", 
    RowBox[{"kvz2", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", " ", "kvz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
       " ", "m2"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726674019565361*^9, 3.7266740372108097`*^9}, 
   3.726740545273677*^9, 3.726743074094013*^9, 3.729079819138659*^9, 
   3.7290806499097652`*^9, 3.730388935966723*^9, {3.7304102238925753`*^9, 
   3.73041025237957*^9}, 3.730416756691951*^9, 3.73041702416013*^9, 
   3.7332552958713217`*^9, 3.7332560748770857`*^9, 3.733258733453217*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["choose gains that decouple angular from linear angular", "Subsubsection",
 CellChangeTimes->{{3.730341047593988*^9, 3.730341084545486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solz\[Theta]2", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AofInterest", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], 
      "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kiz2", ",", "kpz2", ",", "kvz2"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kiz2", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kiz1", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}]]}]}], ",", 
    RowBox[{"kpz2", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kpz1", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}]]}]}], ",", 
    RowBox[{"kvz2", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kvz1", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}]]}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.730388943861351*^9, {3.73041022415123*^9, 3.730410254095879*^9}, 
   3.730416756866054*^9, 3.730417024327826*^9, 3.733255295970039*^9, 
   3.733256075029026*^9, 3.7332587336057053`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["rewrite choice of gains in more convenient manner", "Subsubsection",
 CellChangeTimes->{{3.730341103121126*^9, 3.730341112974743*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"solz1", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "]"}], "]"}], 
        "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kiz1", "\[Rule]", 
         RowBox[{"\[Gamma]i", " ", "kiz2"}]}], ",", 
        RowBox[{"kpz1", "\[Rule]", 
         RowBox[{"\[Gamma]p", " ", "kpz2"}]}], ",", 
        RowBox[{"kvz1", "\[Rule]", 
         RowBox[{"\[Gamma]v", " ", "kvz2"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]i", ",", "\[Gamma]p", ",", "\[Gamma]v"}], "}"}]}], 
    "]"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"solz2", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"6", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], 
        "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kiz1", "\[Rule]", 
         RowBox[{"\[Gamma]i", " ", "kiz2"}]}], ",", 
        RowBox[{"kpz1", "\[Rule]", 
         RowBox[{"\[Gamma]p", " ", "kpz2"}]}], ",", 
        RowBox[{"kvz1", "\[Rule]", 
         RowBox[{"\[Gamma]v", " ", "kvz2"}]}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]i", ",", "\[Gamma]p", ",", "\[Gamma]v"}], "}"}]}], 
    "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.712945014916979*^9, 3.712945043809243*^9}, {
   3.712982474447101*^9, 3.712982483165021*^9}, 3.7134504376899633`*^9, {
   3.726327238090015*^9, 3.7263272499610147`*^9}, {3.726385767341168*^9, 
   3.726385885049056*^9}, {3.726385927547502*^9, 3.726385982460751*^9}, {
   3.726672293100535*^9, 3.7266723009556923`*^9}, {3.726673977657646*^9, 
   3.726673981956297*^9}, {3.726674026500428*^9, 3.726674026665914*^9}, {
   3.7267406294691477`*^9, 3.726740677964666*^9}, {3.729080661002652*^9, 
   3.729080670334421*^9}, 3.7303889498520727`*^9, 3.730389032732141*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Gamma]i", "\[Rule]", 
     FractionBox[
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
       "m2"}], 
      RowBox[{"d1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
        ")"}]}]]}], ",", 
    RowBox[{"\[Gamma]p", "\[Rule]", 
     FractionBox[
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
       "m2"}], 
      RowBox[{"d1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
        ")"}]}]]}], ",", 
    RowBox[{"\[Gamma]v", "\[Rule]", 
     FractionBox[
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
       "m2"}], 
      RowBox[{"d1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
        ")"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712988511498514*^9, 3.713450443598475*^9, 3.713450710505559*^9, 
   3.713451069364211*^9, 3.7136008867065268`*^9, 3.714030540754437*^9, 
   3.714030762041692*^9, 3.7140317218870707`*^9, 3.7140319518285*^9, 
   3.714034134273993*^9, {3.7263272432238617`*^9, 3.726327250259211*^9}, 
   3.726383960081555*^9, 3.726385760968986*^9, 3.7263858858648577`*^9, {
   3.726385947503696*^9, 3.726385982827983*^9}, 3.7263951268339767`*^9, 
   3.726398790104116*^9, 3.7263989530839252`*^9, {3.726672290211594*^9, 
   3.7266723030689077`*^9}, 3.72667404399032*^9, {3.7267406673336678`*^9, 
   3.726740679564711*^9}, {3.7290798225439243`*^9, 3.729079836354186*^9}, {
   3.7290806709193277`*^9, 3.729080676855126*^9}, 3.730388955356915*^9, {
   3.730389033600806*^9, 3.730389043347762*^9}, {3.73038925647285*^9, 
   3.73038929009669*^9}, {3.730410224479932*^9, 3.730410257390753*^9}, 
   3.730416756974907*^9, 3.730417024403363*^9, 3.733255296064416*^9, 
   3.733256075123333*^9, 3.7332587336474657`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Gamma]i", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], 
       RowBox[{"m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]]}]}], ",", 
    RowBox[{"\[Gamma]p", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], 
       RowBox[{"m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]]}]}], ",", 
    RowBox[{"\[Gamma]v", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], 
       RowBox[{"m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.712988511498514*^9, 3.713450443598475*^9, 3.713450710505559*^9, 
   3.713451069364211*^9, 3.7136008867065268`*^9, 3.714030540754437*^9, 
   3.714030762041692*^9, 3.7140317218870707`*^9, 3.7140319518285*^9, 
   3.714034134273993*^9, {3.7263272432238617`*^9, 3.726327250259211*^9}, 
   3.726383960081555*^9, 3.726385760968986*^9, 3.7263858858648577`*^9, {
   3.726385947503696*^9, 3.726385982827983*^9}, 3.7263951268339767`*^9, 
   3.726398790104116*^9, 3.7263989530839252`*^9, {3.726672290211594*^9, 
   3.7266723030689077`*^9}, 3.72667404399032*^9, {3.7267406673336678`*^9, 
   3.726740679564711*^9}, {3.7290798225439243`*^9, 3.729079836354186*^9}, {
   3.7290806709193277`*^9, 3.729080676855126*^9}, 3.730388955356915*^9, {
   3.730389033600806*^9, 3.730389043347762*^9}, {3.73038925647285*^9, 
   3.73038929009669*^9}, {3.730410224479932*^9, 3.730410257390753*^9}, 
   3.730416756974907*^9, 3.730417024403363*^9, 3.733255296064416*^9, 
   3.733256075123333*^9, 3.733258733668707*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GainszOption", "[", "sol_", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"kiz1", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "\[Gamma]iN"}], 
        RowBox[{"\[Gamma]iN", "+", "\[Gamma]iD"}]], " ", "kiz"}]}], ",", "  ", 
     RowBox[{"kiz2", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "\[Gamma]iD"}], 
        RowBox[{"\[Gamma]iN", "+", "\[Gamma]iD"}]], " ", "kiz"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"kpz1", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "\[Gamma]pN"}], 
        RowBox[{"\[Gamma]pN", "+", "\[Gamma]pD"}]], " ", "kpz"}]}], ",", "  ", 
     RowBox[{"kpz2", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "\[Gamma]pD"}], 
        RowBox[{"\[Gamma]pN", "+", "\[Gamma]pD"}]], " ", "kpz"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"kvz1", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "\[Gamma]vN"}], 
        RowBox[{"\[Gamma]vN", "+", "\[Gamma]vD"}]], " ", "kvz"}]}], ",", 
     RowBox[{"kvz2", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "\[Gamma]vD"}], 
        RowBox[{"\[Gamma]vN", "+", "\[Gamma]vD"}]], " ", "kvz"}]}]}], 
    "\[IndentingNewLine]", "}"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Gamma]iN", "\[Rule]", " ", 
      RowBox[{"Numerator", "[", 
       RowBox[{"\[Gamma]i", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"\[Gamma]iD", "\[Rule]", " ", 
      RowBox[{"Denominator", "[", 
       RowBox[{"\[Gamma]i", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]pN", "\[Rule]", " ", 
      RowBox[{"Numerator", "[", 
       RowBox[{"\[Gamma]p", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"\[Gamma]pD", "\[Rule]", " ", 
      RowBox[{"Denominator", "[", 
       RowBox[{"\[Gamma]p", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]vN", "\[Rule]", " ", 
      RowBox[{"Numerator", "[", 
       RowBox[{"\[Gamma]v", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"\[Gamma]vD", "\[Rule]", " ", 
      RowBox[{"Denominator", "[", 
       RowBox[{"\[Gamma]v", "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.726386392924204*^9, 3.7263866061855707`*^9}, {
   3.726387482687848*^9, 3.726387486425024*^9}, {3.726387565267535*^9, 
   3.726387585393352*^9}, {3.726387724437498*^9, 3.726387760065189*^9}, {
   3.7267407011739807`*^9, 3.7267407989607563`*^9}, {3.7267430894366417`*^9, 
   3.726743089534153*^9}, {3.7290798248490963`*^9, 3.729079855043776*^9}, {
   3.729080674126204*^9, 3.729080674219759*^9}, 3.730389003061572*^9, {
   3.730389112934806*^9, 3.7303891895902348`*^9}, {3.730389277529039*^9, 
   3.7303893030922422`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
check that sub-motions are indeed decoupled (we chose to decouple the linear \
from the angular)\
\>", "Subsubsection",
 CellChangeTimes->{{3.730341120613907*^9, 3.730341128792337*^9}, {
  3.7303893152192087`*^9, 3.730389325264153*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "6"}], ",", 
       RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", 
    RowBox[{"GainszOption", "[", "solz1", "]"}]}], "//", "MatrixForm"}], "//",
   "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Asimilar", "1"], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "6"}], ",", 
       RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", 
    RowBox[{"GainszOption", "[", "solz2", "]"}]}], "//", "MatrixForm"}], "//",
   "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7263860725781717`*^9, 3.726386095073221*^9}, {
   3.7263866180269814`*^9, 3.726386650434248*^9}, {3.726672310075149*^9, 
   3.7266723107415133`*^9}, {3.726740804967135*^9, 3.7267408135277147`*^9}, 
   3.730388788499995*^9, {3.730389008759617*^9, 3.7303890393566303`*^9}, {
   3.730389076540908*^9, 3.730389087602366*^9}, {3.730389276318221*^9, 
   3.730389287095894*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kiz", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
          
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"J", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
          
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"J", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kvz", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
          
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"J", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}]], 
      "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kiz", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
          ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"J", "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
          ")"}]}]]}], 
      FractionBox[
       RowBox[{"2", " ", "d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kiz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "m2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"2", " ", "d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kpz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "m2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"2", " ", "d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kvz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "m2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726386083638042*^9, 3.726386095395492*^9}, {
   3.726386626345977*^9, 3.726386650921319*^9}, 3.726386700438158*^9, 
   3.7263875900576677`*^9, 3.726387763141356*^9, 3.726395131399341*^9, 
   3.7263987903226337`*^9, 3.72639895328721*^9, 3.726672311366252*^9, 
   3.726674102004321*^9, {3.726740807696343*^9, 3.726740816848339*^9}, 
   3.726743094084692*^9, 3.729079858256682*^9, 3.729080680136959*^9, 
   3.729081336758841*^9, 3.7290815649955683`*^9, 3.730388969832141*^9, {
   3.730389039999514*^9, 3.730389088009266*^9}, 3.730389139808877*^9, 
   3.7303891965897818`*^9, {3.7303892928953047`*^9, 3.730389307209681*^9}, 
   3.7304102251646757`*^9, 3.7304102633217173`*^9, 3.730416757486528*^9, 
   3.730417025507234*^9, 3.7332552964193*^9, 3.733256075479953*^9, 
   3.7332587340116177`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kiz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "m2"}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kpz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "m2"}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kvz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d2"}], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{"2", " ", "m2"}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kiz", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "m1"}], "+", 
          RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "m1"}], "+", 
          RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kvz", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "m1"}], "+", 
          RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]]},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kiz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "kvz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726386083638042*^9, 3.726386095395492*^9}, {
   3.726386626345977*^9, 3.726386650921319*^9}, 3.726386700438158*^9, 
   3.7263875900576677`*^9, 3.726387763141356*^9, 3.726395131399341*^9, 
   3.7263987903226337`*^9, 3.72639895328721*^9, 3.726672311366252*^9, 
   3.726674102004321*^9, {3.726740807696343*^9, 3.726740816848339*^9}, 
   3.726743094084692*^9, 3.729079858256682*^9, 3.729080680136959*^9, 
   3.729081336758841*^9, 3.7290815649955683`*^9, 3.730388969832141*^9, {
   3.730389039999514*^9, 3.730389088009266*^9}, 3.730389139808877*^9, 
   3.7303891965897818`*^9, {3.7303892928953047`*^9, 3.730389307209681*^9}, 
   3.7304102251646757`*^9, 3.7304102633217173`*^9, 3.730416757486528*^9, 
   3.730417025507234*^9, 3.7332552964193*^9, 3.733256075479953*^9, 
   3.733258734163932*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["vertical linear motion", "Subsection",
 CellChangeTimes->{{3.7263275313349857`*^9, 3.726327541043935*^9}, {
  3.7290798767242804`*^9, 3.729079877835792*^9}, {3.7290799498569508`*^9, 
  3.72907995066116*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", 
        RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "/.", 
     RowBox[{"GainszOption", "[", "solz1", "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328308547742*^9, 3.726328311819013*^9}, {
   3.726386218837888*^9, 3.7263862249096937`*^9}, 3.726387772669621*^9, 
   3.726672318143796*^9, {3.726741875441894*^9, 3.726741884250536*^9}, {
   3.7290799212093143`*^9, 3.7290799302225857`*^9}, 3.7303887908284883`*^9, 
   3.730389334287156*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kiz", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
          
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"J", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpz", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
          
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"J", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "kvz", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
          
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"J", "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7263283121640463`*^9, 3.726383960120669*^9, {3.726386219336753*^9, 
   3.726386225643373*^9}, 3.726387773814768*^9, 3.726395134412401*^9, 
   3.7263951742111473`*^9, 3.726398790463772*^9, 3.726398953400857*^9, 
   3.7266723188668013`*^9, 3.7266741077132607`*^9, 3.7267418847129297`*^9, 
   3.726741925165599*^9, 3.726743104796754*^9, {3.729079868136352*^9, 
   3.7290798816939*^9}, 3.729080689072145*^9, 3.729081339623795*^9, 
   3.729081565149993*^9, 3.730389336015278*^9, 3.73041022566194*^9, 
   3.7304102653607063`*^9, 3.7304167580202923`*^9, 3.73041702562164*^9, 
   3.733255296787895*^9, 3.733256075846339*^9, 3.7332587343817043`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"C3", "[", 
      RowBox[{"fp_", ",", 
       RowBox[{"{", 
        RowBox[{"ki_", ",", "kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fp", " ", "ki"}], " ", ",", 
        RowBox[{"fp", " ", "kp"}], ",", 
        RowBox[{"fp", " ", "kd"}]}], "}"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solzCoeff", "=", 
    RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
     RowBox[{"Solve", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AofInterest", "[", 
            RowBox[{"[", 
             RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
           "#"}], ")"}], "&"}], "[", 
        RowBox[{"C3", "[", 
         RowBox[{"fp", ",", 
          RowBox[{"{", 
           RowBox[{"kiz", ",", "kpz", ",", "kvz"}], "}"}]}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", "fp"}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}]}], "}"}]}], "//", "FullSimplify"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
        RowBox[{"m2", "\[Rule]", " ", "M"}]}], "}"}]}], "//", 
     "FullSimplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.726327263699593*^9, 3.726327495774548*^9}, {
   3.7263279306820803`*^9, 3.726327941520749*^9}, {3.726328302802548*^9, 
   3.726328303216222*^9}, {3.726395172111368*^9, 3.7263951932981167`*^9}, {
   3.726741868672296*^9, 3.726741870648836*^9}, {3.726741918290772*^9, 
   3.726741922229146*^9}, {3.7290799330350113`*^9, 3.72907996961946*^9}, {
   3.729080033760171*^9, 3.729080048186458*^9}, 3.730389343408793*^9, 
   3.730389384765154*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"fp", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d2"}], " ", "J", " ", "m2"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
         RowBox[{"d1", " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
        ")"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726327470277322*^9, 3.726327496190207*^9}, 
   3.726327941999847*^9, 3.726328313836656*^9, 3.726383960187357*^9, 
   3.726386232968755*^9, 3.726387777532385*^9, 3.726395137050026*^9, {
   3.726395175105114*^9, 3.7263951937221527`*^9}, 3.726398790586441*^9, 
   3.726398953546043*^9, 3.726672323282372*^9, 3.7266741148200417`*^9, 
   3.726741926470152*^9, 3.72674310701398*^9, {3.7290798733309307`*^9, 
   3.729079883919594*^9}, 3.7290799341833763`*^9, 3.7290799758618507`*^9, 
   3.729080044381413*^9, 3.729080691824354*^9, 3.729081342626609*^9, 
   3.729081565294866*^9, 3.730389339155711*^9, 3.730389386154875*^9, 
   3.73041022581609*^9, 3.730410267207062*^9, 3.7304167581466*^9, 
   3.730417025703127*^9, 3.733255296822359*^9, 3.73325607587921*^9, 
   3.733258734415743*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["rewriting coefficient in more readable manner", "Subsubsection",
 CellChangeTimes->{{3.730389563148305*^9, 3.730389577723201*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]z1", "=", 
     RowBox[{"d2", " ", "m2", 
      RowBox[{"(", 
       RowBox[{"J", "+", 
        RowBox[{"d1", " ", "m1", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}]}]}], ")"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]z2", "=", 
     RowBox[{
      RowBox[{"-", "d1"}], " ", "m1", " ", 
      RowBox[{"(", 
       RowBox[{"J", "+", 
        RowBox[{"d2", " ", "m2", 
         RowBox[{"(", 
          RowBox[{"d2", "-", "d1"}], ")"}]}]}], ")"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalDelta]z1", "=", 
     RowBox[{"Numerator", "[", 
      RowBox[{"\[Gamma]p", "/.", 
       RowBox[{"solz1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]z2", "=", 
     RowBox[{"Denominator", "[", 
      RowBox[{"\[Gamma]p", "/.", 
       RowBox[{"solz1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"fp", "/.", 
       RowBox[{"solzCoeff", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", " ", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"m", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1"}]}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " "}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m1", " ", 
           "m2"}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d1"}], " ", "d2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"d2", "-", "d1"}], ")"}], " ", "m1", " ", "m2", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[CapitalDelta]z1", "+", "\[CapitalDelta]z2"}], 
         RowBox[{"2", "\[CapitalDelta]z1", " ", "\[CapitalDelta]z2"}]], 
        ")"}]}]]}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"fp", "/.", 
       RowBox[{"solzCoeff", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", " ", "d2"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1", " ", "m2"}], ")"}], 
          "2"], 
         RowBox[{"\[CapitalDelta]z1", " ", "\[CapitalDelta]z2"}]], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", " ", "m1"}], "-", 
              RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d1"}], " ", "d2"}], ")"}], "m1", " ", "m2", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " "}]]}], ")"}]}]], 
      FractionBox["1", 
       RowBox[{" ", 
        RowBox[{"(", 
         RowBox[{"1", "+", " ", 
          FractionBox[
           RowBox[{
            RowBox[{"m", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["d2", "2"], " ", "m2"}], "+", 
               RowBox[{
                SuperscriptBox["d1", "2"], " ", "m1"}]}], ")"}]}], "+", 
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m1", " ", "m2", 
            " "}]]}], ")"}]}]]}]}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.7303893776205263`*^9, 3.730389424073536*^9}, {
   3.730389484231307*^9, 3.730389490764448*^9}, {3.730403333051427*^9, 
   3.7304033333396597`*^9}, 3.7304102749413843`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.730389390251691*^9, 3.7303894951809483`*^9, 3.730410226138206*^9, {
   3.7304102699243813`*^9, 3.730410275363229*^9}, 3.730416758410997*^9, 
   3.730417025783873*^9, 3.733255296903571*^9, 3.733256075999704*^9, 
   3.7332587345386467`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.730389390251691*^9, 3.7303894951809483`*^9, 3.730410226138206*^9, {
   3.7304102699243813`*^9, 3.730410275363229*^9}, 3.730416758410997*^9, 
   3.730417025783873*^9, 3.733255296903571*^9, 3.733256075999704*^9, 
   3.733258734540722*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["vertical angular motion", "Subsection",
 CellChangeTimes->{{3.7263275313349857`*^9, 3.726327549661537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"4", ";;", "6"}], ",", 
        RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "/.", 
     RowBox[{"GainszOption", "[", "solz1", "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328285687058*^9, 3.726328294429411*^9}, {
   3.726387791860672*^9, 3.726387794285327*^9}, 3.726672329911825*^9, {
   3.726741934874979*^9, 3.726741945968248*^9}, 3.730388799826305*^9, 
   3.730389523972262*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      FractionBox[
       RowBox[{"2", " ", "d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kiz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "m2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"2", " ", "d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kpz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "m2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"2", " ", "d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "kvz", " ", "m1", " ",
         "m2"}], 
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "m2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328295422483*^9, 3.726383960244869*^9, 3.7263877948096533`*^9, 
   3.726395143470087*^9, 3.726398790772604*^9, 3.726398953733245*^9, 
   3.7266723303926067`*^9, 3.726741947358451*^9, 3.7267431123665*^9, 
   3.7290801509855328`*^9, 3.729080714156989*^9, 3.7290813910641203`*^9, 
   3.729081572232491*^9, {3.730389516239068*^9, 3.7303895245276737`*^9}, 
   3.7304102267577972`*^9, 3.730410277667925*^9, 3.730416758681759*^9, 
   3.7304170259179153`*^9, 3.733255297045273*^9, 3.73325607604583*^9, 
   3.7332587345761337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"C3", "[", 
    RowBox[{"fp_", ",", 
     RowBox[{"{", 
      RowBox[{"ki_", ",", "kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fp", " ", "ki"}], " ", ",", 
      RowBox[{"fp", " ", "kp"}], ",", 
      RowBox[{"fp", " ", "kd"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Theta]Coeff", "=", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"C3", "[", 
       RowBox[{"fp", ",", 
        RowBox[{"{", 
         RowBox[{"kiz", ",", "kpz", ",", "kvz"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", "fp"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.726327516025825*^9, 3.7263275194444313`*^9}, {
   3.726327896032098*^9, 3.7263279188220367`*^9}, {3.726328281425914*^9, 
   3.7263282985897617`*^9}, {3.726395157813596*^9, 3.7263951663641872`*^9}, 
   3.726741971007625*^9, {3.729080167194954*^9, 3.729080170910594*^9}, {
   3.730389531866797*^9, 3.730389549823813*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"fp", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "d1", " ", 
      RowBox[{"(", 
       RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m1", " ", "m2"}], 
     RowBox[{
      RowBox[{"d2", " ", "J", " ", "m2"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", "m2"}], "-", 
      RowBox[{"d1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.726327520171771*^9, 3.726327922975806*^9, 3.7263282989942408`*^9, 
   3.7263839602907667`*^9, 3.726387800150012*^9, {3.726395146058833*^9, 
   3.726395166682246*^9}, 3.7263987908495827`*^9, 3.726398953815689*^9, 
   3.726672332764162*^9, 3.726741972928977*^9, 3.726743114113937*^9, 
   3.729080155696694*^9, 3.729080191977078*^9, 3.729080716460865*^9, 
   3.729081392885786*^9, 3.729081574360396*^9, 3.7303895531066523`*^9, 
   3.7304102270112543`*^9, 3.730410279495302*^9, 3.7304167588148108`*^9, 
   3.7304170260546417`*^9, 3.733255297066221*^9, 3.733256076118657*^9, 
   3.733258734649744*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["rewriting coefficient in more readable manner", "Subsubsection",
 CellChangeTimes->{{3.730389563148305*^9, 3.730389577723201*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"fp", "/.", 
     RowBox[{"sol\[Theta]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"J", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d1", " ", "m1"}], "-", 
         RowBox[{"d2", "  ", "m2"}]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d1"}], " ", "d2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"d1", "-", "d2"}], ")"}], "  ", "m1", " ", "m2"}]]}]]}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.7290801798876543`*^9, 3.729080185778966*^9}, 
   3.729080723230921*^9, {3.7290807612985086`*^9, 3.729080800402236*^9}, {
   3.7303895439735394`*^9, 3.730389551970937*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.729080187784522*^9, 3.729080193216234*^9}, 
   3.729080725038279*^9, {3.729080772013282*^9, 3.729080801406218*^9}, 
   3.729081578217367*^9, 3.73038955511283*^9, 3.7304102271784163`*^9, 
   3.730416758981975*^9, 3.730417026152215*^9, 3.733255297136311*^9, 
   3.7332560761882877`*^9, 3.733258734719543*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Remark: ratio ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"d2", " ", 
    RowBox[{"(", 
     RowBox[{"J", "+", 
      RowBox[{"d1", " ", 
       RowBox[{"(", 
        RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2"}], 
   RowBox[{"d1", " ", "m1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "J"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], ")"}]}]]],
  
  CellChangeTimes->{{3.7304175387599382`*^9, 3.7304175518921843`*^9}, {
   3.7304175878110723`*^9, 3.730417594731711*^9}}],
 " is always positive"
}], "Subsection",
 CellChangeTimes->{{3.73041763925668*^9, 3.730417649693947*^9}}],

Cell["\<\
take d1 to be positive and to be the closest to the bar\[CloseCurlyQuote]s \
center-of-mass (then \[Epsilon]>0)\
\>", "Text",
 CellChangeTimes->{{3.730417653992728*^9, 3.7304176852102327`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"d2", " ", 
     RowBox[{"(", 
      RowBox[{"J", "+", 
       RowBox[{"d1", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2"}], 
    
    RowBox[{"d1", " ", "m1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "J"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], ")"}]}]],
    "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", "d"}], "-", "\[Epsilon]"}]}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7304175387599382`*^9, 3.7304175518921843`*^9}, {
  3.7304175878110723`*^9, 3.730417594731711*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m2", " ", 
   RowBox[{"(", 
    RowBox[{"d", "+", "\[Epsilon]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"J", "+", 
     RowBox[{"d", " ", "m1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "d"}], "+", "\[Epsilon]"}], ")"}]}]}], ")"}]}], 
  RowBox[{"d", " ", "m1", " ", 
   RowBox[{"(", 
    RowBox[{"J", "+", 
     RowBox[{"m2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", "d", " ", "\[Epsilon]"}], "+", 
        SuperscriptBox["\[Epsilon]", "2"]}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.73041754893294*^9, 3.7304175521065197`*^9}, 
   3.730417595384281*^9, 3.733255297214603*^9, 3.733256076268566*^9, 
   3.733258734806075*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Longitudinal motion", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}}],

Cell[CellGroupData[{

Cell["linear and  angular sub-motions are coupled", "Subsection",
 CellChangeTimes->{{3.730341280668648*^9, 3.730341295085247*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"7", ";;", "14"}], ",", 
      RowBox[{"7", ";;", "14"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.730341276507209*^9, 3.7303412765844584`*^9}, 
   3.73041037530974*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d1", "2"]}], " ", "kpr1", " ", "kpx1", " ", "L1", 
         " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr2", " ", "kpx2", " ", "L2", " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpx1", " ", "L1"}], "+", 
              RowBox[{"kpr2", " ", "kpx2", " ", "L2"}]}], ")"}], " ", "m1", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr2", " ", "m1"}], "+", 
              RowBox[{"kpr1", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d1", "2"]}], " ", "kpr1", " ", "kvx1", " ", "L1", 
         " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr2", " ", "kvx2", " ", "L2", " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvx1", " ", "L1"}], "+", 
              RowBox[{"kpr2", " ", "kvx2", " ", "L2"}]}], ")"}], " ", "m1", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr1", " ", "L1"}], "+", 
        RowBox[{"d2", " ", "kpr2", " ", "L2"}]}], 
       RowBox[{
        RowBox[{"d1", " ", "L1"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
       RowBox[{"kpr2", " ", "kpx2"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
       RowBox[{"kpr2", " ", "kvx2"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpx1"}], "-", 
              RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L1", " ", "m1"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr2"}], " ", "m1"}], "+", 
              RowBox[{"kpr1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
              RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L2", " ", "m2"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "m2"}], "+", 
              RowBox[{"kpr2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvx1"}], "-", 
              RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
              RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L2", " ", 
            "m2"}]}], ")"}]}]}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}], " ", "L1", " ", "L2"}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}]]},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "kpr1", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kpx1"}], "-", 
                 RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L1", " ", 
               "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "L1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "kpr2", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
                 RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L2", " ", 
               "m2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kvx1"}], "-", 
                 RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L1", " ", 
               "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "L1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
                 RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L2", " ", 
               "m2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kpx2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kpx1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kvx2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kvx1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"kpr1", "+", "kpr2"}], ")"}]}], "+", 
           RowBox[{"kpr2", " ", "kpx2", " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "kpx1", " ", "L2"}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr1", " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpr2", " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity"}], "+", 
           RowBox[{"kpr2", " ", "kvx2", " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "kvx1", " ", "L2"}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr1", " ", "kvx1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr2", " ", "kvx2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr2", " ", "L1"}], "+", 
        RowBox[{"d2", " ", "kpr1", " ", "L2"}]}], 
       RowBox[{
        RowBox[{"d1", " ", "L1"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726674192645174*^9, 3.72667433503347*^9, 3.730341277019277*^9, 
   3.7304040699992523`*^9, 3.730404244990472*^9, 3.730409723021941*^9, 
   3.730410375808668*^9, {3.7304105706401854`*^9, 3.730410580771489*^9}, 
   3.730416762290491*^9, 3.733255299258379*^9, 3.7332560783156433`*^9, 
   3.7332587348850107`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
choose gains that decouple angular from linear (not possible)\
\>", "Subsection",
 CellChangeTimes->{{3.730341319203321*^9, 3.730341346570821*^9}, {
  3.7303975813258343`*^9, 3.730397593779244*^9}, {3.730408071215151*^9, 
  3.7304080720924883`*^9}}],

Cell["\<\
proportional and derivative gains would have to be the same and different \
simultaneously\
\>", "Text",
 CellChangeTimes->{{3.730408075725968*^9, 3.730408095143825*^9}, {
  3.730410506049127*^9, 3.73041051065007*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"AofInterest", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "8"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "kpr1"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"AofInterest", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "4"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "kpr1"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"AofInterest", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "5"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "kpr1"}], "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.730407970968603*^9, 3.730408061270632*^9}, {
  3.7304104150793858`*^9, 3.7304104951700993`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"kpr1", "\[Rule]", "kpr2"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7304080136432037`*^9, 3.730408061581403*^9}, 
   3.7304080973964643`*^9, {3.730410453403297*^9, 3.730410495553801*^9}, 
   3.7304105827887897`*^9, 3.730416762424971*^9, 3.733255299324355*^9, 
   3.733256078383873*^9, 3.733258734955508*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"kpr1", "\[Rule]", 
    FractionBox[
     RowBox[{"kpr2", " ", "kpx2"}], "kpx1"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7304080136432037`*^9, 3.730408061581403*^9}, 
   3.7304080973964643`*^9, {3.730410453403297*^9, 3.730410495553801*^9}, 
   3.7304105827887897`*^9, 3.730416762424971*^9, 3.733255299324355*^9, 
   3.733256078383873*^9, 3.733258734957734*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"kpr1", "\[Rule]", 
    FractionBox[
     RowBox[{"kpr2", " ", "kvx2"}], "kvx1"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7304080136432037`*^9, 3.730408061581403*^9}, 
   3.7304080973964643`*^9, {3.730410453403297*^9, 3.730410495553801*^9}, 
   3.7304105827887897`*^9, 3.730416762424971*^9, 3.733255299324355*^9, 
   3.733256078383873*^9, 3.733258734959517*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
choose gains that decouple linear from angular, or angular from linear (the \
latter is not possible)\
\>", "Subsection",
 CellChangeTimes->{{3.730341319203321*^9, 3.730341346570821*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"solx2", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"8", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], 
        "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"kpx2", ",", "kvx2", ",", "kpr2"}], "}"}]}], "]"}], "//", 
     "Simplify"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"solx2", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AofInterest", "[", 
           RowBox[{"[", 
            RowBox[{"8", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], 
          "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ")"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kpx1", "\[Rule]", 
           RowBox[{"kpx", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d1", " ", "L1"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "opx"}]}]}], ",", 
          RowBox[{"kpx2", "\[Rule]", " ", 
           RowBox[{"kpx", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d2", " ", "L2"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], "opx"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"kvx1", "\[Rule]", 
           RowBox[{"kvx", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d1", " ", "L1"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "ovx"}]}]}], ",", 
          RowBox[{"kvx2", "\[Rule]", 
           RowBox[{"kvx", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d2", " ", "L2"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "ovx"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
          RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"opx", ",", "ovx"}], "}"}]}], "]"}], "//", "Simplify"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"solx2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"8", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], 
         "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ")"}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kpx1", "\[Rule]", 
          RowBox[{"kpx", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d1", " ", "L1"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], " ", "opx"}]}]}], ",", 
         RowBox[{"kpx2", "\[Rule]", " ", 
          RowBox[{"kpx", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d2", " ", "L2"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], "opx"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"kvx1", "\[Rule]", 
          RowBox[{"kvx", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d1", " ", "L1"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]vx", " ", 
            "opx"}]}]}], ",", 
         RowBox[{"kvx2", "\[Rule]", 
          RowBox[{"kvx", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d2", " ", "L2"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]vx", " ", 
            "opx"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
         RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "\[IndentingNewLine]", "}"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"opx", ",", "\[Gamma]vx"}], "}"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.730397562436323*^9, 3.730397576703635*^9}, {
  3.730397611683611*^9, 3.730397615639999*^9}, {3.7303976718482924`*^9, 
  3.730397674002619*^9}, {3.730399700047818*^9, 3.7303997371735888`*^9}, {
  3.7303999211711197`*^9, 3.730399923714697*^9}, {3.730401478073854*^9, 
  3.730401507913374*^9}, {3.730403484406307*^9, 3.730403612615716*^9}, {
  3.730403951872837*^9, 3.730403993474732*^9}, {3.730404097754916*^9, 
  3.730404111689012*^9}, {3.730404227872869*^9, 3.730404281577544*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"opx", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "+", 
       RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
      RowBox[{
       RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
       RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], ",", 
    RowBox[{"\[Gamma]vx", "\[Rule]", 
     FractionBox["1", "kpr"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7303931803607264`*^9, 3.7303946624600277`*^9, {3.7303975984094677`*^9, 
   3.730397617026229*^9}, 3.730397675537184*^9, 3.730399744323103*^9, 
   3.7304015121042957`*^9, 3.7304020831231613`*^9, {3.730403604918023*^9, 
   3.730403613303104*^9}, 3.73040373102561*^9, {3.730403859731395*^9, 
   3.730403872040506*^9}, {3.730403943701272*^9, 3.7304039616605463`*^9}, {
   3.7304039940389833`*^9, 3.730404011322928*^9}, 3.730404112120994*^9, {
   3.730404239770924*^9, 3.7304042484640636`*^9}, 3.7304042853732777`*^9, 
   3.730409723343203*^9, 3.730410585173356*^9, 3.730416762582059*^9, 
   3.733255299440431*^9, 3.733256078502512*^9, 3.733258735103334*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "opx = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", 
    RowBox[{"p", ",", "x"}]], TraditionalForm]]],
 " ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalDelta]", 
    RowBox[{"p", ",", "x"}]], TraditionalForm]]],
 " (see ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", 
    RowBox[{"p", ",", "x"}]], TraditionalForm]]],
 " in lateral linear motion)"
}], "Subsubsection",
 CellChangeTimes->{{3.7304074568861017`*^9, 3.730407457380773*^9}, {
  3.7304099803788977`*^9, 3.730410003768952*^9}, {3.73041454605802*^9, 
  3.730414551983656*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"opx", "/.", 
     RowBox[{"solx2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"gravity", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d1", "  ", "L1"}], "-", 
         RowBox[{"d2", "  ", "L2"}]}], ")"}]}], 
      RowBox[{"L1", " ", "L2", 
       RowBox[{"(", 
        RowBox[{"d1", "-", "d2"}], " ", ")"}]}]], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"m", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1", " ", "m1"}], "+", 
          RowBox[{"d2", " ", "L2", " ", "m2"}]}], ")"}]}], 
       RowBox[{" ", 
        RowBox[{"m1", " ", "m2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}]}]}]], ")"}]}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.730407462844912*^9, 3.7304076721663437`*^9}, {
  3.730414540482057*^9, 3.730414572978231*^9}, {3.733249346488839*^9, 
  3.733249367920918*^9}, {3.733249425058423*^9, 3.7332494406816397`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7304076380984077`*^9, 3.7304076420643997`*^9}, 
   3.730407674242223*^9, 3.73041000494732*^9, 3.730410713529097*^9, 
   3.730416762725021*^9, 3.7332552995080967`*^9, 3.7332560785725803`*^9, 
   3.7332587351218348`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["write gain conditions", "Subsubsection",
 CellChangeTimes->{{3.726728755355084*^9, 3.726728763587493*^9}, {
   3.7303932191741247`*^9, 3.730393226753611*^9}, {3.7303934348904753`*^9, 
   3.730393442472876*^9}, 3.7304015955270767`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"GainsxOption", "=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kpx1", "\[Rule]", 
         RowBox[{"kpx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "opx"}]}]}], ",", 
        RowBox[{"kpx2", "\[Rule]", " ", 
         RowBox[{"kpx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], "opx"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kvx1", "\[Rule]", 
         RowBox[{"kvx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "ovx"}]}]}], ",", 
        RowBox[{"kvx2", "\[Rule]", 
         RowBox[{"kvx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], "ovx"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
        RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "\[IndentingNewLine]", "}"}], "/.", 
      RowBox[{"solx2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GainsxOption", "=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kpx1", "\[Rule]", 
         RowBox[{"kpx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "opx"}]}]}], ",", 
        RowBox[{"kpx2", "\[Rule]", " ", 
         RowBox[{"kpx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], "opx"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kvx1", "\[Rule]", 
         RowBox[{"kvx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]vx", " ", 
           "opx"}]}]}], ",", 
        RowBox[{"kvx2", "\[Rule]", 
         RowBox[{"kvx", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], "\[Gamma]vx", " ", "opx"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
        RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "\[IndentingNewLine]", "}"}], "/.", 
      RowBox[{"solx2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kpx1", "-", "kpx2"}], ")"}], "/.", "GainsxOption"}], ")"}], 
      "-", 
      RowBox[{"(", 
       RowBox[{"opx", "/.", 
        RowBox[{"solx2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", "Simplify"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kvx1", "-", "kvx2"}], ")"}], "/.", "GainsxOption"}], ")"}], 
      "-", 
      RowBox[{"(", 
       RowBox[{"ovx", "/.", 
        RowBox[{"solx2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", "Simplify"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.730393231803755*^9, 3.730393419054658*^9}, {
   3.730394716510079*^9, 3.730394813763771*^9}, {3.7303948439146767`*^9, 
   3.730394908204091*^9}, 3.730397643413418*^9, 3.730397682022291*^9, {
   3.730399690395203*^9, 3.730399690703806*^9}, {3.730399755772806*^9, 
   3.730399766789885*^9}, {3.730399913746347*^9, 3.73039992937714*^9}, {
   3.7304015240941553`*^9, 3.730401539860056*^9}, 3.730403736172714*^9, {
   3.730404016299076*^9, 3.730404037454884*^9}, 3.730404118051712*^9, {
   3.730404288297348*^9, 3.730404299552394*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
check that sub-motions are indeed decoupled (we chose to decouple the linear \
from the angular)\
\>", "Subsubsection",
 CellChangeTimes->{{3.730341120613907*^9, 3.730341128792337*^9}, {
  3.7303893152192087`*^9, 3.730389325264153*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["Asimilar", "1"], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"7", ";;", "14"}], ",", 
        RowBox[{"7", ";;", "14"}]}], "]"}], "]"}], "/.", "GainsxOption"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7303998447220592`*^9, 3.730399858482583*^9}, 
   3.730403758975698*^9, 3.730404046380752*^9, 3.730410595087306*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "gravity", " ", "kpr", " ", 
          SuperscriptBox["L1", "2"], " ", "m", " ", "m1"}], "+", 
         RowBox[{"kpr", " ", "L2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d2", "2"], " ", "gravity", " ", "L2", " ", "m"}],
             "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpx", " ", "L1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1"}]}], ")"}], " ", 
          "m2"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "gravity", " ", 
          SuperscriptBox["L1", "2"], " ", "m", " ", "m1"}], "+", 
         RowBox[{"L2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d2", "2"], " ", "gravity", " ", "L2", " ", "m"}],
             "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", "kpr", " ", "kvx", " ", 
             "L1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1"}]}], ")"}], " ", 
          "m2"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", "kpr"}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
         "d1", " ", "gravity", " ", "kpr", " ", "L1", " ", "m", " ", "m1"}], 
         "+", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr", " ", "L2", " ", "m", " ", "m2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "+", 
         
         RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], "0",
       "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kpx", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kvx", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "d2", " ", "L1", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "gravity"}], "+", 
              RowBox[{"kpx", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            SuperscriptBox["L2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpx", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
           
           RowBox[{
            SuperscriptBox["d1", "2"], " ", 
            SuperscriptBox["L1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpx", " ", "L2", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "gravity", " ", 
          SuperscriptBox["L1", "2"], " ", "m", " ", "m1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d2", "2"], " ", "gravity", " ", 
             SuperscriptBox["L2", "2"], " ", "m"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"gravity", "+", 
                  RowBox[{"kpr", " ", "kvx", " ", "L1"}]}], ")"}], " ", 
                "L2"}], "+", 
               RowBox[{"d1", " ", "L1", " ", 
                RowBox[{"(", 
                 RowBox[{"gravity", "+", 
                  RowBox[{"kpr", " ", "kvx", " ", "L2"}]}], ")"}]}]}], ")"}], 
             " ", "m1"}]}], ")"}], " ", "m2"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7303998512227783`*^9, 3.730399859569726*^9}, 
   3.730401543955217*^9, 3.730402084920417*^9, {3.730403740266802*^9, 
   3.7304037622890472`*^9}, 3.730404049379422*^9, 3.730404123870572*^9, 
   3.730404305001886*^9, 3.73040972574998*^9, {3.730410591792879*^9, 
   3.730410603598404*^9}, 3.7304167650142403`*^9, 3.733255300950235*^9, 
   3.733256080030221*^9, 3.7332587366218863`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["linear motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.7263281711595583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"7", ";;", "14"}], ",", 
         RowBox[{"7", ";;", "14"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"4", ";;", "8"}], ",", 
        RowBox[{"4", ";;", "8"}]}], "]"}], "]"}], "/.", "GainsxOption"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328285687058*^9, 3.726328294429411*^9}, {
   3.726387791860672*^9, 3.726387794285327*^9}, {3.726395879705676*^9, 
   3.72639590510732*^9}, {3.7263966718165417`*^9, 3.7263967062431917`*^9}, {
   3.726674433418577*^9, 3.7266745359301243`*^9}, {3.7304041411306458`*^9, 
   3.730404141243018*^9}, 3.730410608803488*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kpx", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kvx", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "d2", " ", "L1", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "gravity"}], "+", 
              RowBox[{"kpx", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            SuperscriptBox["L2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpx", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
           
           RowBox[{
            SuperscriptBox["d1", "2"], " ", 
            SuperscriptBox["L1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpx", " ", "L2", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity"}], "+", 
           RowBox[{"kpr", " ", "kvx", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr", " ", "kvx", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr", " ", "kvx", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7263959064445477`*^9, 3.726398791241679*^9, 3.7263989542094193`*^9, {
   3.726674442459239*^9, 3.7266744889216347`*^9}, 3.7266746327106037`*^9, {
   3.726674867354784*^9, 3.726674874021942*^9}, 3.7304041432957783`*^9, 
   3.730404307204521*^9, 3.730409726077649*^9, 3.730410609628459*^9, 
   3.73041676534597*^9, 3.733255301192086*^9, 3.733256080269261*^9, 
   3.733258736857765*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]5", "[", 
   RowBox[{"q_", ",", 
    RowBox[{"{", 
     RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", " ", "fp", " ", "kp"}], " ", ",", 
     RowBox[{"fp", " ", "fd", " ", "kd"}], ",", 
     RowBox[{"fd", 
      RowBox[{"(", 
       RowBox[{"kp", "+", " ", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"fd", " ", "kd"}], "+", 
      RowBox[{"fp", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "fd"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"solxCoeff", "=", 
  RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}],
         ")"}], "&"}], "[", 
      RowBox[{"\[CapitalGamma]5", "[", 
       RowBox[{"q", ",", 
        RowBox[{"{", 
         RowBox[{"fp", ",", "kpr"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"q", ",", "fp"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
   3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
   3.726328241473325*^9}, {3.726395927154138*^9, 3.726395941936696*^9}, {
   3.726396043235939*^9, 3.7263961012300777`*^9}, {3.726396165264764*^9, 
   3.726396168870923*^9}, 3.7266745085005836`*^9, 3.7266745607895603`*^9, {
   3.726674610661941*^9, 3.7266746267223797`*^9}, {3.7304041547430983`*^9, 
   3.730404187705941*^9}, {3.7304146880820847`*^9, 3.730414691163224*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q", "\[Rule]", 
     FractionBox[
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", 
          SuperscriptBox["L1", "2"], " ", "m1"}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          SuperscriptBox["L2", "2"], " ", "m2"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], "2"], " ", "m1", " ", "m2"}]]}],
     ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"d1", " ", "gravity", " ", "L1"}], "-", 
       RowBox[{"d2", " ", "gravity", " ", "L2"}]}], 
      RowBox[{
       RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
       RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, 3.726383960396386*^9, 3.726395947976009*^9, {
   3.726396089572956*^9, 3.726396101799168*^9}, 3.72639616932799*^9, 
   3.726398791352509*^9, 3.726398954283115*^9, 3.72667456140829*^9, {
   3.726674623747355*^9, 3.7266746278813667`*^9}, {3.726674868663292*^9, 
   3.726674875010693*^9}, 3.730404188334503*^9, 3.73040430919382*^9, 
   3.730409726325783*^9, 3.730410612028762*^9, 3.730416765498226*^9, 
   3.733255301329076*^9, 3.733256080412889*^9, 3.733258736993737*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["check relation", "Subsubsection",
 CellChangeTimes->{{3.73041460029848*^9, 3.730414602455099*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"fp", "/.", 
     RowBox[{"solxCoeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{
    FractionBox["gravity", 
     RowBox[{"L1", " ", "L2"}]], 
    FractionBox[
     RowBox[{
      RowBox[{"d1", "  ", "L1"}], "-", 
      RowBox[{"d2", "  ", "L2"}]}], 
     RowBox[{"d1", "-", "d2"}]]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.730414603931835*^9, 3.730414637332212*^9}, {
  3.73041468566462*^9, 3.730414698304962*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.73041462694943*^9, 3.7304146377668533`*^9}, 
   3.730416765650264*^9, 3.7332553013950787`*^9, 3.7332560804819603`*^9, 
   3.733258737068725*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.72632817761716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"7", ";;", "14"}], ",", 
         RowBox[{"7", ";;", "14"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", 
        RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "/.", "GainsxOption"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.72639900604582*^9, 3.7263990094699*^9}, {
   3.726674540473954*^9, 3.7266745443499613`*^9}, {3.730404195187055*^9, 
   3.7304041953331213`*^9}, 3.730410618636588*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "d2", " ", "kpx", " ", "L1", " ", "L2", 
            " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            SuperscriptBox["L2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{"kpx", " ", "L1", " ", "m1"}]}], ")"}], " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", 
            SuperscriptBox["L1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{"kpx", " ", "L2", " ", "m2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
        "d1", " ", "d2", " ", "kpr", " ", "kvx", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{"kpr", " ", "kvx", " ", "L1", " ", "m1"}]}], ")"}], " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{"kpr", " ", "kvx", " ", "L2", " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.726399009755817*^9, 3.7266746378445587`*^9, 
  3.72667490123772*^9, 3.730404195866543*^9, 3.730404311064081*^9, 
  3.730409726514206*^9, 3.730410619364397*^9, 3.730416765848064*^9, 
  3.7332553015439253`*^9, 3.733256080630301*^9, 3.733258737217112*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]3", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fd_", ",", "\[Delta]kp_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"fd", " ", "kp"}], "+", 
       RowBox[{"fd", " ", "\[Delta]kp"}]}], ",", 
      RowBox[{
       RowBox[{"fd", " ", "kd"}], "+", "\[Delta]kp"}], ",", "fd"}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AofInterest", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", "#"}], 
       ")"}], "&"}], "[", 
     RowBox[{"\[CapitalGamma]3", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fd", ",", "\[Delta]kp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"fd", ",", "\[Delta]kp"}], "}"}]}], "\[IndentingNewLine]", "]"}],
   "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.726327606871179*^9, 3.7263276106035624`*^9}, {
   3.726327770793311*^9, 3.726327799705961*^9}, {3.7263279496618958`*^9, 
   3.72632798833605*^9}, {3.726328261955852*^9, 3.726328272422624*^9}, 
   3.726396247770953*^9, {3.726396280003148*^9, 3.726396280273984*^9}, {
   3.726396348892178*^9, 3.726396356436736*^9}, {3.726396395500808*^9, 
   3.7263964600216017`*^9}, 3.7263965111267357`*^9, {3.726396557414629*^9, 
   3.726396573247301*^9}, {3.726398993334342*^9, 3.726399003333973*^9}, {
   3.726674649621997*^9, 3.726674652431727*^9}, 3.730404201910674*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fd", "\[Rule]", "kpr"}], ",", 
    RowBox[{"\[Delta]kp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", 
          SuperscriptBox["L1", "2"], " ", "m1"}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          SuperscriptBox["L2", "2"], " ", "m2"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d1", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7263276108839684`*^9, 3.726327800066736*^9, {3.7263279685390987`*^9, 
   3.726327989012171*^9}, 3.7263282741889153`*^9, 3.72638396049432*^9, {
   3.726396248418042*^9, 3.726396272545619*^9}, {3.7263963319866943`*^9, 
   3.7263964619412117`*^9}, {3.7263965712930098`*^9, 3.726396576289411*^9}, 
   3.72639879139755*^9, 3.726398954328045*^9, 3.726399012190465*^9, 
   3.726674652891857*^9, 3.726674902247384*^9, 3.730404203053712*^9, 
   3.7304043125458612`*^9, 3.730409726627133*^9, 3.7304106215074387`*^9, 
   3.730416765966639*^9, 3.733255301603491*^9, 3.733256080694336*^9, 
   3.733258737281543*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lateral motion", "Chapter",
 CellChangeTimes->{
  3.713450784010139*^9, {3.726327556502136*^9, 3.726327566637467*^9}, {
   3.726328191491131*^9, 3.726328192534465*^9}}],

Cell[CellGroupData[{

Cell["see that linear and angular motions are coupled", "Subsubsection",
 CellChangeTimes->{{3.7303888930624733`*^9, 3.730388901419463*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    SubscriptBox["Asimilar", "1"], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"15", ";;", "24"}], ",", 
      RowBox[{"15", ";;", "24"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726675016086808*^9, 3.7266750363701067`*^9}, {
   3.730406653129678*^9, 3.730406653307418*^9}, 3.730410708625553*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kpy2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kpy1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kvy2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kvy1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "kpr2", " ", "L1"}], "+", 
           RowBox[{"gravity", " ", "kpr1", " ", "L2"}], "+", 
           RowBox[{"kpr1", " ", "kpy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{"kpr2", " ", "kpy2", " ", "L1", " ", "L2"}]}], ")"}], " ", 
         "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpy1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpr2", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpy2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr1", " ", "kvy1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr2", " ", "kvy2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "kpr1"}], "-", 
        RowBox[{"d1", " ", "kpr2"}]}], 
       RowBox[{"d1", "-", "d2"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpr1"}], " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kp\[Psi]1"}], " ", "L1"}], "+", 
              RowBox[{"kpy1", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"kpr2", " ", "L1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kp\[Psi]2"}], " ", "L2"}], "+", 
              RowBox[{"kpy2", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kpr1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]1"}], " ", "L1"}], "+", 
             RowBox[{"kvy1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"kpr2", " ", "L1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]2"}], " ", "L2"}], "+", 
             RowBox[{"kvy2", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpr2"}], " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m", " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "kpr1", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpy1"}], "-", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kpy1"}], "+", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpr2", " ", "L1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr2", " ", "L1"}], "-", 
                 RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m2"}]}], 
             ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "-", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "L1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{"J", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kpr1"}], "+", "kpr2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "m"}]]},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "kpr2"}], " ", "kpy2", " ", "L1"}], "+", 
          RowBox[{"kpr1", " ", "kpy1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "kpr2"}], " ", "kvy2", " ", "L1"}], "+", 
          RowBox[{"kpr1", " ", "kvy1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kpy1"}], "-", 
                 RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr2"}], " ", "L1", " ", "m1"}], "+", 
                 RowBox[{"kpr1", " ", "L2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ",
             "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kpy1"}], "+", 
                 RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "L2", " ", "m2"}], "+", 
                 RowBox[{"kpr2", " ", "L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         "L2", " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kvy1"}], "-", 
                 RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L1"}], " ", "m1"}], "+", 
                 RowBox[{"L2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ",
             "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kvy1"}], "+", 
                 RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L2"}], " ", "m2"}], "+", 
                 RowBox[{"L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         "L2", " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J"}]], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "kpr1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kp\[Psi]1"}], " ", "L1"}], "+", 
             RowBox[{"kpy1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d2", " ", "kpr2", " ", "L1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kp\[Psi]2"}], " ", "L2"}], "+", 
             RowBox[{"kpy2", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}]}]], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "kpr1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]1"}], " ", "L1"}], "+", 
             RowBox[{"kvy1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d2", " ", "kpr2", " ", "L1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kv\[Psi]2"}], " ", "L2"}], "+", 
             RowBox[{"kvy2", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d2", "2"]}], " ", "J", " ", "kpr2", " ", "kpy2", 
         " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "kpr1", 
         " ", "L2", " ", "m", " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr1", " ", "kpy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr2", " ", "L1"}], "+", 
              RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m"}]}], ")"}], " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpy1"}], "+", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m1", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpr2", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"J", " ", "kpr1", " ", "L2", " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "kpr2", " ", "L1", " ", "m1", 
               " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
        "L2", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d2", "2"]}], " ", "J", " ", "kpr2", " ", "kvy2", 
         " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "L2", " ",
          "m", " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr1", " ", "kvy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}], " ", "m"}]}], ")"}], " ", "m1",
          " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m1", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"J", " ", "L2", " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "L1", " ", "m1", " ", "m2"}]}],
              ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
        "L2", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr1"}], "+", 
        RowBox[{"d2", " ", "kpr2"}]}], 
       RowBox[{"d1", "-", "d2"}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.726675019588911*^9, 3.726675036682515*^9}, 
   3.726764080480618*^9, 3.73040665399442*^9, 3.7304067095414343`*^9, 
   3.730407088415341*^9, 3.73040993716261*^9, 3.730410709115106*^9, 
   3.7304167710807037`*^9, 3.73325530490166*^9, 3.7332560840073967`*^9, 
   3.73325873735754*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["choose gains that decouple linear from angular", "Subsubsection",
 CellChangeTimes->{{3.730341047593988*^9, 3.730341059942281*^9}, {
  3.730395250770293*^9, 3.730395253165038*^9}, {3.730409680914074*^9, 
  3.730409683243505*^9}, {3.730409960231501*^9, 3.730409973406538*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "simpler", " ", "form", "\[IndentingNewLine]", "note", " ", "that", " ", 
     "in", " ", "control", " ", "law"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "kp\[Psi]1", " ", "and", " ", "kv\[Psi]1", " ", "are", " ", 
     "premultiplied", " ", "by", " ", 
     FractionBox["L1", 
      RowBox[{"L1", "+", "L2"}]], "\[IndentingNewLine]", "while", 
     "\[IndentingNewLine]", "kp\[Psi]2", " ", "and", " ", "kv\[Psi]2", " ", 
     "are", " ", "premultiplied", " ", "by", " ", 
     FractionBox["L1", 
      RowBox[{"L1", "+", "L2"}]]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"soly1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AofInterest", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "7", ",", "8", ",", "9", ",", "10"}], "}"}]}], 
           "]"}], "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
        ")"}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kpy1", "\[Rule]", 
          RowBox[{"kpy", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d1", " ", "L1"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
         RowBox[{"kpy2", "\[Rule]", " ", 
          RowBox[{"kpy", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d2", " ", "L2"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"kvy1", "\[Rule]", 
          RowBox[{"kvy", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d1", " ", "L1"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]v\[Psi]", " ", 
            "opy"}]}]}], ",", 
         RowBox[{"kvy2", "\[Rule]", " ", 
          RowBox[{"kvy", "+", 
           RowBox[{
            FractionBox[
             RowBox[{"d2", " ", "L2"}], 
             RowBox[{
              RowBox[{"d1", " ", "L1"}], "-", 
              RowBox[{"d2", " ", "L2"}]}]], "\[Gamma]v\[Psi]", "  ", 
            "opy"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"kp\[Psi]1", "\[Rule]", 
          RowBox[{
           FractionBox["d1", 
            RowBox[{"d1", "-", "d2"}]], 
           RowBox[{"(", 
            RowBox[{"L1", "+", "L2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"op\[Psi]", " ", "opy"}], "+", 
             RowBox[{
              RowBox[{"(", 
               FractionBox[
                RowBox[{"L2", "-", "L1"}], 
                RowBox[{"L2", " ", "L1"}]], ")"}], "kpy"}]}], ")"}]}]}], ",", 
         
         RowBox[{"kp\[Psi]2", "\[Rule]", 
          RowBox[{
           FractionBox["d2", 
            RowBox[{"d1", "-", "d2"}]], 
           RowBox[{"(", 
            RowBox[{"L1", "+", "L2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"op\[Psi]", " ", "opy"}], "+", 
             RowBox[{
              RowBox[{"(", 
               FractionBox[
                RowBox[{"L2", "-", "L1"}], 
                RowBox[{"L2", " ", "L1"}]], ")"}], "kpy"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"kv\[Psi]1", "\[Rule]", 
          RowBox[{
           FractionBox["d1", 
            RowBox[{"d1", "-", "d2"}]], 
           RowBox[{"(", 
            RowBox[{"L1", "+", "L2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
             RowBox[{
              RowBox[{"(", 
               FractionBox[
                RowBox[{"L2", "-", "L1"}], 
                RowBox[{"L2", " ", "L1"}]], ")"}], "kvy"}]}], ")"}]}]}], ",", 
         
         RowBox[{"kv\[Psi]2", "\[Rule]", 
          RowBox[{
           FractionBox["d2", 
            RowBox[{"d1", "-", "d2"}]], 
           RowBox[{"(", 
            RowBox[{"L1", "+", "L2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
             RowBox[{
              RowBox[{"(", 
               FractionBox[
                RowBox[{"L2", "-", "L1"}], 
                RowBox[{"L2", " ", "L1"}]], ")"}], "kvy"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
         RowBox[{"kpr2", "\[Rule]", " ", "kpr"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "opy", ",", "\[Gamma]v\[Psi]", ",", "op\[Psi]", ",", "ov\[Psi]"}], 
       "}"}]}], "]"}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.730416794595583*^9, 3.730416844072051*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"opy", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "J", " ", "L2", " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"J", " ", "L1"}], "+", 
             RowBox[{
              SuperscriptBox["d2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", "m1", " ", "m2"}]]}]}], ",", 
    RowBox[{"\[Gamma]v\[Psi]", "\[Rule]", 
     FractionBox["1", "kpr"]}], ",", 
    RowBox[{"op\[Psi]", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", "-", "d2"}], 
      RowBox[{
       RowBox[{"d1", " ", "L1"}], "-", 
       RowBox[{"d2", " ", "L2"}]}]]}], ",", 
    RowBox[{"ov\[Psi]", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", "-", "d2"}], 
      RowBox[{
       RowBox[{"d1", " ", "kpr", " ", "L1"}], "-", 
       RowBox[{"d2", " ", "kpr", " ", "L2"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7304167788018417`*^9, {3.7304168453263617`*^9, 3.730416854236866*^9}, 
   3.733255305069057*^9, 3.7332560841715117`*^9, 3.733258737535915*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"soly1", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AofInterest", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7", ",", "8", ",", "9", ",", "10"}], "}"}]}],
             "]"}], "]"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         ")"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kpy1", "\[Rule]", 
           RowBox[{"kpy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d1", " ", "L1"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
          RowBox[{"kpy2", "\[Rule]", " ", 
           RowBox[{"kpy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d2", " ", "L2"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"kvy1", "\[Rule]", 
           RowBox[{"kvy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d1", " ", "L1"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]v\[Psi]", " ", 
             "opy"}]}]}], ",", 
          RowBox[{"kvy2", "\[Rule]", " ", 
           RowBox[{"kvy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d2", " ", "L2"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], "\[Gamma]v\[Psi]", "  ", 
             "opy"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"kp\[Psi]1", "\[Rule]", 
           RowBox[{
            FractionBox["d1", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", "op\[Psi]", ")"}]}]}], ",", 
          RowBox[{"kp\[Psi]2", "\[Rule]", 
           RowBox[{
            FractionBox["d2", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", "op\[Psi]", ")"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"kv\[Psi]1", "\[Rule]", 
           RowBox[{
            FractionBox["d1", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", "ov\[Psi]", ")"}]}]}], ",", 
          RowBox[{"kv\[Psi]2", "\[Rule]", 
           RowBox[{
            FractionBox["d2", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", "ov\[Psi]", ")"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
          RowBox[{"kpr2", "\[Rule]", " ", "kpr"}]}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "opy", ",", "\[Gamma]v\[Psi]", ",", "op\[Psi]", ",", "ov\[Psi]"}], 
        "}"}]}], "]"}], "//", "Simplify"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"simpler", " ", "form"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"soly1", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AofInterest", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7", ",", "8", ",", "9", ",", "10"}], "}"}]}],
             "]"}], "]"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         ")"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kpy1", "\[Rule]", 
           RowBox[{"kpy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d1", " ", "L1"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
          RowBox[{"kpy2", "\[Rule]", " ", 
           RowBox[{"kpy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d2", " ", "L2"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"kvy1", "\[Rule]", 
           RowBox[{"kvy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d1", " ", "L1"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]v\[Psi]", " ", 
             "opy"}]}]}], ",", 
          RowBox[{"kvy2", "\[Rule]", " ", 
           RowBox[{"kvy", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"d2", " ", "L2"}], 
              RowBox[{
               RowBox[{"d1", " ", "L1"}], "-", 
               RowBox[{"d2", " ", "L2"}]}]], "\[Gamma]v\[Psi]", "  ", 
             "opy"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"kp\[Psi]1", "\[Rule]", 
           RowBox[{
            FractionBox["d1", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"op\[Psi]", " ", "opy"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["L1", "L2"]}], "+", 
                 FractionBox["L2", "L1"]}], ")"}], "kpy"}]}], ")"}]}]}], ",", 
          
          RowBox[{"kp\[Psi]2", "\[Rule]", 
           RowBox[{
            FractionBox["d2", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"op\[Psi]", " ", "opy"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["L1", "L2"]}], "+", 
                 FractionBox["L2", "L1"]}], ")"}], "kpy"}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"kv\[Psi]1", "\[Rule]", 
           RowBox[{
            FractionBox["d1", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["L1", "L2"]}], "+", 
                 FractionBox["L2", "L1"]}], ")"}], "kvy"}]}], ")"}]}]}], ",", 
          
          RowBox[{"kv\[Psi]2", "\[Rule]", 
           RowBox[{
            FractionBox["d2", 
             RowBox[{"d1", "-", "d2"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["L1", "L2"]}], "+", 
                 FractionBox["L2", "L1"]}], ")"}], "kvy"}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
          RowBox[{"kpr2", "\[Rule]", " ", "kpr"}]}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "opy", ",", "\[Gamma]v\[Psi]", ",", "op\[Psi]", ",", "ov\[Psi]"}], 
        "}"}]}], "]"}], "//", "Simplify"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.730395645604007*^9, 3.730395821525206*^9}, {
   3.7303958536507807`*^9, 3.73039586740877*^9}, {3.73039590568228*^9, 
   3.7303959269427977`*^9}, {3.7303960897627993`*^9, 3.730396166218853*^9}, {
   3.73039632711768*^9, 3.730396331020125*^9}, {3.7303963681204967`*^9, 
   3.730396386223007*^9}, {3.730396677401958*^9, 3.730396850254994*^9}, {
   3.730397729400021*^9, 3.7303978678301086`*^9}, {3.730397932243072*^9, 
   3.730398060585206*^9}, {3.7303986751964417`*^9, 3.730398699121519*^9}, {
   3.730398835234268*^9, 3.7303988385162487`*^9}, {3.730398916887513*^9, 
   3.73039892505168*^9}, {3.730398988661644*^9, 3.730398991061871*^9}, {
   3.7303990347249126`*^9, 3.730399037179788*^9}, {3.7303994712833*^9, 
   3.730399473741549*^9}, {3.730400148876182*^9, 3.73040022786377*^9}, {
   3.7304016501050034`*^9, 3.7304016506325703`*^9}, {3.730402269095223*^9, 
   3.73040230319172*^9}, {3.730402546364141*^9, 3.730402557230837*^9}, {
   3.730402606145905*^9, 3.7304026091635103`*^9}, {3.7304043652417088`*^9, 
   3.730404404478018*^9}, {3.730404441650671*^9, 3.730404529908949*^9}, {
   3.730405139066699*^9, 3.730405149370338*^9}, {3.7304052515791388`*^9, 
   3.7304052728588257`*^9}, {3.730406157981118*^9, 3.730406158318276*^9}, {
   3.7304062085391083`*^9, 3.730406215164587*^9}, {3.7304067336676407`*^9, 
   3.730406761454324*^9}, {3.730407224138629*^9, 3.730407239077779*^9}, 
   3.7304155833417997`*^9, 3.730416849970563*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "opy = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", 
    RowBox[{"p", ",", "y"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalDelta]", 
    RowBox[{"p", ",", "y"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " (see ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", 
    RowBox[{"p", ",", "y"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " in lateral linear motion)"
}], "Subsubsection",
 CellChangeTimes->{{3.7304074568861017`*^9, 3.730407457380773*^9}, {
  3.7304099803788977`*^9, 3.730410003768952*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"opy", "/.", 
     RowBox[{"soly1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["gravity", 
      RowBox[{"L1", " ", "L2"}]], 
     FractionBox[
      RowBox[{
       RowBox[{"d1", "  ", "L1"}], "-", 
       RowBox[{"d2", "  ", "L2"}]}], 
      RowBox[{"d1", " ", "-", "d2"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "L2", " ", "m2"}], " ", "+", 
           RowBox[{"d1", " ", "L1", " ", "m1"}]}], ")"}]}], 
        RowBox[{"m1", " ", "m2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " "}]], "+", 
       RowBox[{
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"-", "d1"}], " ", "d2", " ", "m"}]}], "J"], 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", " ", "-", " ", "d2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"L1", "-", "L2"}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d1", " ", "L1"}], "-", 
            RowBox[{"d2", " ", "L2"}]}], ")"}], " "}]]}]}], ")"}]}], ")"}]}], 
  "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.730407462844912*^9, 3.7304076721663437`*^9}, {
  3.73324958781945*^9, 3.733249600463715*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7304076380984077`*^9, 3.7304076420643997`*^9}, 
   3.730407674242223*^9, 3.73041000494732*^9, 3.730410713529097*^9, 
   3.730416862677602*^9, 3.733255305202681*^9, 3.733256084302662*^9, 
   3.733258737667053*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
choose gains that decouple angular from linear (not possible)\
\>", "Subsubsection",
 CellChangeTimes->{{3.730341047593988*^9, 3.730341084545486*^9}, 
   3.7303897413743277`*^9, {3.730395262389823*^9, 3.730395266946322*^9}}],

Cell[TextData[{
 "Cannot decouple angular motion from linear motion because it requires \
simultaneously that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "=", 
    RowBox[{
     FractionBox[
      RowBox[{" ", 
       RowBox[{"kpy2", " ", "L1"}]}], 
      RowBox[{"kpy1", " ", "L2"}]], "=", 
     FractionBox[
      RowBox[{" ", 
       RowBox[{"kvy2", " ", "L1"}]}], 
      RowBox[{"kvy1", " ", "L2"}]]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{
  3.730395296888517*^9, {3.7304064195059967`*^9, 3.730406439211362*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"15", ";;", "24"}], ",", 
         RowBox[{"15", ";;", "24"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"10", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "kpr1"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"15", ";;", "24"}], ",", 
         RowBox[{"15", ";;", "24"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"10", ",", "2"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "kpr1"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"15", ";;", "24"}], ",", 
         RowBox[{"15", ";;", "24"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"10", ",", "5"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
    "kpr1"}], "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.730410716535871*^9, 3.7304107207104*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"kpr1", "\[Rule]", 
    FractionBox[
     RowBox[{"kpr2", " ", "kpy2", " ", "L1"}], 
     RowBox[{"kpy1", " ", "L2"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.730406413823606*^9, 3.730410007397147*^9, 
  3.730410721299651*^9, 3.7304168627951517`*^9, 3.7332553052776413`*^9, 
  3.7332560843794813`*^9, 3.733258737822073*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"kpr1", "\[Rule]", 
    FractionBox[
     RowBox[{"kpr2", " ", "kvy2", " ", "L1"}], 
     RowBox[{"kvy1", " ", "L2"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.730406413823606*^9, 3.730410007397147*^9, 
  3.730410721299651*^9, 3.7304168627951517`*^9, 3.7332553052776413`*^9, 
  3.7332560843794813`*^9, 3.733258737825322*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"kpr1", "\[Rule]", "kpr2"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.730406413823606*^9, 3.730410007397147*^9, 
  3.730410721299651*^9, 3.7304168627951517`*^9, 3.7332553052776413`*^9, 
  3.7332560843794813`*^9, 3.733258737828157*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["rewrite conditions on gains", "Subsubsection",
 CellChangeTimes->{{3.730341103121126*^9, 3.730341112974743*^9}, {
  3.73040166432314*^9, 3.730401671285347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"GainsyOption", "=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kpy1", "\[Rule]", 
         RowBox[{"kpy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
        RowBox[{"kpy2", "\[Rule]", " ", 
         RowBox[{"kpy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kvy1", "\[Rule]", 
         RowBox[{"kvy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]v\[Psi]", " ", 
           "opy"}]}]}], ",", 
        RowBox[{"kvy2", "\[Rule]", " ", 
         RowBox[{"kvy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], "\[Gamma]v\[Psi]", "  ", 
           "opy"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kp\[Psi]1", "\[Rule]", 
         RowBox[{
          FractionBox["d1", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", "op\[Psi]", ")"}]}]}], ",", 
        RowBox[{"kp\[Psi]2", "\[Rule]", 
         RowBox[{
          FractionBox["d2", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", "op\[Psi]", ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kv\[Psi]1", "\[Rule]", 
         RowBox[{
          FractionBox["d1", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", "ov\[Psi]", ")"}]}]}], ",", 
        RowBox[{"kv\[Psi]2", "\[Rule]", 
         RowBox[{
          FractionBox["d2", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", "ov\[Psi]", ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
        RowBox[{"kpr2", "\[Rule]", " ", "kpr"}]}], "\[IndentingNewLine]", 
       "}"}], "/.", 
      RowBox[{"soly1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"simpler", " ", "form"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"GainsyOption", "=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kpy1", "\[Rule]", 
         RowBox[{"kpy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
        RowBox[{"kpy2", "\[Rule]", " ", 
         RowBox[{"kpy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kvy1", "\[Rule]", 
         RowBox[{"kvy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d1", " ", "L1"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]v\[Psi]", " ", 
           "opy"}]}]}], ",", 
        RowBox[{"kvy2", "\[Rule]", " ", 
         RowBox[{"kvy", "+", 
          RowBox[{
           FractionBox[
            RowBox[{"d2", " ", "L2"}], 
            RowBox[{
             RowBox[{"d1", " ", "L1"}], "-", 
             RowBox[{"d2", " ", "L2"}]}]], "\[Gamma]v\[Psi]", "  ", 
           "opy"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kp\[Psi]1", "\[Rule]", 
         RowBox[{
          FractionBox["d1", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"op\[Psi]", " ", "opy"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["L1", "L2"]}], "+", 
               FractionBox["L2", "L1"]}], ")"}], "kpy"}]}], ")"}]}]}], ",", 
        RowBox[{"kp\[Psi]2", "\[Rule]", 
         RowBox[{
          FractionBox["d2", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"op\[Psi]", " ", "opy"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["L1", "L2"]}], "+", 
               FractionBox["L2", "L1"]}], ")"}], "kpy"}]}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kv\[Psi]1", "\[Rule]", 
         RowBox[{
          FractionBox["d1", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["L1", "L2"]}], "+", 
               FractionBox["L2", "L1"]}], ")"}], "kvy"}]}], ")"}]}]}], ",", 
        RowBox[{"kv\[Psi]2", "\[Rule]", 
         RowBox[{
          FractionBox["d2", 
           RowBox[{"d1", "-", "d2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["L1", "L2"]}], "+", 
               FractionBox["L2", "L1"]}], ")"}], "kvy"}]}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
        RowBox[{"kpr2", "\[Rule]", " ", "kpr"}]}], "\[IndentingNewLine]", 
       "}"}], "/.", 
      RowBox[{"soly1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GainsyOption", "=", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kpy1", "\[Rule]", 
        RowBox[{"kpy", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"d1", " ", "L1"}], 
           RowBox[{
            RowBox[{"d1", " ", "L1"}], "-", 
            RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
       RowBox[{"kpy2", "\[Rule]", " ", 
        RowBox[{"kpy", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"d2", " ", "L2"}], 
           RowBox[{
            RowBox[{"d1", " ", "L1"}], "-", 
            RowBox[{"d2", " ", "L2"}]}]], " ", "opy"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"kvy1", "\[Rule]", 
        RowBox[{"kvy", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"d1", " ", "L1"}], 
           RowBox[{
            RowBox[{"d1", " ", "L1"}], "-", 
            RowBox[{"d2", " ", "L2"}]}]], " ", "\[Gamma]v\[Psi]", " ", 
          "opy"}]}]}], ",", 
       RowBox[{"kvy2", "\[Rule]", " ", 
        RowBox[{"kvy", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"d2", " ", "L2"}], 
           RowBox[{
            RowBox[{"d1", " ", "L1"}], "-", 
            RowBox[{"d2", " ", "L2"}]}]], "\[Gamma]v\[Psi]", "  ", 
          "opy"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"kp\[Psi]1", "\[Rule]", 
        RowBox[{
         FractionBox["d1", 
          RowBox[{"d1", "-", "d2"}]], 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"op\[Psi]", " ", "opy"}], "+", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"L2", "-", "L1"}], 
              RowBox[{"L2", " ", "L1"}]], ")"}], "kpy"}]}], ")"}]}]}], ",", 
       RowBox[{"kp\[Psi]2", "\[Rule]", 
        RowBox[{
         FractionBox["d2", 
          RowBox[{"d1", "-", "d2"}]], 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"op\[Psi]", " ", "opy"}], "+", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"L2", "-", "L1"}], 
              RowBox[{"L2", " ", "L1"}]], ")"}], "kpy"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"kv\[Psi]1", "\[Rule]", 
        RowBox[{
         FractionBox["d1", 
          RowBox[{"d1", "-", "d2"}]], 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"L2", "-", "L1"}], 
              RowBox[{"L2", " ", "L1"}]], ")"}], "kvy"}]}], ")"}]}]}], ",", 
       RowBox[{"kv\[Psi]2", "\[Rule]", 
        RowBox[{
         FractionBox["d2", 
          RowBox[{"d1", "-", "d2"}]], 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ov\[Psi]", " ", "opy"}], "+", 
           RowBox[{
            RowBox[{"(", 
             FractionBox[
              RowBox[{"L2", "-", "L1"}], 
              RowBox[{"L2", " ", "L1"}]], ")"}], "kvy"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
       RowBox[{"kpr2", "\[Rule]", " ", "kpr"}]}], "\[IndentingNewLine]", 
      "}"}], "/.", 
     RowBox[{"soly1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7303954703042517`*^9, 3.730395493535317*^9}, {
   3.730396893453594*^9, 3.73039690833753*^9}, {3.730396944886936*^9, 
   3.730396972385591*^9}, {3.730398131478695*^9, 3.730398145917395*^9}, {
   3.730398816973805*^9, 3.7303988265157747`*^9}, {3.730398864180355*^9, 
   3.7303988703526278`*^9}, {3.7303989106427794`*^9, 3.730398912609614*^9}, {
   3.730399050349135*^9, 3.730399059335147*^9}, 3.730399130667674*^9, {
   3.730399466386017*^9, 3.730399478110161*^9}, {3.7304016771490803`*^9, 
   3.730401759475189*^9}, {3.730402286529702*^9, 3.730402299039784*^9}, {
   3.730406451741857*^9, 3.7304064638351927`*^9}, 3.730406770362207*^9, {
   3.730407306173532*^9, 3.730407329038311*^9}, {3.730416953025029*^9, 
   3.730416964589527*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
check that sub-motions are indeed decoupled (we chose to decouple the linear \
from the angular)\
\>", "Subsubsection",
 CellChangeTimes->{{3.730341120613907*^9, 3.730341128792337*^9}, {
  3.7303893152192087`*^9, 3.730389325264153*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AofInterest", "/.", "GainsyOption"}], "//", "MatrixForm"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7263860725781717`*^9, 3.726386095073221*^9}, {
   3.7263866180269814`*^9, 3.726386650434248*^9}, {3.7263952756641397`*^9, 
   3.7263952806086683`*^9}, {3.7263958084530993`*^9, 
   3.7263958237669163`*^9}, {3.7263975813599873`*^9, 3.7263975859326363`*^9}, 
   3.730396984340487*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kpy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kvy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "d2", " ", "J", " ", "L1", " ", "L2", 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "gravity"}], "+", 
              RowBox[{"kpy", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "J", " ", 
            SuperscriptBox["L2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpy", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
           
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpy", " ", 
               SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m", " ", 
                  "m2"}], "+", 
                 RowBox[{"J", " ", 
                  SuperscriptBox["L1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "J", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity"}], "+", 
           RowBox[{"kpr", " ", "kvy", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "J", " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr", " ", "kvy", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr", " ", "kvy", " ", 
            SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m", " ", 
               "m2"}], "+", 
              RowBox[{"J", " ", 
               SuperscriptBox["L1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{"d2", " ", "J", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "gravity"}], " ", "m"}], "+", 
              RowBox[{"kpy", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1"}]}], 
             ")"}], " ", "m2"}], "-", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpy", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "L1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}],
              ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{"d2", " ", "J", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "gravity"}], " ", "m"}], "+", 
              RowBox[{"kpr", " ", "kvy", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1"}]}], 
             ")"}], " ", "m2"}], "-", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpr", " ", "kvy", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "L1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}],
              ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", "L1", " ", "L2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", "L1", " ", "L2"}]]}], "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", "kpy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", "kvy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      FractionBox[
       RowBox[{"kpr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", 
           SuperscriptBox["L1", "2"], " ", "m", " ", "m1", " ", "m2"}], "+", 
          RowBox[{"d1", " ", "d2", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"J", " ", "kpy", " ", "L1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["d2", "2"], " ", "gravity", " ", "L2", " ", 
              "m"}]}], ")"}], " ", "m1", " ", "m2"}], "-", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", "J", " ", 
           SuperscriptBox["L2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "+", 
             RowBox[{"kpy", " ", "L1", " ", "m1"}]}], ")"}], " ", "m2"}], "-", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"J", " ", "kpy", " ", 
              SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", 
                 SuperscriptBox["L1", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["L1", "2"], "+", 
                   SuperscriptBox["L2", "2"]}], ")"}], " ", "m2"}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", 
         SuperscriptBox["L1", "2"], " ", "m", " ", "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr", " ", "kvy", " ", "L1", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", "L2", " ", 
            "m"}]}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "J", " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{"kpr", " ", "kvy", " ", "L1", " ", "m1"}]}], ")"}], " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr", " ", "kvy", " ", 
            SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               SuperscriptBox["L1", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["L1", "2"], "+", 
                 SuperscriptBox["L2", "2"]}], ")"}], " ", "m2"}]}], ")"}]}]}],
           ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.72639788758722*^9, 3.726397911482459*^9}, 
   3.7263979922836227`*^9, 3.726398254595065*^9, 3.726398807020031*^9, 
   3.726399032804331*^9, 3.7303969863000593`*^9, 3.730398150152719*^9, 
   3.730398874902169*^9, 3.730398942071978*^9, 3.730399068364504*^9, 
   3.730399134580076*^9, 3.7303994969558907`*^9, 3.730401765255046*^9, 
   3.730402309466872*^9, 3.730402569945202*^9, 3.730406470847398*^9, 
   3.730406774562223*^9, 3.730407333308958*^9, 3.73041001562969*^9, 
   3.730410734897428*^9, 3.7304168654630117`*^9, 3.730416971613542*^9, 
   3.733255306338323*^9, 3.7332560854339933`*^9, 3.7332587389057693`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["linear motion", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.7263281711595583`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"15", ";;", "24"}], ",", 
         RowBox[{"15", ";;", "24"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "5"}], ",", 
        RowBox[{"1", ";;", "5"}]}], "]"}], "]"}], "/.", "GainsyOption"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328285687058*^9, 3.726328294429411*^9}, {
   3.726387791860672*^9, 3.726387794285327*^9}, {3.726395879705676*^9, 
   3.72639590510732*^9}, {3.7263966718165417`*^9, 3.7263967062431917`*^9}, {
   3.7263982857912607`*^9, 3.726398294071878*^9}, {3.726675355334217*^9, 
   3.7266753834449987`*^9}, {3.730406782977223*^9, 3.730406783212162*^9}, 
   3.730410740372121*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kpy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", "kvy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "d2", " ", "J", " ", "L1", " ", "L2", 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "gravity"}], "+", 
              RowBox[{"kpy", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "J", " ", 
            SuperscriptBox["L2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpy", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
           
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpy", " ", 
               SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m", " ", 
                  "m2"}], "+", 
                 RowBox[{"J", " ", 
                  SuperscriptBox["L1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "J", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity"}], "+", 
           RowBox[{"kpr", " ", "kvy", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "J", " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr", " ", "kvy", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr", " ", "kvy", " ", 
            SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m", " ", 
               "m2"}], "+", 
              RowBox[{"J", " ", 
               SuperscriptBox["L1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7263982964956303`*^9, 3.726399037713871*^9, 3.7263996133462276`*^9, {
   3.726675375866609*^9, 3.7266753848705463`*^9}, 3.730406783886923*^9, {
   3.730406877540412*^9, 3.730406888855131*^9}, 3.730406972895012*^9, 
   3.7304073446186323`*^9, 3.730410025822069*^9, 3.730410741428072*^9, 
   3.730416865797982*^9, 3.730416923132584*^9, 3.730416971896964*^9, 
   3.7332553066694727`*^9, 3.733256085725816*^9, 3.7332587392010593`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalGamma]5", "[", 
     RowBox[{"q_", ",", 
      RowBox[{"{", 
       RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fd", " ", "fp", " ", "kp"}], " ", ",", 
       RowBox[{"fp", " ", "fd", " ", "kd"}], ",", 
       RowBox[{"fd", 
        RowBox[{"(", 
         RowBox[{"kp", "+", " ", 
          RowBox[{"fp", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], " ", ",", 
       RowBox[{
        RowBox[{"fd", " ", "kd"}], "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "fd"}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solyCoeff", "=", 
    RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
     RowBox[{"Solve", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AofInterest", "[", 
            RowBox[{"[", 
             RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
           "#"}], ")"}], "&"}], "[", 
        RowBox[{"\[CapitalGamma]5", "[", 
         RowBox[{"qy", ",", 
          RowBox[{"{", 
           RowBox[{"fpy", ",", "kpr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"qy", ",", "fpy"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.726327823401803*^9, 3.726327890786975*^9}, {
   3.726328004724906*^9, 3.726328121322792*^9}, {3.726328216063356*^9, 
   3.726328241473325*^9}, {3.7263283332636557`*^9, 3.726328342768092*^9}, {
   3.7263983136480417`*^9, 3.726398325943903*^9}, {3.7263983627848682`*^9, 
   3.726398374248576*^9}, 3.726675401338707*^9, {3.730406790528446*^9, 
   3.730406822705977*^9}, {3.730406869582822*^9, 3.730406885823876*^9}, 
   3.730416911441413*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"qy", "\[Rule]", 
     FractionBox[
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d2", "2"], " ", "J", " ", 
          SuperscriptBox["L2", "2"], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"J", " ", 
             SuperscriptBox["L1", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m2"}]}], 
           ")"}]}]}], ")"}]}], 
      RowBox[{"J", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], "2"], " ", "m1", " ", "m2"}]]}],
     ",", 
    RowBox[{"fpy", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"d1", " ", "gravity", " ", "L1"}], "-", 
       RowBox[{"d2", " ", "gravity", " ", "L2"}]}], 
      RowBox[{
       RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
       RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.726328069282946*^9, 3.726328121765195*^9}, 
   3.7263282419462223`*^9, 3.7263283432806273`*^9, 3.7263839606007843`*^9, {
   3.726398355186508*^9, 3.726398374778612*^9}, 3.726399047644322*^9, {
   3.726399611031694*^9, 3.726399614326625*^9}, 3.726675408138592*^9, {
   3.730406814031336*^9, 3.7304068233523493`*^9}, {3.730406878635301*^9, 
   3.7304068902646008`*^9}, 3.7304073694349546`*^9, 3.7304100276358557`*^9, 
   3.7304107436075277`*^9, 3.730416866152999*^9, 3.7304169234000883`*^9, 
   3.730416972072133*^9, 3.733255306885748*^9, 3.7332560859424973`*^9, 
   3.733258739431316*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["check relation", "Subsubsection",
 CellChangeTimes->{{3.730415000506562*^9, 3.73041500445261*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"qy", "/.", 
     RowBox[{"solyCoeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          SuperscriptBox["L2", "2"], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", 
          SuperscriptBox["L1", "2"], " ", "m1"}]}], ")"}]}], 
      RowBox[{" ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], "2"], " ", "m1", " ", 
        "m2"}]}]], "+", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "d1"}], " ", "d2", " ", "m"}], "J"], 
      FractionBox[
       RowBox[{" ", 
        RowBox[{
         RowBox[{"-", " ", "d1"}], " ", "d2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"L1", "-", "L2"}], ")"}], "2"], " "}]}], 
       RowBox[{" ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], "2"], " "}]]}]}], ")"}]}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.730415011621931*^9, 3.730415013329846*^9}, 
   3.7304151512537203`*^9, 3.7304169096528063`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.730416866242848*^9, 3.730416923493553*^9, 
  3.730416972145499*^9, 3.733255306907922*^9, 3.733255372849248*^9, 
  3.733256085961524*^9, 3.733258739467115*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["angular motion:", "Subsection",
 CellChangeTimes->{{3.726328167415011*^9, 3.72632817761716*^9}, {
  3.726399877586267*^9, 3.726399885859461*^9}, {3.72667572999227*^9, 
  3.7266757302042933`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"GainsyOption", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kv\[Psi]", "\[Rule]", " ", "0"}], ",", 
       RowBox[{"kp\[Psi]", "\[Rule]", " ", "0"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "*)"}]], "Input",
 CellChangeTimes->{{3.726675616496696*^9, 3.726675621275268*^9}, 
   3.726675687688706*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Asimilar", "1"], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"15", ";;", "24"}], ",", 
         RowBox[{"15", ";;", "24"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"6", ";;", "10"}], ",", 
        RowBox[{"6", ";;", "10"}]}], "]"}], "]"}], "/.", "GainsyOption"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AofInterest", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.726328218588498*^9, 3.7263282299041348`*^9}, {
   3.72632832070956*^9, 3.726328365616743*^9}, {3.7263984076530724`*^9, 
   3.726398416140726*^9}, {3.726398595254108*^9, 3.726398605669335*^9}, {
   3.726399069095168*^9, 3.726399069240147*^9}, {3.726675422398278*^9, 
   3.726675429424037*^9}, {3.726675542502304*^9, 3.726675558270903*^9}, {
   3.730406826933138*^9, 3.730406832858473*^9}, 3.730410748110715*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", "kpy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", "kvy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      FractionBox[
       RowBox[{"kpr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", 
           SuperscriptBox["L1", "2"], " ", "m", " ", "m1", " ", "m2"}], "+", 
          RowBox[{"d1", " ", "d2", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"J", " ", "kpy", " ", "L1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["d2", "2"], " ", "gravity", " ", "L2", " ", 
              "m"}]}], ")"}], " ", "m1", " ", "m2"}], "-", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", "J", " ", 
           SuperscriptBox["L2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "+", 
             RowBox[{"kpy", " ", "L1", " ", "m1"}]}], ")"}], " ", "m2"}], "-", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"J", " ", "kpy", " ", 
              SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", 
                 SuperscriptBox["L1", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["L1", "2"], "+", 
                   SuperscriptBox["L2", "2"]}], ")"}], " ", "m2"}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", 
         SuperscriptBox["L1", "2"], " ", "m", " ", "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr", " ", "kvy", " ", "L1", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", "L2", " ", 
            "m"}]}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "J", " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{"kpr", " ", "kvy", " ", "L1", " ", "m1"}]}], ")"}], " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr", " ", "kvy", " ", 
            SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               SuperscriptBox["L1", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["L1", "2"], "+", 
                 SuperscriptBox["L2", "2"]}], ")"}], " ", "m2"}]}], ")"}]}]}],
           ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.726328018050046*^9, {3.7263282303076677`*^9, 3.7263282435610323`*^9}, 
   3.726328328183877*^9, 3.726328366724547*^9, 3.726383960637189*^9, 
   3.726398416748801*^9, 3.726399069648797*^9, {3.726399598606152*^9, 
   3.726399616710496*^9}, 3.7263996685702763`*^9, 3.726675430643284*^9, 
   3.726675559292756*^9, 3.7266756905818787`*^9, {3.730406827953257*^9, 
   3.7304068338792963`*^9}, {3.7304069651122913`*^9, 3.730406974752861*^9}, 
   3.730407371702351*^9, 3.730410029704267*^9, 3.7304107487222652`*^9, {
   3.730416870908833*^9, 3.7304168775069523`*^9}, 3.73041692380483*^9, 
   3.7304169723669233`*^9, 3.733255307179644*^9, 3.7332560862351513`*^9, 
   3.733258739712529*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalGamma]5", "[", 
     RowBox[{"q_", ",", 
      RowBox[{"{", 
       RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fd", " ", "fp", " ", "kp"}], " ", ",", 
       RowBox[{"fp", " ", "fd", " ", "kd"}], ",", 
       RowBox[{"fd", 
        RowBox[{"(", 
         RowBox[{"kp", "+", " ", 
          RowBox[{"fp", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "q"}], ")"}]}]}], ")"}]}], " ", ",", 
       RowBox[{
        RowBox[{"fd", " ", "kd"}], "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]}], ",", "fd"}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"sol\[Psi]Coeff", "=", 
    RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
     RowBox[{"Solve", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AofInterest", "[", 
            RowBox[{"[", 
             RowBox[{"Length", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
           "#"}], ")"}], "&"}], "[", 
        RowBox[{"\[CapitalGamma]5", "[", 
         RowBox[{"q\[Psi]", ",", 
          RowBox[{"{", 
           RowBox[{"fp\[Psi]", ",", "kpr"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"q\[Psi]", ",", "fp\[Psi]"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.726675496432407*^9, 3.726675506716784*^9}, {
  3.73040684679395*^9, 3.7304068643486013`*^9}, {3.730406894786519*^9, 
  3.730406906347966*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q\[Psi]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "J", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            SuperscriptBox["L1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m2"}]}], 
          ")"}]}]}], 
       RowBox[{"d1", " ", "d2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], "2"], " ", "m1", " ", 
        "m2"}]]}]}], ",", 
    RowBox[{"fp\[Psi]", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d1"}], " ", "L1"}], "+", 
         RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", 
       "L2"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.726675509698525*^9, 3.726675571480031*^9, {3.730406902437735*^9, 
   3.7304069068631687`*^9}, 3.730407373632654*^9, 3.730410032221393*^9, 
   3.7304107507086163`*^9, {3.7304168711851263`*^9, 3.730416879477566*^9}, 
   3.7304169240669317`*^9, 3.73041697258885*^9, 3.733255307332387*^9, 
   3.733256086387496*^9, 3.7332587398750153`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["check relation between coefficients ", "Subsubsection",
 CellChangeTimes->{{3.730409465105871*^9, 3.730409482453245*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"fp\[Psi]", "/.", 
     RowBox[{"sol\[Psi]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "d1"}], " ", "d2", " ", "m"}], "J"], " ", "fpy"}], "/.", 
     
     RowBox[{"solyCoeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"q\[Psi]", "/.", 
     RowBox[{"sol\[Psi]Coeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["J", 
       RowBox[{
        RowBox[{"-", "d1"}], " ", "d2", " ", "m"}]], " ", "qy"}], "/.", 
     RowBox[{"solyCoeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", "Simplify"}]}], "Input",\

 CellChangeTimes->{{3.7304069473625*^9, 3.730406961242722*^9}, {
  3.7304073816937237`*^9, 3.730407407950686*^9}, {3.730410037553583*^9, 
  3.730410056781987*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.730406952797121*^9, 3.730406961771928*^9}, {
   3.7304073765741863`*^9, 3.730407408478249*^9}, {3.730410035089562*^9, 
   3.7304100572898273`*^9}, 3.730410753098858*^9, {3.730416871337626*^9, 
   3.7304168816142673`*^9}, 3.730416924211364*^9, 3.730416972695487*^9, 
   3.733255307350402*^9, 3.733255378217053*^9, 3.733256086405797*^9, {
   3.733258739949913*^9, 3.733258751082346*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.730406952797121*^9, 3.730406961771928*^9}, {
   3.7304073765741863`*^9, 3.730407408478249*^9}, {3.730410035089562*^9, 
   3.7304100572898273`*^9}, 3.730410753098858*^9, {3.730416871337626*^9, 
   3.7304168816142673`*^9}, 3.730416924211364*^9, 3.730416972695487*^9, 
   3.733255307350402*^9, 3.733255378217053*^9, 3.733256086405797*^9, {
   3.733258739949913*^9, 3.7332587510842953`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]]
},
WindowSize->{1313, 744},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 195, 3, 93, "Title"],
Cell[777, 27, 223, 4, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1037, 36, 112, 1, 93, "Title"],
Cell[1152, 39, 126, 1, 33, "Text"],
Cell[1281, 42, 9256, 223, 1099, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[10574, 270, 119, 1, 67, "Title"],
Cell[CellGroupData[{
Cell[10718, 275, 169, 2, 81, "Chapter"],
Cell[CellGroupData[{
Cell[10912, 281, 1395, 42, 144, "Input"],
Cell[12310, 325, 2637, 49, 70, "Output"],
Cell[14950, 376, 2700, 51, 70, "Output"],
Cell[17653, 429, 2777, 53, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20479, 488, 105, 1, 81, "Chapter"],
Cell[20587, 491, 645, 14, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21269, 510, 296, 6, 81, "Chapter"],
Cell[CellGroupData[{
Cell[21590, 520, 652, 18, 92, "Input"],
Cell[22245, 540, 2521, 50, 70, "Output"],
Cell[24769, 592, 2558, 52, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27376, 650, 339, 6, 81, "Chapter"],
Cell[CellGroupData[{
Cell[27740, 660, 1724, 39, 92, "Input"],
Cell[29467, 701, 2981, 63, 70, "Output"],
Cell[32451, 766, 3134, 70, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35634, 842, 365, 7, 81, "Chapter"],
Cell[CellGroupData[{
Cell[36024, 853, 1483, 32, 92, "Input"],
Cell[37510, 887, 2670, 54, 70, "Output"],
Cell[40183, 943, 2661, 55, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42893, 1004, 420, 7, 81, "Chapter"],
Cell[CellGroupData[{
Cell[43338, 1015, 1636, 35, 92, "Input"],
Cell[44977, 1052, 2803, 58, 70, "Output"],
Cell[47783, 1112, 2920, 63, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[50764, 1182, 95, 1, 67, "Title"],
Cell[50862, 1185, 182, 2, 81, "Chapter"],
Cell[CellGroupData[{
Cell[51069, 1191, 127, 1, 66, "Chapter"],
Cell[51199, 1194, 2910, 68, 82785, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[54158, 1268, 188, 3, 67, "Title"],
Cell[54349, 1273, 1576, 46, 118, "Input"],
Cell[CellGroupData[{
Cell[55950, 1323, 148, 2, 43, "Subsubsection"],
Cell[56101, 1327, 4479, 129, 300, "Input"],
Cell[CellGroupData[{
Cell[60605, 1460, 588, 17, 39, "Input"],
Cell[61196, 1479, 1869, 42, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[63126, 1528, 176, 2, 67, "Title"],
Cell[CellGroupData[{
Cell[63327, 1534, 188, 2, 66, "Chapter"],
Cell[63518, 1538, 2486, 77, 560, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[66041, 1620, 156, 2, 55, "Chapter"],
Cell[66200, 1624, 3832, 97, 318, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[70069, 1726, 98, 1, 55, "Chapter"],
Cell[70170, 1729, 7276, 183, 430, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[77483, 1917, 314, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[77822, 1925, 6166, 142, 378, "Input"],
Cell[83991, 2069, 2925, 43, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[86965, 2118, 320, 4, 55, "Chapter"],
Cell[87288, 2124, 19155, 445, 1581, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[106480, 2574, 181, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[106686, 2580, 2222, 49, 144, "Input"],
Cell[108911, 2631, 3869, 56, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[112829, 2693, 226, 3, 55, "Chapter"],
Cell[113058, 2698, 2844, 75, 165, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[115939, 2778, 232, 3, 55, "Chapter"],
Cell[116174, 2783, 3704, 88, 358, "Input"],
Cell[CellGroupData[{
Cell[119903, 2875, 774, 20, 66, "Input"],
Cell[120680, 2897, 1804, 28, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[122533, 2931, 157, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[122715, 2937, 2499, 60, 118, "Input"],
Cell[125217, 2999, 2199, 33, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[127465, 3038, 157, 5, 55, "Chapter"],
Cell[CellGroupData[{
Cell[127647, 3047, 627, 18, 55, "Subsection"],
Cell[128277, 3067, 1705, 47, 253, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[130031, 3120, 115, 1, 55, "Chapter"],
Cell[130149, 3123, 1379, 40, 66, "Input"],
Cell[CellGroupData[{
Cell[131553, 3167, 358, 11, 54, "Subsection"],
Cell[131914, 3180, 3309, 69, 131, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135260, 3254, 209, 3, 54, "Subsection"],
Cell[CellGroupData[{
Cell[135494, 3261, 2143, 56, 118, "Input"],
Cell[137640, 3319, 2355, 35, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[140056, 3361, 184, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[140265, 3367, 265, 4, 54, "Subsection"],
Cell[140533, 3373, 1799, 47, 118, "Input"],
Cell[CellGroupData[{
Cell[142357, 3424, 484, 16, 66, "Input"],
Cell[142844, 3442, 1738, 30, 70, "Output"],
Cell[144585, 3474, 1739, 30, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146373, 3510, 140, 1, 54, "Subsection"],
Cell[146516, 3513, 2036, 56, 118, "Input"],
Cell[CellGroupData[{
Cell[148577, 3573, 484, 16, 66, "Input"],
Cell[149064, 3591, 879, 20, 70, "Output"],
Cell[149946, 3613, 879, 20, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[150886, 3640, 141, 1, 55, "Chapter"],
Cell[151030, 3643, 1691, 49, 274, "Input"],
Cell[CellGroupData[{
Cell[152746, 3696, 119, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[152890, 3701, 1157, 37, 86, "Input"],
Cell[154050, 3740, 1930, 52, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[156029, 3798, 129, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[156183, 3803, 4622, 126, 300, "Input"],
Cell[160808, 3931, 819, 16, 70, "Output"],
Cell[161630, 3949, 718, 12, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[162409, 3968, 109, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[162543, 3973, 100, 1, 79, "Subchapter"],
Cell[162646, 3976, 1266, 38, 86, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163949, 4019, 173, 2, 79, "Subchapter"],
Cell[CellGroupData[{
Cell[164147, 4025, 3676, 107, 270, "Input"],
Cell[167826, 4134, 931, 14, 70, "Output"],
Cell[168760, 4150, 930, 14, 70, "Output"],
Cell[169693, 4166, 931, 14, 70, "Output"],
Cell[170627, 4182, 931, 14, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171607, 4202, 120, 1, 79, "Subchapter"],
Cell[171730, 4205, 862, 26, 118, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172629, 4236, 190, 2, 79, "Subchapter"],
Cell[172822, 4240, 5371, 140, 396, "Input"],
Cell[CellGroupData[{
Cell[178218, 4384, 117, 1, 43, "Subsubsection"],
Cell[178338, 4387, 6819, 123, 222, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[185206, 4516, 116, 1, 79, "Subchapter"],
Cell[185325, 4519, 484, 14, 66, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185846, 4538, 564, 13, 157, "Subchapter"],
Cell[CellGroupData[{
Cell[186435, 4555, 3228, 87, 201, "Input"],
Cell[189666, 4644, 710, 11, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190425, 4661, 182, 2, 79, "Subchapter"],
Cell[CellGroupData[{
Cell[190632, 4667, 107, 1, 54, "Subsection"],
Cell[190742, 4670, 383, 10, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191162, 4685, 100, 1, 54, "Subsection"],
Cell[191265, 4688, 5514, 141, 396, "Input"],
Cell[CellGroupData[{
Cell[196804, 4833, 117, 1, 43, "Subsubsection"],
Cell[196924, 4836, 7486, 138, 300, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[204471, 4981, 290, 7, 207, "Subchapter"],
Cell[CellGroupData[{
Cell[204786, 4992, 166, 3, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[204977, 4999, 757, 22, 39, "Input"],
Cell[205737, 5023, 752, 12, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[206538, 5041, 294, 5, 73, "Subsubsection"],
Cell[CellGroupData[{
Cell[206857, 5050, 1828, 51, 124, "Input"],
Cell[208688, 5103, 1674, 30, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210399, 5138, 1780, 50, 124, "Input"],
Cell[212182, 5190, 1443, 27, 70, "Output"]
}, Open  ]],
Cell[213640, 5220, 71, 1, 39, "Input"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[213772, 5228, 172, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[213969, 5236, 763, 18, 39, "Input"],
Cell[214735, 5256, 1655, 25, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[216439, 5287, 131, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[216595, 5292, 2821, 72, 274, "Input"],
Cell[219419, 5366, 1544, 23, 70, "Output"]
}, Open  ]],
Cell[220978, 5392, 7903, 190, 924, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[228918, 5587, 109, 1, 55, "Chapter"],
Cell[229030, 5590, 398, 10, 39, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[229465, 5605, 117, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[229607, 5610, 2292, 62, 144, "Input"],
Cell[231902, 5674, 1560, 24, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[233523, 5705, 235, 3, 67, "Title"],
Cell[CellGroupData[{
Cell[233783, 5712, 122, 1, 43, "Subsubsection"],
Cell[233908, 5715, 344, 9, 42, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234289, 5729, 99, 1, 81, "Chapter"],
Cell[234391, 5732, 2871, 72, 222, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[237299, 5809, 239, 3, 66, "Chapter"],
Cell[237541, 5814, 1552, 28, 66, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[239130, 5847, 135, 1, 66, "Chapter"],
Cell[239268, 5850, 2934, 78, 118, "Input"],
Cell[CellGroupData[{
Cell[242227, 5932, 1420, 40, 65, "Input"],
Cell[243650, 5974, 794, 11, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[244493, 5991, 105, 1, 66, "Chapter"],
Cell[244601, 5994, 1232, 34, 234, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[245870, 6033, 102, 1, 66, "Chapter"],
Cell[245975, 6036, 429, 13, 66, "Input"],
Cell[CellGroupData[{
Cell[246429, 6053, 1056, 25, 92, "Input"],
Cell[247488, 6080, 1940, 42, 70, "Output"],
Cell[249431, 6124, 1940, 42, 70, "Output"]
}, Open  ]],
Cell[251386, 6169, 5928, 115, 705, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[257351, 6289, 116, 1, 66, "Chapter"],
Cell[CellGroupData[{
Cell[257492, 6294, 981, 32, 126, "Input"],
Cell[258476, 6328, 212, 3, 70, "Output"],
Cell[258691, 6333, 214, 3, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[258954, 6342, 251, 6, 121, "Chapter"],
Cell[259208, 6350, 2176, 57, 147, "Input"],
Cell[CellGroupData[{
Cell[261409, 6411, 1476, 37, 144, "Input"],
Cell[262888, 6450, 12313, 312, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[275250, 6768, 150, 4, 121, "Chapter"],
Cell[CellGroupData[{
Cell[275425, 6776, 397, 12, 66, "Input"],
Cell[275825, 6790, 12244, 311, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[288118, 7107, 168, 2, 66, "Chapter"],
Cell[CellGroupData[{
Cell[288311, 7113, 486, 12, 39, "Input"],
Cell[288800, 7127, 2104, 54, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290941, 7186, 112, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[291078, 7191, 601, 17, 66, "Input"],
Cell[291682, 7210, 1306, 34, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293025, 7249, 1369, 39, 196, "Input"],
Cell[294397, 7290, 748, 16, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[295194, 7312, 113, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[295332, 7317, 575, 17, 66, "Input"],
Cell[295910, 7336, 1453, 38, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297400, 7379, 1373, 39, 196, "Input"],
Cell[298776, 7420, 800, 18, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[299637, 7445, 129, 2, 66, "Chapter"],
Cell[CellGroupData[{
Cell[299791, 7451, 103, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[299919, 7456, 439, 12, 66, "Input"],
Cell[300361, 7470, 1559, 40, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301957, 7515, 1362, 39, 196, "Input"],
Cell[303322, 7556, 831, 19, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[304202, 7581, 101, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[304328, 7586, 385, 11, 66, "Input"],
Cell[304716, 7599, 1156, 29, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305909, 7633, 1608, 44, 196, "Input"],
Cell[307520, 7679, 763, 16, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[308344, 7702, 174, 3, 66, "Chapter"],
Cell[CellGroupData[{
Cell[308543, 7709, 103, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[308671, 7714, 490, 13, 66, "Input"],
Cell[309164, 7729, 1591, 41, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310792, 7775, 1410, 39, 196, "Input"],
Cell[312205, 7816, 858, 19, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[313112, 7841, 101, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[313238, 7846, 488, 13, 66, "Input"],
Cell[313729, 7861, 1913, 48, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315679, 7914, 1522, 42, 196, "Input"],
Cell[317204, 7958, 1046, 24, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[318323, 7990, 288, 4, 67, "Title"],
Cell[CellGroupData[{
Cell[318636, 7998, 122, 1, 35, "Subsubsection"],
Cell[318761, 8001, 292, 8, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319090, 8014, 99, 1, 66, "Chapter"],
Cell[319192, 8017, 2951, 73, 6272, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[322180, 8095, 239, 3, 55, "Chapter"],
Cell[322422, 8100, 1552, 28, 1820, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[324011, 8133, 135, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[324171, 8138, 3545, 100, 195, "Input"],
Cell[327719, 8240, 771, 11, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[328539, 8257, 109, 1, 55, "Chapter"],
Cell[328651, 8260, 1055, 31, 292, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[329743, 8296, 102, 1, 55, "Chapter"],
Cell[329848, 8299, 499, 15, 82, "Input"],
Cell[CellGroupData[{
Cell[330372, 8318, 181, 4, 53, "Subsubsection"],
Cell[CellGroupData[{
Cell[330578, 8326, 1812, 46, 168, "Input"],
Cell[332393, 8374, 6164, 173, 70, "Output"]
}, Open  ]],
Cell[338572, 8550, 6478, 134, 1028, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[345099, 8690, 116, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[345240, 8695, 2100, 72, 3546, "Input"],
Cell[347343, 8769, 365, 5, 70, "Output"],
Cell[347711, 8776, 362, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348110, 8786, 104, 1, 1483, "Subsection"],
Cell[CellGroupData[{
Cell[348239, 8791, 417, 13, 1820, "Input"],
Cell[348659, 8806, 287, 7, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[349007, 8820, 150, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[349182, 8828, 859, 24, 3212, "Input"],
Cell[350044, 8854, 50434, 1362, 70, "Output"]
}, Open  ]],
Cell[400493, 10219, 863, 24, 2118, "Input"],
Cell[401359, 10245, 193, 5, 1072, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[401589, 10255, 230, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[401844, 10262, 1183, 29, 57, "Input"],
Cell[403030, 10293, 4812, 133, 70, "Output"],
Cell[407845, 10428, 1840, 46, 70, "Output"]
}, Open  ]],
Cell[409700, 10477, 70, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[409795, 10482, 162, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[409982, 10489, 879, 25, 34, "Input"],
Cell[410864, 10516, 4105, 117, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[415030, 10640, 207, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[415262, 10647, 731, 19, 78, "Input"],
Cell[415996, 10668, 21460, 575, 70, "Output"],
Cell[437459, 11245, 1891, 52, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[439399, 11303, 174, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[439598, 11310, 420, 12, 56, "Input"],
Cell[440021, 11324, 4278, 118, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444336, 11447, 103, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[444464, 11452, 467, 12, 56, "Input"],
Cell[444934, 11466, 2137, 58, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447108, 11529, 1808, 47, 168, "Input"],
Cell[448919, 11578, 975, 21, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[449943, 11605, 183, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[450151, 11611, 469, 12, 56, "Input"],
Cell[450623, 11625, 3271, 87, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[453931, 11717, 2905, 69, 190, "Input"],
Cell[456839, 11788, 1863, 45, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[458739, 11838, 135, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[458899, 11843, 2266, 62, 210, "Input"],
Cell[461168, 11907, 1023, 15, 70, "Output"],
Cell[462194, 11924, 1022, 15, 70, "Output"],
Cell[463219, 11941, 1022, 15, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[464290, 11962, 173, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[464488, 11968, 1141, 35, 99, "Input"],
Cell[465632, 12005, 369, 6, 70, "Output"],
Cell[466004, 12013, 369, 6, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[466446, 12027, 192, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[466663, 12033, 1780, 40, 78, "Input"],
Cell[468446, 12075, 1923, 48, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[470430, 12130, 358, 5, 67, "Title"],
Cell[CellGroupData[{
Cell[470813, 12139, 122, 1, 35, "Subsubsection"],
Cell[470938, 12142, 416, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[471391, 12157, 99, 1, 66, "Chapter"],
Cell[471493, 12160, 2951, 73, 5018, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[474481, 12238, 239, 3, 55, "Chapter"],
Cell[474723, 12243, 1552, 28, 1456, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[476312, 12276, 135, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[476472, 12281, 1450, 43, 1356, "Input"],
Cell[477925, 12326, 363, 6, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[478337, 12338, 105, 1, 55, "Chapter"],
Cell[478445, 12341, 1279, 34, 5297, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[479761, 12380, 102, 1, 55, "Chapter"],
Cell[479866, 12383, 429, 13, 1456, "Input"],
Cell[CellGroupData[{
Cell[480320, 12400, 1078, 23, 1456, "Input"],
Cell[481401, 12425, 1607, 37, 70, "Output"]
}, Open  ]],
Cell[483023, 12465, 5887, 116, 17172, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[488947, 12586, 116, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[489088, 12591, 1098, 35, 2837, "Input"],
Cell[490189, 12628, 218, 3, 70, "Output"],
Cell[490410, 12633, 216, 3, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[490675, 12642, 150, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[490850, 12650, 456, 13, 246, "Input"],
Cell[491309, 12665, 17786, 458, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[509122, 13127, 161, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[509308, 13134, 136, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[509469, 13139, 2272, 66, 115, "Input"],
Cell[511744, 13207, 730, 15, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[512523, 13228, 177, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[512725, 13234, 190, 4, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[512940, 13242, 755, 23, 34, "Input"],
Cell[513698, 13267, 5418, 146, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[519177, 13420, 156, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[519358, 13426, 2619, 73, 189, "Input"],
Cell[521980, 13501, 1169, 29, 70, "Output"],
Cell[523152, 13532, 463, 7, 70, "Output"],
Cell[523618, 13541, 1441, 38, 70, "Output"],
Cell[525062, 13581, 1292, 35, 70, "Output"],
Cell[526357, 13618, 1999, 56, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[528393, 13679, 262, 5, 60, "Subsubsection"],
Cell[CellGroupData[{
Cell[528680, 13688, 1712, 46, 216, "Input"],
Cell[530395, 13736, 2112, 62, 70, "Output"],
Cell[532510, 13800, 898, 26, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[533457, 13832, 124, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[533606, 13837, 432, 12, 34, "Input"],
Cell[534041, 13851, 3074, 84, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[537164, 13941, 203, 3, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[537392, 13948, 2449, 75, 101, "Input"],
Cell[539844, 14025, 359, 6, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[540230, 14035, 153, 2, 35, "Subsubsection"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[540432, 14043, 153, 2, 67, "Title"],
Cell[CellGroupData[{
Cell[540610, 14049, 114, 1, 66, "Chapter"],
Cell[540727, 14052, 929, 25, 3251, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[541693, 14082, 129, 1, 55, "Chapter"],
Cell[541825, 14085, 2145, 40, 3251, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[544007, 14130, 98, 1, 55, "Chapter"],
Cell[544108, 14133, 3666, 69, 7371, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[547811, 14207, 287, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[548123, 14214, 3892, 83, 5603, "Input"],
Cell[552018, 14299, 2120, 33, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[554187, 14338, 243, 3, 55, "Chapter"],
Cell[554433, 14343, 5817, 103, 5628, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[560287, 14451, 181, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[560493, 14457, 2659, 60, 28882, "Input"],
Cell[563155, 14519, 3092, 45, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[566296, 14570, 226, 3, 55, "Chapter"],
Cell[566525, 14575, 3099, 80, 522, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[569661, 14660, 232, 3, 55, "Chapter"],
Cell[569896, 14665, 1865, 37, 1035, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[571798, 14707, 157, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[571980, 14713, 1823, 43, 2056, "Input"],
Cell[573806, 14758, 1264, 20, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[575119, 14784, 109, 1, 55, "Chapter"],
Cell[575231, 14787, 544, 14, 858, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[575812, 14806, 117, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[575954, 14811, 2391, 64, 281, "Input"],
Cell[578348, 14877, 1339, 21, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[579748, 14905, 211, 3, 67, "Title"],
Cell[CellGroupData[{
Cell[579984, 14912, 140, 1, 66, "Chapter"],
Cell[580127, 14915, 858, 23, 1085, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[581022, 14943, 129, 1, 55, "Chapter"],
Cell[581154, 14946, 1912, 30, 843, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[583103, 14981, 98, 1, 55, "Chapter"],
Cell[583204, 14984, 2928, 47, 1332, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[586169, 15036, 265, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[586459, 15043, 2802, 63, 2056, "Input"],
Cell[589264, 15108, 804, 14, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[590117, 15128, 243, 3, 55, "Chapter"],
Cell[590363, 15133, 641, 19, 597, "Input"],
Cell[591007, 15154, 5642, 98, 1332, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[596686, 15257, 181, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[596892, 15263, 3760, 86, 477, "Input"],
Cell[600655, 15351, 3268, 48, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[603972, 15405, 226, 3, 55, "Chapter"],
Cell[604201, 15410, 1985, 44, 1018, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[606223, 15459, 232, 3, 55, "Chapter"],
Cell[606458, 15464, 1913, 33, 353, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[608408, 15502, 157, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[608590, 15508, 144, 1, 102, "Subsubsection"],
Cell[CellGroupData[{
Cell[608759, 15513, 2955, 83, 413, "Input"],
Cell[611717, 15598, 812, 13, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[612590, 15618, 209, 4, 55, "Chapter"],
Cell[612802, 15624, 2496, 59, 806, "Input"],
Cell[CellGroupData[{
Cell[615323, 15687, 129, 1, 197, "Subsubsection"],
Cell[615455, 15690, 1057, 33, 307, "Input"],
Cell[616515, 15725, 3407, 79, 1300, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[619971, 15810, 284, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[620280, 15818, 228, 4, 343, "Subsubsection"],
Cell[620511, 15824, 3322, 70, 1356, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[623882, 15900, 142, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[624049, 15905, 994, 24, 181, "Input"],
Cell[625046, 15931, 1488, 23, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[626583, 15960, 109, 1, 55, "Chapter"],
Cell[626695, 15963, 625, 13, 93, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[627357, 15981, 117, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[627499, 15986, 2437, 64, 351, "Input"],
Cell[629939, 16052, 1308, 20, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[631296, 16078, 229, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[631550, 16085, 107, 1, 487, "Subsection"],
Cell[631660, 16088, 444, 12, 352, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[632141, 16105, 100, 1, 487, "Subsection"],
Cell[632244, 16108, 2735, 66, 1572, "Input"],
Cell[CellGroupData[{
Cell[635004, 16178, 117, 1, 383, "Subsubsection"],
Cell[635124, 16181, 7677, 136, 3270, "Input"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[642862, 16324, 284, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[643171, 16332, 228, 4, 668, "Subsubsection"],
Cell[643402, 16338, 3654, 78, 2675, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[647105, 16422, 142, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[647272, 16427, 141, 1, 127, "Subsubsection"],
Cell[CellGroupData[{
Cell[647438, 16432, 1303, 30, 356, "Input"],
Cell[648744, 16464, 640, 12, 70, "Message"],
Cell[649387, 16478, 640, 12, 70, "Message"],
Cell[650030, 16492, 1604, 24, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[651683, 16522, 290, 7, 627, "Subchapter"],
Cell[CellGroupData[{
Cell[651998, 16533, 166, 3, 127, "Subsubsection"],
Cell[CellGroupData[{
Cell[652189, 16540, 749, 21, 116, "Input"],
Cell[652941, 16563, 527, 10, 70, "Message"],
Cell[653471, 16575, 527, 10, 70, "Message"],
Cell[654001, 16587, 613, 10, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[654663, 16603, 245, 4, 220, "Subsubsection"],
Cell[654911, 16609, 419, 11, 160, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[655367, 16625, 150, 2, 127, "Subsubsection"],
Cell[CellGroupData[{
Cell[655542, 16631, 3497, 96, 1078, "Input"],
Cell[659042, 16729, 3009, 53, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[662100, 16788, 919, 28, 558, "Subsubsection"],
Cell[663022, 16818, 4710, 125, 1171, "Input"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[667805, 16951, 361, 5, 67, "Title"],
Cell[CellGroupData[{
Cell[668191, 16960, 122, 1, 35, "Subsubsection"],
Cell[668316, 16963, 344, 9, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[668697, 16977, 99, 1, 66, "Chapter"],
Cell[668799, 16980, 4095, 94, 602, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[672931, 17079, 239, 3, 55, "Chapter"],
Cell[673173, 17084, 1824, 32, 597, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[675034, 17121, 135, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[675194, 17126, 1679, 45, 132, "Input"],
Cell[676876, 17173, 875, 14, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[677800, 17193, 105, 1, 55, "Chapter"],
Cell[677908, 17196, 1330, 35, 292, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[679275, 17236, 102, 1, 55, "Chapter"],
Cell[679380, 17239, 599, 17, 82, "Input"],
Cell[CellGroupData[{
Cell[680004, 17260, 2246, 62, 240, "Input"],
Cell[682253, 17324, 2086, 46, 70, "Output"],
Cell[684342, 17372, 4893, 136, 70, "Output"]
}, Open  ]],
Cell[689250, 17511, 6482, 128, 920, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[695769, 17644, 116, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[695910, 17649, 1359, 48, 157, "Input"],
Cell[697272, 17699, 244, 4, 70, "Output"],
Cell[697519, 17705, 242, 4, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[697810, 17715, 172, 4, 100, "Chapter"],
Cell[CellGroupData[{
Cell[698007, 17723, 1053, 31, 136, "Input"],
Cell[699063, 17756, 497, 14, 70, "Output"],
Cell[699563, 17772, 717, 23, 70, "Output"]
}, Open  ]],
Cell[700295, 17798, 116, 1, 46, "Text"],
Cell[700414, 17801, 7838, 217, 1065, "Input"],
Cell[708255, 18020, 109, 1, 46, "Text"],
Cell[CellGroupData[{
Cell[708389, 18025, 903, 26, 82, "Input"],
Cell[709295, 18053, 705, 12, 70, "Output"]
}, Open  ]],
Cell[710015, 18068, 115, 1, 46, "Text"],
Cell[710133, 18071, 647, 12, 82, "Input"],
Cell[710783, 18085, 2651, 74, 125, "Input"],
Cell[CellGroupData[{
Cell[713459, 18163, 126, 1, 53, "Subsubsection"],
Cell[CellGroupData[{
Cell[713610, 18168, 1368, 43, 157, "Input"],
Cell[714981, 18213, 220, 3, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[715250, 18222, 135, 1, 53, "Subsubsection"],
Cell[CellGroupData[{
Cell[715410, 18227, 1196, 39, 156, "Input"],
Cell[716609, 18268, 171, 2, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[716841, 18277, 150, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[717016, 18285, 434, 13, 597, "Input"],
Cell[717453, 18300, 16647, 409, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[734149, 18715, 168, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[734342, 18721, 510, 12, 34, "Input"],
Cell[734855, 18735, 2449, 66, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[737341, 18806, 112, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[737478, 18811, 625, 18, 56, "Input"],
Cell[738106, 18831, 1365, 38, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[739508, 18874, 1238, 33, 167, "Input"],
Cell[740749, 18909, 557, 12, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[741355, 18927, 113, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[741493, 18932, 625, 18, 56, "Input"],
Cell[742121, 18952, 1587, 43, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[743745, 19000, 1273, 35, 167, "Input"],
Cell[745021, 19037, 622, 15, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[745704, 19059, 129, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[745858, 19065, 103, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[745986, 19070, 587, 14, 56, "Input"],
Cell[746576, 19086, 1928, 51, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[748541, 19142, 1814, 50, 168, "Input"],
Cell[750358, 19194, 598, 13, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[751005, 19213, 101, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[751131, 19218, 486, 13, 56, "Input"],
Cell[751620, 19233, 1374, 38, 70, "Output"]
}, Open  ]],
Cell[753009, 19274, 561, 18, 34, "Input"],
Cell[CellGroupData[{
Cell[753595, 19296, 1587, 43, 168, "Input"],
Cell[755185, 19341, 670, 15, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[755916, 19363, 174, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[756115, 19370, 103, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[756243, 19375, 590, 14, 54, "Input"],
Cell[756836, 19391, 1932, 51, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[758805, 19447, 1890, 52, 159, "Input"],
Cell[760698, 19501, 573, 13, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[761320, 19520, 101, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[761446, 19525, 614, 14, 54, "Input"],
Cell[762063, 19541, 2314, 62, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[764414, 19608, 1889, 52, 159, "Input"],
Cell[766306, 19662, 728, 17, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[767107, 19687, 401, 5, 67, "Title"],
Cell[CellGroupData[{
Cell[767533, 19696, 122, 1, 35, "Subsubsection"],
Cell[767658, 19699, 344, 9, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[768039, 19713, 284, 9, 86, "Chapter"],
Cell[768326, 19724, 785, 17, 93, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[769148, 19746, 239, 3, 55, "Chapter"],
Cell[769390, 19751, 1824, 32, 158, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[771251, 19788, 135, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[771411, 19793, 1606, 44, 85, "Input"],
Cell[773020, 19839, 970, 13, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[774039, 19858, 105, 1, 55, "Chapter"],
Cell[774147, 19861, 1339, 35, 200, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[775523, 19901, 102, 1, 55, "Chapter"],
Cell[775628, 19904, 544, 16, 82, "Input"],
Cell[CellGroupData[{
Cell[776197, 19924, 2363, 60, 242, "Input"],
Cell[778563, 19986, 2196, 47, 70, "Output"]
}, Open  ]],
Cell[780774, 20036, 6581, 129, 920, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[787392, 20170, 116, 1, 55, "Chapter"],
Cell[CellGroupData[{
Cell[787533, 20175, 2575, 83, 182, "Input"],
Cell[790111, 20260, 210, 3, 70, "Output"],
Cell[790324, 20265, 210, 3, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[790583, 20274, 172, 4, 100, "Chapter"],
Cell[CellGroupData[{
Cell[790780, 20282, 977, 27, 109, "Input"],
Cell[791760, 20311, 914, 29, 70, "Output"],
Cell[792677, 20342, 752, 23, 70, "Output"]
}, Open  ]],
Cell[793444, 20368, 169, 2, 37, "Text"],
Cell[793616, 20372, 7838, 217, 852, "Input"],
Cell[801457, 20591, 109, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[801591, 20596, 903, 26, 66, "Input"],
Cell[802497, 20624, 728, 12, 70, "Output"]
}, Open  ]],
Cell[803240, 20639, 115, 1, 37, "Text"],
Cell[803358, 20642, 3271, 86, 152, "Input"],
Cell[CellGroupData[{
Cell[806654, 20732, 126, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[806805, 20737, 1368, 43, 126, "Input"],
Cell[808176, 20782, 245, 3, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[808470, 20791, 135, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[808630, 20796, 1196, 39, 125, "Input"],
Cell[809829, 20837, 198, 3, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[810088, 20847, 150, 4, 55, "Chapter"],
Cell[CellGroupData[{
Cell[810263, 20855, 434, 13, 56, "Input"],
Cell[810700, 20870, 100371, 2671, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[911120, 23547, 168, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[911313, 23553, 140, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[911478, 23558, 458, 12, 56, "Input"],
Cell[911939, 23572, 13954, 398, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[925942, 23976, 137, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[926104, 23981, 792, 20, 34, "Input"],
Cell[926899, 24003, 2161, 62, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[929109, 24071, 145, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[929279, 24076, 505, 16, 34, "Input"],
Cell[929787, 24094, 2076, 65, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[931912, 24165, 140, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[932077, 24170, 2353, 60, 57, "Input"],
Cell[934433, 24232, 2652, 69, 70, "Output"],
Cell[937088, 24303, 2851, 76, 70, "Output"]
}, Open  ]],
Cell[939954, 24382, 3228, 81, 303, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[943219, 24468, 246, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[943490, 24477, 1069, 28, 57, "Input"],
Cell[944562, 24507, 12558, 343, 70, "Output"],
Cell[957123, 24852, 12084, 339, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[969256, 25197, 213, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[969494, 25204, 903, 23, 56, "Input"],
Cell[970400, 25229, 6055, 166, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[976492, 25400, 2270, 61, 213, "Input"],
Cell[978765, 25463, 2457, 62, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[981259, 25530, 136, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[981420, 25535, 4398, 131, 255, "Input"],
Cell[985821, 25668, 291, 5, 70, "Output"],
Cell[986115, 25675, 289, 5, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[986465, 25687, 113, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[986603, 25692, 823, 22, 56, "Input"],
Cell[987429, 25716, 2841, 72, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[990307, 25793, 1658, 45, 190, "Input"],
Cell[991968, 25840, 1213, 27, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[993218, 25872, 136, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[993379, 25877, 814, 24, 67, "Input"],
Cell[994196, 25903, 357, 5, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[994614, 25915, 700, 22, 56, "Subsection"],
Cell[995317, 25939, 203, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[995545, 25947, 825, 27, 57, "Input"],
Cell[996373, 25976, 804, 23, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[997238, 26006, 129, 2, 55, "Chapter"],
Cell[CellGroupData[{
Cell[997392, 26012, 131, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[997548, 26017, 414, 12, 56, "Input"],
Cell[997965, 26031, 13314, 365, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1011328, 26402, 259, 5, 45, "Subsection"],
Cell[1011590, 26409, 228, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[1011843, 26418, 870, 26, 80, "Input"],
Cell[1012716, 26446, 371, 7, 70, "Output"],
Cell[1013090, 26455, 426, 9, 70, "Output"],
Cell[1013519, 26466, 426, 9, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1013994, 26481, 197, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[1014216, 26489, 5283, 141, 457, "Input"],
Cell[1019502, 26632, 1212, 23, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1020751, 26660, 569, 20, 40, "Subsubsection"],
Cell[CellGroupData[{
Cell[1021345, 26684, 1137, 34, 56, "Input"],
Cell[1022485, 26720, 269, 4, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1022803, 26730, 240, 3, 35, "Subsubsection"],
Cell[1023046, 26735, 4563, 126, 419, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1027646, 26866, 246, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1027917, 26875, 546, 14, 56, "Input"],
Cell[1028466, 26891, 7758, 204, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1036285, 27102, 103, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[1036413, 27107, 897, 22, 56, "Input"],
Cell[1037313, 27131, 4607, 123, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1041957, 27259, 2038, 53, 168, "Input"],
Cell[1043998, 27314, 1495, 37, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1045530, 27356, 104, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1045659, 27361, 524, 16, 54, "Input"],
Cell[1046186, 27379, 195, 3, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1046442, 27389, 101, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[1046568, 27394, 745, 20, 56, "Input"],
Cell[1047316, 27416, 3166, 83, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1050519, 27504, 1825, 46, 168, "Input"],
Cell[1052347, 27552, 1391, 33, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1053799, 27592, 174, 3, 55, "Chapter"],
Cell[CellGroupData[{
Cell[1053998, 27599, 140, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1054163, 27604, 463, 12, 56, "Input"],
Cell[1054629, 27618, 19997, 537, 252, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1074675, 28161, 281, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1074981, 28168, 5030, 137, 452, "Input"],
Cell[1080014, 28307, 1623, 45, 59, "Output"]
}, Open  ]],
Cell[1081652, 28355, 8982, 222, 556, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1090671, 28582, 620, 22, 40, "Subsubsection"],
Cell[CellGroupData[{
Cell[1091316, 28608, 1497, 47, 56, "Input"],
Cell[1092816, 28657, 263, 4, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1093128, 28667, 234, 4, 35, "Subsubsection"],
Cell[1093365, 28673, 533, 17, 45, "Text"],
Cell[CellGroupData[{
Cell[1093923, 28694, 1355, 43, 80, "Input"],
Cell[1095281, 28739, 388, 9, 53, "Output"],
Cell[1095672, 28750, 388, 9, 53, "Output"],
Cell[1096063, 28761, 295, 6, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1096407, 28773, 166, 2, 35, "Subsubsection"],
Cell[1096576, 28777, 10423, 285, 757, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1107036, 29067, 246, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1107307, 29076, 443, 9, 32, "Input"],
Cell[1107753, 29087, 15046, 384, 251, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1122848, 29477, 103, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[1122976, 29482, 949, 23, 56, "Input"],
Cell[1123928, 29507, 5573, 147, 138, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1129538, 29659, 2408, 65, 191, "Input"],
Cell[1131949, 29726, 1863, 47, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1133849, 29778, 104, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1133978, 29783, 1436, 46, 64, "Input"],
Cell[1135417, 29831, 208, 3, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1135686, 29841, 201, 3, 45, "Subsection"],
Cell[1135890, 29846, 528, 15, 34, "Input"],
Cell[CellGroupData[{
Cell[1136443, 29865, 993, 23, 56, "Input"],
Cell[1137439, 29890, 5953, 149, 138, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1143429, 30044, 2137, 61, 191, "Input"],
Cell[1145569, 30107, 1696, 47, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1147302, 30159, 127, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[1147454, 30164, 1058, 34, 97, "Input"],
Cell[1148515, 30200, 436, 6, 32, "Output"],
Cell[1148954, 30208, 438, 6, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]]
}
]
*)

