(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    546861,      14478]
NotebookOptionsPosition[    536113,      14120]
NotebookOutlinePosition[    536471,      14136]
CellTagsIndexPosition[    536428,      14133]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Heterogeneous Collaborative Tethered Bar Stabilization with Two Aerial \
Vehicles\
\>", "Chapter",
 CellChangeTimes->{3.7134457082910023`*^9}],

Cell[CellGroupData[{

Cell["Notation", "Title",
 CellChangeTimes->{{3.713445719142926*^9, 3.713445735876649*^9}, {
  3.713445773377067*^9, 3.713445796019923*^9}, {3.71344815603894*^9, 
  3.713448156767825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Orthogonal", " ", "Projection", " ", "Operator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OP", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"x", ",", " ", "x"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Skew", " ", "symmetric", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Skew", "[", "\[Omega]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Omega]", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unskew", "[", "x_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Unskew", "[", 
      RowBox[{"Skew", "[", 
       RowBox[{"{", 
        RowBox[{"aa", ",", "bb", ",", "cc"}], "}"}], "]"}], "]"}], "//", 
     "MatrixForm"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{3.712038015027322*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parametrization", " ", "of", " ", "unit", " ", "vector", " ", "with", " ",
     "psi", " ", "and", " ", "theta", " ", "angle"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"uv1", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "]"}], " ", "=", " ", "e1"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uv1", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"uv3", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "]"}], " ", "=", " ", "e3"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uv3", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Duv1", "[", 
     RowBox[{"\[Theta]_", ",", "\[Omega]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"uv1", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "}"}]}], "]"}], 
       ".", "\[Omega]"}], ")"}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "\[Rule]", " ", 
       "\[Theta]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Duv3", "[", 
     RowBox[{"\[Theta]_", ",", "\[Omega]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"uv3", "[", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "}"}]}], "]"}], 
       ".", "\[Omega]"}], ")"}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "\[Rule]", " ", 
       "\[Theta]"}], "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{"just", " ", "checking", " ", "orthogonality"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"uv1", "[", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], "]"}], ".", 
      RowBox[{"Duv1", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]\[Psi]", ",", "\[Omega]\[Theta]"}], "}"}]}], 
       "]"}]}], "//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"uv3", "[", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], "]"}], ".", 
      RowBox[{"Duv3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]\[Psi]", ",", "\[Omega]\[Theta]"}], "}"}]}], 
       "]"}]}], "//", "Simplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQ/eaFwSr+wNeOeTM/7ADROvf/HAHRjNNtj4JoF9Wt
vMlA+viz8/wgmu9Q5dTlQFrOacEcEG1jG3ESRCuEMl4B0ZYPH3muANIdx9iD
QPTkvwfzQXTI399FIHrpbYMWEP1Kjm0aiF5++mzoaiA9/+myBBDNYnE4BUQv
uaeWBqK5djruANHbjt09AaK7TpWfBdFnugvOgejfp3z1rwHpMOlMMG0a/NXu
U8Frx1vz++xBtCMfV+vG7teORb2X+kH03qtWC0H01pqqjSC6rPfSdhCddzp2
F4jOWugy6SaQlmP1BNNiwV//WvW8dsxpnsBoDaR3d7/kBdGf03epgGjXtRqa
INqGJccQRBucUf5e1fvaUURvDpjWm+OqdhJIz9SarQ6ipx+bY3UNSC8Lb7AG
0WuunNCMXA5S/0kLTJ/fYQii98hKuoJoAP2O2TA=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Problem Description", "Title",
 CellChangeTimes->{{3.7134457981662817`*^9, 3.713445805074523*^9}}],

Cell["State and input decomposition (these are dummy names)", "Subtitle",
 CellChangeTimes->{{3.666548864490391*^9, 3.6665488704971523`*^9}, {
  3.713448172575499*^9, 3.71344818704732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"kinematic", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"{", 
      RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{"{", 
      RowBox[{"p1x", ",", "p1y", ",", "p1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2", "=", 
     RowBox[{"{", 
      RowBox[{"p2x", ",", "p2y", ",", "p2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N1", "=", 
     RowBox[{"{", 
      RowBox[{"n1x", ",", "n1y", ",", "n1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N2", "=", 
     RowBox[{"{", 
      RowBox[{"n2x", ",", "n2y", ",", "n2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zk", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"p", ",", "n", ",", "P1", ",", "P2", ",", "N1", ",", "N2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"dynamic", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"{", 
      RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V1", "=", 
     RowBox[{"{", 
      RowBox[{"v1x", ",", "v1y", ",", "v1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V2", "=", 
     RowBox[{"{", 
      RowBox[{"v2x", ",", "v2y", ",", "v2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zd", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"v", ",", "\[Omega]", ",", "V1", ",", "V2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"integral", " ", "states"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]", "=", 
     RowBox[{"{", 
      RowBox[{"\[Xi]1", ",", "\[Xi]2"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"full", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"zk", ",", "zd", ",", "\[Xi]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "input", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1", "=", 
     RowBox[{"{", 
      RowBox[{"u1x", ",", "u1y", ",", "u1z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2", "=", 
     RowBox[{"{", 
      RowBox[{"u2x", ",", "u2y", ",", "u2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"u1", ",", "u2"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6982351556835938`*^9, 3.698235272007811*^9}, {
   3.6982364061172447`*^9, 3.6982364062671423`*^9}, {3.698236983523291*^9, 
   3.6982370020195503`*^9}, {3.698296961499886*^9, 3.6982969962004557`*^9}, {
   3.711617258247077*^9, 3.7116173456632147`*^9}, {3.7116193540671997`*^9, 
   3.711619359532646*^9}, {3.711632585698887*^9, 3.7116325899252453`*^9}, {
   3.711633190565557*^9, 3.711633192961708*^9}, {3.7117161323299437`*^9, 
   3.711716238235461*^9}, {3.711716874982142*^9, 3.7117168999958143`*^9}, {
   3.711717367647488*^9, 3.711717372867188*^9}, {3.7117176407422237`*^9, 
   3.7117176414614677`*^9}, {3.712841126129848*^9, 3.712841140853944*^9}, {
   3.7128411715321817`*^9, 3.712841273144071*^9}, {3.712842078017605*^9, 
   3.712842090953711*^9}, {3.7128433325969963`*^9, 3.712843336250773*^9}, {
   3.71284368106555*^9, 3.712843688512825*^9}, {3.7128478971826468`*^9, 
   3.712847897712319*^9}, 3.7128482596203413`*^9}],

Cell[CellGroupData[{

Cell["State set (in manuscript ZSET is called f)", "Chapter",
 CellChangeTimes->{{3.7134482064870863`*^9, 3.713448228580737*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZSET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", "n2y_", ",", 
      "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}],
      "}"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"n", ".", "n"}], "-", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N1", ".", "N1"}], "-", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"N2", ".", "N2"}], "-", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"#", ".", "#"}], 
           SuperscriptBox["L1", "2"]], " ", "-", " ", "1"}], ")"}], "&"}], 
       ")"}], "[", 
      RowBox[{"P1", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d1", " ", "n"}]}], ")"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"#", ".", "#", " "}], 
           SuperscriptBox["L2", "2"]], "-", " ", "1"}], ")"}], "&"}], ")"}], 
      "[", 
      RowBox[{"P2", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d2", " ", "n"}]}], ")"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"n", ".", "\[Omega]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", ".", "#2"}], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P1", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V1", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d1", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", ".", "#2"}], " ", "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"P2", "-", 
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
       RowBox[{"V2", "-", 
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"d2", " ", 
           RowBox[{
            RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}]}],
       "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7116247263438053`*^9, 3.711625080704311*^9}, {
   3.7116327000706253`*^9, 3.711632704034306*^9}, 3.711632961076932*^9, {
   3.711716284722204*^9, 3.711716331960615*^9}, {3.711716510078374*^9, 
   3.711716538794478*^9}, 3.711717833137534*^9, 3.712037969096005*^9, {
   3.7120380976024942`*^9, 3.712038100563798*^9}, {3.712038300858714*^9, 
   3.712038301077929*^9}, {3.712833004798354*^9, 3.712833068677009*^9}, {
   3.712833192071289*^9, 3.712833199099535*^9}, {3.7128416322260113`*^9, 
   3.712841641946229*^9}, {3.7128417274155693`*^9, 3.712841746175961*^9}, {
   3.712841828006036*^9, 3.712841834301639*^9}, 3.7128421734105864`*^9, {
   3.7128428414685717`*^9, 3.712842841629944*^9}, {3.7128434402926292`*^9, 
   3.712843455184675*^9}, {3.712843547717203*^9, 3.7128435660242233`*^9}, {
   3.7128436252905807`*^9, 3.712843674325706*^9}, {3.712843706921115*^9, 
   3.712843707133142*^9}, 3.7128439365706377`*^9, {3.7128439751095543`*^9, 
   3.712843975255516*^9}, {3.712847966084299*^9, 3.712847981739162*^9}, {
   3.712928168137063*^9, 3.71292818919967*^9}, {3.71292823912971*^9, 
   3.7129282488132563`*^9}, {3.713448308356637*^9, 3.713448308609475*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tangent set", "Chapter",
 CellChangeTimes->{{3.7134482603686028`*^9, 3.713448262456069*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Delta]p", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]px", ",", "\[Delta]py", ",", "\[Delta]pz"}], "}"}]}], 
    ";", 
    RowBox[{"\[Delta]n", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]nx", ",", "\[Delta]ny", ",", "\[Delta]nz"}], "}"}]}], 
    ";", 
    RowBox[{"\[Delta]P1", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]p1x", ",", "\[Delta]p1y", ",", "\[Delta]p1z"}], 
      "}"}]}], ";", 
    RowBox[{"\[Delta]P2", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]p2x", ",", "\[Delta]p2y", ",", "\[Delta]p2z"}], 
      "}"}]}], ";", 
    RowBox[{"\[Delta]N1", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]n1x", ",", "\[Delta]n1y", ",", "\[Delta]n1z"}], 
      "}"}]}], ";", 
    RowBox[{"\[Delta]N2", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]n2x", ",", "\[Delta]n2y", ",", "\[Delta]n2z"}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Delta]v", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]vx", ",", "\[Delta]vy", ",", "\[Delta]vz"}], "}"}]}], 
    ";", 
    RowBox[{"\[Delta]\[Omega]", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Delta]\[Omega]x", ",", "\[Delta]\[Omega]y", ",", 
       "\[Delta]\[Omega]z"}], "}"}]}], ";", 
    RowBox[{"\[Delta]V1", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]v1x", ",", "\[Delta]v1y", ",", "\[Delta]v1z"}], 
      "}"}]}], ";", 
    RowBox[{"\[Delta]V2", "=", 
     RowBox[{"{", 
      RowBox[{"\[Delta]v2x", ",", "\[Delta]v2y", ",", "\[Delta]v2z"}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TangentZSET", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\[Delta]px_", ",", "\[Delta]py_", ",", "\[Delta]pz_", ",", 
         "\[Delta]nx_", ",", "\[Delta]ny_", ",", "\[Delta]nz_", ",", 
         "\[Delta]p1x_", ",", "\[Delta]p1y_", ",", "\[Delta]p1z_", ",", 
         "\[Delta]p2x_", ",", "\[Delta]p2y_", ",", "\[Delta]p2z_", ",", 
         "\[Delta]n1x_", ",", "\[Delta]n1y_", ",", "\[Delta]n1z_", ",", 
         "\[Delta]n2x_", ",", "\[Delta]n2y_", ",", "\[Delta]n2z_", ",", 
         "\[Delta]vx_", ",", "\[Delta]vy_", ",", "\[Delta]vz_", ",", 
         "\[Delta]\[Omega]x_", ",", "\[Delta]\[Omega]y_", ",", 
         "\[Delta]\[Omega]z_", ",", "\[Delta]v1x_", ",", "\[Delta]v1y_", ",", 
         "\[Delta]v1z_", ",", "\[Delta]v2x_", ",", "\[Delta]v2y_", ",", 
         "\[Delta]v2z_", ",", "\[Delta]\[Xi]1_", ",", "\[Delta]\[Xi]2_"}], 
        "}"}]}], "\[IndentingNewLine]", "]"}], "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", ".", "\[Delta]n"}], ",", "\[IndentingNewLine]", 
       RowBox[{"N1", ".", "\[Delta]N1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"N2", ".", "\[Delta]N2"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#1", ".", "#2"}], " ", "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P1", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]P1", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d1", " ", "\[Delta]n"}]}], ")"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#1", ".", "#2"}], "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P2", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]P2", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d2", " ", "\[Delta]n"}]}], ")"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Delta]n", ".", "\[Omega]"}], "+", 
        RowBox[{"n", ".", "\[Delta]\[Omega]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#3", ".", "#2"}], "+", 
           RowBox[{"#1", ".", "#4"}]}], " ", "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P1", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d1", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"V1", "-", 
          RowBox[{"(", 
           RowBox[{"v", "+", 
            RowBox[{"d1", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}],
          ",", 
         RowBox[{"\[Delta]P1", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d1", " ", "\[Delta]n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]V1", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]v", "+", 
            RowBox[{"d1", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Delta]\[Omega]", "]"}], ".", "n"}]}], 
            "+", 
            RowBox[{"d1", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "\[Delta]n"}]}]}], 
           ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#3", ".", "#2"}], "+", 
           RowBox[{"#1", ".", "#4"}]}], " ", "&"}], ")"}], "[", 
        RowBox[{
         RowBox[{"P2", "-", 
          RowBox[{"(", 
           RowBox[{"p", "+", 
            RowBox[{"d2", " ", "n"}]}], ")"}]}], ",", 
         RowBox[{"V2", "-", 
          RowBox[{"(", 
           RowBox[{"v", "+", 
            RowBox[{"d2", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], ")"}]}],
          ",", 
         RowBox[{"\[Delta]P2", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]p", "+", 
            RowBox[{"d2", " ", "\[Delta]n"}]}], ")"}]}], ",", 
         RowBox[{"\[Delta]V2", "-", 
          RowBox[{"(", 
           RowBox[{"\[Delta]v", "+", 
            RowBox[{"d2", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Delta]\[Omega]", "]"}], ".", "n"}]}], 
            "+", 
            RowBox[{"d2", " ", 
             RowBox[{
              RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "\[Delta]n"}]}]}], 
           ")"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.711625093733251*^9, 3.711625459743107*^9}, {
   3.7116255109941187`*^9, 3.711625555179262*^9}, 3.711625588953806*^9, {
   3.711626147955268*^9, 3.711626295203321*^9}, {3.7116263372823677`*^9, 
   3.711626355480554*^9}, 3.711632721094366*^9, {3.7117162848352127`*^9, 
   3.711716332023011*^9}, {3.711716552426841*^9, 3.711716738528173*^9}, 
   3.711716974852784*^9, 3.7128418280214863`*^9, {3.712841920265244*^9, 
   3.712841986314221*^9}, {3.7128421734249697`*^9, 3.71284220836207*^9}, {
   3.712842626571199*^9, 3.7128426267367487`*^9}, {3.7128431333866653`*^9, 
   3.712843135715652*^9}, {3.712843726451879*^9, 3.712843744204632*^9}, 
   3.712843940090583*^9, {3.71284796609508*^9, 3.7128480036006823`*^9}, {
   3.713448244710395*^9, 3.713448264833825*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["function that generates arbitrary element of state set", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
  3.666784754227034*^9, 3.6667847600915203`*^9}, {3.713448271503984*^9, 
  3.713448298749484*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zl", "[", "l_", "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"uv1", "[", 
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "3"}], "]"}], "]"}], "+", 
      RowBox[{"d1", " ", 
       RowBox[{"uv1", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}]}], "+", 
      RowBox[{"L1", " ", 
       RowBox[{"uv3", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"6", ";;", "7"}], "]"}], "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "3"}], "]"}], "]"}], "+", 
      RowBox[{"d2", " ", 
       RowBox[{"uv1", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}]}], "+", 
      RowBox[{"L2", " ", 
       RowBox[{"uv3", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"8", ";;", "9"}], "]"}], "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"uv3", "[", 
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"10", ";;", "11"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"uv3", "[", 
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"12", ";;", "13"}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"14", ";;", "16"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Skew", "[", 
       RowBox[{"uv1", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"Duv1", "[", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}], ",", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"17", ";;", "18"}], "]"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"14", ";;", "16"}], "]"}], "]"}], "+", 
      RowBox[{"d1", " ", 
       RowBox[{"Duv1", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "5"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"17", ";;", "18"}], "]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"L1", " ", 
       RowBox[{"Duv3", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"6", ";;", "7"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"19", ";;", "20"}], "]"}], "]"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", 
        RowBox[{"14", ";;", "16"}], "]"}], "]"}], "+", 
      RowBox[{"d2", " ", 
       RowBox[{"Duv1", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "5"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"17", ";;", "18"}], "]"}], "]"}]}], "]"}]}], "+", 
      RowBox[{"L2", " ", 
       RowBox[{"Duv3", "[", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"8", ";;", "9"}], "]"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{"[", 
           RowBox[{"21", ";;", "22"}], "]"}], "]"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"23", ";;", "24"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zlR", "[", "]"}], "=", 
    RowBox[{"zl", "[", 
     RowBox[{"Join", "[", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "24"}], "]"}], 
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"zlR", "[", "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"ZSET", "[", 
    RowBox[{"zl", "[", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "#"], "&"}], ",", "24"}], "]"}], "]"}], "]"}], 
   "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.697118200248754*^9, 3.697118239535376*^9}, {
   3.697118360659931*^9, 3.697118470468795*^9}, {3.697118689203661*^9, 
   3.6971187966698236`*^9}, {3.6971188307685328`*^9, 
   3.6971188421873293`*^9}, {3.697118878196802*^9, 3.697118974011015*^9}, {
   3.697119006213297*^9, 3.6971190396741123`*^9}, {3.6971390020228662`*^9, 
   3.697139009318285*^9}, {3.697139373346467*^9, 3.697139374878284*^9}, {
   3.697139414268791*^9, 3.697139469001493*^9}, {3.697141223768364*^9, 
   3.697141227711032*^9}, {3.69731249658494*^9, 3.697312510042843*^9}, {
   3.697400254573415*^9, 3.697400273661202*^9}, {3.697400303986665*^9, 
   3.69740057700772*^9}, {3.697400609630624*^9, 3.697400609841353*^9}, {
   3.698055377956704*^9, 3.698055400306435*^9}, {3.6980554414583282`*^9, 
   3.698055483594681*^9}, {3.7116174218139544`*^9, 3.711617421827387*^9}, 
   3.7116176007977867`*^9, {3.711617938728627*^9, 3.7116180228914537`*^9}, {
   3.711621070398707*^9, 3.711621081343431*^9}, {3.711715923540648*^9, 
   3.711715992726617*^9}, {3.711717833103348*^9, 3.711717833110628*^9}, {
   3.7117370649094048`*^9, 3.7117370657243958`*^9}, {3.712038037186582*^9, 
   3.712038054528998*^9}, {3.712841289703867*^9, 3.712841352076231*^9}, {
   3.712841392500101*^9, 3.712841558909223*^9}, {3.7128421149733753`*^9, 
   3.7128421239142103`*^9}, {3.712842751772552*^9, 3.712842776049879*^9}, {
   3.7128428291157846`*^9, 3.712842830499154*^9}, {3.7128433773066273`*^9, 
   3.712843431773552*^9}, {3.71284394430901*^9, 3.712843966942237*^9}, {
   3.7128479117985287`*^9, 3.712847930833536*^9}, {3.71344832098267*^9, 
   3.7134483254863033`*^9}, 3.71344970442523*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.713448323233808*^9, 3.713448390223907*^9, {3.713449634163185*^9, 
   3.713449645340069*^9}, {3.713449706025828*^9, 3.7134497188018837`*^9}, 
   3.71360058842673*^9, {3.7136006685489397`*^9, 3.713600682113246*^9}, 
   3.714029480515603*^9, 3.714034017964863*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector field", "Chapter",
 CellChangeTimes->{{3.665997800093148*^9, 3.6659978055554113`*^9}, {
  3.711621165123749*^9, 3.711621169743795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"cables", " ", "unit", " ", "vectors"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nC1", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     FractionBox[
      RowBox[{"P1", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d1", " ", "n"}]}], ")"}]}], "L1"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nC2", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     FractionBox[
      RowBox[{"P2", "-", 
       RowBox[{"(", 
        RowBox[{"p", "+", 
         RowBox[{"d2", " ", "n"}]}], ")"}]}], "L2"]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"tensions", " ", "in", " ", "cables"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MT", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["m", "m1"], ",", 
           FractionBox["m", "m2"]}], "}"}], "]"}], "+", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "\[Gamma]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1"}], "}"}]}], "}"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"m", " ", "d1", " ", "d2"}], "J"], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox["d1", "d2"], " ", 
              RowBox[{"\[Delta]1", ".", "\[Delta]1"}]}], ",", 
             RowBox[{"\[Delta]1", ".", "\[Delta]2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Delta]1", ".", "\[Delta]2"}], ",", 
             RowBox[{
              FractionBox["d2", "d1"], 
              RowBox[{"\[Delta]2", ".", "\[Delta]2"}]}]}], "}"}]}], "}"}]}]}],
        ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Gamma]", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"nC1", "[", "z", "]"}], ".", 
          RowBox[{"nC2", "[", "z", "]"}]}]}], ",", 
        RowBox[{"\[Delta]1", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"Skew", "[", "n", "]"}], ".", 
          RowBox[{"nC1", "[", "z", "]"}]}]}], ",", 
        RowBox[{"\[Delta]2", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"Skew", "[", "n", "]"}], ".", 
          RowBox[{"nC2", "[", "z", "]"}]}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BB", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"nC1", "[", "z", "]"}], ".", "u1"}], 
          FractionBox["m", "m1"]}], "+", 
         RowBox[{
          FractionBox["m", "L1"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", 
           RowBox[{"V1", "-", 
            RowBox[{"(", 
             RowBox[{"v", "+", 
              RowBox[{"d1", " ", 
               RowBox[{
                RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], 
             ")"}]}], "]"}]}], "+", " ", 
         RowBox[{"m", " ", "d1", " ", 
          RowBox[{
           RowBox[{"nC1", "[", "z", "]"}], ".", "n"}], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", "\[Omega]", 
           "]"}]}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"nC2", "[", "z", "]"}], ".", "u2"}], 
          FractionBox["m", "m2"]}], "+", 
         RowBox[{
          FractionBox["m", "L2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", 
           RowBox[{"V2", "-", 
            RowBox[{"(", 
             RowBox[{"v", "+", 
              RowBox[{"d2", " ", 
               RowBox[{
                RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}]}]}], 
             ")"}]}], "]"}]}], "+", " ", 
         RowBox[{"m", " ", "d2", " ", 
          RowBox[{
           RowBox[{"nC2", "[", "z", "]"}], ".", "n"}], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ".", "#"}], "&"}], ")"}], "[", "\[Omega]", 
           "]"}]}]}], ")"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Te", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"MT", "[", "zk", "]"}], "]"}], ".", 
      RowBox[{"BB", "[", 
       RowBox[{"z", ",", "u"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"linear", " ", "and", " ", "angular", " ", "accelerations"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", "m"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"T1", " ", 
          RowBox[{"nC1", "[", "z", "]"}]}], "+", 
         RowBox[{"T2", " ", 
          RowBox[{"nC2", "[", "z", "]"}]}], "-", " ", 
         RowBox[{"m", " ", "gravity", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]B", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", "J"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"d1", " ", "n"}], "]"}], ".", 
           RowBox[{"nC1", "[", "z", "]"}]}], " ", "T1"}], " ", "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Skew", "[", 
            RowBox[{"d2", " ", "n"}], "]"}], ".", 
           RowBox[{"nC2", "[", "z", "]"}]}], "T2"}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A1", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["1", "m1"], 
       RowBox[{"(", 
        RowBox[{"u1", "-", 
         RowBox[{"T1", " ", 
          RowBox[{"nC1", "[", "z", "]"}]}], "-", " ", 
         RowBox[{"m1", " ", "gravity", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["1", "m2"], 
       RowBox[{"(", 
        RowBox[{"u2", "-", 
         RowBox[{"T2", " ", 
          RowBox[{"nC2", "[", "z", "]"}]}], "-", " ", 
         RowBox[{"m2", " ", "gravity", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ")"}]}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T1", ",", "T2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"Te", "[", 
         RowBox[{"z", ",", "u"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zk", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{"v", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Skew", "[", "\[Omega]", "]"}], ".", "n"}], ",", 
       "\[IndentingNewLine]", "V1", ",", "\[IndentingNewLine]", "V2"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZdFullyActuated", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"z", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Tau]B", "[", 
        RowBox[{"z", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"A1", "[", 
        RowBox[{"z", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"A2", "[", 
        RowBox[{"z", ",", "u"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zd", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{"ZdFullyActuated", "[", 
      RowBox[{"z", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u1", ".", "N1"}], " ", "N1"}], ",", 
         RowBox[{
          RowBox[{"u2", ".", "N2"}], " ", "N2"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZIntegrator", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1z", "-", "L1"}], ",", 
       RowBox[{"p2z", "-", "L2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Z", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", 
         ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",",
          "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
         "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
         "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",",
          "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
         "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "u1x_", ",", "u1y_", ",", "u1z_", ",", "u2x_", ",", "u2y_", ",", 
         "u2z_"}], "}"}]}], "]"}], "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Zk", "[", "z", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Skew", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"{", 
               RowBox[{"kpr1x", ",", "kpr1y", ",", "kpr1z"}], "}"}], "]"}], 
             ".", " ", 
             RowBox[{"Skew", "[", 
              FractionBox["u1", 
               SqrtBox[
                RowBox[{"u1", ".", "u1"}]]], "]"}], ".", "N1"}]}], "]"}], ".",
           "N1"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Skew", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"{", 
               RowBox[{"kpr2x", ",", "kpr2y", ",", "kpr2z"}], "}"}], "]"}], 
             ".", " ", 
             RowBox[{"Skew", "[", 
              FractionBox["u2", 
               SqrtBox[
                RowBox[{"u2", ".", "u2"}]]], "]"}], ".", "N2"}]}], "]"}], ".",
           "N2"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Skew", "[", 
         RowBox[{
          RowBox[{"-", " ", "kpr1"}], " ", 
          RowBox[{
           RowBox[{"Skew", "[", 
            FractionBox["u1", 
             SqrtBox[
              RowBox[{"u1", ".", "u1"}]]], "]"}], ".", "N1"}]}], "]"}], ".", 
        "N1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Skew", "[", 
         RowBox[{
          RowBox[{"-", "kpr2"}], " ", 
          RowBox[{
           RowBox[{"Skew", "[", 
            FractionBox["u2", 
             SqrtBox[
              RowBox[{"u2", ".", "u2"}]]], "]"}], ".", "N2"}]}], "]"}], ".", 
        "N2"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Zd", "[", 
        RowBox[{"z", ",", "u"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ZIntegrator", "[", "z", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.697400682497552*^9, 3.697400683235924*^9}, 
   3.697400813783896*^9, {3.697400858437114*^9, 3.697400871115472*^9}, {
   3.697400908311493*^9, 3.697401159068199*^9}, {3.698055586122117*^9, 
   3.698055588296116*^9}, {3.698056542684677*^9, 3.698056552466524*^9}, {
   3.698235111344733*^9, 3.69823512671377*^9}, {3.6982366567826138`*^9, 
   3.6982366803944607`*^9}, {3.698237041849807*^9, 3.698237062183079*^9}, {
   3.698296328890626*^9, 3.698296382642074*^9}, {3.698296426982251*^9, 
   3.698296484584517*^9}, {3.698296525845749*^9, 3.698296558333123*^9}, {
   3.698296594014716*^9, 3.698296639109754*^9}, {3.698296715695365*^9, 
   3.698296766142324*^9}, {3.698296829912444*^9, 3.6982968462241087`*^9}, {
   3.698296919475834*^9, 3.6982969512167892`*^9}, {3.6982970081121407`*^9, 
   3.6982971601189327`*^9}, {3.7116172924516172`*^9, 
   3.7116173135692368`*^9}, {3.711617600829135*^9, 3.711617600834444*^9}, {
   3.7116211814820538`*^9, 3.7116211903545094`*^9}, {3.711621674121518*^9, 
   3.711621684289032*^9}, {3.7116226266695623`*^9, 3.711622657368965*^9}, {
   3.7116227064891872`*^9, 3.711622875093487*^9}, {3.711623073320809*^9, 
   3.7116230935901937`*^9}, {3.711623124016121*^9, 3.711623136621789*^9}, {
   3.711623194100933*^9, 3.7116232225230007`*^9}, {3.711623291248263*^9, 
   3.7116233162765017`*^9}, {3.711626131209844*^9, 3.711626132107855*^9}, {
   3.711626373708078*^9, 3.7116263753900623`*^9}, {3.7116264742237577`*^9, 
   3.711626679957713*^9}, {3.711626725144823*^9, 3.711626778033641*^9}, {
   3.71162689733743*^9, 3.7116269922027283`*^9}, {3.711627036057825*^9, 
   3.711627037440173*^9}, {3.7116279668739223`*^9, 3.711627995359263*^9}, {
   3.7116280287955837`*^9, 3.711628078391036*^9}, {3.711628446905264*^9, 
   3.711628816619896*^9}, {3.711628849708926*^9, 3.711628851675909*^9}, {
   3.711628903811613*^9, 3.711629021299794*^9}, {3.711629084199346*^9, 
   3.7116292645521173`*^9}, {3.711629298749126*^9, 3.711629334010613*^9}, {
   3.711630407964484*^9, 3.711630461296159*^9}, {3.7116327828384447`*^9, 
   3.7116328480417957`*^9}, {3.711632986156638*^9, 3.71163302875439*^9}, {
   3.71163307677535*^9, 3.711633080282186*^9}, 3.7116331265298433`*^9, {
   3.711689294866427*^9, 3.711689298484226*^9}, {3.711716284965667*^9, 
   3.7117163320871058`*^9}, {3.711716755984516*^9, 3.7117168689313707`*^9}, {
   3.711716914097118*^9, 3.711716926278614*^9}, {3.711716978791876*^9, 
   3.711717134159712*^9}, 3.7117173042513313`*^9, {3.711723906207171*^9, 
   3.7117239189962263`*^9}, 3.712038129588223*^9, {3.712039142693501*^9, 
   3.712039273186387*^9}, {3.712043072787568*^9, 3.712043075086792*^9}, {
   3.712841828031774*^9, 3.7128418281427298`*^9}, {3.7128419997226543`*^9, 
   3.7128420529535933`*^9}, {3.712842173438087*^9, 3.712842173507884*^9}, {
   3.712842222131393*^9, 3.712842535873464*^9}, 3.71284260024035*^9, {
   3.712844022737658*^9, 3.71284402501755*^9}, {3.7128461211563377`*^9, 
   3.712846191106421*^9}, {3.712847103843172*^9, 3.712847112378648*^9}, {
   3.712847966107134*^9, 3.712847966222744*^9}, {3.712848040002239*^9, 
   3.712848072801487*^9}, {3.712848118243079*^9, 3.712848136005253*^9}, {
   3.7128482011882353`*^9, 3.712848298990376*^9}, {3.713448346045266*^9, 
   3.7134483598689203`*^9}, {3.71344839713986*^9, 3.713448420023366*^9}, {
   3.713448499727456*^9, 3.713448544843899*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["checking that vector field is within tangent set", "Chapter",
 CellChangeTimes->{{3.712038811277717*^9, 3.712038834014045*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Chop", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"TangentZSET", "[", 
         RowBox[{"z", ",", 
          RowBox[{"Z", "[", 
           RowBox[{"z", ",", "u"}], "]"}]}], "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"z", "\[Rule]", " ", 
          RowBox[{"zl", "[", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "24"}], "]"}], 
           "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",",
            "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], "/.",
       "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"u", "\[Rule]", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10", ",", "10"}], "}"}], ",", "6"}], "]"}]}], "]"}]}], "/.",
      "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "kpr1x", ",", "kpr1y", ",", "kpr1z", ",", "kpr2x", ",", "kpr2y", ",", 
         "kpr2z"}], "}"}], "\[Rule]", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", "6"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"Chop", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"ZSET", "[", "z", "]"}], ",", 
           RowBox[{"{", "z", "}"}]}], "]"}], "]"}], ".", 
        RowBox[{"Z", "[", 
         RowBox[{"z", ",", "u"}], "]"}]}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"z", "\[Rule]", " ", 
         RowBox[{"zl", "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "24"}], "]"}], 
          "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
          "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], "/.",
      "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{"u", "\[Rule]", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "6"}], "]"}]}], 
      "]"}]}], "/.", "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kpr1", ",", "kpr2"}], "}"}], "\[Rule]", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "10"}], "}"}], ",", "2"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.711633142776978*^9, 3.711633142957838*^9}, {
   3.711633207554667*^9, 3.711633208645482*^9}, 3.711633238773624*^9, {
   3.71163407516049*^9, 3.711634139805245*^9}, {3.711717396201397*^9, 
   3.711717418048194*^9}, 3.711717480473504*^9, {3.711717833150804*^9, 
   3.711717833157578*^9}, {3.7120381316591873`*^9, 3.712038187889556*^9}, {
   3.712038320716567*^9, 3.712038339377733*^9}, {3.712038369407885*^9, 
   3.712038371599181*^9}, {3.712038633411572*^9, 3.712038651549141*^9}, {
   3.712038783309617*^9, 3.7120388016940727`*^9}, {3.712842552026746*^9, 
   3.712842569687134*^9}, {3.712842861381813*^9, 3.712842861842023*^9}, {
   3.7128483060378313`*^9, 3.712848358959763*^9}, {3.713448442566313*^9, 
   3.713448490895706*^9}, {3.713448556254397*^9, 3.713448589422153*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.7120381152681627`*^9, 3.712038195254126*^9}, 
   3.7120382373104057`*^9, 3.7120383560503407`*^9, 3.712038462602194*^9, 
   3.712038802489809*^9, 3.7120392870802507`*^9, 3.7120400533716917`*^9, 
   3.7120490080286407`*^9, 3.712058597787944*^9, 3.712117088837121*^9, 
   3.712127201428541*^9, 3.712134774567882*^9, 3.7121500948831882`*^9, 
   3.712150579414322*^9, 3.712151238841858*^9, 3.7121558587600393`*^9, 
   3.712382151600459*^9, 3.712830597485321*^9, 3.712830642766521*^9, 
   3.712839871831526*^9, 3.712842570656641*^9, {3.7128426196284513`*^9, 
   3.712842632872696*^9}, 3.712842700299861*^9, {3.7128428566748323`*^9, 
   3.712842865294299*^9}, 3.7128432121144953`*^9, 3.712843359828312*^9, 
   3.712843716013856*^9, {3.7128439891062517`*^9, 3.712844029913664*^9}, 
   3.7128462227703342`*^9, 3.712847153088462*^9, 3.712848324583284*^9, 
   3.7128483623165817`*^9, 3.712899212710343*^9, 3.712905101540876*^9, 
   3.712928201042177*^9, 3.712928304583976*^9, 3.712928974185845*^9, 
   3.712929755275689*^9, 3.712948193231392*^9, 3.712948727344996*^9, 
   3.712982052846031*^9, 3.7129830128655987`*^9, 3.7129881519644003`*^9, {
   3.713448480305551*^9, 3.713448491675489*^9}, {3.713448562111394*^9, 
   3.713448579875558*^9}, {3.713449634571957*^9, 3.713449645826301*^9}, 
   3.7134497192056217`*^9, 3.713600588873612*^9, {3.71360066897045*^9, 
   3.713600682495743*^9}, 3.7140294809841433`*^9, 3.714034018379023*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["equilibrium state", "Chapter",
 CellChangeTimes->{{3.7120389777603073`*^9, 3.712038982949807*^9}, {
  3.7134486113669453`*^9, 3.713448611875164*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zeq", "=", 
   RowBox[{"zl", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "24"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zeq", "[", 
    RowBox[{"[", "31", "]"}], "]"}], "=", "\[Xi]1star"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zeq", "[", 
    RowBox[{"[", "32", "]"}], "]"}], "=", "\[Xi]2star"}], 
  ";"}], "\[IndentingNewLine]", "zeq"}], "Input",
 CellChangeTimes->{{3.712038990164638*^9, 3.712038992606546*^9}, {
  3.71284158640333*^9, 3.7128415926469593`*^9}, {3.712842834188586*^9, 
  3.712842835628652*^9}, {3.712843434574793*^9, 3.712843435620257*^9}, {
  3.712843970530437*^9, 3.712843970676407*^9}, {3.71284793520811*^9, 
  3.712847935320546*^9}, {3.7134486966801367`*^9, 3.713448757353994*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "d1", ",", "0", 
   ",", "L1", ",", "d2", ",", "0", ",", "L2", ",", "0", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "\[Xi]1star", ",", "\[Xi]2star"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7120389938649797`*^9, 3.71204005300133*^9, 3.7120490073703136`*^9, 
   3.7120585974579887`*^9, 3.712117087938985*^9, 3.712127196337996*^9, 
   3.712134773836677*^9, 3.712150094146441*^9, 3.712150578851078*^9, 
   3.7121512379675694`*^9, 3.7121558580290623`*^9, 3.712382151023314*^9, 
   3.7128305740941353`*^9, 3.712830642150257*^9, 3.712839871128881*^9, 
   3.7128415934299517`*^9, 3.712842128674515*^9, 3.712842836084979*^9, 
   3.712843359141919*^9, 3.712843436151952*^9, 3.712843514623495*^9, 
   3.7128437036484632`*^9, 3.712843971147111*^9, 3.7128440077812147`*^9, 
   3.7128462203653097`*^9, 3.712847151542429*^9, 3.7128479356681147`*^9, 
   3.712848160827917*^9, 3.712848267252268*^9, 3.712899211970461*^9, 
   3.712905100844636*^9, 3.712928973573987*^9, 3.7129297546006727`*^9, 
   3.712948192138562*^9, 3.712948726652055*^9, 3.7129820520955133`*^9, 
   3.7129830120272703`*^9, 3.7129881505472307`*^9, 3.7134483327639503`*^9, 
   3.713448392532982*^9, {3.7134487125386543`*^9, 3.713448759896096*^9}, {
   3.713449634659545*^9, 3.713449645905867*^9}, 3.713449719258773*^9, 
   3.713600588979764*^9, {3.713600669051106*^9, 3.7136006825678673`*^9}, 
   3.714029481076003*^9, 3.714034018431869*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["equilibrium input", "Chapter",
 CellChangeTimes->{{3.712039046240158*^9, 3.712039050803523*^9}, {
  3.712039321674848*^9, 3.712039330339319*^9}, {3.713448619185652*^9, 
  3.713448619412182*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ueq", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"m1", " ", "gravity"}], " ", "+", 
      FractionBox[
       RowBox[{"d2", " ", "gravity", " ", "m"}], 
       RowBox[{"d2", "-", "d1"}]]}], ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"m2", " ", "gravity"}], " ", "+", 
      FractionBox[
       RowBox[{"d1", " ", "gravity", " ", "m"}], 
       RowBox[{"d1", "-", "d2"}]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.712039055245289*^9, 3.712039075825623*^9}, {
  3.712039346484489*^9, 3.7120393530212927`*^9}, {3.713448637769609*^9, 
  3.713448638505965*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["check vector field vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.7134486234932833`*^9, 3.713448635451254*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{"zeq", ",", "ueq"}], "]"}], "//", "FullSimplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.713448642138747*^9, 3.7134487625077143`*^9, {3.713449634808668*^9, 
   3.7134496460306892`*^9}, 3.713449719342246*^9, 3.7136005891501207`*^9, {
   3.713600669249176*^9, 3.713600682698051*^9}, 3.714029481285183*^9, 
   3.714034018550478*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Control Law", "Title",
 CellChangeTimes->{{3.713445806467986*^9, 3.713445812734324*^9}}],

Cell[CellGroupData[{

Cell["PD control laws (we removed saturations for simplicity)", "Chapter",
 CellChangeTimes->{{3.7120393698603773`*^9, 3.7120393804879923`*^9}, {
  3.713448786237568*^9, 3.713448799188367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uPD", "[", 
   RowBox[{"p_", ",", "v_", ",", 
    RowBox[{"{", 
     RowBox[{"kp_", ",", "kv_", ",", "\[Sigma]p_", ",", "\[Sigma]v_"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "kp"}], " ", "p"}], " ", "-", " ", 
   RowBox[{"kv", " ", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.7120584505551777`*^9, 3.712058476755711*^9}, {
   3.712058541732068*^9, 3.712058565179367*^9}, {3.712058671317902*^9, 
   3.712058721481213*^9}, {3.712058887269067*^9, 3.71205888759383*^9}, {
   3.7120590055443497`*^9, 3.712059009310205*^9}, 3.7120591390329027`*^9, {
   3.712116852915504*^9, 3.712116914673811*^9}, {3.712830645465815*^9, 
   3.71283064726532*^9}, 3.71284405109263*^9, {3.713448769567884*^9, 
   3.713448770684608*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Control law for each uav", "Chapter",
 CellChangeTimes->{{3.712040075566353*^9, 3.712040080540077*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "pd", " ", "control", " ", "law", " ", "for", " ", "for", " ", "each", " ",
     "direction"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"u1cl", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m1", " ", 
        RowBox[{"uPD", "[", 
         RowBox[{
          RowBox[{"p1x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "7", "]"}], "]"}]}], ",", 
          RowBox[{"v1x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "19", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
           "kpx1", ",", "kvx1", ",", "\[Sigma]px1", ",", "\[Sigma]vx1"}], 
           "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uPD", "[", 
           RowBox[{
            RowBox[{"p1y", "-", 
             RowBox[{"zeq", "[", 
              RowBox[{"[", "8", "]"}], "]"}]}], ",", 
            RowBox[{"v1y", "-", 
             RowBox[{"zeq", "[", 
              RowBox[{"[", "20", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
             "kpy1", ",", "kvy1", ",", "\[Sigma]py1", ",", "\[Sigma]vy1"}], 
             "}"}]}], "]"}], "+", 
          RowBox[{"d1", " ", "L1", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kp\[Psi]1", " ", "ny"}], "+", 
             RowBox[{"kv\[Psi]1", " ", "\[Omega]z"}]}], ")"}]}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m1", " ", 
         RowBox[{"uPD", "[", 
          RowBox[{
           RowBox[{"p1z", "-", 
            RowBox[{"zeq", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}], ",", 
           RowBox[{"v1z", "-", 
            RowBox[{"zeq", "[", 
             RowBox[{"[", "21", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
            "kpz1", ",", "kvz1", ",", "\[Sigma]pz1", ",", "\[Sigma]vz1"}], 
            "}"}]}], "]"}]}], "-", 
        RowBox[{"m1", " ", "kiz1", " ", "\[Xi]1"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m1", " ", "+", " ", 
         FractionBox["m", "2"]}], ")"}], " ", 
       RowBox[{"uPD", "[", 
        RowBox[{
         RowBox[{"p1z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}], ",", 
         RowBox[{"v1z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "21", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
          "kpz1", ",", "kvz1", ",", "\[Sigma]pz1", ",", "\[Sigma]vz1"}], 
          "}"}]}], "]"}]}], "}"}], ";"}], "*)"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "this", " ", "is", " ", "NOT", " ", "a", " ", "good", " ", "option", " ", 
     "to", " ", "study", " ", "the", " ", "case", " ", "when", " ", "we", " ", 
     RowBox[{"don", "'"}], "t", " ", "know", " ", "mass", " ", "of", " ", 
     "bar"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"u2cl", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m2", " ", 
        RowBox[{"uPD", "[", 
         RowBox[{
          RowBox[{"p2x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "10", "]"}], "]"}]}], ",", 
          RowBox[{"v2x", "-", 
           RowBox[{"zeq", "[", 
            RowBox[{"[", "22", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
           "kpx2", ",", "kvx2", ",", "\[Sigma]px2", ",", "\[Sigma]vx2"}], 
           "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uPD", "[", 
           RowBox[{
            RowBox[{"p2y", "-", 
             RowBox[{"zeq", "[", 
              RowBox[{"[", "11", "]"}], "]"}]}], ",", 
            RowBox[{"v2y", "-", 
             RowBox[{"zeq", "[", 
              RowBox[{"[", "23", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
             "kpy2", ",", "kvy2", ",", "\[Sigma]py2", ",", "\[Sigma]vy2"}], 
             "}"}]}], "]"}], "+", 
          RowBox[{"d2", " ", "L2", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kp\[Psi]2", " ", "ny"}], "+", 
             RowBox[{"kv\[Psi]2", " ", "\[Omega]z"}]}], ")"}]}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m2", " ", 
         RowBox[{"uPD", "[", 
          RowBox[{
           RowBox[{"p2z", "-", 
            RowBox[{"zeq", "[", 
             RowBox[{"[", "12", "]"}], "]"}]}], ",", 
           RowBox[{"v2z", "-", 
            RowBox[{"zeq", "[", 
             RowBox[{"[", "24", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
            "kpz2", ",", "kvz2", ",", "\[Sigma]pz2", ",", "\[Sigma]vz2"}], 
            "}"}]}], "]"}]}], "-", 
        RowBox[{"m2", " ", "kiz2", " ", "\[Xi]2"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m2", " ", "+", " ", 
         FractionBox["m", "2"]}], ")"}], 
       RowBox[{"uPD", "[", 
        RowBox[{
         RowBox[{"p2z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "12", "]"}], "]"}]}], ",", 
         RowBox[{"v2z", "-", 
          RowBox[{"zeq", "[", 
           RowBox[{"[", "24", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
          "kpz2", ",", "kvz2", ",", "\[Sigma]pz2", ",", "\[Sigma]vz2"}], 
          "}"}]}], "]"}]}], "}"}], ";"}], "*)"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "MAKING", " ", "THIS", " ", "CHOICE", " ", "GREATLY", " ", "COMPLICATES", 
     " ", "THE", " ", "ANALYSIS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"complete", " ", "control", " ", "law"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ucl", "[", "z_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ueq", "/.", 
       RowBox[{"{", 
        RowBox[{"m", "\[Rule]", " ", "mEstimate"}], "}"}]}], ")"}], "+", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"u1cl", "[", "z", "]"}], ",", 
       RowBox[{"u2cl", "[", "z", "]"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.678453870578924*^9, 3.6784538851660337`*^9}, {
   3.6784539201437883`*^9, 3.67845426729596*^9}, {3.6784542976203947`*^9, 
   3.678454338207302*^9}, {3.678454368219833*^9, 3.67845442420653*^9}, {
   3.678455564719254*^9, 3.6784555755938787`*^9}, {3.678455667955229*^9, 
   3.67845567412951*^9}, {3.6784557240285482`*^9, 3.67845580636443*^9}, {
   3.67845594497412*^9, 3.6784560056472273`*^9}, {3.678456040740004*^9, 
   3.678456113360455*^9}, {3.6784565804483*^9, 3.6784566989706917`*^9}, {
   3.67845699495473*^9, 3.6784570051161823`*^9}, {3.678457074189624*^9, 
   3.678457074400229*^9}, {3.678457120811713*^9, 3.678457132773929*^9}, {
   3.6784573833439817`*^9, 3.678457399044024*^9}, {3.678457566717965*^9, 
   3.678457575258934*^9}, {3.6784576138433027`*^9, 3.67845764511302*^9}, {
   3.678457681670499*^9, 3.6784576869371843`*^9}, {3.6785030133194637`*^9, 
   3.678503018851026*^9}, {3.678503053700424*^9, 3.678503061887308*^9}, {
   3.6785031141864853`*^9, 3.678503151671834*^9}, {3.6785035454280252`*^9, 
   3.678503565801978*^9}, {3.692605692777117*^9, 3.692605787151251*^9}, {
   3.692605871228614*^9, 3.692605875567656*^9}, {3.697783560030775*^9, 
   3.697783584633834*^9}, {3.697864144145309*^9, 3.6978642846827497`*^9}, {
   3.6978644724858093`*^9, 3.697864474524767*^9}, {3.6978645253057003`*^9, 
   3.697864529099121*^9}, {3.6978648087283993`*^9, 3.697864819666897*^9}, {
   3.697864857946622*^9, 3.697864871615958*^9}, {3.697865030310058*^9, 
   3.697865054256448*^9}, {3.6978653837364273`*^9, 3.697865403161058*^9}, {
   3.697865434075416*^9, 3.697865435874483*^9}, {3.6978655603144903`*^9, 
   3.6978655605135307`*^9}, {3.697878887139681*^9, 3.6978789273146276`*^9}, {
   3.712038875130848*^9, 3.712038878681403*^9}, 3.7120393854066896`*^9, {
   3.712040082366139*^9, 3.712040082678351*^9}, {3.7120401609284153`*^9, 
   3.712040170183938*^9}, {3.712040226413877*^9, 3.712040307061963*^9}, {
   3.7120403525685987`*^9, 3.7120404400933*^9}, {3.7120474726221743`*^9, 
   3.7120474757472897`*^9}, {3.712116926109763*^9, 3.712117064974493*^9}, {
   3.7121172584306*^9, 3.712117304172991*^9}, {3.71211769691184*^9, 
   3.7121177334271097`*^9}, {3.7121178099621468`*^9, 3.712117826487574*^9}, {
   3.7121273633642406`*^9, 3.712127392651319*^9}, {3.712134728325556*^9, 
   3.712134736513805*^9}, {3.712134776729841*^9, 3.7121347833000307`*^9}, {
   3.712150008166641*^9, 3.712150028687416*^9}, {3.7121500979389563`*^9, 
   3.7121501124205008`*^9}, {3.712841828170721*^9, 3.712841828175336*^9}, {
   3.712842173521311*^9, 3.712842173526173*^9}, {3.712844056258308*^9, 
   3.7128440869021053`*^9}, {3.712847966254746*^9, 3.712847966259042*^9}, {
   3.712853316853519*^9, 3.712853343932612*^9}, {3.71285339637422*^9, 
   3.712853408929783*^9}, {3.712853548788332*^9, 3.71285355298173*^9}, {
   3.71298295129955*^9, 3.712982955194254*^9}, {3.712983293924004*^9, 
   3.7129833113195972`*^9}, {3.713448815718647*^9, 3.7134488689281063`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
define equilibrium properly now (now that closed can be defined) \
\>", "Chapter",
 CellChangeTimes->{{3.7120404506307907`*^9, 3.7120404753435917`*^9}, {
  3.7134489055036983`*^9, 3.713448907169035*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zeq", "[", 
    RowBox[{"[", "31", "]"}], "]"}], "=", 
   RowBox[{
    FractionBox["gravity", "kiz1"], 
    FractionBox[
     RowBox[{"m", "-", "mEstimate"}], "m1"], 
    FractionBox[
     RowBox[{"d2", "  "}], 
     RowBox[{"d1", "-", "d2"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zeq", "[", 
    RowBox[{"[", "32", "]"}], "]"}], "=", 
   RowBox[{
    FractionBox["gravity", "kiz2"], 
    FractionBox[
     RowBox[{"m", "-", "mEstimate"}], "m2"], 
    FractionBox[
     RowBox[{"d1", "  "}], 
     RowBox[{"d2", "-", "d1"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.712040480531617*^9, {3.71298292900562*^9, 3.712982931389945*^9}, {
   3.712982961577345*^9, 3.712982966421186*^9}, {3.713448884247497*^9, 
   3.713448922044145*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Closed loop vector field", "Chapter",
 CellChangeTimes->{{3.713448913683614*^9, 3.713448920377898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Zcl", "[", "z_", "]"}], ":=", 
  RowBox[{"Z", "[", 
   RowBox[{"z", ",", 
    RowBox[{"ucl", "[", "z", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7134489264835033`*^9, 3.713448926741601*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check it vanishes at equilibrium", "Chapter",
 CellChangeTimes->{{3.713448929119544*^9, 3.713448934629406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Zcl", "[", "zeq", "]"}], "//", "FullSimplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7134489360954933`*^9, {3.713449635118136*^9, 3.713449646196268*^9}, 
   3.713449719504774*^9, 3.7136005894359713`*^9, {3.7136006697001667`*^9, 
   3.713600682949279*^9}, 3.7140294815836773`*^9, 3.714034018798943*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Routh\[CloseCurlyQuote]s Criterion", "Title",
 CellChangeTimes->{{3.7134458142349358`*^9, 3.713445817129426*^9}}],

Cell[CellGroupData[{

Cell["Controllable canonical form", "Chapter",
 CellChangeTimes->{{3.7120541198105907`*^9, 3.71205412486038*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"addrow", "[", "a_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"UnitVector", "[", 
       RowBox[{
        RowBox[{"Length", "[", "a", "]"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "a", "]"}], "+", "1", "-", 
         RowBox[{
          RowBox[{"Dimensions", "[", "#", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "}"}], ",", "#"}], "]"}],
    "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "a_", "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{
    RowBox[{"addrow", "[", "a", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"-", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Length", "[", "a", "]"}], "-", "1"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3"}], "}"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "]"}], 
  "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7120552813651543`*^9, 3.712055332502823*^9}, {
  3.712055374880151*^9, 3.7120554005155563`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.712854454801506*^9, 3.712857947760923*^9, 
   3.7129284352718563`*^9, 3.712930456299375*^9, 3.7134490623729753`*^9, {
   3.713449635190847*^9, 3.713449646270899*^9}, 3.7134497195704536`*^9, 
   3.713600589550254*^9, {3.713600669796749*^9, 3.713600683111655*^9}, 
   3.714029481675905*^9, 3.71403401884622*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.712854454801506*^9, 3.712857947760923*^9, 
   3.7129284352718563`*^9, 3.712930456299375*^9, 3.7134490623729753`*^9, {
   3.713449635190847*^9, 3.713449646270899*^9}, 3.7134497195704536`*^9, 
   3.713600589550254*^9, {3.713600669796749*^9, 3.713600683111655*^9}, 
   3.714029481675905*^9, 3.714034018865787*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{"-", "a0"}], 
      RowBox[{"-", "a1"}], 
      RowBox[{"-", "a2"}], 
      RowBox[{"-", "a3"}], 
      RowBox[{"-", "a4"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71205530000025*^9, 3.712055333328465*^9}, {
   3.712055390029583*^9, 3.712055400759265*^9}, 3.71205573325695*^9, 
   3.7121542746987667`*^9, 3.712156632599451*^9, 3.712161859194921*^9, 
   3.712165302505271*^9, 3.712854454801506*^9, 3.712857947760923*^9, 
   3.7129284352718563`*^9, 3.712930456299375*^9, 3.7134490623729753`*^9, {
   3.713449635190847*^9, 3.713449646270899*^9}, 3.7134497195704536`*^9, 
   3.713600589550254*^9, {3.713600669796749*^9, 3.713600683111655*^9}, 
   3.714029481675905*^9, 3.7140340188767567`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hurwitz conditions", "Chapter",
 CellChangeTimes->{{3.7120554792779493`*^9, 3.712055483753387*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<hurwitz_conditions.nb\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.71005535745792*^9, 3.710055358482471*^9}, {
   3.710055419189004*^9, 3.710055459554541*^9}, {3.7100555370149403`*^9, 
   3.710055548671946*^9}, 3.710055638835634*^9, 3.710057803745392*^9, {
   3.7100599861952877`*^9, 3.710059990024391*^9}, 3.7101574160581427`*^9, {
   3.710157992771703*^9, 3.710157993807963*^9}, {3.712055524490918*^9, 
   3.712055546142333*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[CapitalGamma]3 (all terms need to be positive: in first column of Routh\
\[CloseCurlyQuote]s table)\
\>", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
  3.7120557198662043`*^9, 3.712055720104171*^9}, {3.713449075653973*^9, 
  3.713449081278111*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]\[CapitalGamma]3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", " ", 
      RowBox[{"(", 
       RowBox[{"kp", "+", "fp"}], ")"}]}], " ", ",", 
     RowBox[{
      RowBox[{"fd", " ", "kd"}], "+", "fp"}], ",", "fd"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]3", "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Step4", "[", 
   RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]3", "]"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712930462315465*^9, 3.7129304785245113`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0"},
     {"0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fd"}], " ", 
       RowBox[{"(", 
        RowBox[{"fp", "+", "kp"}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "fp"}], "-", 
       RowBox[{"fd", " ", "kd"}]}], 
      RowBox[{"-", "fd"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7129304759074497`*^9, 3.712930478950245*^9}, 
   3.7134490711519413`*^9, {3.713449637190078*^9, 3.713449648021843*^9}, 
   3.7134497212550783`*^9, 3.713600592366877*^9, {3.713600672100586*^9, 
   3.713600685200796*^9}, 3.714029483707858*^9, 3.7140340206801443`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"fd"},
      {
       RowBox[{"fd", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fd", " ", "kd"}], "-", "kp"}], ")"}]}]},
      {
       RowBox[{"fd", " ", 
        RowBox[{"(", 
         RowBox[{"fp", "+", "kp"}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7129304759074497`*^9, 3.712930478950245*^9}, 
   3.7134490711519413`*^9, {3.713449637190078*^9, 3.713449648021843*^9}, 
   3.7134497212550783`*^9, 3.713600592366877*^9, {3.713600672100586*^9, 
   3.713600685200796*^9}, 3.714029483707858*^9, 3.714034020700333*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[CapitalGamma]5 (all terms need to be positive: in first column of Routh\
\[CloseCurlyQuote]s table)\
\>", "Chapter",
 CellChangeTimes->{{3.7120554182278137`*^9, 3.712055419427719*^9}, {
   3.712055595766025*^9, 3.712055596366538*^9}, {3.712055702778782*^9, 
   3.712055713266334*^9}, 3.712154265780588*^9, 3.71344908635152*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalGamma]\[CapitalGamma]5", "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k\[Theta]"}], 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"ggL", " ", 
            RowBox[{"(", 
             RowBox[{"kp", "+", 
              RowBox[{"ggL", " ", "p2"}]}], ")"}]}], " ", ",", 
           RowBox[{"ggL", " ", "kv"}], ",", 
           RowBox[{"(", 
            RowBox[{"kp", "+", " ", 
             RowBox[{"ggL", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "rr", "+", "p6"}], ")"}]}]}], ")"}], " ", 
           ",", " ", "kv", ",", "0"}], "}"}]}], "-", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           SuperscriptBox["ggL", "2"], " ", "p2"}], ",", "0", ",", 
          RowBox[{"ggL", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "rr", "+", "p6"}], ")"}]}], " ", ",", 
          "k\[Theta]"}], "}"}]}], ")"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]\[CapitalGamma]5", "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fd", " ", "fp", " ", 
           RowBox[{"(", 
            RowBox[{"kp", "+", 
             RowBox[{"fp", " ", "p1"}]}], ")"}]}], " ", ",", 
          RowBox[{"fp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fd", " ", "kv"}], "+", 
             RowBox[{"fp", " ", "p1"}]}], ")"}]}], ",", 
          RowBox[{"fd", 
           RowBox[{"(", 
            RowBox[{"kp", "+", " ", 
             RowBox[{"fp", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ")"}]}], " ", 
          ",", 
          RowBox[{
           RowBox[{"fd", " ", "kv"}], "+", 
           RowBox[{"fp", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ",", "fd"}], 
         "}"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]5", "]"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Step4", "[", 
     RowBox[{"CC", "[", "\[CapitalGamma]\[CapitalGamma]5", "]"}], "]"}], "//",
     "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.712854475602787*^9, 3.7128545452865553`*^9}, {
  3.7128546037419252`*^9, 3.712854639899626*^9}, {3.712854782574995*^9, 
  3.712854790674692*^9}, {3.712855059645575*^9, 3.712855060238492*^9}, {
  3.7128552583318768`*^9, 3.7128552596810207`*^9}, {3.7128554224390697`*^9, 
  3.712855430784445*^9}, {3.7128556039266567`*^9, 3.712855607155005*^9}, {
  3.7128565905430307`*^9, 3.7128566070877733`*^9}, {3.71285702699781*^9, 
  3.712857040329*^9}, {3.712857087715067*^9, 3.712857091194635*^9}, {
  3.71285795421245*^9, 3.712857999637442*^9}, {3.712928444078889*^9, 
  3.712928627056727*^9}, {3.712928757908557*^9, 3.712928773069557*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"},
     {
      RowBox[{
       RowBox[{"-", "fd"}], " ", "fp", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", " ", "p1"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "fp"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"fd", " ", "kv"}], "+", 
         RowBox[{"fp", " ", "p1"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "fd"}], " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "p1", "+", "p2"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "fd"}], " ", "kv"}], "-", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "p1", "+", "p2"}], ")"}]}]}], 
      RowBox[{"-", "fd"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.714034020750087*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {"fd"},
      {
       RowBox[{"fd", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kp"}], "+", 
          RowBox[{"fd", " ", "kv"}]}], ")"}]}]},
      {
       RowBox[{
        SuperscriptBox["fd", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kp"}], "+", 
          RowBox[{"fd", " ", "kv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", 
           RowBox[{"(", 
            RowBox[{"p1", "+", "p2"}], ")"}]}]}], ")"}]}]},
      {
       RowBox[{
        SuperscriptBox["fd", "2"], " ", 
        SuperscriptBox["fp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"kp", "-", 
           RowBox[{"fd", " ", "kv"}]}], ")"}], "2"], " ", "p2"}]},
      {
       RowBox[{"fd", " ", "fp", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "p1"}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712928773733694*^9, 3.713449037010037*^9, 3.7134490899004498`*^9, {
   3.713449637299316*^9, 3.713449648127002*^9}, 3.713449721342002*^9, 
   3.713600592490123*^9, {3.713600672202799*^9, 3.7136006853082523`*^9}, 
   3.714029483810367*^9, 3.71403402076991*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Crane system", "Title",
 CellChangeTimes->{{3.713445818990615*^9, 3.713445823656205*^9}}],

Cell["check notebook at \[OpenCurlyDoubleQuote]crane_system/crane_system\
\[CloseCurlyDoubleQuote].nb", "Chapter",
 CellChangeTimes->{{3.713449136132983*^9, 3.7134491458120337`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Linearization", "Title",
 CellChangeTimes->{3.713445825099208*^9}],

Cell[CellGroupData[{

Cell["Stability vector field term (only for analysis)", "Chapter",
 CellChangeTimes->{{3.7120421708683567`*^9, 3.7120422205169086`*^9}, {
  3.7128306840760193`*^9, 3.71283068718001*^9}, {3.7134496094633293`*^9, 
  3.7134496232282867`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DZSET", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", "n2y_", ",", 
      "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}],
      "}"}], "]"}], "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"ZSET", "[", "z", "]"}], ",", 
      RowBox[{"{", "z", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ZS", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"ZSET", "[", "z", "]"}], ".", 
      RowBox[{"DZSET", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ZS", "[", 
      RowBox[{"{", 
       RowBox[{
       "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",",
         "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", 
        "p2z_", ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", 
        "n2y_", ",", "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", 
        "\[Omega]x_", ",", "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", 
        "v1y_", ",", "v1z_", ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", 
        "\[Xi]1_", ",", "\[Xi]2_"}], "}"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"DZSET", "[", "zeq", "]"}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"DZSET", "[", "zeq", "]"}], ".", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DZSET", "[", "zeq", "]"}], "]"}]}], "]"}], ".", 
      RowBox[{"ZSET", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"ZS", "[", 
       RowBox[{"zlR", "[", "]"}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
          "m2", ",", "d1", ",", "d2"}], "}"}], "\[Rule]", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], "}"}], ",", "9"}], "]"}]}], "]"}]}], 
     "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.712830773527231*^9, 3.7128309192395477`*^9}, {
   3.712833495665552*^9, 3.712833508713584*^9}, {3.71283357008792*^9, 
   3.7128335976910353`*^9}, {3.71283534408328*^9, 3.712835344330735*^9}, {
   3.7128355335133457`*^9, 3.7128355336799107`*^9}, 3.712837005757556*^9, 
   3.712837065836936*^9, 3.712838456858864*^9, {3.712838505922365*^9, 
   3.712838551215933*^9}, {3.7128418281986103`*^9, 3.712841828216846*^9}, {
   3.712842173539816*^9, 3.712842173548656*^9}, {3.712847966278987*^9, 
   3.7128479662996902`*^9}, {3.712905307583363*^9, 3.712905307739265*^9}, 
   3.713449834593012*^9, {3.713600697627223*^9, 3.7136007092075443`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"DZSET", "[", "zeq", "]"}], "//", "Simplify"}], "//", 
   RowBox[{"MatrixForm", "\[IndentingNewLine]", 
    RowBox[{"Chop", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DZSET", "[", "z", "]"}], ".", 
          RowBox[{"Z", "[", 
           RowBox[{"z", ",", "u"}], "]"}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"z", "\[Rule]", " ", 
           RowBox[{"zl", "[", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "30"}], "]"}], 
            "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", 
            ",", "m2", ",", "d1", ",", "d2", ",", "Jxx1", ",", "Jyy1", ",", 
            "Jzz1", ",", "Jxx2", ",", "Jyy2", ",", "Jzz2"}], "}"}], "\[Rule]",
           " ", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "10"}], "}"}], ",", "15"}], "]"}]}], "]"}]}], "/.",
        "\[IndentingNewLine]", 
       RowBox[{"Thread", "[", 
        RowBox[{"u", "\[Rule]", " ", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}], ",", "6"}], "]"}]}], "]"}]}], "/.",
       "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "kpr1x", ",", "kpr1y", ",", "kpr1z", ",", "kpr2x", ",", "kpr2y", ",",
           "kpr2z"}], "}"}], "\[Rule]", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10", ",", "10"}], "}"}], ",", "6"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7128367238525352`*^9, 3.7128367415391207`*^9}, {
   3.712836869667871*^9, 3.712836915048229*^9}, {3.7128375485905523`*^9, 
   3.7128375790761337`*^9}, {3.712844098266749*^9, 3.712844107303217*^9}, 
   3.7128483939830112`*^9, 3.7134497807344418`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["determinant of matrix being inverted is positive", "Chapter",
 CellChangeTimes->{{3.713449796880292*^9, 3.7134498095432177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{
     RowBox[{"DZSET", "[", "zeq", "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"DZSET", "[", "zeq", "]"}], "]"}]}], "]"}], "//", "Simplify"}], 
  "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Det", "[", 
    RowBox[{
     RowBox[{"DZSET", "[", "zeq", "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"DZSET", "[", "zeq", "]"}], "]"}]}], "]"}], "-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["2", "5"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "d1", " ", "d2"}]}], ")"}]}], " ", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "+", "d2"}], ")"}], "2"]}]}], ")"}]}], ")"}], "2"]}],
   "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712833525463954*^9, 3.7128335553129683`*^9}, {
  3.712905108458235*^9, 3.712905203291492*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "4"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["1", "4"], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", "4"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          SuperscriptBox["d2", "2"]}], ")"}], " ", 
        SuperscriptBox["L1", "2"]}], 
       RowBox[{"12", "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"8", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["d2", "2"]}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d1", " ", "d2"}]}], ")"}], " ", "L1", " ", "L2"}], 
        RowBox[{"12", "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["d1", "2"]}], "-", 
         RowBox[{"8", " ", "d1", " ", "d2"}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["d2", "2"]}]}]]}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d1", " ", "d2"}]}], ")"}], " ", "L1", " ", "L2"}], 
        RowBox[{"12", "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["d1", "2"]}], "-", 
         RowBox[{"8", " ", "d1", " ", "d2"}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["d2", "2"]}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          SuperscriptBox["d1", "2"]}], ")"}], " ", 
        SuperscriptBox["L2", "2"]}], 
       RowBox[{"12", "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"8", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", "+", 
        SuperscriptBox["d2", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", 
        SuperscriptBox["L1", "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"1", "+", 
         RowBox[{"d1", " ", "d2"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L1", " ", "L2"}]]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"1", "+", 
         RowBox[{"d1", " ", "d2"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L1", " ", "L2"}]]}], 
      FractionBox[
       RowBox[{"2", "+", 
        SuperscriptBox["d1", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", 
        SuperscriptBox["L2", "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.712833536188715*^9, 3.712833555835596*^9}, 
   3.712839872868579*^9, 3.712844140362217*^9, 3.7128462283239317`*^9, 
   3.712847154070732*^9, 3.7128483990769463`*^9, 3.712853432245816*^9, 
   3.712853570449809*^9, 3.7128992138925867`*^9, {3.712905102611966*^9, 
   3.7129052047413473`*^9}, 3.712905313218721*^9, 3.712928201923765*^9, 
   3.712928305481811*^9, 3.712928974987455*^9, 3.7129297560771227`*^9, 
   3.712948728168977*^9, 3.712982053854125*^9, 3.712983014094935*^9, 
   3.71298815318546*^9, 3.713449785919264*^9, 3.713600592667281*^9, 
   3.713600675223144*^9, 3.713600715430771*^9, 3.7140294839910583`*^9, 
   3.714034020894039*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.712833536188715*^9, 3.712833555835596*^9}, 
   3.712839872868579*^9, 3.712844140362217*^9, 3.7128462283239317`*^9, 
   3.712847154070732*^9, 3.7128483990769463`*^9, 3.712853432245816*^9, 
   3.712853570449809*^9, 3.7128992138925867`*^9, {3.712905102611966*^9, 
   3.7129052047413473`*^9}, 3.712905313218721*^9, 3.712928201923765*^9, 
   3.712928305481811*^9, 3.712928974987455*^9, 3.7129297560771227`*^9, 
   3.712948728168977*^9, 3.712982053854125*^9, 3.712983014094935*^9, 
   3.71298815318546*^9, 3.713449785919264*^9, 3.713600592667281*^9, 
   3.713600675223144*^9, 3.713600715430771*^9, 3.7140294839910583`*^9, 
   3.714034020910132*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stability vector field term (only for analysis)", "Chapter",
 CellChangeTimes->{3.71344986719869*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ztilde", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", "n2y_", ",", 
      "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}],
      "}"}], "]"}], "=", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"DZSET", "[", "zeq", "]"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{
       RowBox[{"DZSET", "[", "zeq", "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"DZSET", "[", "zeq", "]"}], "]"}]}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"DZSET", "[", "z", "]"}], ".", 
        RowBox[{"Zcl", "[", "z", "]"}]}], "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"ZSET", "[", "z", "]"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Ztilde", "[", "z", "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z", "\[Rule]", " ", 
        RowBox[{"zl", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "30"}], "]"}], 
         "]"}]}], "]"}]}], "/.", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "gravity", ",", "m", ",", "J", ",", "L1", ",", "L2", ",", "m1", ",", 
         "m2", ",", "d1", ",", "d2", ",", "Jxx1", ",", "Jyy1", ",", "Jzz1", 
         ",", "Jxx2", ",", "Jyy2", ",", "Jzz2", ",", "mEstimate"}], "}"}], 
       "\[Rule]", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "10"}], "}"}], ",", "16"}], "]"}]}], "]"}]}], "/.",
     "\[IndentingNewLine]", 
    RowBox[{"Thread", "[", 
     RowBox[{"u", "\[Rule]", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10", ",", "10"}], "}"}], ",", "6"}], "]"}]}], "]"}]}], "/.",
    "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kpx1", ",", "kvx1", ",", "kpx2", ",", "kvx2", ",", "kpy1", ",", "kvy1",
        ",", "kpy2", ",", "kvy2", ",", "kpz1", ",", "kvz1", ",", "kpz2", ",", 
       "kvz2", ",", "kiz1", ",", "kiz2", ",", "kpr1x", ",", "kp\[Psi]1", ",", 
       "kp\[Psi]2", ",", "kv\[Psi]1", ",", "kv\[Psi]2", ",", "kpr1y", ",", 
       "kpr1z", ",", "kpr2x", ",", "kpr2y", ",", "kpr2z"}], "}"}], "\[Rule]", 
     " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "24"}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.712899224713998*^9, 3.7128994642065353`*^9}, {
  3.712983066539115*^9, 3.712983070285384*^9}, {3.7134498429103737`*^9, 
  3.713449851144709*^9}, {3.713600734075107*^9, 3.713600760397026*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0.`", ",", "0", ",", "0", ",", "0.`", ",", "0", ",", 
   "0", ",", "0.`", ",", "0", ",", "0", ",", "0.`", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712899264607069*^9, 3.712899384302148*^9, 3.712899417119483*^9, {
   3.712899452257107*^9, 3.712899462143915*^9}, 3.71290531927188*^9, 
   3.712928975969862*^9, 3.712929757074029*^9, 3.712948729177589*^9, 
   3.7129820548220778`*^9, 3.7129830152587757`*^9, 3.712983071640141*^9, 
   3.712988154263459*^9, 3.713449852822407*^9, 3.713600592983254*^9, 
   3.713600719553589*^9, 3.713600764086985*^9, 3.714029485450598*^9, 
   3.714034022286215*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Add stability vector field term", "Chapter",
 CellChangeTimes->{{3.713449871894384*^9, 3.713449888861031*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Z3", "[", 
    RowBox[{"{", 
     RowBox[{
     "px_", ",", "py_", ",", "pz_", ",", "nx_", ",", "ny_", ",", "nz_", ",", 
      "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_", ",", "p2y_", ",", "p2z_",
       ",", "n1x_", ",", "n1y_", ",", "n1z_", ",", "n2x_", ",", "n2y_", ",", 
      "n2z_", ",", "vx_", ",", "vy_", ",", "vz_", ",", "\[Omega]x_", ",", 
      "\[Omega]y_", ",", "\[Omega]z_", ",", "v1x_", ",", "v1y_", ",", "v1z_", 
      ",", "v2x_", ",", "v2y_", ",", "v2z_", ",", "\[Xi]1_", ",", "\[Xi]2_"}],
      "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Zcl", "[", "z", "]"}], " ", "+", 
    RowBox[{"Ztilde", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z3", "[", "zeq", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7128306909203444`*^9, 3.712830759328185*^9}, {
   3.712830924706766*^9, 3.712830925717293*^9}, {3.712830956070786*^9, 
   3.7128309634840307`*^9}, {3.7128310072591343`*^9, 3.712831039424521*^9}, {
   3.712833601773696*^9, 3.712833602403789*^9}, 3.712838619158235*^9, 
   3.7128418282364473`*^9, 3.712842173560626*^9, 3.712847966321644*^9, 
   3.7128992160626287`*^9, {3.712899474713931*^9, 3.71289948226154*^9}, {
   3.7134498572674303`*^9, 3.71344985855131*^9}, 3.713449891044877*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.712831033648622*^9, 3.712831037530973*^9}, 
   3.7128330843292828`*^9, 3.712833206667367*^9, 3.712833510118167*^9, 
   3.7128336028127413`*^9, 3.712835535438048*^9, 3.712837008116082*^9, 
   3.712837068641282*^9, 3.712838624729905*^9, 3.712839873574751*^9, 
   3.7128441524110203`*^9, 3.7128462296157513`*^9, 3.7128471546674557`*^9, 
   3.712848404945753*^9, 3.712853432731254*^9, 3.7128535709580317`*^9, {
   3.712899483543291*^9, 3.712899511490407*^9}, 3.7129289765542383`*^9, 
   3.712929757696146*^9, 3.71294872974405*^9, 3.7129820553181467`*^9, 
   3.712983015941577*^9, 3.71298307484315*^9, 3.712988155244772*^9, 
   3.713449892118478*^9, 3.713600593896145*^9, 3.71360076712624*^9, 
   3.714029486170163*^9, 3.714034023006749*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linearization matrix", "Chapter",
 CellChangeTimes->{{3.712043505293087*^9, 3.712043512378201*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"AS", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"ZS", "[", "z", "]"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z", "\[Rule]", " ", "zeq"}], "]"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"AS", "//", "MatrixForm"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7128313097312*^9, 3.7128313101678753`*^9}, {
   3.712831440020103*^9, 3.712831473193467*^9}, {3.71283394564575*^9, 
   3.712833946567602*^9}, 3.713449903401479*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[CapitalLambda]S", ",", "PS"}], "}"}], "=", 
    RowBox[{"Eigensystem", "[", "AS", "]"}]}], ";", "\[IndentingNewLine]", 
   "\[CapitalLambda]S"}], "*)"}]], "Input",
 CellChangeTimes->{{3.712833927400133*^9, 3.712833932448642*^9}, 
   3.712833978439855*^9, {3.713449917028306*^9, 3.7134499311672573`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ANS", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Zcl", "[", "z", "]"}], "-", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"DZSET", "[", "zeq", "]"}], "]"}], ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{"DZSET", "[", "zeq", "]"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"DZSET", "[", "zeq", "]"}], "]"}]}], "]"}], ".", 
          RowBox[{"DZSET", "[", "z", "]"}], ".", 
          RowBox[{"Zcl", "[", "z", "]"}]}]}], " ", ",", 
        RowBox[{"{", "z", "}"}]}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"z", "\[Rule]", " ", "zeq"}], "]"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DZSET", "[", "zeq", "]"}], ".", "ANS"}], "//", "Simplify"}]}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Z3", "[", "z", "]"}], ",", 
         RowBox[{"{", "z", "}"}]}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"z", "\[Rule]", " ", "zeq"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"gravity", ">", "0"}], " ", "&&", " ", 
       RowBox[{"M", ">", "0"}], "&&", 
       RowBox[{"m", ">", "0"}], "&&", " ", 
       RowBox[{"m1", ">", "0"}], " ", "&&", " ", 
       RowBox[{"m2", " ", ">", "0"}], " ", "&&", 
       RowBox[{"d1", "<", "0"}], "&&", 
       RowBox[{"d2", ">", " ", "0"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"A", "//", "MatrixForm"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.697868867188023*^9, 3.6978689376077003`*^9}, {
   3.697869060394891*^9, 3.69786908876962*^9}, {3.697869212884316*^9, 
   3.697869213358185*^9}, 3.6978696398213882`*^9, {3.7120435302538643`*^9, 
   3.712043574075939*^9}, {3.7120586109226303`*^9, 3.712058665942432*^9}, 
   3.7121171172300262`*^9, 3.7121171955136642`*^9, {3.7128309364076567`*^9, 
   3.712830945753442*^9}, {3.712831046926709*^9, 3.712831053689604*^9}, {
   3.7128443618047132`*^9, 3.7128444153504763`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Similarity matrix", "Chapter",
 CellChangeTimes->{{3.697869293982729*^9, 3.697869298807856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"meaning", " ", "of", " ", 
    RowBox[{"sum", "/", "difference"}], " ", "of", " ", "integrals", " ", 
    "can", " ", "only", " ", "be", " ", "understood", " ", "after", " ", "a", 
    " ", "coordinate", " ", "transformation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "i_", "]"}], ":=", 
     RowBox[{"UnitVector", "[", 
      RowBox[{"32", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", "31", "]"}], "+", 
          RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "A", ".", 
        "z"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
         RowBox[{"d2", "\[Rule]", " ", 
          RowBox[{"-", "d"}]}], ",", 
         RowBox[{"\[Lambda]", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
      RowBox[{
       RowBox[{"Simplify", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", "[", "32", "]"}], "-", 
           RowBox[{"e", "[", "31", "]"}]}], ")"}], ".", "A", ".", "A", ".", 
         "z"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d1", "\[Rule]", " ", "1"}], ",", 
         RowBox[{"d2", "\[Rule]", " ", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"\[Lambda]", "\[Rule]", " ", "0"}]}], "}"}]}]}], "//", 
     "Simplify"}]}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.712945556575392*^9, 3.712945652838678*^9}, {
  3.712945862112567*^9, 3.712945865940085*^9}, {3.7129459400492373`*^9, 
  3.712945948559615*^9}, {3.712982294946391*^9, 3.712982295476671*^9}, {
  3.7134499884868307`*^9, 3.7134500466761*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i_", "]"}], ":=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{"32", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PP", " ", "=", " ", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["d2", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
            RowBox[{"e", "[", "31", "]"}]}], "-", " ", 
           RowBox[{
            FractionBox["d1", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
            RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["d2", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
             RowBox[{"e", "[", "31", "]"}]}], "-", " ", 
            RowBox[{
             FractionBox["d1", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
             RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "A"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["d2", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
             RowBox[{"e", "[", "31", "]"}]}], "-", " ", 
            RowBox[{
             FractionBox["d1", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}]], " ", 
             RowBox[{"e", "[", "32", "]"}]}]}], ")"}], ".", "A", ".", "A"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}], ")"}]], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"e", "[", "31", "]"}], "-", " ", 
            RowBox[{"e", "[", "32", "]"}]}], ")"}]}], ",", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}], ")"}]], 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"e", "[", "31", "]"}], "-", " ", 
             RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A"}]}], ",", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}], ")"}]], 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"e", "[", "31", "]"}], "-", " ", 
             RowBox[{"e", "[", "32", "]"}]}], ")"}], ".", "A", ".", "A"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ".", "A", ".", "A", ".", "A", ".", 
          "A"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", "[", "7", "]"}], "-", 
          RowBox[{"e", "[", "10", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "[", "7", "]"}], "-", 
            RowBox[{"e", "[", "10", "]"}]}], ")"}], ".", "A"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "[", "7", "]"}], "-", 
            RowBox[{"e", "[", "10", "]"}]}], ")"}], ".", "A", ".", "A"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ".", "A", ".", "A", ".", "A", ".", 
          "A"}], ",", "\[IndentingNewLine]", 
         RowBox[{"e", "[", "5", "]"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "5", "]"}], ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "5", "]"}], ".", "A", ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "5", "]"}], ".", "A", ".", "A", ".", "A"}], ",", 
         RowBox[{
          RowBox[{"e", "[", "5", "]"}], ".", "A", ".", "A", ".", "A", ".", 
          "A"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DZSET", "[", "zeq", "]"}]}], "\[IndentingNewLine]", "]"}], "//",
      "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "PP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"PP", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQnXduVsSJnteOP2bezgXRJuaWJSD6TolgKYjedv58
FYi++SayFkTHXJ7WCKJnLFsFpn8YL5oKoq2Ko2eDaIZTLntBdMTs34dBdCbv
UzuF3teOtu5+jiCaid/bFUQ7N5hngOgJcy2Xgmi2SdOXgegITR9vzRWvHR2P
l4eDaAXzM+dWrnztWGD/C0ybze+5CqIvhX+7BqIfXP51Gyzfcfc+iH5f1Ki4
Gkiv3mekDKL/2VhpgOhtHwL0QfQ5Dik7ED3hhzWYtlRnNl8DpJvUpK1A9IHz
K+xBtNLbC04g2qW6bzmIfvDl/GoQfXG9c+AGIF2+8GwUiFZ7rTINREsYnF0M
Ftd/57YJSDtppgWA6KUK7j4PgfSi+zt8QfSJB4cqvgHpjLxt1SB6l9gZjhur
XjuaBr0D0wANjN4F
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32", ",", "32"}], "}"}]], "Output",
 CellChangeTimes->{{3.712833886692034*^9, 3.712833915867976*^9}, {
   3.712834027895306*^9, 3.7128340343968782`*^9}, 3.712835558890874*^9, 
   3.712836049695063*^9, 3.7128361195726757`*^9, 3.712836959145611*^9, 
   3.712837026931858*^9, 3.712837117245376*^9, 3.71283866988132*^9, 
   3.712839912164576*^9, 3.71284450311637*^9, {3.712845040572978*^9, 
   3.7128450897987423`*^9}, 3.7128462823618193`*^9, 3.7128472067998962`*^9, 
   3.712848474170609*^9, 3.712848518059503*^9, 3.712853477176382*^9, 
   3.7128536139351873`*^9, 3.71289960570595*^9, 3.712929062567473*^9, 
   3.712929844086401*^9, 3.71294320513054*^9, 3.712944752366617*^9, 
   3.712948829819803*^9, 3.712982299670187*^9, 3.712983174784028*^9, 
   3.712988263547311*^9, 3.713450057294711*^9, 3.713450853742062*^9, 
   3.713600833297285*^9, 3.714029547918064*^9, 3.714034088987575*^9}],

Cell[BoxData["32"], "Output",
 CellChangeTimes->{{3.712833886692034*^9, 3.712833915867976*^9}, {
   3.712834027895306*^9, 3.7128340343968782`*^9}, 3.712835558890874*^9, 
   3.712836049695063*^9, 3.7128361195726757`*^9, 3.712836959145611*^9, 
   3.712837026931858*^9, 3.712837117245376*^9, 3.71283866988132*^9, 
   3.712839912164576*^9, 3.71284450311637*^9, {3.712845040572978*^9, 
   3.7128450897987423`*^9}, 3.7128462823618193`*^9, 3.7128472067998962`*^9, 
   3.712848474170609*^9, 3.712848518059503*^9, 3.712853477176382*^9, 
   3.7128536139351873`*^9, 3.71289960570595*^9, 3.712929062567473*^9, 
   3.712929844086401*^9, 3.71294320513054*^9, 3.712944752366617*^9, 
   3.712948829819803*^9, 3.712982299670187*^9, 3.712983174784028*^9, 
   3.712988263547311*^9, 3.713450057294711*^9, 3.713450853742062*^9, 
   3.713600833297285*^9, 3.714029547918064*^9, 3.714034089103052*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["d2", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "0", "0", 
      FractionBox["d1", 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["d1", "2"], "+", 
          SuperscriptBox["d2", "2"]}], ")"}], " ", "\[Lambda]"}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "+", "d2"}], ")"}], " ", "\[Lambda]"}], 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d1", "2"]}], "-", 
         RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d2", "2"]}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "+", 
          RowBox[{"2", " ", "d2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2"}], "+", 
          SuperscriptBox["d2", "3"]}], ")"}], " ", "\[Lambda]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}]}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d1", "3"], "+", "d2", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["d2", "2"]}], ")"}]}]}], ")"}], " ", 
         "\[Lambda]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"]}]}], ")"}]}]]}], "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"1", "+", 
        SuperscriptBox["d1", "2"], "+", 
        SuperscriptBox["d2", "2"]}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", 
      FractionBox[
       RowBox[{"d1", "+", "d2"}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0", "0", 
      FractionBox[
       RowBox[{"1", "-", 
        RowBox[{"d1", " ", "d2"}], "+", 
        SuperscriptBox["d2", "2"]}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0", 
      FractionBox[
       RowBox[{"1", "+", 
        SuperscriptBox["d1", "2"], "-", 
        RowBox[{"d1", " ", "d2"}]}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], 
      FractionBox["1", 
       RowBox[{"d1", "-", "d2"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "d1"}], "+", "d2"}]], "0", "0", 
      FractionBox["1", 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "+", "d2"}], ")"}], " ", "\[Lambda]"}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "\[Lambda]"}], 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d1", "2"]}], "-", 
         RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d2", "2"]}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"d1", " ", "d2"}], "+", 
          SuperscriptBox["d2", "2"]}], ")"}], " ", "\[Lambda]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}]}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "+", 
           SuperscriptBox["d1", "2"], "+", 
           RowBox[{"d1", " ", "d2"}]}], ")"}], " ", "\[Lambda]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"]}]}], ")"}]}]]}], "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", "+", "d2"}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", 
      FractionBox["3", 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1"}], "+", "d2"}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0", 
      FractionBox[
       RowBox[{"d1", "-", 
        RowBox[{"2", " ", "d2"}]}], 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "2"]}], "-", 
        RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["d2", "2"]}]}]], "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "gravity", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L1"}], "+", "L2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], "0", "0", 
      
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d2", " ", "gravity"}], 
        RowBox[{
         RowBox[{"d1", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "L1"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "gravity"}], 
       RowBox[{
        RowBox[{"d1", " ", "L2"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "\[Lambda]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "gravity", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d2", " ", "gravity"}], 
        RowBox[{
         RowBox[{"d1", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "L1"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "gravity"}], 
       RowBox[{
        RowBox[{"d1", " ", "L2"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "L1", " ", "L2", 
           " ", "m1", " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           SuperscriptBox["L2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", 
           SuperscriptBox["L1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", "L2", " ", "m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "L1"}], " ", "m1"}], "+", 
                RowBox[{"L2", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"L1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", 
              SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"d1", " ", "L1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "L2"}], " ", "m2"}], "+", 
                RowBox[{"L1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"L2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2", " ", 
              SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d2", " ", 
         SuperscriptBox["gravity", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "L1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "L2", " ", "m1"}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", 
         SuperscriptBox["gravity", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "L2", " ", "m2"}], "+", 
           RowBox[{"d1", " ", "L1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d2", " ", 
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "m1"}]], 
      "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", 
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L2", " ", "m2"}]], 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "+", 
         
         RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], "0",
       "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
         "d1", " ", "d2", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], 
         "+", 
         RowBox[{
         "d1", " ", "d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
        
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], "0",
       "0", 
      FractionBox[
       RowBox[{"d2", " ", "gravity", " ", "m"}], 
       RowBox[{
        RowBox[{"d1", " ", "L1", " ", "m1"}], "-", 
        RowBox[{"d2", " ", "L1", " ", "m1"}]}]], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "gravity", " ", "m"}], 
       RowBox[{
        RowBox[{"d1", " ", "L2", " ", "m2"}], "-", 
        RowBox[{"d2", " ", "L2", " ", "m2"}]}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "m2"}]]}], "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "gravity", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L1"}], "+", "L2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], "0", "0", 
      
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d2", " ", "gravity"}], 
        RowBox[{
         RowBox[{"d1", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "L1"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "gravity"}], 
       RowBox[{
        RowBox[{"d1", " ", "L2"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "gravity", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L1"}], "+", "L2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d2", " ", "gravity"}], 
        RowBox[{
         RowBox[{"d1", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "L1"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "gravity"}], 
       RowBox[{
        RowBox[{"d1", " ", "L2"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "J", " ", "L1", " ",
            "L2", " ", "m1", " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", "J", " ", 
           SuperscriptBox["L2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m", " ", "m2"}],
              "+", 
             RowBox[{"J", " ", 
              SuperscriptBox["L1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", "m1", 
           " ", "m2"}], "+", 
          RowBox[{"d2", " ", "J", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "m1"}], "+", 
             RowBox[{"L2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", "L1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m2"}], "+", 
             RowBox[{"J", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "L2"}], " ", "m2"}], "+", 
                RowBox[{"L1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d2", " ", 
         SuperscriptBox["gravity", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "J", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", 
               "m1"}], "+", 
              RowBox[{"J", " ", "L2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", 
         SuperscriptBox["L1", "2"], " ", "L2", " ", "m1"}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", 
         SuperscriptBox["gravity", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d2"}], " ", "J", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m2"}], "+", 
              
              RowBox[{"J", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d2", " ", 
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "m1"}]], 
      "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", 
        SuperscriptBox["gravity", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L2", " ", "m2"}]], 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "L1"}], "+", 
          RowBox[{"d1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m"}], 
        RowBox[{
         RowBox[{"d1", " ", "J", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "J", " ", "L1"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m"}], 
       RowBox[{
        RowBox[{"d1", " ", "J", " ", "L2"}], "-", 
        RowBox[{"d2", " ", "J", " ", "L2"}]}]], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "L1"}], "+", 
          RowBox[{"d1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m"}], 
        RowBox[{
         RowBox[{"d1", " ", "J", " ", "L1"}], "-", 
         RowBox[{"d2", " ", "J", " ", "L1"}]}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m"}], 
       RowBox[{
        RowBox[{"d1", " ", "J", " ", "L2"}], "-", 
        RowBox[{"d2", " ", "J", " ", "L2"}]}]], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        SuperscriptBox["gravity", "2"], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", "m1", 
           " ", "m2"}], "+", 
          RowBox[{"d2", " ", "J", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "m1"}], "+", 
             RowBox[{"L2", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", "L1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m2"}], "+", 
             RowBox[{"J", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "L2"}], " ", "m2"}], "+", 
                RowBox[{"L1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        SuperscriptBox["J", "2"], " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], "0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d1", "2"], " ", 
        SuperscriptBox["d2", "2"], " ", 
        SuperscriptBox["gravity", "2"], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d2", " ", "L1"}], "-", 
              RowBox[{"d1", " ", "L2"}]}], ")"}], "2"], " ", "m", " ", "m1", 
           " ", "m2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "L1", " ", "L2", " ", "m1", " ", 
              "m2"}], "+", 
             RowBox[{
              SuperscriptBox["L2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
             RowBox[{
              SuperscriptBox["L1", "2"], " ", "m1", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        SuperscriptBox["J", "2"], " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", 
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["gravity", "2"], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d2"}], " ", "L1"}], "+", 
              RowBox[{"d1", " ", "L2"}]}], ")"}], " ", "m", " ", "m1"}], "+", 
           
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "L1"}], " ", "m1"}], "+", 
              RowBox[{"L2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
         SuperscriptBox["J", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "L2", " ", "m1"}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         SuperscriptBox["gravity", "2"], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d2", " ", "L1"}], "-", 
              RowBox[{"d1", " ", "L2"}]}], ")"}], " ", "m", " ", "m2"}], "+", 
           
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "L2"}], " ", "m2"}], "+", 
              RowBox[{"L1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
         SuperscriptBox["J", "2"], " ", "L1", " ", 
         SuperscriptBox["L2", "2"], " ", "m2"}]]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", 
         SuperscriptBox["gravity", "2"], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "-", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         "m1"}]]}], "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        SuperscriptBox["gravity", "2"], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L2", " ", 
        "m2"}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["2", "L1"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d1"}], "L1"]}], "0", "0", 
      FractionBox["2", "L1"], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["2", "L2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "d2"}], "L2"]}], "0", "0", "0", "0", "0", 
      FractionBox["2", "L2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "L1"}], "0", 
      RowBox[{"d1", " ", "L1"}], "0", "0", "0", "L1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "L2"}], "0", 
      RowBox[{"d2", " ", "L2"}], "0", "0", "0", "0", "0", "0", "L2", "0", 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.712833886692034*^9, 3.712833915867976*^9}, {
   3.712834027895306*^9, 3.7128340343968782`*^9}, 3.712835558890874*^9, 
   3.712836049695063*^9, 3.7128361195726757`*^9, 3.712836959145611*^9, 
   3.712837026931858*^9, 3.712837117245376*^9, 3.71283866988132*^9, 
   3.712839912164576*^9, 3.71284450311637*^9, {3.712845040572978*^9, 
   3.7128450897987423`*^9}, 3.7128462823618193`*^9, 3.7128472067998962`*^9, 
   3.712848474170609*^9, 3.712848518059503*^9, 3.712853477176382*^9, 
   3.7128536139351873`*^9, 3.71289960570595*^9, 3.712929062567473*^9, 
   3.712929844086401*^9, 3.71294320513054*^9, 3.712944752366617*^9, 
   3.712948829819803*^9, 3.712982299670187*^9, 3.712983174784028*^9, 
   3.712988263547311*^9, 3.713450057294711*^9, 3.713450853742062*^9, 
   3.713600833297285*^9, 3.714029547918064*^9, 3.714034089182616*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
State matrix after similarity transformation (check block triangular \
structure)\
\>", "Chapter",
 CellChangeTimes->{
  3.6784537446066513`*^9, {3.678455413121221*^9, 3.678455417246153*^9}, {
   3.713450070240844*^9, 3.713450102188195*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Asimilar", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"PP", ".", "A", ".", 
      RowBox[{"Inverse", "[", "PP", "]"}]}], ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Asimilar", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.697870154197797*^9, 3.697870195485117*^9}, {
   3.6978769698458157`*^9, 3.697876983490487*^9}, {3.712043719281135*^9, 
   3.712043720155946*^9}, 3.7121172262676287`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kiz1"}], "+", 
            RowBox[{"d1", " ", "kiz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kiz1", " ", "m1"}], "+", 
            RowBox[{"kiz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kpz1"}], "+", 
            RowBox[{"d1", " ", "kpz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kpz1", " ", "m1"}], "+", 
            RowBox[{"kpz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d2"}], " ", "kvz1"}], "+", 
            RowBox[{"d1", " ", "kvz2"}]}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kvz1", " ", "m1"}], "+", 
            RowBox[{"kvz2", " ", "m2"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
         RowBox[{
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kiz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kiz1"}], "+", "kiz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kiz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kiz1", "-", "kiz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kpz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kpz1"}], "+", "kpz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kpz1", "-", "kpz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "J", " ", "kvz2", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "kvz1"}], "+", "kvz2"}], ")"}], " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kvz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz1", "-", "kvz2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", 
         SuperscriptBox["d2", "4"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "+", 
           RowBox[{"L1", " ", 
            SuperscriptBox["m1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz1", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "5"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "-", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "kvz1", " ", "m1"}], "-", 
              RowBox[{"kvz2", " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
               "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"d1", " ", 
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "m2"}], ")"}]}], "-", "m2"}], ")"}]}], 
              "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz1", " ", "m1"}], "+", 
                 RowBox[{"kvz2", " ", "m2"}]}], ")"}]}], "+", 
              RowBox[{"m2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", "kvz1", " ", "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d1", "2"]}]}], ")"}], " ", "kvz2", " ", 
                  "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "-", 
                    RowBox[{"3", " ", "m1"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d1", "2"], " ", "m1"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m2"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["d1", "2"]}], ")"}]}], " ", "kvz1", " ", 
               "m1", " ", "m2"}], "-", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "kvz2", " ", "m1", " ", "m2"}],
               "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m", " ", "m1", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "m", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m", " ", "m2", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "m1", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d1", "2"], " ", "m1", " ", "m2", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "m1"}], "+", 
                 "m2"}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "kvz1", " ", "m1"}], "+", 
                 RowBox[{"kvz2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m2", "-", 
                    RowBox[{
                    SuperscriptBox["d1", "2"], " ", "m2"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"2", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "kvz1", " ", "m2"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "kvz2", " ", 
                  "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "m"}], "+", 
                    RowBox[{
                    SuperscriptBox["d1", "2"], " ", "m2"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d1", "4"], " ", "d2", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m2", "2"]}], ")"}]}], "+", 
           RowBox[{"L2", " ", 
            SuperscriptBox["m2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"kvz2", "-", "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], 
          ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "5"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m2", "2"]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d2", " ", "L2", " ", "m2", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{"2", " ", "kvz2", " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
               "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "-", "m2"}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 SuperscriptBox["d2", "2"]}], ")"}], " ", "m1", " ", "m2"}], 
              "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz1"}], " ", "m1", " ", "m2"}], "-", 
                 RowBox[{"kvz2", " ", "m1", " ", "m2"}], "+", 
                 RowBox[{"m", " ", "m1", " ", "\[Lambda]"}], "+", 
                 RowBox[{"m", " ", "m2", " ", "\[Lambda]"}], "+", 
                 RowBox[{"2", " ", "m1", " ", "m2", " ", "\[Lambda]"}]}], 
                ")"}]}], "+", 
              RowBox[{"2", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
                ")"}]}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m2"}]}], 
                ")"}]}]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "m2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}]}], " ", "kvz1", " ", 
                  "m1"}], "-", 
                 RowBox[{"2", " ", "kvz2", " ", "m1"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", "m1"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m1", "-", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", "m1"}]}], ")"}]}], "-", 
                 RowBox[{"2", " ", "kvz2", " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"2", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "-", "m2"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", "m1"}], ")"}]}], "-", "m1"}], ")"}], " ",
                "m2"}]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz1", " ", "m1"}], "+", 
                 RowBox[{"kvz2", " ", "m2"}]}], ")"}]}], "+", 
              RowBox[{"m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"]}]}], ")"}], " ", "kvz1", " ", 
                  "m2"}], "+", 
                 RowBox[{"4", " ", "kvz2", " ", "m2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "-", 
                    RowBox[{"3", " ", "m2"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "d2", " ", "kvz1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "3"], " ", "kvz1"}], "+", 
           RowBox[{"d1", " ", "kvz2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", "kvz2"}]}], ")"}], " ",
          "m1", " ", "m2"}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               SuperscriptBox["d2", "2"]}], ")"}]}], " ", "kvz1", " ", "m1"}],
            "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"d1", " ", "d2"}]}], ")"}], " ", "kvz2", " ", "m2"}]}], 
          ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "kvz1"}], "+", 
           RowBox[{"d1", " ", 
            SuperscriptBox["d2", "2"], " ", "kvz1"}], "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["d1", "2"]}], ")"}], " ", "kvz2"}]}], ")"}], " ",
          "m1", " ", "m2"}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kvz1", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", 
              RowBox[{"d1", " ", "d2", " ", "m1"}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["d1", "2"]}], ")"}], " ", "kvz2", " ", "m2"}]}], 
          ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kiz1"}], " ", "m1"}], "+", 
           RowBox[{"kiz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kiz2"}], " ", "m2"}], "+", 
           RowBox[{"kiz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz1"}], " ", "m1"}], "+", 
           RowBox[{"kpz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpz2"}], " ", "m2"}], "+", 
           RowBox[{"kpz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
           RowBox[{"kvz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
           RowBox[{"kvz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kiz1", "+", "kiz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kiz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kiz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kpz1", "+", "kpz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{"kvz1", "+", "kvz2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kvz2", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kvz1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}]], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "m2"}], "-", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", "m2"}], "-", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "J", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "L1", " ", 
         SuperscriptBox["m1", "2"], " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], ")"}]}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "4"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz1"}], " ", "m1"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", "m1", " ", "m2"}], "-", 
              RowBox[{"2", " ", "J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "m1"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d2", "2"], " ", "m1"}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m1"}]}], ")"}], 
               " ", "m2"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz1", " ", "m1", 
               " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "m2"}]}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", "m1"}], ")"}]}], "-", 
                    RowBox[{"6", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
                 RowBox[{"J", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ",
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "m1", " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz1", " ", "m1", " ", "m2"}], "-", 
              RowBox[{"kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
                 RowBox[{"J", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ",
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz2", " ", "m2"}], "+", 
              RowBox[{"2", " ", "kvz1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}], "-", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "gravity", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m2"}], ")"}]}], "+", 
              RowBox[{"L1", " ", "\[Lambda]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kvz2"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", 
                    RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
                 RowBox[{"kvz1", " ", "m1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
                 RowBox[{"m1", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", "\[Lambda]"}], 
           "-", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "m2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz1", " ", "m1"}], "+", 
              RowBox[{"2", " ", "kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}], "-", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "-", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "-", 
              RowBox[{"kvz1", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
              RowBox[{"m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "4"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m2", "2"]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kvz2"}], " ", "m2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"2", " ", "J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "kvz2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
              RowBox[{"kvz1", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m2"}]}], 
                ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "m1"}], "+", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], 
                 "+", 
                 RowBox[{"J", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ",
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "m1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m1"}], ")"}]}]}], ")"}], " ", 
               "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "kvz2", " ", "m1", " ", "m2"}], "+", 
              RowBox[{"kvz1", " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2"}]}], 
                ")"}]}], "+", 
              RowBox[{"J", " ", "m", " ", "\[Lambda]"}], "+", 
              RowBox[{"J", " ", "m1", " ", "\[Lambda]"}], "+", 
              RowBox[{"3", " ", "m", " ", "m1", " ", "\[Lambda]"}], "+", 
              RowBox[{"J", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{"3", " ", "m1", " ", "m2", " ", "\[Lambda]"}], "-", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "m2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kvz2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m1"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "kvz2", " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz1", " ", "m1"}], 
           "+", 
           RowBox[{"kvz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kvz2", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "-", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
           
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d1", "3"]}], " ", "kvz2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kvz1", " ", "m1"}], "+", 
           RowBox[{"2", " ", "kvz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kvz2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "-", 
           RowBox[{"kvz1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kvz2", " ", "m2"}], "+", 
           RowBox[{"kvz1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2", "-", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kpx2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kpx1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kvx2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kvx1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"kpr1", "+", "kpr2"}], ")"}]}], "+", 
           RowBox[{"kpr2", " ", "kpx2", " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "kpx1", " ", "L2"}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr1", " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpr2", " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpx2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity"}], "+", 
           RowBox[{"kpr2", " ", "kvx2", " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "kvx1", " ", "L2"}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr1", " ", "kvx1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr2", " ", "kvx2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr2", " ", "L1"}], "+", 
        RowBox[{"d2", " ", "kpr1", " ", "L2"}]}], 
       RowBox[{
        RowBox[{"d1", " ", "L1"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "kpr1", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kpx1"}], "-", 
                 RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L1", " ", 
               "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "L1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "kpr2", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
                 RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L2", " ", 
               "m2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kvx1"}], "-", 
                 RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L1", " ", 
               "m1"}]}], ")"}], " ", "m2"}], "+", 
           RowBox[{"d1", " ", "L1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", "m"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
                 RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L2", " ", 
               "m2"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}]}]], "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", "L2", " ", "m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"kpr1", "-", "\[Lambda]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["\[Lambda]", "3"]}], "+", 
                RowBox[{"kpr1", " ", 
                 RowBox[{"(", 
                  RowBox[{"kpx1", "-", 
                   RowBox[{"kvx1", " ", "\[Lambda]"}], "+", 
                   SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"d1", " ", "L1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"kpr2", "-", "\[Lambda]"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Lambda]", "3"], "-", 
                RowBox[{"kpr2", " ", 
                 RowBox[{"(", 
                  RowBox[{"kpx2", "-", 
                   RowBox[{"kvx2", " ", "\[Lambda]"}], "+", 
                   SuperscriptBox["\[Lambda]", "2"]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
       RowBox[{"kpr2", " ", "kpx2"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
       RowBox[{"kpr2", " ", "kvx2"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpx1"}], "-", 
              RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L1", " ", "m1"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr2"}], " ", "m1"}], "+", 
              RowBox[{"kpr1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
         "m2"}], "+", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kpx1"}], "+", 
              RowBox[{"kpr2", " ", "kpx2"}]}], ")"}], " ", "L2", " ", "m2"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "m2"}], "+", 
              RowBox[{"kpr2", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvx1"}], "-", 
              RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kvx1"}], "+", 
              RowBox[{"kpr2", " ", "kvx2"}]}], ")"}], " ", "L2", " ", 
            "m2"}]}], ")"}]}]}], 
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"kpr1", "-", "kpr2"}], ")"}], " ", "L1", " ", "L2"}], 
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d1", "2"]}], " ", "kpr1", " ", "kpx1", " ", "L1", 
         " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr2", " ", "kpx2", " ", "L2", " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpx1", " ", "L1"}], "+", 
              RowBox[{"kpr2", " ", "kpx2", " ", "L2"}]}], ")"}], " ", "m1", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr2", " ", "m1"}], "+", 
              RowBox[{"kpr1", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d1", "2"]}], " ", "kpr1", " ", "kvx1", " ", "L1", 
         " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr2", " ", "kvx2", " ", "L2", " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvx1", " ", "L1"}], "+", 
              RowBox[{"kpr2", " ", "kvx2", " ", "L2"}]}], ")"}], " ", "m1", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr1", " ", "L1"}], "+", 
        RowBox[{"d2", " ", "kpr2", " ", "L2"}]}], 
       RowBox[{
        RowBox[{"d1", " ", "L1"}], "-", 
        RowBox[{"d2", " ", "L2"}]}]], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gravity", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kpr2"}], " ", "m1"}], "-", 
             RowBox[{"kpr1", " ", "m2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
            ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kpr1", " ", 
              RowBox[{"(", 
               RowBox[{"kpx1", "+", 
                RowBox[{"\[Lambda]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "kvx1"}], "+", "\[Lambda]"}], ")"}]}]}], 
               ")"}]}], "-", 
             RowBox[{"kpr2", " ", 
              RowBox[{"(", 
               RowBox[{"kpx2", "+", 
                RowBox[{"\[Lambda]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "kvx2"}], "+", "\[Lambda]"}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m1", " ", "m2"}]], "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kpy2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kpy1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "kpr2", " ", "kvy2", " ", "L1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr1", " ", "kvy1", " ", "L2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "kpr2", " ", "L1"}], "+", 
           RowBox[{"gravity", " ", "kpr1", " ", "L2"}], "+", 
           RowBox[{"kpr1", " ", "kpy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{"kpr2", " ", "kpy2", " ", "L1", " ", "L2"}]}], ")"}], " ", 
         "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "kpr1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpy1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "kpr2", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpy2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2"}], 
           "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}]}]}], ")"}], " ", "m1", " ", 
         "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr1", " ", "kvy1", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kpr2", " ", "kvy2", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "kpr1"}], "-", 
        RowBox[{"d1", " ", "kpr2"}]}], 
       RowBox[{"d1", "-", "d2"}]], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kpr1", " ", 
           RowBox[{"(", 
            RowBox[{"kpy1", "-", 
             RowBox[{"kp\[Psi]1", " ", "L1"}]}], ")"}], " ", "L2"}], "+", 
          RowBox[{"kpr2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kpy2"}], " ", "L1"}], "+", 
             RowBox[{"kp\[Psi]2", " ", "L1", " ", "L2"}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kpr1", " ", 
           RowBox[{"(", 
            RowBox[{"kvy1", "-", 
             RowBox[{"kv\[Psi]1", " ", "L1"}]}], ")"}], " ", "L2"}], "+", 
          RowBox[{"kpr2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "kvy2"}], " ", "L1"}], "+", 
             RowBox[{"kv\[Psi]2", " ", "L1", " ", "L2"}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kpr2"}], " ", "L1"}], "+", 
           RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m", " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "kpr1", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpy1"}], "-", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kpy1"}], "+", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpr2", " ", "L1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr2", " ", "L1"}], "-", 
                 RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m2"}]}], 
             ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "-", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", 
            "m1"}]}], ")"}], " ", "m2"}], "+", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "kpr1"}], " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "L1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "L1", " ", "L2", " ", 
        "m", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{"J", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "kpr1"}], "+", "kpr2"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "m"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "kpr2"}], " ", "kpy2", " ", "L1"}], "+", 
          RowBox[{"kpr1", " ", "kpy1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "kpr2"}], " ", "kvy2", " ", "L1"}], "+", 
          RowBox[{"kpr1", " ", "kvy1", " ", "L2"}]}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2"}]], 
      
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kpy1"}], "-", 
                 RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr2"}], " ", "L1", " ", "m1"}], "+", 
                 RowBox[{"kpr1", " ", "L2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ",
             "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kpy1"}], "+", 
                 RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "L2", " ", "m2"}], "+", 
                 RowBox[{"kpr2", " ", "L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         "L2", " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kpr1", " ", "kvy1"}], "-", 
                 RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m1"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L1"}], " ", "m1"}], "+", 
                 RowBox[{"L2", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}]}]}], ")"}], " ",
             "m2"}], "+", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "kpr1"}], " ", "kvy1"}], "+", 
                 RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2",
                " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L2"}], " ", "m2"}], "+", 
                 RowBox[{"L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
         "L2", " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{"kpr1", "-", "kpr2"}], ")"}], " ", "m"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "kpr1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "kpy1"}], "+", 
              RowBox[{"kp\[Psi]1", " ", "L1"}]}], ")"}], " ", "L2"}], "+", 
           RowBox[{"d2", " ", "kpr2", " ", "L1", " ", 
            RowBox[{"(", 
             RowBox[{"kpy2", "-", 
              RowBox[{"kp\[Psi]2", " ", "L2"}]}], ")"}]}]}], ")"}], " ", 
         "m"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", 
         "L2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "kpr1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "kvy1"}], "+", 
              RowBox[{"kv\[Psi]1", " ", "L1"}]}], ")"}], " ", "L2"}], "+", 
           RowBox[{"d2", " ", "kpr2", " ", "L1", " ", 
            RowBox[{"(", 
             RowBox[{"kvy2", "-", 
              RowBox[{"kv\[Psi]2", " ", "L2"}]}], ")"}]}]}], ")"}], " ", 
         "m"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", 
         "L2"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d2", "2"]}], " ", "J", " ", "kpr2", " ", "kpy2", 
         " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "kpr1", 
         " ", "L2", " ", "m", " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr1", " ", "kpy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr2", " ", "L1"}], "+", 
              RowBox[{"kpr1", " ", "L2"}]}], ")"}], " ", "m"}]}], ")"}], " ", 
         "m1", " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kpy1"}], "+", 
              RowBox[{"kpr2", " ", "kpy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m1", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "kpr2", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"J", " ", "kpr1", " ", "L2", " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "kpr2", " ", "L1", " ", "m1", 
               " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
        "L2", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["d2", "2"]}], " ", "J", " ", "kpr2", " ", "kvy2", 
         " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "L2", " ",
          "m", " ", "m1", " ", "m2"}], "-", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "kpr1", " ", "kvy1", " ", "L1", " ", "L2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "+", "L2"}], ")"}], " ", "m"}]}], ")"}], " ", "m1",
          " ", "m2"}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kpr1", " ", "kvy1"}], "+", 
              RowBox[{"kpr2", " ", "kvy2"}]}], ")"}], " ", "L1", " ", "L2", 
            " ", "m1", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "L1", " ", "m1"}], "+", 
              RowBox[{"J", " ", "L2", " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "L1", " ", "m1", " ", "m2"}]}],
              ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", "L1", " ", 
        "L2", " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "d1"}], " ", "kpr1"}], "+", 
        RowBox[{"d2", " ", "kpr2"}]}], 
       RowBox[{"d1", "-", "d2"}]], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6977836177146387`*^9, 3.6978701963044367`*^9, 3.697871078830763*^9, 
   3.6978714131456423`*^9, 3.69787200237407*^9, {3.697872152922316*^9, 
   3.6978721593215*^9}, 3.697876867369138*^9, 3.6978769840532*^9, 
   3.697879207754341*^9, 3.697880823797571*^9, 3.6978903874521303`*^9, 
   3.6979217259969482`*^9, 3.697957481475752*^9, 3.697959715389634*^9, 
   3.7120437208504744`*^9, 3.712049013239768*^9, 3.7120587453059063`*^9, 
   3.712058904853096*^9, 3.712059028605111*^9, 3.7120591528896933`*^9, {
   3.712117225853702*^9, 3.712117227081306*^9}, 3.7121173301268063`*^9, 
   3.712117850101088*^9, 3.712118360048242*^9, 3.712127470767145*^9, 
   3.712127802771987*^9, 3.712127896572558*^9, 3.712129191111999*^9, 
   3.712130722217599*^9, 3.712133654918023*^9, 3.7121348146973658`*^9, {
   3.712136627708021*^9, 3.7121366312146063`*^9}, 3.712150137251163*^9, 
   3.712150592633234*^9, 3.712151257684966*^9, 3.7121558704717417`*^9, 
   3.712382164122594*^9, 3.712834046037046*^9, 3.7128355722728643`*^9, 
   3.712836068115005*^9, 3.712836129955315*^9, 3.712836975654483*^9, 
   3.712837045812353*^9, 3.7128386969272137`*^9, 3.712839920615035*^9, 
   3.7128451518111963`*^9, 3.712846318685009*^9, 3.712847242430127*^9, 
   3.712848543041909*^9, 3.7128534951180553`*^9, 3.712853631438216*^9, 
   3.7128996252306967`*^9, 3.7129290814669657`*^9, 3.712929863441465*^9, 
   3.712944775058774*^9, 3.712948849419992*^9, 3.7129823231595507`*^9, 
   3.712983198684827*^9, 3.7129882899413633`*^9, 3.713450095501244*^9, 
   3.713450755443057*^9, {3.7134508719039993`*^9, 3.713450896365004*^9}, 
   3.713600852660125*^9, 3.714029567041482*^9, 3.71403410954449*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Asimilar", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"25", ";;", "32"}], ",", 
     RowBox[{"25", ";;", "32"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.712834097478877*^9, 3.7128341074249773`*^9}, {
  3.712845161917933*^9, 3.7128451750922613`*^9}, {3.712848537933586*^9, 
  3.7128485652262087`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7128341078256407`*^9, 3.712835573374217*^9, {3.712836080104887*^9, 
   3.712836082326406*^9}, 3.712836132599811*^9, 3.7128369802734747`*^9, 
   3.712838699123364*^9, 3.7128399208051453`*^9, 3.71284517540409*^9, {
   3.7128463190905733`*^9, 3.712846330975478*^9}, 3.712847242618738*^9, {
   3.712848559955093*^9, 3.71284856558327*^9}, 3.712853495236617*^9, 
   3.7128536315711*^9, 3.712899625463045*^9, 3.712929081607523*^9, 
   3.712929863612421*^9, 3.7129448291504917`*^9, 3.712948849520998*^9, 
   3.712982323269149*^9, 3.71298319881238*^9, 3.712988290069971*^9, 
   3.712988433029614*^9, 3.713450105134698*^9, 3.7134508965187387`*^9, 
   3.71360085540103*^9, 3.7140295671844378`*^9, 3.714034109676531*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
choosing gains that make the block matrices into block triangular\
\>", "Chapter",
 CellChangeTimes->{{3.712117368197363*^9, 3.712117372829557*^9}, {
  3.7134501109124327`*^9, 3.713450132940597*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"solz\[Theta]", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Asimilar", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "]"}], "]"}], 
      "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kpz2", ",", "kvz2", ",", "kiz2"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solz\[Theta]", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.71284521003465*^9, 3.712845229835372*^9}, {
   3.712850125329578*^9, 3.712850216262006*^9}, {3.71285034601357*^9, 
   3.712850375575284*^9}, {3.712850601983975*^9, 3.71285061084903*^9}, 
   3.712850667199596*^9, {3.712850746696039*^9, 3.712850799670621*^9}, {
   3.712850848879777*^9, 3.71285085715917*^9}, {3.712944931421036*^9, 
   3.712944934706902*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpz2", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", " ", "kpz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
       " ", "m2"}]]}], ",", 
    RowBox[{"kvz2", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", " ", "kvz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
       " ", "m2"}]]}], ",", 
    RowBox[{"kiz2", "\[Rule]", 
     FractionBox[
      RowBox[{"d1", " ", "kiz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
      RowBox[{"d2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{"d1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
       " ", "m2"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.71294483748813*^9, 3.712944935633647*^9, 3.712946367603444*^9, 
   3.712948849886763*^9, 3.712982323774942*^9, 3.7129832110626173`*^9, 
   3.71298829035567*^9, 3.712988441107541*^9, {3.71345013700168*^9, 
   3.713450141936681*^9}, 3.7134507559079638`*^9, 3.713450896718151*^9, 
   3.713600866530809*^9, 3.7140295674084587`*^9, 3.714031670581089*^9, 
   3.714034109941968*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpz2", "\[Rule]", 
     FractionBox[
      RowBox[{"kpz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m2"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m1"}]}], ")"}], " ", "m2"}]]}], ",", 
    RowBox[{"kvz2", "\[Rule]", 
     FractionBox[
      RowBox[{"kvz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m2"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m1"}]}], ")"}], " ", "m2"}]]}], ",", 
    RowBox[{"kiz2", "\[Rule]", 
     FractionBox[
      RowBox[{"kiz1", " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m2"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"J", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", "m1"}]}], ")"}], " ", "m2"}]]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.71294483748813*^9, 3.712944935633647*^9, 3.712946367603444*^9, 
   3.712948849886763*^9, 3.712982323774942*^9, 3.7129832110626173`*^9, 
   3.71298829035567*^9, 3.712988441107541*^9, {3.71345013700168*^9, 
   3.713450141936681*^9}, 3.7134507559079638`*^9, 3.713450896718151*^9, 
   3.713600866530809*^9, 3.7140295674084587`*^9, 3.714031670581089*^9, 
   3.7140341100054092`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solx\[Delta]", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Asimilar", "[", 
       RowBox[{"[", 
        RowBox[{"11", ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "13", ",", "14"}], "}"}]}], "]"}], "]"}], 
      "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kpx2", ",", "kvx2", ",", "kpr2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solx\[Delta]", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.71284525783922*^9, 3.712845280900334*^9}, {
   3.712845729826879*^9, 3.71284574646846*^9}, {3.7128463657184353`*^9, 
   3.712846375514085*^9}, {3.712848576073709*^9, 3.7128486130173693`*^9}, 
   3.713450144449844*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpx2", "\[Rule]", 
     RowBox[{"kpx1", "+", 
      RowBox[{
       FractionBox["1", "2"], " ", "gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"L1", " ", "m1"}]], "-", 
         FractionBox["1", 
          RowBox[{"L2", " ", "m2"}]]}], ")"}]}]}]}], ",", 
    RowBox[{"kvx2", "\[Rule]", 
     RowBox[{"kvx1", "+", 
      FractionBox[
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "L1"}], " ", "m1"}], "+", 
          RowBox[{"L2", " ", "m2"}]}], ")"}]}], 
       RowBox[{
       "2", " ", "kpr1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]]}]}], 
    ",", 
    RowBox[{"kpr2", "\[Rule]", "kpr1"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7128452828522997`*^9, 3.7128457476817017`*^9, {3.712846319455151*^9, 
   3.712846334952338*^9}, {3.712846368697412*^9, 3.7128463765580473`*^9}, 
   3.712847243371057*^9, {3.712848582988469*^9, 3.712848614606758*^9}, 
   3.712850109300475*^9, 3.712851385483081*^9, 3.71285349564223*^9, 
   3.7128536319846277`*^9, 3.712899626253675*^9, 3.712929082131892*^9, 
   3.7129298641442327`*^9, 3.71294495394659*^9, 3.712948850240981*^9, 
   3.712982324375663*^9, 3.712983211541277*^9, 3.712988443853854*^9, 
   3.71298848911544*^9, {3.713450138330625*^9, 3.713450145216604*^9}, 
   3.7134507563123217`*^9, 3.71345089715727*^9, 3.713600867031734*^9, 
   3.714029567814754*^9, 3.7140316731041393`*^9, 3.7140341103491507`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"soly\[Psi]", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Asimilar", "[", 
       RowBox[{"[", 
        RowBox[{"19", ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "21", ",", "22", ",", "23", ",", "24"}], "}"}]}],
         "]"}], "]"}], "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "kpy2", ",", "kvy2", ",", "kp\[Psi]2", ",", "kv\[Psi]2", ",", "kpr2"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soly\[Psi]", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.712845392840171*^9, 3.7128454351309347`*^9}, {
   3.712845609077692*^9, 3.712845616985711*^9}, {3.7128456532176723`*^9, 
   3.712845662695304*^9}, {3.712846416017309*^9, 3.7128464172881327`*^9}, {
   3.712848648693727*^9, 3.712848664643806*^9}, {3.712848717916184*^9, 
   3.712848768133766*^9}, 3.713450148113227*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpy2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
       "2", " ", "J", " ", "kpy1", " ", "L1", " ", "L2", " ", "m1", " ", 
        "m2"}], "+", 
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "m1"}], "+", 
             RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{"2", " ", "J", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]]}], 
    ",", 
    RowBox[{"kvy2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
       "2", " ", "J", " ", "kpr1", " ", "kvy1", " ", "L1", " ", "L2", " ", 
        "m1", " ", "m2"}], "+", 
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "m1"}], "+", 
             RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{
      "2", " ", "J", " ", "kpr1", " ", "L1", " ", "L2", " ", "m1", " ", 
       "m2"}]]}], ",", 
    RowBox[{"kp\[Psi]2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "J", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kpy1", " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}]}], "+", 
          RowBox[{"kp\[Psi]1", " ", "L1", " ", "L2"}]}], ")"}], " ", "m1", 
        " ", "m2"}], "+", 
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "m1"}], "+", 
             RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{"2", " ", "J", " ", "L1", " ", 
       SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}], ",", 
    RowBox[{"kv\[Psi]2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "J", " ", "kpr1", " ", "L2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kvy1", " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}]}], "+", 
          RowBox[{"kv\[Psi]1", " ", "L1", " ", "L2"}]}], ")"}], " ", "m1", 
        " ", "m2"}], "+", 
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "m1"}], "+", 
             RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{"2", " ", "J", " ", "kpr1", " ", "L1", " ", 
       SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}], ",", 
    RowBox[{"kpr2", "\[Rule]", "kpr1"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.712845435811625*^9, 3.712845627707041*^9, 
  3.712845667230041*^9, 3.7128463197432013`*^9, 3.7128464238865833`*^9, 
  3.712847246575742*^9, 3.7128487326646748`*^9, 3.712848769570169*^9, 
  3.712850111053301*^9, 3.71285349689176*^9, 3.7128536332368193`*^9, 
  3.712899627851226*^9, 3.712929083194394*^9, 3.71292986536655*^9, 
  3.7129449560920486`*^9, 3.712948851485573*^9, 3.7129823256132298`*^9, 
  3.7129832127661324`*^9, 3.712988490729188*^9, 3.7134501503475523`*^9, 
  3.7134507576198807`*^9, 3.7134508983944683`*^9, 3.713600868220995*^9, 
  3.714029568966381*^9, 3.714031676343854*^9, 3.7140341115837317`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
choosing gains that make the block matrices into block triangular (part 2)\
\>", "Chapter",
 CellChangeTimes->{{3.712127723443057*^9, 3.712127741406831*^9}, 
   3.712850975973908*^9, {3.713450160850645*^9, 3.713450166432267*^9}}],

Cell[CellGroupData[{

Cell["z and \[Theta] motion", "Section",
 CellChangeTimes->{{3.7134503019844513`*^9, 3.7134503057424498`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solz\[Theta]2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kpz1", "\[Rule]", " ", "kpz"}], ",", 
         RowBox[{"kpz2", "\[Rule]", " ", 
          RowBox[{"r", " ", "kpz"}]}], ",", 
         RowBox[{"kvz1", "\[Rule]", " ", "kvz"}], ",", 
         RowBox[{"kvz2", "\[Rule]", 
          RowBox[{"r", " ", "kvz"}]}], ",", 
         RowBox[{"kiz1", "\[Rule]", " ", "kiz"}], ",", 
         RowBox[{"kiz2", "\[Rule]", 
          RowBox[{"r", " ", "kiz"}]}]}], "}"}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{"r", "\[Rule]", 
        FractionBox[
         RowBox[{"d1", " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"d2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
           ")"}]}], 
         RowBox[{"d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "J"}], "+", 
            RowBox[{"d1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
          " ", "m2"}]]}], "}"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solz\[Theta]2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kpz1", "\[Rule]", 
          RowBox[{"r1", " ", "kpz"}]}], ",", 
         RowBox[{"kpz2", "\[Rule]", " ", 
          RowBox[{"r2", " ", "kpz"}]}], ",", 
         RowBox[{"kvz1", "\[Rule]", " ", 
          RowBox[{"r1", " ", "kvz"}]}], ",", 
         RowBox[{"kvz2", "\[Rule]", 
          RowBox[{"r2", " ", "kvz"}]}], ",", 
         RowBox[{"kiz1", "\[Rule]", " ", 
          RowBox[{"r1", " ", "kiz"}]}], ",", 
         RowBox[{"kiz2", "\[Rule]", 
          RowBox[{"r2", " ", "kiz"}]}]}], "}"}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", "\[Rule]", 
         FractionBox[
          RowBox[{"m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "J"}], "+", 
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{"d1", "+", "d2"}], ")"}], " ", "m"}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m1"}]}], ")"}], 
           " "}], 
          RowBox[{" ", 
           RowBox[{"m", " ", "m", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], "2"]}]}]]}], ",", 
        RowBox[{"r2", "\[Rule]", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{"m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "J"}], "+", 
              RowBox[{"d1", " ", 
               RowBox[{"(", 
                RowBox[{"d1", "+", "d2"}], ")"}], " ", "m"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m2"}]}], 
             ")"}]}]}], 
          RowBox[{"m", " ", "m", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], "2"]}]]}]}], "}"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"m", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "is", " ", "not", " ", "a",
     " ", "good", " ", "characteristic", " ", "moment", " ", "of", " ", 
    "inertia", " ", "since", " ", "d1", " ", "and", " ", "d2", " ", "might", 
    " ", "be", " ", "close", " ", "to", " ", 
    RowBox[{"zero", ":", " ", 
     RowBox[{"those", " ", "are", " ", "contact", " ", "points"}]}]}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solz\[Theta]2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kpz1", "\[Rule]", 
          RowBox[{"r1", " ", "kpz"}]}], ",", 
         RowBox[{"kpz2", "\[Rule]", " ", 
          RowBox[{"r2", " ", "kpz"}]}], ",", 
         RowBox[{"kvz1", "\[Rule]", " ", 
          RowBox[{"r1", " ", "kvz"}]}], ",", 
         RowBox[{"kvz2", "\[Rule]", 
          RowBox[{"r2", " ", "kvz"}]}], ",", 
         RowBox[{"kiz1", "\[Rule]", " ", 
          RowBox[{"r1", " ", "kiz"}]}], ",", 
         RowBox[{"kiz2", "\[Rule]", 
          RowBox[{"r2", " ", "kiz"}]}]}], "}"}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r1", "\[Rule]", 
         FractionBox[
          RowBox[{"m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "J"}], "+", 
             RowBox[{"d2", " ", 
              RowBox[{"(", 
               RowBox[{"d1", "+", "d2"}], ")"}], " ", "m"}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m1"}]}], ")"}], 
           " "}], 
          RowBox[{"  ", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m1", " ", "m2", 
            " ", " "}]}]]}], ",", 
        RowBox[{"r2", "\[Rule]", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{"m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "J"}], "+", 
              RowBox[{"d1", " ", 
               RowBox[{"(", 
                RowBox[{"d1", "+", "d2"}], ")"}], " ", "m"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m2"}]}], 
             ")"}]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "m1", " ", "m2", 
           " "}]]}]}], "}"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solz\[Theta]2", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpz1", "\[Rule]", 
         RowBox[{"r1", " ", "kpz"}]}], ",", 
        RowBox[{"kpz2", "\[Rule]", " ", 
         RowBox[{"r2", " ", "kpz"}]}], ",", 
        RowBox[{"kvz1", "\[Rule]", " ", 
         RowBox[{"r1", " ", "kvz"}]}], ",", 
        RowBox[{"kvz2", "\[Rule]", 
         RowBox[{"r2", " ", "kvz"}]}], ",", 
        RowBox[{"kiz1", "\[Rule]", " ", 
         RowBox[{"r1", " ", "kiz"}]}], ",", 
        RowBox[{"kiz2", "\[Rule]", 
         RowBox[{"r2", " ", "kiz"}]}]}], "}"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1", "\[Rule]", 
        FractionBox[
         RowBox[{"d2", " ", "m2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "J"}], "+", 
            RowBox[{"d1", " ", "m1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}], ")"}]}]}], ")"}], " "}], 
         RowBox[{" ", 
          RowBox[{
           FractionBox[
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"d1", " ", "-", "d2"}], ")"}]}], "4"], " ", "-", 
           RowBox[{"d1", " ", "d2", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1", " ", "m2", 
            " "}]}]}]]}], ",", 
       RowBox[{"r2", "\[Rule]", 
        FractionBox[
         RowBox[{"d1", " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{"J", "+", 
            RowBox[{"d2", " ", "m2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "d1"}], "+", "d2"}], ")"}]}]}], ")"}]}], 
         RowBox[{" ", 
          RowBox[{
           FractionBox[
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"d1", " ", "-", "d2"}], ")"}]}], "4"], " ", "-", 
           RowBox[{"d1", " ", "d2", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1", " ", "m2", 
            " "}]}]}]]}]}], "}"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.712852705188785*^9, 3.712852708681492*^9}, {
   3.712852745853682*^9, 3.7128527570907583`*^9}, {3.712853923505863*^9, 
   3.712853929029764*^9}, {3.712944960519264*^9, 3.712944972494727*^9}, {
   3.7129489986054087`*^9, 3.712949023644924*^9}, {3.712949057247285*^9, 
   3.712949069111581*^9}, {3.712949101882037*^9, 3.712949152989788*^9}, {
   3.7129493262933893`*^9, 3.712949387358448*^9}, {3.712982123142661*^9, 
   3.7129821808090887`*^9}, 3.712982225705946*^9, {3.712982424281262*^9, 
   3.712982426226828*^9}, {3.7134502242221746`*^9, 3.713450244796446*^9}, {
   3.7134506097738743`*^9, 3.7134506245318527`*^9}, {3.714030880755451*^9, 
   3.714031003126416*^9}, {3.714031068550037*^9, 3.714031071632902*^9}, {
   3.714031374765008*^9, 3.714031413255333*^9}, {3.7140315386458683`*^9, 
   3.7140315467867126`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solz\[Theta]2", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"d2", " ", "m2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "J"}], "+", 
         RowBox[{"d1", " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d1"}], "+", "d2"}], ")"}]}]}], ")"}], " "}], 
      RowBox[{" ", 
       RowBox[{
        FractionBox[
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m1", "+", "m2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"d1", " ", "-", "d2"}], ")"}]}], "4"], " ", "-", 
        RowBox[{"d1", " ", "d2", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1", " ", "m2", " "}]}]}]], 
     "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"d2", " ", "m2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d1"}], "+", "d2"}], ")"}]}]}], ")"}], " "}], 
       RowBox[{" ", 
        RowBox[{
         FractionBox[
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"d1", " ", "-", "d2"}], ")"}]}], "4"], " ", "-", 
         RowBox[{"d1", " ", "d2", 
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1", " ", "m2", " "}]}]}]],
       "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
        RowBox[{"m2", "\[Rule]", " ", "M"}]}], "}"}]}], "//", "Simplify"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.712982191868444*^9, 3.712982232411831*^9}, {
   3.712982346498795*^9, 3.712982433326892*^9}, {3.712985706977635*^9, 
   3.7129857166498632`*^9}, {3.713450235826062*^9, 3.713450289164329*^9}, {
   3.7134505112728786`*^9, 3.7134505182084913`*^9}, 3.7134506315379887`*^9, {
   3.7140309943245363`*^9, 3.714031021999194*^9}, {3.714031074185232*^9, 
   3.714031127418583*^9}, {3.71403117108538*^9, 3.714031222980015*^9}, {
   3.714031267493202*^9, 3.7140313260901012`*^9}, {3.71403154893124*^9, 
   3.714031550839123*^9}, 3.714033229316729*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"J", "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["d", "2"], " ", "m1"}]}], ")"}], " ", "m2"}], 
  RowBox[{
   RowBox[{"4", " ", 
    SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
   RowBox[{"J", " ", 
    RowBox[{"(", 
     RowBox[{"m1", "+", "m2"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.712982325951483*^9, {3.7129823763063717`*^9, 3.712982413442946*^9}, 
   3.7129832132424192`*^9, 3.712985717174459*^9, 3.71298845015165*^9, 
   3.712988491742457*^9, {3.713450232609766*^9, 3.713450239645542*^9}, {
   3.713450273943615*^9, 3.713450290199849*^9}, 3.713450521040041*^9, 
   3.713450632012142*^9, 3.713450757744491*^9, 3.71345090182041*^9, 
   3.71360086849009*^9, 3.714029569172783*^9, 3.7140306455753202`*^9, {
   3.7140309950558367`*^9, 3.714031022403413*^9}, {3.714031075545066*^9, 
   3.714031127820212*^9}, {3.714031172197977*^9, 3.7140311777223682`*^9}, {
   3.7140312081578703`*^9, 3.714031223377068*^9}, {3.714031274651208*^9, 
   3.7140313268098*^9}, 3.714031420733028*^9, 3.7140315513966837`*^9, {
   3.7140316601679173`*^9, 3.714031680041614*^9}, 3.7140332298624496`*^9, 
   3.714034111792967*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["kpz2", "kpz1"], "/.", 
      RowBox[{"solz\[Theta]2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
    FractionBox[
     RowBox[{"d1", "  ", "m1", " ", 
      RowBox[{"(", 
       RowBox[{"J", "+", 
        RowBox[{"d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
     RowBox[{"d2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "J"}], "+", 
        RowBox[{"d1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ",
       "m2"}]]}], "//", "Simplify"}], "*)"}]], "Input",
 CellChangeTimes->{{3.714031597566325*^9, 3.71403162039923*^9}, 
   3.714033223077773*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["x and \[Delta] motion", "Section",
 CellChangeTimes->{{3.7134503019844513`*^9, 3.713450312123538*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kpx2", "/.", 
     RowBox[{"solx\[Delta]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpx1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kvx2", "/.", 
     RowBox[{"solx\[Delta]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvx1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solx\[Delta]2", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpx1", "\[Rule]", " ", 
         RowBox[{"kpx", "-", 
          FractionBox["offsetp", "2"]}]}], ",", 
        RowBox[{"kpx2", "\[Rule]", " ", 
         RowBox[{"kpx", "+", 
          FractionBox["offsetp", "2"]}]}], ",", 
        RowBox[{"kvx1", "\[Rule]", " ", 
         RowBox[{"kvx", "-", 
          FractionBox["offsetv", "2"]}]}], ",", 
        RowBox[{"kvx2", "\[Rule]", " ", 
         RowBox[{"kvx", "+", 
          FractionBox["offsetv", "2"]}]}], ",", 
        RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
        RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "}"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"offsetp", "\[Rule]", 
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{
           RowBox[{"kpx2", "/.", 
            RowBox[{"solx\[Delta]", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpx1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"offsetv", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"CoefficientList", "[", 
            RowBox[{
             RowBox[{"kvx2", "/.", 
              RowBox[{"solx\[Delta]", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvx1"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"kpr1", "\[Rule]", "kpr"}], "}"}]}], ")"}]}]}], "}"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solx\[Delta]2", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.712851054049542*^9, 3.7128510818574533`*^9}, {
  3.712851134735491*^9, 3.712851143950695*^9}, {3.712851239814246*^9, 
  3.712851328439828*^9}, {3.712851374870714*^9, 3.712851375070299*^9}, {
  3.712852668239893*^9, 3.712852673075128*^9}, {3.71285277359942*^9, 
  3.712852785418932*^9}, {3.71293744388628*^9, 3.712937454865231*^9}, {
  3.71293750651577*^9, 3.712937507259328*^9}, {3.7134509088860826`*^9, 
  3.713450919745678*^9}, {3.713451001894788*^9, 3.7134510112618723`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "+", 
      RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
     RowBox[{
      RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
      RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], ",", 
   "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7128512780050583`*^9, {3.7128513081929083`*^9, 3.712851329550353*^9}, {
   3.712851375680786*^9, 3.712851389423121*^9}, {3.712852591825636*^9, 
   3.712852596919978*^9}, 3.712852674173605*^9, 3.71285278686474*^9, 
   3.712853497043429*^9, 3.71285363340949*^9, 3.712853911399488*^9, 
   3.712899667402014*^9, 3.712929083411615*^9, 3.712929865522667*^9, {
   3.712937432687912*^9, 3.712937455217751*^9}, 3.712937507728297*^9, 
   3.712937743214283*^9, 3.712944974516868*^9, 3.712948851589406*^9, 
   3.712982442860489*^9, 3.7129832133199368`*^9, 3.7129884572084627`*^9, 
   3.71298849209441*^9, {3.713450295728363*^9, 3.713450322535799*^9}, 
   3.713450757829988*^9, {3.713450911815407*^9, 3.713450923429441*^9}, 
   3.7134510161805687`*^9, 3.71360086864909*^9, 3.714029569264495*^9, 
   3.71403064680062*^9, 3.714031555573139*^9, 3.7140341119257803`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "+", 
      RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
     RowBox[{
      RowBox[{"d1", " ", "kpr1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}],
       "-", 
      RowBox[{
      "d2", " ", "kpr1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], 
   ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7128512780050583`*^9, {3.7128513081929083`*^9, 3.712851329550353*^9}, {
   3.712851375680786*^9, 3.712851389423121*^9}, {3.712852591825636*^9, 
   3.712852596919978*^9}, 3.712852674173605*^9, 3.71285278686474*^9, 
   3.712853497043429*^9, 3.71285363340949*^9, 3.712853911399488*^9, 
   3.712899667402014*^9, 3.712929083411615*^9, 3.712929865522667*^9, {
   3.712937432687912*^9, 3.712937455217751*^9}, 3.712937507728297*^9, 
   3.712937743214283*^9, 3.712944974516868*^9, 3.712948851589406*^9, 
   3.712982442860489*^9, 3.7129832133199368`*^9, 3.7129884572084627`*^9, 
   3.71298849209441*^9, {3.713450295728363*^9, 3.713450322535799*^9}, 
   3.713450757829988*^9, {3.713450911815407*^9, 3.713450923429441*^9}, 
   3.7134510161805687`*^9, 3.71360086864909*^9, 3.714029569264495*^9, 
   3.71403064680062*^9, 3.714031555573139*^9, 3.714034111936887*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpx1", "\[Rule]", 
     RowBox[{"kpx", "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"L1", " ", "m1"}]]}], "+", 
         FractionBox["1", 
          RowBox[{"L2", " ", "m2"}]]}], ")"}]}]}]}], ",", 
    RowBox[{"kpx2", "\[Rule]", 
     RowBox[{"kpx", "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"L1", " ", "m1"}]], "-", 
         FractionBox["1", 
          RowBox[{"L2", " ", "m2"}]]}], ")"}]}]}]}], ",", 
    RowBox[{"kvx1", "\[Rule]", 
     RowBox[{"kvx", "+", 
      FractionBox[
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L1", " ", "m1"}], "-", 
          RowBox[{"L2", " ", "m2"}]}], ")"}]}], 
       RowBox[{
       "4", " ", "kpr", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]]}]}], 
    ",", 
    RowBox[{"kvx2", "\[Rule]", 
     RowBox[{"kvx", "+", 
      FractionBox[
       RowBox[{"gravity", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "L1"}], " ", "m1"}], "+", 
          RowBox[{"L2", " ", "m2"}]}], ")"}]}], 
       RowBox[{
       "4", " ", "kpr", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]]}]}], 
    ",", 
    RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
    RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7128512780050583`*^9, {3.7128513081929083`*^9, 3.712851329550353*^9}, {
   3.712851375680786*^9, 3.712851389423121*^9}, {3.712852591825636*^9, 
   3.712852596919978*^9}, 3.712852674173605*^9, 3.71285278686474*^9, 
   3.712853497043429*^9, 3.71285363340949*^9, 3.712853911399488*^9, 
   3.712899667402014*^9, 3.712929083411615*^9, 3.712929865522667*^9, {
   3.712937432687912*^9, 3.712937455217751*^9}, 3.712937507728297*^9, 
   3.712937743214283*^9, 3.712944974516868*^9, 3.712948851589406*^9, 
   3.712982442860489*^9, 3.7129832133199368`*^9, 3.7129884572084627`*^9, 
   3.71298849209441*^9, {3.713450295728363*^9, 3.713450322535799*^9}, 
   3.713450757829988*^9, {3.713450911815407*^9, 3.713450923429441*^9}, 
   3.7134510161805687`*^9, 3.71360086864909*^9, 3.714029569264495*^9, 
   3.71403064680062*^9, 3.714031555573139*^9, 3.714034112344159*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["y and \[Psi] motion option 1", "Section",
 CellChangeTimes->{{3.713450329958967*^9, 3.7134503584037037`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kpy2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpy1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kvy2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvy1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kp\[Psi]2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kp\[Psi]1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kv\[Psi]2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kv\[Psi]1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soly\[Psi]2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpy1", "\[Rule]", " ", 
         RowBox[{"kpy", "-", 
          FractionBox["offsetyp", "2"]}]}], ",", 
        RowBox[{"kpy2", "\[Rule]", " ", 
         RowBox[{"kpy", "+", 
          FractionBox["offsetyp", "2"]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kvy1", "\[Rule]", " ", 
         RowBox[{"kvy", "-", 
          FractionBox["offsetyv", "2"]}]}], ",", 
        RowBox[{"kvy2", "\[Rule]", " ", 
         RowBox[{"kvy", "+", 
          FractionBox["offsetyv", "2"]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kp\[Psi]1", "\[Rule]", 
         RowBox[{"kp\[Psi]", "-", 
          FractionBox["offset\[Psi]p", 
           RowBox[{"2", " "}]]}]}], ",", 
        RowBox[{"kp\[Psi]2", "\[Rule]", 
         RowBox[{"kp\[Psi]", "+", 
          FractionBox["offset\[Psi]p", 
           RowBox[{"2", " "}]]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kv\[Psi]1", "\[Rule]", 
         RowBox[{"kv\[Psi]", "-", 
          FractionBox["offset\[Psi]v", 
           RowBox[{"2", " "}]]}]}], ",", 
        RowBox[{"kv\[Psi]2", "\[Rule]", 
         RowBox[{"kv\[Psi]", "+", 
          FractionBox["offset\[Psi]v", 
           RowBox[{"2", " "}]]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
        RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "}"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"offset\[Psi]p", "\[Rule]", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"kp\[Psi]2", "/.", 
             RowBox[{"soly\[Psi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "kp\[Psi]1"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"kpy1", "\[Rule]", "  ", 
          RowBox[{"kpy", "-", 
           FractionBox["offsetyp", "2"]}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"offset\[Psi]v", "\[Rule]", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"kv\[Psi]2", "/.", 
             RowBox[{"soly\[Psi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "kv\[Psi]1"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
          RowBox[{"kvy1", "\[Rule]", "  ", 
           RowBox[{"kvy", "-", 
            FractionBox["offsetyv", "2"]}]}]}], "}"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"offsetyp", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"kpy2", "/.", 
           RowBox[{"soly\[Psi]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpy1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"offsetyv", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"kvy2", "/.", 
             RowBox[{"soly\[Psi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvy1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], "}"}]}], ")"}]}]}], 
     "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712135175816742*^9, 3.712135194969357*^9}, {
   3.7121353152956467`*^9, 3.712135350628128*^9}, {3.712135446570263*^9, 
   3.712135612958049*^9}, {3.712135649329316*^9, 3.712135662173764*^9}, {
   3.712135708969202*^9, 3.71213582459439*^9}, {3.71213586180589*^9, 
   3.712135978768214*^9}, {3.712136014190837*^9, 3.712136023124683*^9}, {
   3.7121360583231707`*^9, 3.712136088285685*^9}, {3.712136133143704*^9, 
   3.712136147241569*^9}, {3.712136189583568*^9, 3.712136208379449*^9}, 
   3.7121362515028048`*^9, {3.7121363430886097`*^9, 3.712136392644628*^9}, {
   3.712136576886442*^9, 3.712136588539839*^9}, {3.712136682147962*^9, 
   3.712136710243705*^9}, {3.7121368086491003`*^9, 3.71213684005147*^9}, {
   3.712136902879105*^9, 3.712136938633255*^9}, {3.712851012114504*^9, 
   3.712851032668519*^9}, {3.7128514022443647`*^9, 3.7128514245717487`*^9}, {
   3.712851466796229*^9, 3.7128515940998297`*^9}, {3.7128516376738863`*^9, 
   3.7128516593720293`*^9}, {3.712851702641626*^9, 3.712851709684218*^9}, {
   3.712853131971134*^9, 3.712853141520771*^9}, {3.7128536603311777`*^9, 
   3.712853676123444*^9}, {3.7128537534820023`*^9, 3.712853830379998*^9}, {
   3.712853864912047*^9, 3.712853898282374*^9}, {3.713450326418145*^9, 
   3.7134503474314823`*^9}, {3.7134509297995853`*^9, 3.713450931577642*^9}, {
   3.713450966082801*^9, 3.71345099340845*^9}, {3.7134510239790792`*^9, 
   3.713451032600836*^9}, {3.714029535750242*^9, 3.714029595976612*^9}, {
   3.714029689884831*^9, 3.714029690048147*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"gravity", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d2"}], " ", "J", " ", "L2", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["d1", "2"], " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
       RowBox[{"d1", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", "L1"}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", " ", 
     "m1", " ", "m2"}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.714029569860865*^9, 3.714029596398755*^9}, 
   3.714029691470652*^9, 3.7140306495752974`*^9, 3.714031557829199*^9, 
   3.714034112447288*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"gravity", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d2"}], " ", "J", " ", "L2", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["d1", "2"], " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
       RowBox[{"d1", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", "L1"}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "kpr1", " ", "L1", " ",
      "L2", " ", "m1", " ", "m2"}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.714029569860865*^9, 3.714029596398755*^9}, 
   3.714029691470652*^9, 3.7140306495752974`*^9, 3.714031557829199*^9, 
   3.714034112456541*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
      RowBox[{"(", 
       RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", "m2"}], 
     "+", 
     RowBox[{"d2", " ", "J", " ", "L2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "gravity"}], " ", "m"}], "+", 
        RowBox[{"kpy1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1"}]}], ")"}], " ",
       "m2"}], "-", 
     RowBox[{"d1", " ", "m1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"J", " ", "kpy1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
        RowBox[{"gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "L1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", 
     SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.714029569860865*^9, 3.714029596398755*^9}, 
   3.714029691470652*^9, 3.7140306495752974`*^9, 3.714031557829199*^9, 
   3.714034112547886*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
      RowBox[{"(", 
       RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", "m2"}], 
     "+", 
     RowBox[{"d2", " ", "J", " ", "L2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "gravity"}], " ", "m"}], "+", 
        RowBox[{"kpr1", " ", "kvy1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1"}]}], ")"}], " ",
       "m2"}], "-", 
     RowBox[{"d1", " ", "m1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"J", " ", "kpr1", " ", "kvy1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
        RowBox[{"gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "L1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "kpr1", " ", "L1", " ", 
     SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.714029569860865*^9, 3.714029596398755*^9}, 
   3.714029691470652*^9, 3.7140306495752974`*^9, 3.714031557829199*^9, 
   3.714034112730811*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"offsetyp", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{
         RowBox[{"kpy2", "/.", 
          RowBox[{"soly\[Psi]", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpy1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"offsetyv", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{
           RowBox[{"kvy2", "/.", 
            RowBox[{"soly\[Psi]", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvy1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], "}"}]}], ")"}]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"offset\[Psi]p", "\[Rule]", 
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{
           RowBox[{"kp\[Psi]2", "/.", 
            RowBox[{"soly\[Psi]", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "kp\[Psi]1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"kpy1", "\[Rule]", "  ", 
         RowBox[{"kpy", "-", 
          FractionBox["offsetyp", "2"]}]}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"offset\[Psi]v", "\[Rule]", 
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{
           RowBox[{"kv\[Psi]2", "/.", 
            RowBox[{"soly\[Psi]", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "kv\[Psi]1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
         RowBox[{"kvy1", "\[Rule]", "  ", 
          RowBox[{"kvy", "-", 
           FractionBox["offsetyv", "2"]}]}]}], "}"}]}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"offsetyp", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"kpy2", "/.", 
           RowBox[{"soly\[Psi]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpy1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"offsetyv", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"kvy2", "/.", 
             RowBox[{"soly\[Psi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvy1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], "}"}]}], ")"}]}]}], 
     "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.714029706563692*^9, 3.714029712081514*^9}, {
  3.714029854603243*^9, 3.714029876153144*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"offsetyp", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"L1", " ", "m1"}], "-", 
            RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
      "2", " ", "J", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]]}]}], ",", 
   RowBox[{"offsetyv", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"L1", " ", "m1"}], "-", 
            RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
      "2", " ", "J", " ", "kpr", " ", "L1", " ", "L2", " ", "m1", " ", 
       "m2"}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.71402970933745*^9, 3.7140297125056067`*^9}, 
   3.714029876622367*^9, 3.714030651656796*^9, 3.714034113433099*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"offset\[Psi]p", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"4", " ", "J", " ", "kpy", " ", "L1", " ", 
       RowBox[{"(", 
        RowBox[{"L1", "-", "L2"}], ")"}], " ", "L2", " ", "m1", " ", "m2"}], 
      "-", 
      RowBox[{"gravity", " ", 
       RowBox[{"(", 
        RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"L1", " ", "m1"}], "-", 
            RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
     RowBox[{"4", " ", "J", " ", 
      SuperscriptBox["L1", "2"], " ", 
      SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}], ",", 
   RowBox[{"offset\[Psi]v", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"4", " ", "J", " ", "kpr", " ", "kvy", " ", "L1", " ", 
       RowBox[{"(", 
        RowBox[{"L1", "-", "L2"}], ")"}], " ", "L2", " ", "m1", " ", "m2"}], 
      "-", 
      RowBox[{"gravity", " ", 
       RowBox[{"(", 
        RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"L1", " ", "m1"}], "-", 
            RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
     RowBox[{"4", " ", "J", " ", "kpr", " ", 
      SuperscriptBox["L1", "2"], " ", 
      SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.71402970933745*^9, 3.7140297125056067`*^9}, 
   3.714029876622367*^9, 3.714030651656796*^9, 3.7140341135523376`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["y and \[Psi] motion option 2", "Section",
 CellChangeTimes->{{3.713450329958967*^9, 3.7134503635037727`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kpy2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpy1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kvy2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvy1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kp\[Psi]2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kp\[Psi]1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"kv\[Psi]2", "/.", 
     RowBox[{"soly\[Psi]", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "kv\[Psi]1"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soly\[Psi]2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"kpy1", "\[Rule]", " ", 
         RowBox[{"kpy", "-", 
          FractionBox["offsetyp", "2"]}]}], ",", 
        RowBox[{"kpy2", "\[Rule]", " ", 
         RowBox[{"kpy", "+", 
          FractionBox["offsetyp", "2"]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kvy1", "\[Rule]", " ", 
         RowBox[{"kvy", "-", 
          FractionBox["offsetyv", "2"]}]}], ",", 
        RowBox[{"kvy2", "\[Rule]", " ", 
         RowBox[{"kvy", "+", 
          FractionBox["offsetyv", "2"]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"kp\[Psi]1", "\[Rule]", "0"}], ",", 
        RowBox[{"kp\[Psi]2", "\[Rule]", "offset\[Psi]p"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kv\[Psi]1", "\[Rule]", "0"}], ",", 
        RowBox[{"kv\[Psi]2", "\[Rule]", "offset\[Psi]v"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
        RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "}"}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"offset\[Psi]p", "\[Rule]", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"kp\[Psi]2", "/.", 
             RowBox[{"soly\[Psi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "kp\[Psi]1"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"kpy1", "\[Rule]", "  ", 
          RowBox[{"kpy", "-", 
           FractionBox["offsetyp", "2"]}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"offset\[Psi]v", "\[Rule]", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"kv\[Psi]2", "/.", 
             RowBox[{"soly\[Psi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "kv\[Psi]1"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], ",", 
          RowBox[{"kvy1", "\[Rule]", "  ", 
           RowBox[{"kvy", "-", 
            FractionBox["offsetyv", "2"]}]}]}], "}"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"offsetyp", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"kpy2", "/.", 
           RowBox[{"soly\[Psi]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "kpy1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"offsetyv", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"kvy2", "/.", 
             RowBox[{"soly\[Psi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "kvy1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"kpr1", "\[Rule]", " ", "kpr"}], "}"}]}], ")"}]}]}], 
     "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7128541354256477`*^9, 3.712854154525517*^9}, {
   3.713450946881983*^9, 3.713450958235985*^9}, {3.7134510453595*^9, 
   3.713451046981811*^9}, 3.71403051808368*^9, 3.714031781777564*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"gravity", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d2"}], " ", "J", " ", "L2", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["d1", "2"], " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
       RowBox[{"d1", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", "L1"}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", " ", 
     "m1", " ", "m2"}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.714031802372856*^9, 3.714031930779106*^9, 
  3.7140341137195683`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"gravity", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d2"}], " ", "J", " ", "L2", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["d1", "2"], " ", "d2", " ", 
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "-", 
       RowBox[{"d1", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", "L1"}], "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "kpr1", " ", "L1", " ",
      "L2", " ", "m1", " ", "m2"}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.714031802372856*^9, 3.714031930779106*^9, 
  3.714034113734047*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
      RowBox[{"(", 
       RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", "m2"}], 
     "+", 
     RowBox[{"d2", " ", "J", " ", "L2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "gravity"}], " ", "m"}], "+", 
        RowBox[{"kpy1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1"}]}], ")"}], " ",
       "m2"}], "-", 
     RowBox[{"d1", " ", "m1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"J", " ", "kpy1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
        RowBox[{"gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "L1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", 
     SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.714031802372856*^9, 3.714031930779106*^9, 
  3.71403411374164*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
      RowBox[{"(", 
       RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", "m2"}], 
     "+", 
     RowBox[{"d2", " ", "J", " ", "L2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "gravity"}], " ", "m"}], "+", 
        RowBox[{"kpr1", " ", "kvy1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m1"}]}], ")"}], " ",
       "m2"}], "-", 
     RowBox[{"d1", " ", "m1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"J", " ", "kpr1", " ", "kvy1", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
        RowBox[{"gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "L1"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
       ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "kpr1", " ", "L1", " ", 
     SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.714031802372856*^9, 3.714031930779106*^9, 
  3.714034113750987*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["State matrix if gains respect relations above", "Chapter",
 CellChangeTimes->{{3.712118127707405*^9, 3.712118134545293*^9}, {
  3.7134503853566647`*^9, 3.713450398117222*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AsimilarSimplified", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Asimilar", "/.", 
       RowBox[{"solz\[Theta]2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
      RowBox[{"solx\[Delta]2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
     RowBox[{"soly\[Psi]2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AsimilarSimplified", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.712118097850472*^9, 3.71211811967861*^9}, {
   3.712118311916069*^9, 3.71211831250072*^9}, {3.712118346960799*^9, 
   3.712118350215057*^9}, {3.712130800897305*^9, 3.7121308193437653`*^9}, {
   3.7128458941348677`*^9, 3.712845902851489*^9}, 3.712852601841559*^9, {
   3.712853918457061*^9, 3.712853938783078*^9}, 3.712946380550653*^9, 
   3.71294870518293*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kiz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
         "m2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kpz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
         "m2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kvz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
         "m2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d2"}], " ", "m2"}], "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "d1", " ", 
         SuperscriptBox["d2", "4"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "+", 
           RowBox[{"L1", " ", 
            SuperscriptBox["m1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"4", " ", "d2", " ", "kvz", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "-", 
              "\[Lambda]"}], ")"}], " ", "\[Lambda]"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d2", "5"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"4", " ", "d2", " ", "kvz", " ", "m1", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                 " ", "m2"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "-", 
        FractionBox[
         RowBox[{"4", " ", "d1", " ", 
          SuperscriptBox["d2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "m1"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "-", "m2"}], ")"}]}], "-", "m2"}], ")"}]}], 
               "+", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "-", "m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"L1", " ", "m1", " ", "m2", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d2", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2"}], "+", 
               RowBox[{"d1", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["d1", "2"]}]}], ")"}], " ", "kvz", " ", 
                SuperscriptBox["m1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "kvz", " ", 
                "m1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "J"}], "+", 
                  RowBox[{"d1", " ", "d2", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{
                FractionBox["1", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d1", "2"]}]}], ")"}], " ", "m1"}]}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{
         "4", " ", "d1", " ", "L1", " ", "m1", " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d1", "2"], " ", "m1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "+", 
               RowBox[{
                FractionBox["1", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                "\[Lambda]"}]}], ")"}]}], "+", 
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "d2", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2"}], "+", 
               RowBox[{"d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "+", 
               RowBox[{
                FractionBox["1", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                "\[Lambda]"}]}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "+", 
        RowBox[{
         SuperscriptBox["d2", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m2"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "-", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"4", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox["d1", "2"]}], ")"}], " ", "d2", " ", "kvz", 
                 " ", "m1", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                 " ", 
                 SuperscriptBox["m2", "2"]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "-", 
              FractionBox[
               RowBox[{"4", " ", 
                SuperscriptBox["d1", "3"], " ", "kvz", " ", 
                SuperscriptBox["m1", "2"], " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "J"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
                   "m2"}]}], ")"}]}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m", " ", "m1", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "m", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{
               SuperscriptBox["d1", "2"], " ", "m", " ", "m2", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"2", " ", "m1", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["d1", "2"], " ", "m1", " ", "m2", " ", 
               "\[Lambda]"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"4", " ", "d2", " ", "kvz", " ", "m1", " ", 
                    RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                    " ", "m2"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"4", " ", "d2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "m1"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["d1", "2"], " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "m1"}], "+", 
                  "m2"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "d2", " ", "kvz", " ", "m1", " ", 
                   RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                   " ", "m2"}], "+", 
                  RowBox[{"d1", " ", "kvz", " ", "m1", " ", 
                   RowBox[{"(", 
                    RowBox[{"m2", "-", 
                    RowBox[{
                    SuperscriptBox["d1", "2"], " ", "m2"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{
                   FractionBox["1", "4"], " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                   "\[Lambda]"}]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["d1", "2"], " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "d2", " ", "kvz", " ", 
                   RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                   " ", 
                   SuperscriptBox["m2", "2"]}], "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "-", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "kvz", " ", "m1",
                    " ", "m2", " ", 
                   RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{
                   FractionBox["1", "4"], " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d1", "2"]}], ")"}], " ", "m"}], "+", 
                    RowBox[{
                    SuperscriptBox["d1", "2"], " ", "m2"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                   "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "4"], " ", "d2", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["m", "2"], "-", 
                SuperscriptBox["m2", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
             RowBox[{"L2", " ", 
              SuperscriptBox["m2", "2"], " ", "\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "kvz", " ", "m1", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 FractionBox["1", "4"], " ", 
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                 "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["d1", "5"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["m", "2"], "-", 
                SuperscriptBox["m2", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
             RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 FractionBox["1", "4"], " ", 
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                 "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d2", " ", "L2", " ", "m2", " ", "\[Lambda]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", "m2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d2", " ", "kvz", " ", "m1", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                 " ", "m2"}], "-", 
                RowBox[{
                 FractionBox["1", "4"], " ", 
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                 "\[Lambda]"}]}], ")"}]}], "+", 
             RowBox[{"J", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d2", " ", "kvz", " ", "m1", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                 " ", "m2"}], "+", 
                RowBox[{"2", " ", "d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                  ")"}]}], "-", 
                RowBox[{
                 FractionBox["1", "4"], " ", 
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                 "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1", "-", "m2"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", "m1"}], ")"}]}], "-", "m1"}], ")"}], 
                 " ", "m2"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"L2", " ", "m1", " ", "m2", " ", "\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "d2"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"]}]}], ")"}], " ", "kvz", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                 " ", 
                 SuperscriptBox["m2", "2"]}], "-", 
                RowBox[{"4", " ", "d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "kvz", " ",
                  "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "J"}], "+", 
                   RowBox[{"d1", " ", "d2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{
                 FractionBox["1", "4"], " ", 
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2"}]}], 
                  ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                 "\[Lambda]"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1", "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m2"}]}], 
                  ")"}]}]}], ")"}]}], "-", 
             RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz", " ", "m1",
                     " ", 
                    RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                    " ", "m2"}], "+", 
                   RowBox[{"2", " ", "d1", " ", "kvz", " ", 
                    SuperscriptBox["m1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                    ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "4"], " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", "m1"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}], "+", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d2", " ", "kvz", " ", 
                    RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "-", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", "m1"}]}], ")"}], " ", 
                    "m2"}], "+", 
                   RowBox[{
                   "2", " ", "d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                    RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                    ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "4"], " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["d1", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", "m2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1", "-", "m2"}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox["d2", "2"]}], ")"}], " ", "m1", " ", "m2"}],
                 "+", 
                RowBox[{"m", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "+", 
                   RowBox[{
                    SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "m1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                    RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                    ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "4"], " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "m2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}], "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                    RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                    ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "4"], " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}], "-", 
                RowBox[{
                 FractionBox["1", "4"], " ", 
                 SuperscriptBox["d2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    SuperscriptBox["d1", "2"], " ", "d2", " ", "m1", " ", 
                    "m2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "kvz", " ", "m1", " ", "m2"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "m1", " ", "m2"}], "+", 
                    RowBox[{"m", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}], "+", 
                   RowBox[{"d2", " ", "J", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", "kvz", " ", "m1", " ", 
                    SuperscriptBox["m2", "2"]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "m1", " ", "m2"}], "+", 
                    RowBox[{"m", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}], "+", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    SuperscriptBox["d2", "2"], " ", "m1", " ", "m2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "kvz", " ", "m1", " ", "m2"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "m1", " ", "m2"}], "+", 
                    RowBox[{"m", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}], "+", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "kvz", " ", 
                    SuperscriptBox["m1", "2"], " ", "m2"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "m1", " ", "m2"}], "+", 
                    RowBox[{"m", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                    "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "0", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "+", 
          RowBox[{"2", " ", "d2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2"}], "+", 
          SuperscriptBox["d2", "3"]}], ")"}], " ", "kvz", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", "m2",
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d1", "3"], "+", "d2", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["d2", "2"]}], ")"}]}]}], ")"}], " ", "kvz", " ", 
         "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
         "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "J"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}]},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kiz", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kpz", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kvz", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}], " ", "m1", " ", "m2",
          " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "m1"}], "+", 
           RowBox[{"d2", " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"4", " ", "d1", " ", "d2", " ", "kiz", " ", "m1", " ", "m2"}], 
       
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"4", " ", "d1", " ", "d2", " ", "kpz", " ", "m1", " ", "m2"}], 
       
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m1", "+", "m2"}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"4", " ", "d1", " ", "d2", " ", "kvz", " ", "m1", " ", "m2"}], 
       
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{"J", " ", 
         RowBox[{"(", 
          RowBox[{"m1", "+", "m2"}], ")"}]}]}]], "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d1"}], " ", "m1"}], "+", 
           RowBox[{"d2", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d2", " ", "m2"}], "-", 
           RowBox[{"d1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d1"}], " ", "m1"}], "+", 
          RowBox[{"d2", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", "m2"}], "-", 
          RowBox[{"d1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "J", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", 
         SuperscriptBox["\[Lambda]", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", "L1", " ", 
         SuperscriptBox["m1", "2"], " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"4", " ", "d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "J"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", "m2"}]}], 
               ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], ")"}]}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "4"], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"]}], ")"}]}], "-", 
           RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"4", " ", "d2", " ", "kvz", " ", "m1", " ", 
                 RowBox[{"(", 
                  RowBox[{"J", "+", 
                   RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                 " ", "m2"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", "m1", " ", "m2"}], "-", 
              RowBox[{"2", " ", "J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "m1"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d2", "2"], " ", "m1"}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}], "+", 
           FractionBox[
            RowBox[{"4", " ", "L1", " ", "m1", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["d2", "2"]}], ")"}], " ", "kvz", " ", "m1", 
                " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "m2"}]}], ")"}]}], "-", 
               RowBox[{"d1", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "-", 
               RowBox[{
                FractionBox["1", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", "m1"}], ")"}]}], "-", 
                    RowBox[{"6", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], 
                " ", "\[Lambda]"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], ")"}]}], 
        "+", 
        RowBox[{
         SuperscriptBox["d2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "m1", " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
           
           FractionBox[
            RowBox[{"4", " ", "L1", " ", "m1", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "d2", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", 
                SuperscriptBox["m2", "2"]}], "+", 
               RowBox[{"d1", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m1"}], ")"}], " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "+", 
               RowBox[{
                FractionBox["1", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], 
                " ", "\[Lambda]"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], ")"}]}], 
        "+", 
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox["d1", "2"], " ", "m1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "d2", " ", "kvz", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m2"}], ")"}]}], "-", 
               RowBox[{"d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "-", 
               RowBox[{
                FractionBox["3", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                "\[Lambda]"}]}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["d2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", "gravity", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m1"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "-", "m2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
               RowBox[{"L1", " ", "m1", " ", "\[Lambda]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"d2", " ", "kvz", " ", 
                   RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d1", " ", 
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                   " ", "m2", " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
                  RowBox[{"d1", " ", "kvz", " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", 
                    RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2", " ", 
                   RowBox[{"(", 
                    RowBox[{"J", "+", 
                    RowBox[{"d2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                    ")"}]}], "-", 
                  RowBox[{
                   FractionBox["1", "4"], " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "-", "m2"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                   "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
            RowBox[{"J", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "4"], " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m2", "2"]}], ")"}]}], "+", 
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"4", " ", "d1", " ", "kvz", " ", "m1", " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "J"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
                    "m2"}]}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "m2"}], ")"}], " ", "\[Lambda]"}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}], " ", "\[Lambda]"}], 
           "-", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox["d2", "2"], " ", "m2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d2", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2"}], "-", 
               RowBox[{"2", " ", "d1", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m1"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "-", 
               RowBox[{
                FractionBox["3", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m1"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                "\[Lambda]"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], ")"}]}], 
        "+", 
        RowBox[{
         SuperscriptBox["d1", "3"], " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "-", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           FractionBox[
            RowBox[{
            "4", " ", "L2", " ", "m1", " ", "m2", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "d2"}], " ", "kvz", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "m2"}], ")"}]}], "-", 
               RowBox[{"d1", " ", "kvz", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "+", 
               RowBox[{
                FractionBox["1", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"m", "-", "m2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                "\[Lambda]"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], ")"}]}], 
        "+", 
        RowBox[{"d1", " ", "d2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"2", " ", "J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           FractionBox[
            RowBox[{"4", " ", "L2", " ", "m2", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "d1", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", 
                  RowBox[{"2", " ", "m1"}]}], ")"}], " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "d1"}], "+", "d2"}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "+", 
               RowBox[{"d2", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m2"}]}], 
                 ")"}]}], "+", 
               RowBox[{
                FractionBox["1", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "m1"}], "+", 
                    RowBox[{
                    SuperscriptBox["d2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"m", "+", "m1"}], ")"}]}]}], ")"}], " ", "m2"}], 
                  "+", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}], 
                " ", "\[Lambda]"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d1", "-", "d2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
               RowBox[{"J", " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], ")"}]}], 
        "+", 
        RowBox[{
         SuperscriptBox["d1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "m1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m1"}], ")"}]}]}], ")"}], " ", 
               "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"L2", " ", "m2", " ", "\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"8", " ", "d1", " ", "kvz", " ", 
                 SuperscriptBox["m1", "2"], " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "J"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
                    "m2"}]}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                   "-", 
                   RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}], "+", 
              FractionBox[
               RowBox[{"4", " ", "d2", " ", "kvz", " ", "m1", " ", 
                RowBox[{"(", 
                 RowBox[{"J", "+", 
                  RowBox[{"d1", " ", 
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "m1"}]}], ")"}], 
                " ", "m2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2"}]}], 
                 ")"}]}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
                  "-", 
                  RowBox[{"J", " ", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "+", 
              RowBox[{"J", " ", "m", " ", "\[Lambda]"}], "+", 
              RowBox[{"J", " ", "m1", " ", "\[Lambda]"}], "+", 
              RowBox[{"3", " ", "m", " ", "m1", " ", "\[Lambda]"}], "+", 
              RowBox[{"J", " ", "m2", " ", "\[Lambda]"}], "+", 
              RowBox[{"3", " ", "m1", " ", "m2", " ", "\[Lambda]"}], "-", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", "m2", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"4", " ", "d1", " ", "kvz", " ", "m1", " ", 
                   RowBox[{"(", 
                    RowBox[{"m", "+", "m1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "J"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", "d2", " ", 
                    "m2"}]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"d1", "-", "d2"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}],
                     "-", 
                    RowBox[{"J", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m"}], "+", "m1"}], ")"}], " ", 
                  "\[Lambda]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], "0", 
      FractionBox[
       RowBox[{"4", " ", "kvz", " ", "m1", " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["d2", "2"]}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             SuperscriptBox["d2", "2"]}], ")"}], " ", "J", " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "4"], " ", 
           SuperscriptBox["d2", "2"], " ", "m1", " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "3"], " ", "d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "J"}], " ", "m1"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["d2", "2"]}], ")"}], " ", "m1", " ", "m2"}], 
             "+", 
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox["d2", "2"]}], ")"}], " ", "m1"}], "-", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}],
           "+", 
          RowBox[{"d1", " ", "d2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["d2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"3", "+", 
                   SuperscriptBox["d2", "2"]}], ")"}], " ", "m1"}]}], ")"}], 
              " ", "m2"}], "+", 
             RowBox[{"J", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"3", "+", 
                   SuperscriptBox["d2", "2"]}], ")"}], " ", "m"}], "+", "m1", 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox["d2", "2"]}], ")"}], " ", "m2"}]}], 
               ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"J", " ", "m1"}], "+", 
             RowBox[{
              SuperscriptBox["d2", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", 
                 RowBox[{"(", 
                  RowBox[{"m1", "-", "m2"}], ")"}]}], "+", 
                RowBox[{"m1", " ", "m2"}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["d2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "m", " ", "m1"}], "-", 
                RowBox[{"J", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "m1"}], ")"}]}], "+", 
                RowBox[{"m", " ", "m2"}], "+", 
                RowBox[{"6", " ", "m1", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d1", "2"]}], "-", 
          RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
          "+", 
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kvz", " ", "m1", " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["d2", "2"]}], " ", "J", " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "5"], " ", "d2", " ", "m1", " ", "m2"}], "+", 
           RowBox[{"d1", " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "m"}], "+", 
                 RowBox[{"3", " ", "m1"}]}], ")"}], " ", "m2"}], "+", 
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "m"}], "+", 
                 RowBox[{"2", " ", "m1"}], "+", "m2", "-", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "3"], " ", "d2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", "m1"}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", 
                 SuperscriptBox["d2", "2"]}], ")"}], " ", "m1", " ", "m2"}], 
              "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "-", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "m1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", "m2"}]}], ")"}]}]}], 
             ")"}]}], "-", 
           RowBox[{
            SuperscriptBox["d1", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "m1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m1", " ", "m2"}], "+", 
                 RowBox[{"m", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "m1"}], "+", "m2"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "J", " ", "m1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "4"], " ", "m1", " ", "m2"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "6"}], " ", "m1", " ", "m2"}], "+", 
                 RowBox[{"J", " ", 
                  RowBox[{"(", 
                   RowBox[{"m", "+", "m2"}], ")"}]}], "-", 
                 RowBox[{"m", " ", 
                  RowBox[{"(", 
                   RowBox[{"m1", "+", 
                    RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d1", "2"]}], "-", 
           RowBox[{"2", " ", "d1", " ", "d2"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d2", "2"]}]}], ")"}], " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], "-", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "d1", " ", "d2", " ", "m1", " ", "m2"}], 
           "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1"}], ")"}], " ", "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m2"}], ")"}]}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}]}], ")"}]}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"gravity", " ", "kpr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           SuperscriptBox["L2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "-", 
             RowBox[{"2", " ", "kpx", " ", "L1", " ", "m1"}]}], ")"}], " ", 
           "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", 
           SuperscriptBox["L1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "-", 
             RowBox[{"2", " ", "kpx", " ", "L2", " ", "m2"}]}], ")"}]}], "+", 
          
          RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "kpx", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
             
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{"gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d2", "2"], " ", 
           SuperscriptBox["L2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "-", 
             RowBox[{"2", " ", "kpr", " ", "kvx", " ", "L1", " ", "m1"}]}], 
            ")"}], " ", "m2"}], "+", 
          RowBox[{
           SuperscriptBox["d1", "2"], " ", 
           SuperscriptBox["L1", "2"], " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "-", 
             RowBox[{"2", " ", "kpr", " ", "kvx", " ", "L2", " ", "m2"}]}], 
            ")"}]}], "+", 
          RowBox[{"d1", " ", "d2", " ", "L1", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "kpr", " ", "kvx", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
             
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{"kpr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d2", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "kpx", " ", "L1", " ", "m1"}], "+", 
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "m1"}]}], ")"}]}]}], ")"}], " ", "m2"}], 
          "-", 
          RowBox[{"d1", " ", "L1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "kpx", " ", "L2", " ", "m2"}], "+", 
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", "m1", 
        " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"d2", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpr", " ", "kvx", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m1"}]}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        
        RowBox[{"d1", " ", "L1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpr", " ", "kvx", " ", "L2", " ", "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", "m1", 
        " ", "m2"}]], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      FractionBox[
       RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"kpr", "-", "\[Lambda]"}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "L2", " ", "m2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Lambda]", "3"], "-", 
                RowBox[{"kpr", " ", 
                 RowBox[{"(", 
                  RowBox[{"kpx", "+", 
                   RowBox[{"\[Lambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "kvx"}], "+", "\[Lambda]"}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"d2", " ", "L2", " ", "m2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{"kpr", "-", "\[Lambda]"}], ")"}]}], "+", 
             RowBox[{"2", " ", "L1", " ", 
              RowBox[{"(", 
               RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["\[Lambda]", "3"]}], "+", 
                RowBox[{"kpr", " ", 
                 RowBox[{"(", 
                  RowBox[{"kpx", "+", 
                   RowBox[{"\[Lambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "kvx"}], "+", "\[Lambda]"}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
        SuperscriptBox["L1", "2"], " ", 
        SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]], "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
         "d1", " ", "gravity", " ", "kpr", " ", "L1", " ", "m", " ", "m1"}], 
         "+", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr", " ", "L2", " ", "m", " ", "m2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "+", 
         
         RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
        RowBox[{
         RowBox[{"d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], "-", 
         RowBox[{"d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], "0",
       "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
         "d1", " ", "gravity", " ", "kpr", " ", "L1", " ", "m", " ", "m1"}], 
         "-", 
         RowBox[{
         "d2", " ", "gravity", " ", "kpr", " ", "L2", " ", "m", " ", "m2"}], 
         "+", 
         RowBox[{
         "2", " ", "d1", " ", "kpr", " ", "kpx", " ", "L1", " ", "L2", " ", 
          "m1", " ", "m2"}], "-", 
         RowBox[{
         "2", " ", "d2", " ", "kpr", " ", "kpx", " ", "L1", " ", "L2", " ", 
          "m1", " ", "m2"}]}], 
        RowBox[{
         RowBox[{"2", " ", "d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}],
          "-", 
         RowBox[{
         "2", " ", "d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "-", 
         
         RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}], "+", 
         
         RowBox[{
         "2", " ", "d1", " ", "kpr", " ", "kvx", " ", "L1", " ", "L2", " ", 
          "m1", " ", "m2"}], "-", 
         RowBox[{
         "2", " ", "d2", " ", "kpr", " ", "kvx", " ", "L1", " ", "L2", " ", 
          "m1", " ", "m2"}]}], 
        RowBox[{
         RowBox[{"2", " ", "d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}],
          "-", 
         RowBox[{
         "2", " ", "d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"L1", " ", "m1"}], "+", 
           RowBox[{"L2", " ", "m2"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"kpr", "-", "\[Lambda]"}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", "L1", " ", "L2", " ", "m1", 
         " ", "m2"}]]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", "kpr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "L1", 
            " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "J", " ", 
            SuperscriptBox["L2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "gravity"}], " ", "m"}], "+", 
              RowBox[{"2", " ", "kpy", " ", "L1", " ", "m1"}]}], ")"}], " ", 
            "m2"}], "-", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "J", " ", "kpy", " ", 
               SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", 
                  SuperscriptBox["L1", "2"]}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m2"}]}], 
                ")"}]}]}], ")"}]}], "-", 
           RowBox[{"d1", " ", "d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "J", " ", "kpy", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], 
                 "+", 
                 RowBox[{"J", " ", "L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
           ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", 
         SuperscriptBox["L1", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "3"], " ", "d2", " ", "gravity", " ", "L1", 
            " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{
            SuperscriptBox["d2", "2"], " ", "J", " ", 
            SuperscriptBox["L2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "gravity"}], " ", "m"}], "+", 
              RowBox[{"2", " ", "kpr", " ", "kvy", " ", "L1", " ", "m1"}]}], 
             ")"}], " ", "m2"}], "-", 
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "J", " ", "kpr", " ", "kvy", " ", 
               SuperscriptBox["L1", "2"], " ", "L2", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", 
                  SuperscriptBox["L1", "2"]}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m2"}]}], 
                ")"}]}]}], ")"}]}], "-", 
           RowBox[{"d1", " ", "d2", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "J", " ", "kpr", " ", "kvy", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], 
                 "+", 
                 RowBox[{"J", " ", "L1", " ", 
                  RowBox[{"(", 
                   RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
           ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", "J", " ", 
         SuperscriptBox["L1", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"kpr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", "m1", 
           " ", "m2"}], "+", 
          RowBox[{"d2", " ", "J", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "kpy", " ", "L1", " ", "m1"}], "+", 
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{"m", "+", 
                RowBox[{"2", " ", "m1"}]}], ")"}]}]}], ")"}], " ", "m2"}], 
          "-", 
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "J", " ", "kpy", " ", "L1", " ", "L2", " ", "m2"}], 
             "+", 
             RowBox[{"gravity", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m2"}], 
                "+", 
                RowBox[{"J", " ", "L1", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", 
                   RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
         "m2"}], "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "kpr", " ", "kvy", " ", "L1", " ", "m1"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", 
              RowBox[{"2", " ", "m1"}]}], ")"}]}]}], ")"}], " ", "m2"}], "-", 
        
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "2", " ", "J", " ", "kpr", " ", "kvy", " ", "L1", " ", "L2", " ", 
            "m2"}], "+", 
           RowBox[{"gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m2"}], "+", 
              
              RowBox[{"J", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{"m", "+", 
                 RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
       
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["L1", "2"], "-", 
              SuperscriptBox["L2", "2"]}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "-", 
           RowBox[{"d2", " ", "J", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], " ", "m"}], "+", 
              RowBox[{"2", " ", "kpy", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
            "m2"}], "-", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "J", " ", "kpy", " ", "L1", " ", "L2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "L1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}],
              ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
         SuperscriptBox["J", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["L1", "2"], "-", 
              SuperscriptBox["L2", "2"]}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "-", 
           RowBox[{"d2", " ", "J", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], " ", "m"}], "+", 
              RowBox[{"2", " ", "kpr", " ", "kvy", " ", "L1", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1"}]}], ")"}], " ", 
            "m2"}], "-", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "J", " ", "kpr", " ", "kvy", " ", "L1", " ", "L2", 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "L1"}], "+", "L2"}], ")"}], " ", "m2"}], "+", 
              RowBox[{"gravity", " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "L1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}],
              ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"d1", "-", "d2"}], ")"}], "2"], " ", 
         SuperscriptBox["J", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", 
         SuperscriptBox["L2", "2"], " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", "L1", " ", "L2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"d1", " ", "d2", " ", "m"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", "L1", " ", "L2"}]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "kpr", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{"d2", " ", "J", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "gravity"}], " ", "m"}], "+", 
              RowBox[{"2", " ", "kpy", " ", "L1", " ", "m1"}]}], ")"}], " ", 
            "m2"}], "-", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "J", " ", "kpy", " ", "L1", " ", "L2", " ", "m2"}], 
              "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "L1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}],
              ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "L2", " ", "m1", " ", "m2"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d1", " ", "d2", " ", "gravity", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
            RowBox[{"(", 
             RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
            "m2"}], "+", 
           RowBox[{"d2", " ", "J", " ", "L2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "gravity"}], " ", "m"}], "+", 
              RowBox[{"2", " ", "kpr", " ", "kvy", " ", "L1", " ", "m1"}]}], 
             ")"}], " ", "m2"}], "-", 
           RowBox[{"d1", " ", "m1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "2", " ", "J", " ", "kpr", " ", "kvy", " ", "L1", " ", "L2", 
               " ", "m2"}], "+", 
              RowBox[{"gravity", " ", "m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J", " ", "L1"}], "+", 
                 RowBox[{
                  SuperscriptBox["d2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"L1", "-", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}],
              ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}], " ", 
         SuperscriptBox["J", "2"], " ", 
         SuperscriptBox["L1", "2"], " ", "L2", " ", "m1", " ", "m2"}]]}], 
      FractionBox[
       RowBox[{"kpr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
           RowBox[{"(", 
            RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", "m1", " ", 
           "m2"}], "+", 
          RowBox[{"d2", " ", "J", " ", "L2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gravity", " ", "m"}], "+", 
             RowBox[{"2", " ", "kpy", " ", "L1", " ", "m1"}]}], ")"}], " ", 
           "m2"}], "-", 
          RowBox[{"d1", " ", "m1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "J", " ", "kpy", " ", "L1", " ", "L2", " ", "m2"}], 
             "+", 
             RowBox[{"gravity", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", " ", "L1"}], "+", 
                RowBox[{
                 SuperscriptBox["d2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"L1", "+", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", "m1", " ", "m2"}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["d1", "2"], " ", "d2", " ", "gravity", " ", 
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], " ", "m", " ", "m1", " ", "m2"}], 
        "+", 
        RowBox[{"d2", " ", "J", " ", "L2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gravity", " ", "m"}], "+", 
           RowBox[{"2", " ", "kpr", " ", "kvy", " ", "L1", " ", "m1"}]}], 
          ")"}], " ", "m2"}], "-", 
        RowBox[{"d1", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "2", " ", "J", " ", "kpr", " ", "kvy", " ", "L1", " ", "L2", " ", 
            "m2"}], "+", 
           RowBox[{"gravity", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", " ", "L1"}], "+", 
              RowBox[{
               SuperscriptBox["d2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], " ", "m2"}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"d1", "-", "d2"}], ")"}], " ", "J", " ", "L1", " ", "L2", 
        " ", "m1", " ", "m2"}]], 
      RowBox[{"-", "kpr"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "\[Lambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "\[Lambda]"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "\[Lambda]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.712118121159089*^9, {3.7121183134530153`*^9, 3.712118361415965*^9}, 
   3.712127627457837*^9, 3.712127764087522*^9, 3.712127814647032*^9, 
   3.7121279110908213`*^9, 3.712130581260113*^9, 3.712130742220441*^9, {
   3.7121308029332848`*^9, 3.712130820454838*^9}, 3.7121361107898607`*^9, 
   3.712136156902248*^9, 3.712136220508626*^9, 3.712136260973846*^9, 
   3.712136403049707*^9, 3.71213696758477*^9, 3.7121502619211407`*^9, 
   3.71215059624776*^9, 3.712151264527417*^9, 3.712155876071486*^9, 
   3.712382170032302*^9, 3.712839226007615*^9, 3.71284595193544*^9, 
   3.712846456596137*^9, 3.7128472549384117`*^9, 3.712848788521823*^9, 
   3.712852614616385*^9, 3.712852692419676*^9, 3.71285272746294*^9, 
   3.712852796434763*^9, 3.71285394560638*^9, 3.712854166406406*^9, 
   3.712899682005507*^9, 3.7129290908776293`*^9, 3.712929873742146*^9, 
   3.7129449881687517`*^9, 3.712946390128953*^9, 3.712948859911867*^9, 
   3.712949174343101*^9, 3.7129494055326633`*^9, 3.712982464383987*^9, 
   3.712983233823802*^9, 3.712988470479671*^9, 3.7129885108527517`*^9, 
   3.713450416173375*^9, 3.7134507058469973`*^9, 3.71345077753308*^9, 
   3.713451068810204*^9, 3.713600886066307*^9, 3.714030539984508*^9, 
   3.7140306696805773`*^9, 3.71403144691822*^9, 3.714031575919845*^9, 
   3.714031705997246*^9, 3.7140319467417297`*^9, 3.7140341334861593`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["z and \[Theta] matrix", "Chapter",
 CellChangeTimes->{{3.713450417179948*^9, 3.713450422588997*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AsimilarSimplified", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "6"}], ",", 
       RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{"-", "d"}]}]}], "}"}]}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"AsimilarSimplified", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
        RowBox[{"d2", "\[Rule]", " ", 
         RowBox[{"-", "d"}]}], ",", 
        RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
        RowBox[{"m2", "\[Rule]", " ", "M"}]}], "}"}]}], "//", 
     "FullSimplify"}], "//", "MatrixForm"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.712945014916979*^9, 3.712945043809243*^9}, {
   3.712982474447101*^9, 3.712982483165021*^9}, 3.7134504376899633`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kiz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m1"}]}], ")"}], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "m1", " ", "m2"}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kpz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m1"}]}], ")"}], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "m1", " ", "m2"}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "kvz", " ", "m1", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m1"}]}], ")"}], " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"], " ", "m2"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "m1", " ", "m2"}], "+", 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]]}], 
      "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{"4", " ", "d", " ", "kiz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "-", "m2"}], ")"}], " ", "m2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "m1", " ", "m2"}], "+", 
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"4", " ", "d", " ", "kpz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "-", "m2"}], ")"}], " ", "m2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "m1", " ", "m2"}], "+", 
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"4", " ", "d", " ", "kvz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", "m"}]}], ")"}], " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "-", "m2"}], ")"}], " ", "m2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{"m", "+", "m1", "+", "m2"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "m1", " ", "m2"}], "+", 
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}]}], ")"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox["d", "2"], " ", "kiz", " ", "m1", " ", "m2"}], 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox["d", "2"], " ", "kpz", " ", "m1", " ", "m2"}], 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m1", "+", "m2"}], ")"}]}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox["d", "2"], " ", "kvz", " ", "m1", " ", "m2"}], 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["d", "2"], " ", "m1", " ", "m2"}], "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{"m1", "+", "m2"}], ")"}]}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.712988511498514*^9, 3.713450443598475*^9, 
  3.713450710505559*^9, 3.713451069364211*^9, 3.7136008867065268`*^9, 
  3.714030540754437*^9, 3.714030762041692*^9, 3.7140317218870707`*^9, 
  3.7140319518285*^9, 3.714034134273993*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["x and \[Delta] motion", "Chapter",
 CellChangeTimes->{3.713450784010139*^9}],

Cell[CellGroupData[{

Cell["systems of 3rd order", "Subchapter",
 CellChangeTimes->{{3.7120461272805777`*^9, 3.712046134118257*^9}, {
  3.7129297293378553`*^9, 3.71292973063983*^9}, {3.713450769546569*^9, 
  3.7134507857546597`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]3", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], "=", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fd", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", "fp"}], ")"}]}], " ", ",", 
       RowBox[{
        RowBox[{"fd", " ", "kd"}], "+", "fp"}], ",", "fd"}], "}"}]}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"AofInterest", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AsimilarSimplified", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"7", ";;", "11"}], ",", 
          RowBox[{"7", ";;", "11"}]}], "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d1", "\[Rule]", "d"}], ",", 
         RowBox[{"d2", "\[Rule]", " ", 
          RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
     "MatrixForm"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{"AsimilarSimplified", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"12", ";;", "14"}], ",", 
       RowBox[{"12", ";;", "14"}]}], "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aux", "=", " ", 
   RowBox[{
    RowBox[{"AofInterest", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "-", 
    RowBox[{"\[CapitalGamma]3", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"fp", ",", "fd"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol4", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Aux", "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "fp", ",", "fd"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aux", "/.", 
   RowBox[{"sol4", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"sol4", "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol4", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol4", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"m2", "\[Rule]", " ", "M"}]}], "}"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{
  3.712929734154932*^9, {3.7129297655255737`*^9, 3.712929785043717*^9}, {
   3.712929828312599*^9, 3.712929922442255*^9}, {3.7129299893588543`*^9, 
   3.71293000708534*^9}, {3.712930093520051*^9, 3.712930102045932*^9}, {
   3.7129301473624897`*^9, 3.712930193903036*^9}, {3.712930231075961*^9, 
   3.7129302629316273`*^9}, {3.712930304646874*^9, 3.712930308842493*^9}, {
   3.712930339523213*^9, 3.712930434110643*^9}, {3.7134511387314053`*^9, 
   3.713451147618335*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Solve","svars",
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"",2,
   123,1,29718940377574948816,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.712929995023278*^9, 3.712930007573245*^9}, {
   3.712930095926165*^9, 3.712930106830183*^9}, {3.7129301483055153`*^9, 
   3.712930194329401*^9}, {3.712930243051703*^9, 3.712930263547447*^9}, 
   3.712930319893977*^9, {3.7129303776447983`*^9, 3.71293043463237*^9}, {
   3.7134511242737017`*^9, 3.713451142101206*^9}, 3.7136008868341007`*^9, 
   3.714030541024137*^9, 3.7140319541900597`*^9, 3.7140341345303297`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929918929101*^9, 3.712929923156069*^9}, {
   3.712929982081903*^9, 3.712930007599017*^9}, {3.7129300959527483`*^9, 
   3.7129301068567944`*^9}, {3.712930148334269*^9, 3.7129301943536577`*^9}, {
   3.712930243092527*^9, 3.712930263575382*^9}, 3.712930319921864*^9, {
   3.712930377674179*^9, 3.712930434667211*^9}, {3.713451124307054*^9, 
   3.713451142140283*^9}, 3.713600886856617*^9, 3.714030541049028*^9, 
   3.7140319542213507`*^9, 3.71403413455716*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"d1", " ", "gravity", " ", "L1", " ", "m", " ", "m1"}], "-", 
       RowBox[{"d2", " ", "gravity", " ", "L2", " ", "m", " ", "m2"}]}], 
      RowBox[{
       RowBox[{"2", " ", "d1", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}], 
       "-", 
       RowBox[{
       "2", " ", "d2", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929918929101*^9, 3.712929923156069*^9}, {
   3.712929982081903*^9, 3.712930007599017*^9}, {3.7129300959527483`*^9, 
   3.7129301068567944`*^9}, {3.712930148334269*^9, 3.7129301943536577`*^9}, {
   3.712930243092527*^9, 3.712930263575382*^9}, 3.712930319921864*^9, {
   3.712930377674179*^9, 3.712930434667211*^9}, {3.713451124307054*^9, 
   3.713451142140283*^9}, 3.713600886856617*^9, 3.714030541049028*^9, 
   3.7140319542213507`*^9, 3.714034134569803*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L1", " ", "m1"}], "+", 
         RowBox[{"L2", " ", "m2"}]}], ")"}]}], 
      RowBox[{"4", " ", "L1", " ", "L2", " ", "m1", " ", "m2"}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929918929101*^9, 3.712929923156069*^9}, {
   3.712929982081903*^9, 3.712930007599017*^9}, {3.7129300959527483`*^9, 
   3.7129301068567944`*^9}, {3.712930148334269*^9, 3.7129301943536577`*^9}, {
   3.712930243092527*^9, 3.712930263575382*^9}, 3.712930319921864*^9, {
   3.712930377674179*^9, 3.712930434667211*^9}, {3.713451124307054*^9, 
   3.713451142140283*^9}, 3.713600886856617*^9, 3.714030541049028*^9, 
   3.7140319542213507`*^9, 3.714034134580475*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", "m"}], 
      RowBox[{"2", " ", "L", " ", "M"}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929918929101*^9, 3.712929923156069*^9}, {
   3.712929982081903*^9, 3.712930007599017*^9}, {3.7129300959527483`*^9, 
   3.7129301068567944`*^9}, {3.712930148334269*^9, 3.7129301943536577`*^9}, {
   3.712930243092527*^9, 3.712930263575382*^9}, 3.712930319921864*^9, {
   3.712930377674179*^9, 3.712930434667211*^9}, {3.713451124307054*^9, 
   3.713451142140283*^9}, 3.713600886856617*^9, 3.714030541049028*^9, 
   3.7140319542213507`*^9, 3.714034134592126*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["systems of 5th order", "Subchapter",
 CellChangeTimes->{{3.7120461272805777`*^9, 3.712046134118257*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fd", " ", "fp", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"fp", " ", "p1"}]}], ")"}]}], " ", ",", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fd", " ", "kd"}], "+", 
          RowBox[{"fp", " ", "p1"}]}], ")"}]}], ",", 
       RowBox[{"fd", 
        RowBox[{"(", 
         RowBox[{"kp", "+", " ", 
          RowBox[{"fp", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ")"}]}], " ", ",", 
       RowBox[{
        RowBox[{"fd", " ", "kd"}], "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ",", "fd"}], "}"}], 
     "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"fp", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fd", " ", 
           RowBox[{"(", 
            RowBox[{"kp", "+", 
             RowBox[{"fp", " ", "p1"}]}], ")"}]}], " ", ",", 
          RowBox[{"fp", " ", "p1"}], ",", 
          RowBox[{"fd", 
           RowBox[{"(", 
            RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}], " ", ",", 
          RowBox[{"1", "+", "p2", "+", "p1"}], ",", "0"}], "}"}]}], "+", 
       RowBox[{"fd", 
        RowBox[{"{", 
         RowBox[{"0", " ", ",", 
          RowBox[{"fp", "  ", "kd"}], ",", " ", "kp", " ", ",", "kd", ",", 
          "1"}], "}"}]}]}], ")"}]}], "//", "Simplify"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fd", " ", "fp", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", " ", "p1"}]}], ")"}]}], " ", ",", 
      RowBox[{"fp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"fd", " ", "kd"}], "+", 
         RowBox[{"fp", " ", "p1"}]}], ")"}]}], ",", 
      RowBox[{"fd", 
       RowBox[{"(", 
        RowBox[{"kp", "+", " ", 
         RowBox[{"fp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ")"}]}], " ", ",", 
      
      RowBox[{
       RowBox[{"fd", " ", "kd"}], "+", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ",", "fd"}], "}"}], 
    "-", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fd", " ", "fp", " ", 
         RowBox[{"(", 
          RowBox[{"kp", "+", 
           RowBox[{"fp", " ", "p1"}]}], ")"}]}], " ", ",", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fd", " ", "kd"}], "+", 
           RowBox[{"fp", " ", "p1"}]}], ")"}]}], ",", 
        RowBox[{"fd", " ", "kp"}], " ", ",", 
        RowBox[{"fd", " ", "kd"}], ",", "fd"}], "}"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "p2", "+", "p1"}], ")"}], " ", "fp", 
       RowBox[{"{", 
        RowBox[{
        "0", " ", ",", "0", ",", " ", "fd", " ", ",", "1", " ", ",", "0"}], 
        "}"}]}]}], ")"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.712930834093364*^9, 3.712930840643413*^9}, {
  3.7129308833447313`*^9, 3.7129309714095287`*^9}, {3.71293101178831*^9, 
  3.712931013112547*^9}, {3.712931044737829*^9, 3.712931098016238*^9}, {
  3.71293117604782*^9, 3.712931293572939*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712930840999065*^9, 3.7129309720441427`*^9, 3.712931014594221*^9, {
   3.712931057914109*^9, 3.7129310986933603`*^9}, {3.7129312154014683`*^9, 
   3.712931226405491*^9}, {3.71293125910297*^9, 3.712931294969225*^9}, 
   3.713451157351511*^9, 3.71360088697262*^9, 3.714030541251507*^9, 
   3.7140341346876698`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]5", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"fp_", ",", "fd_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kd_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fd", " ", "fp", " ", 
       RowBox[{"(", 
        RowBox[{"kp", "+", 
         RowBox[{"fp", " ", "p1"}]}], ")"}]}], " ", ",", 
      RowBox[{"fp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"fd", " ", "kd"}], "+", 
         RowBox[{"fp", " ", "p1"}]}], ")"}]}], ",", 
      RowBox[{"fd", 
       RowBox[{"(", 
        RowBox[{"kp", "+", " ", 
         RowBox[{"fp", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ")"}]}], " ", ",", 
      
      RowBox[{
       RowBox[{"fd", " ", "kd"}], "+", 
       RowBox[{"fp", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "p2", "+", "p1"}], ")"}]}]}], ",", "fd"}], 
     "}"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"AofInterest", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AsimilarSimplified", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"7", ";;", "11"}], ",", 
          RowBox[{"7", ";;", "11"}]}], "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d1", "\[Rule]", "d"}], ",", 
         RowBox[{"d2", "\[Rule]", " ", 
          RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
     "MatrixForm"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{"AsimilarSimplified", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"7", ";;", "11"}], ",", 
       RowBox[{"7", ";;", "11"}]}], "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aux", "=", " ", 
   RowBox[{
    RowBox[{"AofInterest", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "-", 
    RowBox[{"\[CapitalGamma]5", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"fp", ",", "fd"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kpx", ",", "kvx"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol1", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Aux", "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "fp", ",", "fd"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aux", "/.", 
   RowBox[{"sol1", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"sol1", "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol1", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol1", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"m2", "\[Rule]", " ", "M"}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.712929119199483*^9, 3.712929135959839*^9}, {
  3.712929216037655*^9, 3.712929219106752*^9}, {3.712930128226768*^9, 
  3.712930136664714*^9}, {3.7134511624920053`*^9, 3.713451163695698*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929108610139*^9, 3.7129291366794767`*^9}, 
   3.7129292210581713`*^9, 3.712930137353568*^9, {3.713451159681848*^9, 
   3.713451164310577*^9}, 3.713600887294525*^9, 3.7140305416499853`*^9, 
   3.714031957202808*^9, 3.714034135264456*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "+", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1", " ", "m1"}], "+", 
          RowBox[{"d2", " ", "L2", " ", "m2"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d1", " ", "L1"}], "-", 
           RowBox[{"d2", " ", "L2"}]}], ")"}], "2"], " ", "m1", " ", 
        "m2"}]]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox[
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d1", "2"], " ", 
          SuperscriptBox["L1", "2"], " ", "m1"}], "+", 
         RowBox[{
          SuperscriptBox["d2", "2"], " ", 
          SuperscriptBox["L2", "2"], " ", "m2"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d1", " ", "L1"}], "-", 
          RowBox[{"d2", " ", "L2"}]}], ")"}], "2"], " ", "m1", " ", "m2"}]]}],
     ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"d1", " ", "gravity", " ", "L1"}], "-", 
       RowBox[{"d2", " ", "gravity", " ", "L2"}]}], 
      RowBox[{
       RowBox[{"d1", " ", "L1", " ", "L2"}], "-", 
       RowBox[{"d2", " ", "L1", " ", "L2"}]}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929108610139*^9, 3.7129291366794767`*^9}, 
   3.7129292210581713`*^9, 3.712930137353568*^9, {3.713451159681848*^9, 
   3.713451164310577*^9}, 3.713600887294525*^9, 3.7140305416499853`*^9, 
   3.714031957202808*^9, 3.714034135278964*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L1", " ", "m1"}], "-", 
          RowBox[{"L2", " ", "m2"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], "2"], " ", "m1", " ", "m2"}]]}]}],
     ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox[
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["L1", "2"], " ", "m1"}], "+", 
         RowBox[{
          SuperscriptBox["L2", "2"], " ", "m2"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}], "2"], " ", "m1", " ", "m2"}]]}], 
    ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", 
       RowBox[{"(", 
        RowBox[{"L1", "+", "L2"}], ")"}]}], 
      RowBox[{"2", " ", "L1", " ", "L2"}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929108610139*^9, 3.7129291366794767`*^9}, 
   3.7129292210581713`*^9, 3.712930137353568*^9, {3.713451159681848*^9, 
   3.713451164310577*^9}, 3.713600887294525*^9, 3.7140305416499853`*^9, 
   3.714031957202808*^9, 3.714034135290605*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", "0"}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox["m", 
      RowBox[{"2", " ", "M"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox["gravity", "L"]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712929108610139*^9, 3.7129291366794767`*^9}, 
   3.7129292210581713`*^9, 3.712930137353568*^9, {3.713451159681848*^9, 
   3.713451164310577*^9}, 3.713600887294525*^9, 3.7140305416499853`*^9, 
   3.714031957202808*^9, 3.714034135301548*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Good and bad type of asymmetry", "Chapter",
 CellChangeTimes->{{3.713451286557625*^9, 3.713451296136018*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
     RowBox[{"sol1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"-", " ", 
         SqrtBox[
          RowBox[{"1", "+", "ee"}]]}], " ", "d"}]}], ",", 
      RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
      RowBox[{"L2", "\[Rule]", "  ", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "+", "ee"}]], " ", "L"}]}], ",", 
      RowBox[{"m1", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", " ", 
          RowBox[{"1", "+", "ee"}], ")"}], "2"], "M"}]}], ",", 
      RowBox[{"m2", "\[Rule]", "  ", "M"}]}], "}"}]}], "//", "Simplify"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.712929603122693*^9, 3.712929618569832*^9}, {
  3.712940298057744*^9, 3.712940298637752*^9}, {3.713451316885182*^9, 
  3.713451346369419*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
    RowBox[{"sol1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", 
      RowBox[{"-", " ", "d"}]}], ",", 
     RowBox[{"L1", "\[Rule]", " ", 
      RowBox[{"2", "  ", "L"}]}], ",", 
     RowBox[{"L2", "\[Rule]", "  ", "L"}], ",", 
     RowBox[{"m1", "\[Rule]", 
      RowBox[{"3", " ", "M"}]}], ",", 
     RowBox[{"m2", "\[Rule]", "  ", "M"}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
    RowBox[{"sol1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", 
      RowBox[{"-", " ", "d"}]}], ",", 
     RowBox[{"L1", "\[Rule]", 
      RowBox[{"2", " ", "L"}]}], ",", 
     RowBox[{"L2", "\[Rule]", "  ", "L"}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"m2", "\[Rule]", 
      RowBox[{"3", " ", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7129403049000387`*^9, 3.7129403561658497`*^9}, {
   3.7129403922553167`*^9, 3.712940466527966*^9}, {3.712940525715397*^9, 
   3.712940534500061*^9}, {3.712940566024023*^9, 3.712940584506819*^9}, 
   3.713600584439889*^9, {3.7136008954404783`*^9, 3.713600910367734*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"5", " ", "gravity", " ", "m"}], 
  RowBox[{"72", " ", "L", " ", "M"}]]], "Output",
 CellChangeTimes->{{3.712940579429946*^9, 3.712940585144577*^9}, {
   3.7134513017238407`*^9, 3.713451359029525*^9}, 3.713600585179146*^9, {
   3.713600887596249*^9, 3.713600910666103*^9}, 3.714030541880887*^9, 
   3.714031959903336*^9, 3.71403413585117*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"gravity", " ", "m"}], 
   RowBox[{"72", " ", "L", " ", "M"}]]}]], "Output",
 CellChangeTimes->{{3.712940579429946*^9, 3.712940585144577*^9}, {
   3.7134513017238407`*^9, 3.713451359029525*^9}, 3.713600585179146*^9, {
   3.713600887596249*^9, 3.713600910666103*^9}, 3.714030541880887*^9, 
   3.714031959903336*^9, 3.71403413586833*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["y and \[Psi] motion", "Chapter",
 CellChangeTimes->{{3.713451186647971*^9, 3.7134511890587263`*^9}}],

Cell[CellGroupData[{

Cell["y", "Subchapter",
 CellChangeTimes->{3.7134512087666187`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"AofInterest", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AsimilarSimplified", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"15", ";;", "19"}], ",", 
          RowBox[{"15", ";;", "19"}]}], "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d1", "\[Rule]", "d"}], ",", 
         RowBox[{"d2", "\[Rule]", " ", 
          RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
     "MatrixForm"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AofInterest", "=", 
     RowBox[{
      RowBox[{"AsimilarSimplified", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"15", ";;", "19"}], ",", 
         RowBox[{"15", ";;", "19"}]}], "]"}], "]"}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Aux", "=", " ", 
      RowBox[{
       RowBox[{"AofInterest", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "-", 
       RowBox[{"\[CapitalGamma]5", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"fp", ",", "fd"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}]}]}], ";"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol2", "=", 
     RowBox[{"Solve", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Aux", "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", "fp", ",", "fd"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Aux", "/.", 
     RowBox[{"sol2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol2", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol2", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
       RowBox[{"d2", "\[Rule]", " ", 
        RowBox[{"-", "d"}]}], ",", 
       RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
       RowBox[{"L2", "\[Rule]", " ", "L"}], ",", 
       RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
       RowBox[{"m2", "\[Rule]", " ", "M"}]}], "}"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.712849046057675*^9, 3.712849120084735*^9}, {
   3.712849153332575*^9, 3.7128491866387777`*^9}, {3.712849252185626*^9, 
   3.712849345165066*^9}, {3.712849378495935*^9, 3.712849419731876*^9}, {
   3.7128494866046057`*^9, 3.71284955196838*^9}, 3.712852861553344*^9, {
   3.712852893004334*^9, 3.712852917183426*^9}, {3.712853973565165*^9, 
   3.712854047132305*^9}, {3.712855881523466*^9, 3.712855887282476*^9}, {
   3.712856480761307*^9, 3.712856535311509*^9}, {3.712856867462824*^9, 
   3.712856943449503*^9}, {3.712856997141193*^9, 3.712857000811743*^9}, {
   3.712857129870899*^9, 3.712857136766575*^9}, {3.712857917337469*^9, 
   3.712857925366869*^9}, {3.712858003976475*^9, 3.712858020925601*^9}, {
   3.712889887540496*^9, 3.7128898910173817`*^9}, {3.7129290098350477`*^9, 
   3.712929027575224*^9}, {3.7129290617426767`*^9, 3.712929101573427*^9}, {
   3.712929151373266*^9, 3.712929202569336*^9}, {3.713451183927044*^9, 
   3.713451198800187*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7128528974123783`*^9, 3.712852917803164*^9}, 
   3.712853061115445*^9, 3.7128539693116302`*^9, 3.7128540007989407`*^9, 
   3.712854048255602*^9, 3.7128541764722013`*^9, 3.712854710785348*^9, 
   3.7128555827100983`*^9, 3.712855725698217*^9, 3.712855761453576*^9, 
   3.7128558880729237`*^9, 3.712856536218258*^9, 3.7128566965170403`*^9, {
   3.712856909478689*^9, 3.7128569208264437`*^9}, 3.7128569543611794`*^9, 
   3.712857001907572*^9, {3.712857118034178*^9, 3.7128571375234632`*^9}, {
   3.7128580091495543`*^9, 3.712858021621532*^9}, 3.7128898919009953`*^9, 
   3.712899696148288*^9, 3.712929168776466*^9, 3.712929203591552*^9, 
   3.713451202282703*^9, 3.713451361183454*^9, 3.71403054585958*^9, 
   3.714031965096871*^9, 3.714034136785248*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L1", " ", "m1"}], "-", 
             RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "J", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"L1", "+", "L2"}], ")"}], "2"], " ", "m1", " ", "m2"}]]}]}],
     ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox[
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"L1", "-", "L2"}], ")"}], "2"], " ", "m1", " ", "m2"}], 
         "+", 
         RowBox[{"J", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["L1", "2"], " ", "m1"}], "+", 
            RowBox[{
             SuperscriptBox["L2", "2"], " ", "m2"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"J", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}], "2"], " ", "m1", " ", "m2"}]]}], 
    ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{"gravity", " ", 
       RowBox[{"(", 
        RowBox[{"L1", "+", "L2"}], ")"}]}], 
      RowBox[{"2", " ", "L1", " ", "L2"}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7128528974123783`*^9, 3.712852917803164*^9}, 
   3.712853061115445*^9, 3.7128539693116302`*^9, 3.7128540007989407`*^9, 
   3.712854048255602*^9, 3.7128541764722013`*^9, 3.712854710785348*^9, 
   3.7128555827100983`*^9, 3.712855725698217*^9, 3.712855761453576*^9, 
   3.7128558880729237`*^9, 3.712856536218258*^9, 3.7128566965170403`*^9, {
   3.712856909478689*^9, 3.7128569208264437`*^9}, 3.7128569543611794`*^9, 
   3.712857001907572*^9, {3.712857118034178*^9, 3.7128571375234632`*^9}, {
   3.7128580091495543`*^9, 3.712858021621532*^9}, 3.7128898919009953`*^9, 
   3.712899696148288*^9, 3.712929168776466*^9, 3.712929203591552*^9, 
   3.713451202282703*^9, 3.713451361183454*^9, 3.71403054585958*^9, 
   3.714031965096871*^9, 3.7140341367999363`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", "0"}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox["m", 
      RowBox[{"2", " ", "M"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox["gravity", "L"]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7128528974123783`*^9, 3.712852917803164*^9}, 
   3.712853061115445*^9, 3.7128539693116302`*^9, 3.7128540007989407`*^9, 
   3.712854048255602*^9, 3.7128541764722013`*^9, 3.712854710785348*^9, 
   3.7128555827100983`*^9, 3.712855725698217*^9, 3.712855761453576*^9, 
   3.7128558880729237`*^9, 3.712856536218258*^9, 3.7128566965170403`*^9, {
   3.712856909478689*^9, 3.7128569208264437`*^9}, 3.7128569543611794`*^9, 
   3.712857001907572*^9, {3.712857118034178*^9, 3.7128571375234632`*^9}, {
   3.7128580091495543`*^9, 3.712858021621532*^9}, 3.7128898919009953`*^9, 
   3.712899696148288*^9, 3.712929168776466*^9, 3.712929203591552*^9, 
   3.713451202282703*^9, 3.713451361183454*^9, 3.71403054585958*^9, 
   3.714031965096871*^9, 3.714034136812375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Good and bad type of asymmetry", "Subsubsection",
 CellChangeTimes->{{3.713451286557625*^9, 3.713451296136018*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
     RowBox[{"sol1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"-", " ", 
         SqrtBox[
          RowBox[{"1", "+", "ee"}]]}], " ", "d"}]}], ",", 
      RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
      RowBox[{"L2", "\[Rule]", "  ", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "+", "ee"}]], " ", "L"}]}], ",", 
      RowBox[{"m1", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", " ", 
          RowBox[{"1", "+", "ee"}], ")"}], "2"], "M"}]}], ",", 
      RowBox[{"m2", "\[Rule]", "  ", "M"}]}], "}"}]}], "//", "Simplify"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.712929603122693*^9, 3.712929618569832*^9}, {
  3.712940298057744*^9, 3.712940298637752*^9}, {3.713451316885182*^9, 
  3.713451346369419*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
     RowBox[{"sol2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", 
       RowBox[{"-", " ", "d"}]}], ",", 
      RowBox[{"L1", "\[Rule]", " ", 
       RowBox[{"2", "  ", "L"}]}], ",", 
      RowBox[{"L2", "\[Rule]", "  ", "L"}], ",", 
      RowBox[{"m1", "\[Rule]", 
       RowBox[{"2", " ", "m"}]}], ",", 
      RowBox[{"m2", "\[Rule]", " ", 
       RowBox[{"4", " ", "m"}]}], ",", " ", 
      RowBox[{"J", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", 
        FractionBox["m", "2"]}]}]}], " ", "}"}]}], "//", "Simplify"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
     RowBox[{"sol2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", 
       RowBox[{"-", " ", "d"}]}], ",", 
      RowBox[{"L1", "\[Rule]", 
       RowBox[{"2", " ", "L"}]}], ",", 
      RowBox[{"L2", "\[Rule]", "  ", "L"}], ",", 
      RowBox[{"m1", "\[Rule]", 
       RowBox[{"4", " ", "m"}]}], ",", 
      RowBox[{"m2", "\[Rule]", 
       RowBox[{"2", " ", "m"}]}], ",", " ", 
      RowBox[{"J", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", 
        FractionBox["m", "2"]}]}]}], "}"}]}], "//", "Simplify"}], " ", "//", 
  "N"}]}], "Input",
 CellChangeTimes->{{3.7129403049000387`*^9, 3.7129403561658497`*^9}, {
   3.7129403922553167`*^9, 3.712940466527966*^9}, {3.712940525715397*^9, 
   3.712940534500061*^9}, {3.712940566024023*^9, 3.712940584506819*^9}, 
   3.713600584439889*^9, {3.7136008954404783`*^9, 3.713600910367734*^9}, {
   3.714031980683456*^9, 3.71403203531536*^9}, {3.7140320653633347`*^9, 
   3.7140321061810627`*^9}, {3.714032144900069*^9, 3.714032155208634*^9}, {
   3.714032185651309*^9, 3.714032249825471*^9}, {3.7140322969561234`*^9, 
   3.714032418073723*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"0.08333333333333333`", " ", "gravity"}], "L"]], "Output",
 CellChangeTimes->{{3.712940579429946*^9, 3.712940585144577*^9}, {
   3.7134513017238407`*^9, 3.713451359029525*^9}, 3.713600585179146*^9, {
   3.713600887596249*^9, 3.713600910666103*^9}, 3.714030541880887*^9, {
   3.714031959903336*^9, 3.7140319831250362`*^9}, 3.714032036043524*^9, {
   3.7140320662138443`*^9, 3.714032086447123*^9}, {3.7140321216413116`*^9, 
   3.7140321556856813`*^9}, {3.714032191607605*^9, 3.714032250111272*^9}, {
   3.7140323129494257`*^9, 3.714032444881619*^9}, 3.714034137053731*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"0.11458333333333333`", " ", "gravity"}], "L"]], "Output",
 CellChangeTimes->{{3.712940579429946*^9, 3.712940585144577*^9}, {
   3.7134513017238407`*^9, 3.713451359029525*^9}, 3.713600585179146*^9, {
   3.713600887596249*^9, 3.713600910666103*^9}, 3.714030541880887*^9, {
   3.714031959903336*^9, 3.7140319831250362`*^9}, 3.714032036043524*^9, {
   3.7140320662138443`*^9, 3.714032086447123*^9}, {3.7140321216413116`*^9, 
   3.7140321556856813`*^9}, {3.714032191607605*^9, 3.714032250111272*^9}, {
   3.7140323129494257`*^9, 3.714032444881619*^9}, 3.714034137068338*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Psi]", "Subchapter",
 CellChangeTimes->{{3.7134512127685413`*^9, 3.713451213298399*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]5", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p2_", ",", "p6_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kp_", ",", "kv_"}], "}"}], ",", "k\[Theta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "k\[Theta]"}], 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"gL", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "+", 
          RowBox[{"gL", " ", "p2"}]}], ")"}]}], " ", ",", 
       RowBox[{"gL", " ", "kv"}], ",", 
       RowBox[{"(", 
        RowBox[{"kp", "+", " ", 
         RowBox[{"gL", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "p6", "+", "p2"}], ")"}]}]}], ")"}], " ", ",", 
       " ", "kv", ",", "0"}], "}"}]}], "-", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox["gL", "2"], " ", "p2"}], ",", "0", ",", 
      RowBox[{"gL", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "p6", "+", "p2"}], ")"}]}], " ", ",", "k\[Theta]"}],
      "}"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"AofInterest", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AsimilarSimplified", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"20", ";;", "24"}], ",", 
          RowBox[{"20", ";;", "24"}]}], "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d1", "\[Rule]", "d"}], ",", 
         RowBox[{"d2", "\[Rule]", " ", 
          RowBox[{"-", "d"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
     "MatrixForm"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AofInterest", "=", 
   RowBox[{
    RowBox[{"AsimilarSimplified", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"20", ";;", "24"}], ",", 
       RowBox[{"20", ";;", "24"}]}], "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aux", "=", " ", 
   RowBox[{
    RowBox[{"AofInterest", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "-", " ", 
    RowBox[{"\[CapitalGamma]5", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"fp", ",", "fd"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kpy", ",", "kvy"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol3", "=", 
   RowBox[{"Solve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Aux", "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "fp", ",", "fd"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aux", "/.", 
   RowBox[{"sol3", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol3", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol3", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"m2", "\[Rule]", " ", "M"}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol3", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d1", "\[Rule]", " ", "d"}], ",", 
     RowBox[{"d2", "\[Rule]", " ", 
      RowBox[{"-", "d"}]}], ",", 
     RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"L2", "\[Rule]", " ", "L"}], ",", 
     RowBox[{"m1", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"m2", "\[Rule]", " ", "M"}], ",", 
     RowBox[{"J", "\[Rule]", " ", 
      RowBox[{
       FractionBox["1", "12"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", "d"}], ")"}], "2"], "m"}]}]}], "}"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.712856062773191*^9, 3.712856084620051*^9}, {
  3.712856305595718*^9, 3.712856429087453*^9}, {3.712858042102138*^9, 
  3.712858044835031*^9}, {3.712929239887555*^9, 3.712929269610483*^9}, {
  3.712929312852688*^9, 3.712929326723762*^9}, {3.713451219060378*^9, 
  3.713451221259918*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712855893437166*^9, 3.712855980054945*^9, 3.712856030968955*^9, {
   3.712856067769691*^9, 3.712856085470656*^9}, 3.712856271522493*^9, 
   3.71285634037218*^9, {3.712856380805854*^9, 3.712856455439385*^9}, 
   3.712856705197672*^9, 3.71285804598676*^9, {3.712929261623456*^9, 
   3.7129292700597887`*^9}, 3.712929328158907*^9, 3.713451221870883*^9, 
   3.714030556799683*^9, 3.714032447901909*^9, 3.714034137488594*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"L1", "-", "L2"}], ")"}], " ", "m1", " ", "m2"}], "+", 
       RowBox[{"J", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L1", " ", "m1"}], "-", 
          RowBox[{"L2", " ", "m2"}]}], ")"}]}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["d", "2"], " ", "L2", " ", "m1", " ", "m2"}]]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox["J", 
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", "m1"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["d", "2"], " ", "gravity", " ", "m"}], 
      RowBox[{"J", " ", "L1"}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712855893437166*^9, 3.712855980054945*^9, 3.712856030968955*^9, {
   3.712856067769691*^9, 3.712856085470656*^9}, 3.712856271522493*^9, 
   3.71285634037218*^9, {3.712856380805854*^9, 3.712856455439385*^9}, 
   3.712856705197672*^9, 3.71285804598676*^9, {3.712929261623456*^9, 
   3.7129292700597887`*^9}, 3.712929328158907*^9, 3.713451221870883*^9, 
   3.714030556799683*^9, 3.714032447901909*^9, 3.7140341375056953`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", "0"}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox["J", 
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"], " ", "M"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["d", "2"], " ", "gravity", " ", "m"}], 
      RowBox[{"J", " ", "L"}]]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712855893437166*^9, 3.712855980054945*^9, 3.712856030968955*^9, {
   3.712856067769691*^9, 3.712856085470656*^9}, 3.712856271522493*^9, 
   3.71285634037218*^9, {3.712856380805854*^9, 3.712856455439385*^9}, 
   3.712856705197672*^9, 3.71285804598676*^9, {3.712929261623456*^9, 
   3.7129292700597887`*^9}, 3.712929328158907*^9, 3.713451221870883*^9, 
   3.714030556799683*^9, 3.714032447901909*^9, 3.714034137516436*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", "0"}], ",", 
    RowBox[{"p2", "\[Rule]", 
     FractionBox["m", 
      RowBox[{"6", " ", "M"}]]}], ",", 
    RowBox[{"fp", "\[Rule]", 
     FractionBox[
      RowBox[{"3", " ", "gravity"}], "L"]}], ",", 
    RowBox[{"fd", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.712855893437166*^9, 3.712855980054945*^9, 3.712856030968955*^9, {
   3.712856067769691*^9, 3.712856085470656*^9}, 3.712856271522493*^9, 
   3.71285634037218*^9, {3.712856380805854*^9, 3.712856455439385*^9}, 
   3.712856705197672*^9, 3.71285804598676*^9, {3.712929261623456*^9, 
   3.7129292700597887`*^9}, 3.712929328158907*^9, 3.713451221870883*^9, 
   3.714030556799683*^9, 3.714032447901909*^9, 3.714034137527109*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Good and bad type of asymmetry", "Subsubsection",
 CellChangeTimes->{{3.713451286557625*^9, 3.713451296136018*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
     RowBox[{"sol1", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"-", " ", 
         SqrtBox[
          RowBox[{"1", "+", "ee"}]]}], " ", "d"}]}], ",", 
      RowBox[{"L1", "\[Rule]", " ", "L"}], ",", 
      RowBox[{"L2", "\[Rule]", "  ", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "+", "ee"}]], " ", "L"}]}], ",", 
      RowBox[{"m1", "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", " ", 
          RowBox[{"1", "+", "ee"}], ")"}], "2"], "M"}]}], ",", 
      RowBox[{"m2", "\[Rule]", "  ", "M"}]}], "}"}]}], "//", "Simplify"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.712929603122693*^9, 3.712929618569832*^9}, {
  3.712940298057744*^9, 3.712940298637752*^9}, {3.713451316885182*^9, 
  3.713451346369419*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
     RowBox[{"sol3", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", 
       RowBox[{"-", " ", "d"}]}], ",", 
      RowBox[{"L1", "\[Rule]", " ", 
       RowBox[{"2", "  ", "L"}]}], ",", 
      RowBox[{"L2", "\[Rule]", "  ", "L"}], ",", 
      RowBox[{"m1", "\[Rule]", 
       RowBox[{"2", " ", "m"}]}], ",", 
      RowBox[{"m2", "\[Rule]", " ", 
       RowBox[{"4", " ", "m"}]}], ",", " ", 
      RowBox[{"J", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", 
        FractionBox["m", "2"]}]}]}], " ", "}"}]}], "//", "Simplify"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "fp"}], " ", "p1"}], "/.", 
     RowBox[{"sol3", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", "\[Rule]", "  ", "d"}], ",", 
      RowBox[{"d2", "\[Rule]", 
       RowBox[{"-", " ", "d"}]}], ",", 
      RowBox[{"L1", "\[Rule]", 
       RowBox[{"2", " ", "L"}]}], ",", 
      RowBox[{"L2", "\[Rule]", "  ", "L"}], ",", 
      RowBox[{"m1", "\[Rule]", 
       RowBox[{"4", " ", "m"}]}], ",", 
      RowBox[{"m2", "\[Rule]", 
       RowBox[{"2", " ", "m"}]}], ",", " ", 
      RowBox[{"J", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", 
        FractionBox["m", "2"]}]}]}], "}"}]}], "//", "Simplify"}], " ", "//", 
  "N"}]}], "Input",
 CellChangeTimes->{{3.7129403049000387`*^9, 3.7129403561658497`*^9}, {
   3.7129403922553167`*^9, 3.712940466527966*^9}, {3.712940525715397*^9, 
   3.712940534500061*^9}, {3.712940566024023*^9, 3.712940584506819*^9}, 
   3.713600584439889*^9, {3.7136008954404783`*^9, 3.713600910367734*^9}, {
   3.714031980683456*^9, 3.71403203531536*^9}, {3.7140320653633347`*^9, 
   3.7140321061810627`*^9}, {3.714032144900069*^9, 3.714032155208634*^9}, {
   3.714032185651309*^9, 3.714032249825471*^9}, {3.7140322969561234`*^9, 
   3.714032418073723*^9}, {3.714032457962453*^9, 3.714032500781464*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"0.25`", " ", "gravity"}], "L"]}]], "Output",
 CellChangeTimes->{{3.712940579429946*^9, 3.712940585144577*^9}, {
   3.7134513017238407`*^9, 3.713451359029525*^9}, 3.713600585179146*^9, {
   3.713600887596249*^9, 3.713600910666103*^9}, 3.714030541880887*^9, {
   3.714031959903336*^9, 3.7140319831250362`*^9}, 3.714032036043524*^9, {
   3.7140320662138443`*^9, 3.714032086447123*^9}, {3.7140321216413116`*^9, 
   3.7140321556856813`*^9}, {3.714032191607605*^9, 3.714032250111272*^9}, {
   3.7140323129494257`*^9, 3.714032418596497*^9}, {3.714032460514887*^9, 
   3.714032539427973*^9}, 3.714034138021646*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"0.34375`", " ", "gravity"}], "L"]}]], "Output",
 CellChangeTimes->{{3.712940579429946*^9, 3.712940585144577*^9}, {
   3.7134513017238407`*^9, 3.713451359029525*^9}, 3.713600585179146*^9, {
   3.713600887596249*^9, 3.713600910666103*^9}, 3.714030541880887*^9, {
   3.714031959903336*^9, 3.7140319831250362`*^9}, 3.714032036043524*^9, {
   3.7140320662138443`*^9, 3.714032086447123*^9}, {3.7140321216413116`*^9, 
   3.7140321556856813`*^9}, {3.714032191607605*^9, 3.714032250111272*^9}, {
   3.7140323129494257`*^9, 3.714032418596497*^9}, {3.714032460514887*^9, 
   3.714032539427973*^9}, 3.71403413803804*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relations with specific physical constants", "Chapter",
 CellChangeTimes->{{3.713451238360181*^9, 3.713451249565943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gravity", "\[Rule]", "9.81"}], ",", "\[IndentingNewLine]", 
     RowBox[{"m1", " ", "\[Rule]", "2.222"}], ",", 
     RowBox[{"(*", 
      RowBox[{"neo", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"m2", "\[Rule]", " ", 
      RowBox[{"2.733", "+", "0.8"}]}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"popeye", " ", "mass"}], " ", "+", " ", 
       RowBox[{"robotic", " ", "arm"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"L1", "\[Rule]", " ", "1.45"}], ",", 
     RowBox[{"(*", 
      RowBox[{"cable", " ", "length", " ", "neo"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"L2", "\[Rule]", "1.2"}], " ", ",", 
     RowBox[{"(*", 
      RowBox[{"cable", " ", "length", " ", "popeye"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d1", "\[Rule]", " ", 
      RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"d2", "\[Rule]", " ", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhysicalConstants", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{"PhysicalConstants", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"J", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"d1", " ", "m1", " ", "gravity"}], "+", 
           RowBox[{"d2", " ", "m2", " ", "gravity"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", "d1", "]"}], "+", 
               RowBox[{"Abs", "[", "d2", "]"}]}], ")"}], "2"]}]}]}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"d1", "*", "m1", "*", "g"}], "+", 
           RowBox[{"d2", "*", "m2", "*", "g"}], "+", 
           RowBox[{
            FractionBox["1", "12"], "mbar", " ", 
            SuperscriptBox["L", "2"]}]}], "*)"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"m", "\[Rule]", " ", 
          RowBox[{"m1", "+", "m2", "+", "mbar"}]}]}], "\[IndentingNewLine]", 
        "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", " ", "0.587"}], ",", 
         RowBox[{"m2", "\[Rule]", " ", "0.608"}], ",", 
         RowBox[{"mbar", "\[Rule]", " ", "0.287"}]}], "}"}]}], "/.", 
      "PhysicalConstants"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solz\[Theta]2", "/.", "PhysicalConstants"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solx\[Delta]2", "/.", "PhysicalConstants"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soly\[Psi]2", "/.", "PhysicalConstants"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.712857223867889*^9, 3.712857238341395*^9}, {
  3.712857280749794*^9, 3.71285735491728*^9}, {3.712857407267355*^9, 
  3.712857408344347*^9}, {3.7128574532220287`*^9, 3.712857486081949*^9}, {
  3.7128575765153503`*^9, 3.712857584937153*^9}, {3.713451231875615*^9, 
  3.713451251297145*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpz1", "\[Rule]", 
     RowBox[{"1.0119350786378802`", " ", "kpz"}]}], ",", 
    RowBox[{"kpz2", "\[Rule]", 
     RowBox[{"0.9880649213621195`", " ", "kpz"}]}], ",", 
    RowBox[{"kvz1", "\[Rule]", 
     RowBox[{"1.0119350786378802`", " ", "kvz"}]}], ",", 
    RowBox[{"kvz2", "\[Rule]", 
     RowBox[{"0.9880649213621195`", " ", "kvz"}]}], ",", 
    RowBox[{"kiz1", "\[Rule]", 
     RowBox[{"1.0119350786378802`", " ", "kiz"}]}], ",", 
    RowBox[{"kiz2", "\[Rule]", 
     RowBox[{"0.9880649213621195`", " ", "kiz"}]}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.712857294802072*^9, 3.712857361004488*^9}, {
   3.712857408857272*^9, 3.712857418953743*^9}, {3.712857454181406*^9, 
   3.7128574867584476`*^9}, 3.7134512518912373`*^9, 3.7137733308476133`*^9, 
   3.714034138506216*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpx1", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "0.2707946337910483`"}], "+", "kpx"}]}], ",", 
    RowBox[{"kpx2", "\[Rule]", 
     RowBox[{"0.2707946337910483`", "\[VeryThinSpace]", "+", "kpx"}]}], ",", 
    RowBox[{"kvx1", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["0.2707946337910483`", "kpr"]}], "+", "kvx"}]}], ",", 
    RowBox[{"kvx2", "\[Rule]", 
     RowBox[{
      FractionBox["0.2707946337910483`", "kpr"], "+", "kvx"}]}], ",", 
    RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
    RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712857294802072*^9, 3.712857361004488*^9}, {
   3.712857408857272*^9, 3.712857418953743*^9}, {3.712857454181406*^9, 
   3.7128574867584476`*^9}, 3.7134512518912373`*^9, 3.7137733308476133`*^9, 
   3.7140341385213823`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kpy1", "\[Rule]", 
     RowBox[{"3.1912786371654853`", "\[VeryThinSpace]", "+", "kpy"}]}], ",", 
    RowBox[{"kpy2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "3.1912786371654853`"}], "+", "kpy"}]}], ",", 
    RowBox[{"kvy1", "\[Rule]", 
     RowBox[{
      FractionBox["3.191278637165487`", "kpr"], "+", "kvy"}]}], ",", 
    RowBox[{"kvy2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["3.191278637165487`", "kpr"]}], "+", "kvy"}]}], ",", 
    RowBox[{"kp\[Psi]1", "\[Rule]", "0"}], ",", 
    RowBox[{"kp\[Psi]2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "4.8602806830393925`"}], "+", 
      RowBox[{"0.14367816091954022`", " ", "kpy"}]}]}], ",", 
    RowBox[{"kv\[Psi]1", "\[Rule]", "0"}], ",", 
    RowBox[{"kv\[Psi]2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["4.860280683039396`", "kpr"]}], "+", 
      RowBox[{"0.14367816091954033`", " ", "kvy"}]}]}], ",", 
    RowBox[{"kpr1", "\[Rule]", "kpr"}], ",", 
    RowBox[{"kpr2", "\[Rule]", "kpr"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.712857294802072*^9, 3.712857361004488*^9}, {
   3.712857408857272*^9, 3.712857418953743*^9}, {3.712857454181406*^9, 
   3.7128574867584476`*^9}, 3.7134512518912373`*^9, 3.7137733308476133`*^9, 
   3.714034138532839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"PhysicalConstants", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox["m", "m1"], "100"}], "/.", 
  "PhysicalConstants"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox["m", "m2"], "100"}], "/.", "PhysicalConstants"}]}], "Input",
 CellChangeTimes->{{3.7137734594687157`*^9, 3.713773478328403*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gravity", "\[Rule]", "9.81`"}], ",", 
   RowBox[{"m1", "\[Rule]", "2.222`"}], ",", 
   RowBox[{"m2", "\[Rule]", "3.5330000000000004`"}], ",", 
   RowBox[{"L1", "\[Rule]", "1.45`"}], ",", 
   RowBox[{"L2", "\[Rule]", "1.2`"}], ",", 
   RowBox[{"d1", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"d2", "\[Rule]", "1"}], ",", 
   RowBox[{"J", "\[Rule]", "0.3016766666666667`"}], ",", 
   RowBox[{"m", "\[Rule]", "1.4819999999999998`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.713773337045237*^9, {3.713773468063455*^9, 3.713773478822605*^9}, 
   3.714034138761076*^9}],

Cell[BoxData["66.69666966696668`"], "Output",
 CellChangeTimes->{
  3.713773337045237*^9, {3.713773468063455*^9, 3.713773478822605*^9}, 
   3.714034138777207*^9}],

Cell[BoxData["41.94735352391734`"], "Output",
 CellChangeTimes->{
  3.713773337045237*^9, {3.713773468063455*^9, 3.713773478822605*^9}, 
   3.714034138787273*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.713773445553917*^9, 3.7137734582635727`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.713773441816881*^9, 3.713773444309149*^9}}]
}, Open  ]]
}, Closed]]
},
WindowSize->{1383, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 152, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[734, 28, 188, 3, 66, "Title"],
Cell[925, 33, 2132, 64, 138, "Input"],
Cell[3060, 99, 5003, 144, 285, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8100, 248, 104, 1, 66, "Title"],
Cell[8207, 251, 189, 2, 51, "Subtitle"],
Cell[8399, 255, 4003, 108, 537, "Input"],
Cell[CellGroupData[{
Cell[12427, 367, 129, 1, 65, "Chapter"],
Cell[12559, 370, 4014, 97, 314, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16610, 472, 98, 1, 65, "Chapter"],
Cell[16711, 475, 7622, 185, 348, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24370, 665, 241, 3, 65, "Chapter"],
Cell[CellGroupData[{
Cell[24636, 672, 6345, 167, 369, "Input"],
Cell[30984, 841, 425, 9, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31458, 856, 148, 2, 65, "Chapter"],
Cell[31609, 860, 23724, 553, 1589, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55370, 1418, 133, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[55528, 1423, 4305, 111, 285, "Input"],
Cell[59836, 1536, 1584, 24, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61469, 1566, 155, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[61649, 1572, 868, 22, 96, "Input"],
Cell[62520, 1596, 1642, 25, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64211, 1627, 200, 3, 65, "Chapter"],
Cell[64414, 1632, 654, 17, 51, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65105, 1654, 129, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[65259, 1659, 117, 3, 32, "Input"],
Cell[65379, 1664, 657, 12, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[66097, 1683, 94, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[66216, 1688, 193, 2, 65, "Chapter"],
Cell[66412, 1692, 777, 17, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67226, 1714, 109, 1, 65, "Chapter"],
Cell[67338, 1717, 10348, 236, 358, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77723, 1958, 213, 4, 65, "Chapter"],
Cell[77939, 1964, 817, 26, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78793, 1995, 109, 1, 65, "Chapter"],
Cell[78905, 1998, 233, 6, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79175, 2009, 117, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[79317, 2014, 93, 2, 32, "Input"],
Cell[79413, 2018, 633, 11, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[80107, 2036, 119, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[80251, 2041, 113, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[80389, 2046, 1395, 42, 117, "Input"],
Cell[81787, 2090, 1231, 29, 74, "Output"],
Cell[83021, 2121, 1297, 31, 92, "Output"],
Cell[84321, 2154, 1374, 33, 108, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85744, 2193, 105, 1, 65, "Chapter"],
Cell[85852, 2196, 645, 14, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86534, 2215, 296, 6, 65, "Chapter"],
Cell[CellGroupData[{
Cell[86855, 2225, 652, 18, 75, "Input"],
Cell[87510, 2245, 1119, 30, 76, "Output"],
Cell[88632, 2277, 1152, 32, 94, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[89833, 2315, 339, 6, 65, "Chapter"],
Cell[CellGroupData[{
Cell[90197, 2325, 3011, 77, 98, "Input"],
Cell[93211, 2404, 1739, 50, 110, "Output"],
Cell[94953, 2456, 1829, 55, 134, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[96843, 2518, 95, 1, 66, "Title"],
Cell[96941, 2521, 182, 2, 65, "Chapter"]
}, Closed]],
Cell[CellGroupData[{
Cell[97160, 2528, 72, 1, 66, "Title"],
Cell[CellGroupData[{
Cell[97257, 2533, 239, 3, 65, "Chapter"],
Cell[97499, 2538, 3678, 78, 159, "Input"],
Cell[101180, 2618, 2283, 58, 159, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103500, 2681, 135, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[103660, 2686, 1048, 32, 57, "Input"],
Cell[104711, 2720, 4855, 132, 248, "Output"],
Cell[109569, 2854, 693, 10, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110311, 2870, 107, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[110443, 2875, 3311, 83, 201, "Input"],
Cell[113757, 2960, 870, 15, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114676, 2981, 116, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[114817, 2986, 1301, 24, 75, "Input"],
Cell[116121, 3012, 1151, 18, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117321, 3036, 105, 1, 65, "Chapter"],
Cell[117429, 3039, 614, 16, 54, "Input"],
Cell[118046, 3057, 390, 9, 54, "Input"],
Cell[118439, 3068, 952, 27, 54, "Input"],
Cell[119394, 3097, 1320, 31, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120751, 3133, 102, 1, 65, "Chapter"],
Cell[120856, 3136, 1824, 46, 117, "Input"],
Cell[CellGroupData[{
Cell[122705, 3186, 5463, 141, 389, "Input"],
Cell[128171, 3329, 923, 14, 32, "Output"],
Cell[129097, 3345, 877, 12, 32, "Output"],
Cell[129977, 3359, 37545, 1001, 784, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[167571, 4366, 251, 6, 65, "Chapter"],
Cell[CellGroupData[{
Cell[167847, 4376, 485, 11, 54, "Input"],
Cell[168335, 4389, 100271, 2650, 678, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268643, 7044, 374, 10, 32, "Input"],
Cell[269020, 7056, 1900, 42, 160, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[270969, 7104, 209, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[271203, 7112, 1127, 29, 54, "Input"],
Cell[272333, 7143, 2205, 64, 47, "Output"],
Cell[274541, 7209, 1674, 47, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276252, 7261, 973, 27, 54, "Input"],
Cell[277228, 7290, 1576, 37, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[278841, 7332, 1160, 29, 54, "Input"],
Cell[280004, 7363, 4366, 116, 139, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[284419, 7485, 239, 4, 65, "Chapter"],
Cell[CellGroupData[{
Cell[284683, 7493, 110, 1, 64, "Section"],
Cell[284796, 7496, 9071, 245, 234, "Input"],
Cell[CellGroupData[{
Cell[293892, 7745, 2848, 80, 122, "Input"],
Cell[296743, 7827, 1214, 25, 53, "Output"]
}, Open  ]],
Cell[297972, 7855, 855, 27, 41, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298864, 7887, 108, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[298997, 7892, 2804, 72, 157, "Input"],
Cell[301804, 7966, 1305, 24, 46, "Output"],
Cell[303112, 7992, 1343, 26, 48, "Output"],
Cell[304458, 8020, 2465, 62, 83, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[306972, 8088, 115, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[307112, 8093, 5941, 141, 357, "Input"],
Cell[313056, 8236, 1002, 28, 51, "Output"],
Cell[314061, 8266, 1015, 28, 52, "Output"],
Cell[315079, 8296, 1480, 43, 53, "Output"],
Cell[316562, 8341, 1519, 43, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318118, 8389, 3345, 93, 155, "Input"],
Cell[321466, 8484, 1392, 39, 52, "Output"],
Cell[322861, 8525, 1972, 53, 96, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[324882, 8584, 115, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[325022, 8589, 4244, 113, 319, "Input"],
Cell[329269, 8704, 929, 27, 51, "Output"],
Cell[330201, 8733, 940, 27, 52, "Output"],
Cell[331144, 8762, 1404, 42, 53, "Output"],
Cell[332551, 8806, 1444, 42, 53, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[334056, 8855, 181, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[334262, 8861, 883, 20, 54, "Input"],
Cell[335148, 8883, 133392, 3358, 704, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[468589, 12247, 106, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[468720, 12252, 1175, 34, 54, "Input"],
Cell[469898, 12288, 8606, 242, 170, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[478553, 12536, 82, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[478660, 12541, 211, 3, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[478896, 12548, 3546, 103, 264, "Input"],
Cell[482445, 12653, 643, 11, 24, "Message"],
Cell[483091, 12666, 566, 9, 32, "Output"],
Cell[483660, 12677, 1021, 21, 46, "Output"],
Cell[484684, 12700, 896, 19, 45, "Output"],
Cell[485583, 12721, 741, 15, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[486373, 12742, 110, 1, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[486508, 12747, 3377, 99, 117, "Input"],
Cell[489888, 12848, 440, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[490365, 12861, 3796, 114, 285, "Input"],
Cell[494164, 12977, 365, 6, 32, "Output"],
Cell[494532, 12985, 1855, 53, 53, "Output"],
Cell[496390, 13040, 1452, 43, 53, "Output"],
Cell[497845, 13085, 590, 14, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[498496, 13106, 115, 1, 65, "Chapter"],
Cell[498614, 13109, 1039, 31, 40, "Input"],
Cell[CellGroupData[{
Cell[499678, 13144, 1501, 41, 54, "Input"],
Cell[501182, 13187, 380, 7, 45, "Output"],
Cell[501565, 13196, 390, 8, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[502004, 13210, 106, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[502135, 13215, 67, 1, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[502227, 13220, 3608, 92, 243, "Input"],
Cell[505838, 13314, 876, 13, 32, "Output"],
Cell[506717, 13329, 2548, 66, 53, "Output"],
Cell[509268, 13397, 1101, 21, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[510406, 13423, 121, 1, 35, "Subsubsection"],
Cell[510530, 13426, 1039, 31, 40, "Input"],
Cell[CellGroupData[{
Cell[511594, 13461, 2193, 58, 83, "Input"],
Cell[513790, 13521, 608, 9, 45, "Output"],
Cell[514401, 13532, 608, 9, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[515070, 13548, 96, 1, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[515191, 13553, 4413, 130, 304, "Input"],
Cell[519607, 13685, 548, 9, 32, "Output"],
Cell[520158, 13696, 1353, 34, 49, "Output"],
Cell[521514, 13732, 905, 21, 49, "Output"],
Cell[522422, 13755, 800, 18, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[523259, 13778, 121, 1, 35, "Subsubsection"],
Cell[523383, 13781, 1039, 31, 40, "Input"],
Cell[CellGroupData[{
Cell[524447, 13816, 2239, 58, 83, "Input"],
Cell[526689, 13876, 662, 11, 45, "Output"],
Cell[527354, 13889, 664, 11, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[528091, 13908, 127, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[528243, 13913, 3199, 77, 456, "Input"],
Cell[531445, 13992, 861, 20, 32, "Output"],
Cell[532309, 14014, 892, 21, 47, "Output"],
Cell[533204, 14037, 1339, 32, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[534580, 14074, 336, 8, 104, "Input"],
Cell[534919, 14084, 632, 15, 32, "Output"],
Cell[535554, 14101, 162, 3, 32, "Output"],
Cell[535719, 14106, 162, 3, 32, "Output"]
}, Open  ]],
Cell[535896, 14112, 94, 1, 32, "Input"],
Cell[535993, 14115, 92, 1, 32, "Input"]
}, Open  ]]
}, Closed]]
}
]
*)

